<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Gradient-Boosting Machine (XGBoost)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="xgboost_files/libs/clipboard/clipboard.min.js"></script>
<script src="xgboost_files/libs/quarto-html/quarto.js"></script>
<script src="xgboost_files/libs/quarto-html/popper.min.js"></script>
<script src="xgboost_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="xgboost_files/libs/quarto-html/anchor.min.js"></script>
<link href="xgboost_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="xgboost_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="xgboost_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="xgboost_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="xgboost_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Gradient-Boosting Machine (XGBoost)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="exploring-the-association-between-neoantigen-related-variables-and-immune-scores" class="level3">
<h3 class="anchored" data-anchor-id="exploring-the-association-between-neoantigen-related-variables-and-immune-scores"><em>Exploring the association between neoantigen-related variables and immune scores</em></h3>
<p>This notebook details the steps taken to assess the relationship between different clinical variables alongside types of neoantigen metrics versus various immune scores (immune gene signatures).</p>
<section id="package-and-raw-data-loading" class="level4">
<h4 class="anchored" data-anchor-id="package-and-raw-data-loading"><strong>Package and Raw Data Loading</strong></h4>
<p>First, import necessary packages and load in the raw data table into <code>pandas</code> dataFrame.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn <span class="im">as</span> skl</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xgboost <span class="im">as</span> xgb</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> warnings <span class="im">import</span> simplefilter</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>simplefilter(action<span class="op">=</span><span class="st">"ignore"</span>, category<span class="op">=</span>pd.errors.PerformanceWarning)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_columns'</span>, <span class="va">None</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_format <span class="op">=</span> <span class="st">'retina'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>NOTE: Initially MH used <code>data_updated230524_new_excludedIHC.tsv</code> as starting point, but I realized that for certain rows, they are essentially ‘duplicates’ only differing in the value of Batch, which does not make sense. I have manually removed these rows, and saved it as a new <code>tsv</code> file, which is named as below.</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read in latest data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># use the 202409_new_excludedIHC_batch-duplicate-removed.tsv</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"../input-data/SA/202409_new_excludedIHC_batch-duplicate-removed.tsv"</span>,sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.shape)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#print row 107 and 226</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>df.iloc[[<span class="dv">107</span>,<span class="dv">226</span>,<span class="dv">555</span>,<span class="dv">872</span>], <span class="dv">1</span>:<span class="dv">25</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(953, 156)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Batch</th>
<th data-quarto-table-cell-role="th">PAM50</th>
<th data-quarto-table-cell-role="th">Subtype</th>
<th data-quarto-table-cell-role="th">HR_status</th>
<th data-quarto-table-cell-role="th">HER_status</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">AgeGroup</th>
<th data-quarto-table-cell-role="th">Stage</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionNeo_bestScore</th>
<th data-quarto-table-cell-role="th">FusionTransscript_Count</th>
<th data-quarto-table-cell-role="th">Fusion_T2NeoRate</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50Percentile</th>
<th data-quarto-table-cell-role="th">TotalNeo_Count</th>
<th data-quarto-table-cell-role="th">ESTIMATE</th>
<th data-quarto-table-cell-role="th">IMPRES</th>
<th data-quarto-table-cell-role="th">Bindea_full</th>
<th data-quarto-table-cell-role="th">Expanded_IFNg</th>
<th data-quarto-table-cell-role="th">C_Bcellsnaive</th>
<th data-quarto-table-cell-role="th">C_Bcellsmemory</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">107</td>
<td>Batch_1</td>
<td>LumA</td>
<td>HR+/HER2-</td>
<td>HR+</td>
<td>HER2-</td>
<td>60.0</td>
<td>51-60</td>
<td>2.0</td>
<td>2.0</td>
<td>3.0</td>
<td>NaN</td>
<td>NaN</td>
<td>10.0</td>
<td>NaN</td>
<td>153.0</td>
<td>3.9</td>
<td>0.0038</td>
<td>NaN</td>
<td>2706.111665</td>
<td>9.0</td>
<td>-0.2558</td>
<td>-0.7362</td>
<td>0.078713</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">226</td>
<td>Batch_1</td>
<td>LumA</td>
<td>HR+/HER2-</td>
<td>HR+</td>
<td>HER2-</td>
<td>66.0</td>
<td>61-70</td>
<td>3.0</td>
<td>2.0</td>
<td>2.5</td>
<td>NaN</td>
<td>NaN</td>
<td>12.0</td>
<td>NaN</td>
<td>141.0</td>
<td>3.8</td>
<td>0.0040</td>
<td>NaN</td>
<td>2809.623846</td>
<td>9.0</td>
<td>-0.2755</td>
<td>-0.8429</td>
<td>0.164741</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">555</td>
<td>Batch_2</td>
<td>Her2</td>
<td>TNBC</td>
<td>HR-</td>
<td>HER2-</td>
<td>67.0</td>
<td>61-70</td>
<td>1.0</td>
<td>NaN</td>
<td>1.6</td>
<td>NaN</td>
<td>NaN</td>
<td>62.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5273.837913</td>
<td>10.0</td>
<td>0.0110</td>
<td>0.6930</td>
<td>0.118868</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">872</td>
<td>Batch_2</td>
<td>Basal</td>
<td>TNBC</td>
<td>HR-</td>
<td>HER2-</td>
<td>56.0</td>
<td>51-60</td>
<td>2.0</td>
<td>2.0</td>
<td>2.6</td>
<td>48.0</td>
<td>10.86</td>
<td>85.0</td>
<td>0.564705882</td>
<td>2179.0</td>
<td>1.8</td>
<td>0.0010</td>
<td>2227.0</td>
<td>3518.159157</td>
<td>10.0</td>
<td>-0.3685</td>
<td>0.1545</td>
<td>0.106324</td>
<td>0.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># exclude the 29 Cibersort scores, leaving only 3</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(columns<span class="op">=</span>[<span class="st">'Bindea_full'</span>, <span class="st">'Expanded_IFNg'</span>, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">'C_Bcellsmemory'</span>,<span class="st">'C_Plasmacells'</span>,<span class="st">'C_TcellsCD8'</span>,<span class="st">'C_TcellsCD4naive'</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">'C_TcellsCD4memoryactivated'</span>,<span class="st">'C_Tcellsfollicularhelper'</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">'C_Tcellsregulatory(Tregs)'</span>,<span class="st">'C_Tcellsgammadelta'</span>,<span class="st">'C_NKcellsresting'</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">'C_NKcellsactivated'</span>, <span class="st">'C_Monocytes'</span>, <span class="st">'C_MacrophagesM0'</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">'C_MacrophagesM1'</span>,<span class="st">'C_Dendriticcellsresting'</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">'C_Dendriticcellsactivated'</span>, <span class="st">'C_Mastcellsresting'</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">'C_Mastcellsactivated'</span>,<span class="st">'C_Eosinophils'</span>, <span class="st">'C_Neutrophils'</span>, <span class="st">'S_PAM100HRD'</span>])</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.shape)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(953, 134)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">Batch</th>
<th data-quarto-table-cell-role="th">PAM50</th>
<th data-quarto-table-cell-role="th">Subtype</th>
<th data-quarto-table-cell-role="th">HR_status</th>
<th data-quarto-table-cell-role="th">HER_status</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">AgeGroup</th>
<th data-quarto-table-cell-role="th">Stage</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionNeo_bestScore</th>
<th data-quarto-table-cell-role="th">FusionTransscript_Count</th>
<th data-quarto-table-cell-role="th">Fusion_T2NeoRate</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50Percentile</th>
<th data-quarto-table-cell-role="th">TotalNeo_Count</th>
<th data-quarto-table-cell-role="th">ESTIMATE</th>
<th data-quarto-table-cell-role="th">IMPRES</th>
<th data-quarto-table-cell-role="th">C_Bcellsnaive</th>
<th data-quarto-table-cell-role="th">C_TcellsCD4memoryresting</th>
<th data-quarto-table-cell-role="th">C_MacrophagesM2</th>
<th data-quarto-table-cell-role="th">S_Attractors_LYM</th>
<th data-quarto-table-cell-role="th">S_Attractors_IFIT3</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_GIMAP4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_HLA.DPA1</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SLAMF6</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_LILRB4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SIGLEC9</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CYTH4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CD3E</th>
<th data-quarto-table-cell-role="th">S_Lymph_Vessels</th>
<th data-quarto-table-cell-role="th">S_ICR_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_INHIB_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_ACT_SCORE</th>
<th data-quarto-table-cell-role="th">S_Angiogenesis</th>
<th data-quarto-table-cell-role="th">S_APM1</th>
<th data-quarto-table-cell-role="th">S_APM2</th>
<th data-quarto-table-cell-role="th">S_ICS5_score</th>
<th data-quarto-table-cell-role="th">S_LIexpression_score</th>
<th data-quarto-table-cell-role="th">S_Chemokine12_score</th>
<th data-quarto-table-cell-role="th">S_NHI_5gene_score</th>
<th data-quarto-table-cell-role="th">S_CD68</th>
<th data-quarto-table-cell-role="th">S_CD8A</th>
<th data-quarto-table-cell-role="th">S_PD1_data</th>
<th data-quarto-table-cell-role="th">S_PDL1_data</th>
<th data-quarto-table-cell-role="th">S_PD1_PDL1_score</th>
<th data-quarto-table-cell-role="th">S_CTLA4_data</th>
<th data-quarto-table-cell-role="th">S_Bcell_mg_IGJ</th>
<th data-quarto-table-cell-role="th">S_Bcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_STAT1_score</th>
<th data-quarto-table-cell-role="th">S_CSF1_response</th>
<th data-quarto-table-cell-role="th">S_TcClassII_score</th>
<th data-quarto-table-cell-role="th">S_IL12_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL4_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL2_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL13_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IFNG_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TGFB_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TREM1_data</th>
<th data-quarto-table-cell-role="th">S_DAP12_data</th>
<th data-quarto-table-cell-role="th">S_Tcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_IL8_21978456</th>
<th data-quarto-table-cell-role="th">S_IFN_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC1_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC2_21978456</th>
<th data-quarto-table-cell-role="th">S_Bcell_21978456</th>
<th data-quarto-table-cell-role="th">S_Tcell_21978456</th>
<th data-quarto-table-cell-role="th">S_CD103pos_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_CD103neg_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_IgG_19272155</th>
<th data-quarto-table-cell-role="th">S_Interferon_19272155</th>
<th data-quarto-table-cell-role="th">S_LCK_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.I_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.II_19272155</th>
<th data-quarto-table-cell-role="th">S_STAT1_19272155</th>
<th data-quarto-table-cell-role="th">S_Troester_WoundSig_19887484</th>
<th data-quarto-table-cell-role="th">S_MDACC.FNA.1_20805453</th>
<th data-quarto-table-cell-role="th">S_IGG_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Minterferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Immune_cell_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_MCD3_CD8_21214954</th>
<th data-quarto-table-cell-role="th">S_Interferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_B_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_CD8_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_GRANS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_LYMPHS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_T_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_TGFB_PCA_17349583</th>
<th data-quarto-table-cell-role="th">S_Rotterdam_ERneg_PCA_15721472</th>
<th data-quarto-table-cell-role="th">S_HER2_Immune_PCA_18006808</th>
<th data-quarto-table-cell-role="th">S_IR7_score</th>
<th data-quarto-table-cell-role="th">S_Buck14_score</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_score</th>
<th data-quarto-table-cell-role="th">S_Immune_NSCLC_score</th>
<th data-quarto-table-cell-role="th">S_Module3_IFN_score</th>
<th data-quarto-table-cell-role="th">S_Module4_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module5_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module11_Prolif_score</th>
<th data-quarto-table-cell-role="th">S_CD8_CD68_ratio</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_TcClassII_ratio</th>
<th data-quarto-table-cell-role="th">S_CHANG_CORE_SERUM_RESPONSE_UP</th>
<th data-quarto-table-cell-role="th">S_CSR_Activated_15701700</th>
<th data-quarto-table-cell-role="th">S_B_cells</th>
<th data-quarto-table-cell-role="th">S_T_cells</th>
<th data-quarto-table-cell-role="th">S_T_helper</th>
<th data-quarto-table-cell-role="th">S_Tcm</th>
<th data-quarto-table-cell-role="th">S_Tem</th>
<th data-quarto-table-cell-role="th">S_Th1</th>
<th data-quarto-table-cell-role="th">S_Th2</th>
<th data-quarto-table-cell-role="th">S_TFH</th>
<th data-quarto-table-cell-role="th">S_CD8_Tcells</th>
<th data-quarto-table-cell-role="th">S_Th17</th>
<th data-quarto-table-cell-role="th">S_Treg</th>
<th data-quarto-table-cell-role="th">S_Tgd</th>
<th data-quarto-table-cell-role="th">S_Cytotoxic_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cd56dim</th>
<th data-quarto-table-cell-role="th">S_NK_cd56bright</th>
<th data-quarto-table-cell-role="th">S_DC</th>
<th data-quarto-table-cell-role="th">S_iDC</th>
<th data-quarto-table-cell-role="th">S_aDC</th>
<th data-quarto-table-cell-role="th">S_pDC</th>
<th data-quarto-table-cell-role="th">S_Eosinophils</th>
<th data-quarto-table-cell-role="th">S_Macrophages</th>
<th data-quarto-table-cell-role="th">S_Mast</th>
<th data-quarto-table-cell-role="th">S_Neutrophils</th>
<th data-quarto-table-cell-role="th">S_Bindea_full</th>
<th data-quarto-table-cell-role="th">S_Expanded_IFNg</th>
<th data-quarto-table-cell-role="th">S_KEGG_MMR</th>
<th data-quarto-table-cell-role="th">S_KEGG_TGF_Beta</th>
<th data-quarto-table-cell-role="th">S_KEGG_Cytosolic_DNA_Sensing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>SD0012</td>
<td>Batch_1</td>
<td>LumB</td>
<td>HR+/HER2-</td>
<td>HR+</td>
<td>HER2-</td>
<td>50.0</td>
<td>41-50</td>
<td>2.0</td>
<td>2.0</td>
<td>2.3</td>
<td>20.0</td>
<td>5.79</td>
<td>42.0</td>
<td>0.476190476</td>
<td>357.0</td>
<td>1.7</td>
<td>0.0025</td>
<td>377.0</td>
<td>2895.605487</td>
<td>9.0</td>
<td>0.120394</td>
<td>0.117468</td>
<td>0.448450</td>
<td>0.3620</td>
<td>0.4216</td>
<td>0.3034</td>
<td>0.4425</td>
<td>0.2749</td>
<td>0.2983</td>
<td>0.2756</td>
<td>0.3121</td>
<td>0.2765</td>
<td>0.3203</td>
<td>0.2463</td>
<td>0.2341</td>
<td>0.2495</td>
<td>0.3571</td>
<td>0.4591</td>
<td>0.3985</td>
<td>0.2130</td>
<td>0.2223</td>
<td>0.2766</td>
<td>0.3573</td>
<td>0.1561</td>
<td>0.2942</td>
<td>0.1536</td>
<td>0.2530</td>
<td>0.2042</td>
<td>0.2061</td>
<td>0.1942</td>
<td>0.2764</td>
<td>0.3327</td>
<td>0.3795</td>
<td>0.3435</td>
<td>0.2846</td>
<td>0.3797</td>
<td>0.3761</td>
<td>0.3197</td>
<td>0.4008</td>
<td>0.4403</td>
<td>0.2907</td>
<td>0.4011</td>
<td>0.2526</td>
<td>0.2237</td>
<td>0.4256</td>
<td>0.3971</td>
<td>0.4477</td>
<td>0.1852</td>
<td>0.2516</td>
<td>0.2262</td>
<td>0.3854</td>
<td>0.1591</td>
<td>0.4462</td>
<td>0.2912</td>
<td>0.4211</td>
<td>0.4502</td>
<td>0.3610</td>
<td>0.2711</td>
<td>0.3414</td>
<td>0.2183</td>
<td>0.3728</td>
<td>0.3512</td>
<td>0.3529</td>
<td>0.4162</td>
<td>0.3612</td>
<td>0.2215</td>
<td>0.3614</td>
<td>0.4294</td>
<td>0.3451</td>
<td>0.4648</td>
<td>0.2937</td>
<td>0.3338</td>
<td>0.2999</td>
<td>0.2094</td>
<td>0.2743</td>
<td>0.3203</td>
<td>0.4136</td>
<td>0.2546</td>
<td>0.2730</td>
<td>0.3697</td>
<td>0.2268</td>
<td>0.3335</td>
<td>0.3959</td>
<td>0.4066</td>
<td>0.2199</td>
<td>0.2395</td>
<td>0.4132</td>
<td>0.3633</td>
<td>0.3210</td>
<td>0.2599</td>
<td>0.3561</td>
<td>0.3112</td>
<td>0.3645</td>
<td>0.2810</td>
<td>0.2348</td>
<td>0.1945</td>
<td>0.2188</td>
<td>0.3281</td>
<td>0.0602</td>
<td>0.2038</td>
<td>0.2445</td>
<td>0.3220</td>
<td>0.2212</td>
<td>0.2866</td>
<td>0.3030</td>
<td>0.3657</td>
<td>0.2499</td>
<td>0.2531</td>
<td>0.3031</td>
<td>0.3097</td>
<td>0.4053</td>
<td>0.3537</td>
<td>0.2530</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>SD0014</td>
<td>Batch_1</td>
<td>LumA</td>
<td>HR+/HER2-</td>
<td>HR+</td>
<td>HER2-</td>
<td>58.0</td>
<td>51-60</td>
<td>2.0</td>
<td>2.0</td>
<td>2.5</td>
<td>10.0</td>
<td>5.28</td>
<td>17.0</td>
<td>0.588235294</td>
<td>85.0</td>
<td>4.1</td>
<td>0.0039</td>
<td>95.0</td>
<td>4257.831526</td>
<td>11.0</td>
<td>0.165023</td>
<td>0.207531</td>
<td>0.124223</td>
<td>0.4126</td>
<td>0.3815</td>
<td>0.3619</td>
<td>0.4760</td>
<td>0.3343</td>
<td>0.3001</td>
<td>0.2769</td>
<td>0.3761</td>
<td>0.3525</td>
<td>0.3452</td>
<td>0.3051</td>
<td>0.2701</td>
<td>0.3143</td>
<td>0.3803</td>
<td>0.4819</td>
<td>0.4125</td>
<td>0.3002</td>
<td>0.3106</td>
<td>0.3646</td>
<td>0.3753</td>
<td>0.1030</td>
<td>0.3644</td>
<td>0.2726</td>
<td>0.2377</td>
<td>0.2553</td>
<td>0.2513</td>
<td>0.2820</td>
<td>0.3079</td>
<td>0.3515</td>
<td>0.3869</td>
<td>0.3868</td>
<td>0.3133</td>
<td>0.4051</td>
<td>0.4031</td>
<td>0.3308</td>
<td>0.4120</td>
<td>0.4496</td>
<td>0.2012</td>
<td>0.4360</td>
<td>0.3290</td>
<td>0.2562</td>
<td>0.3882</td>
<td>0.4310</td>
<td>0.4682</td>
<td>0.2990</td>
<td>0.3007</td>
<td>0.2859</td>
<td>0.3998</td>
<td>0.2225</td>
<td>0.4068</td>
<td>0.3481</td>
<td>0.4494</td>
<td>0.4710</td>
<td>0.4011</td>
<td>0.2840</td>
<td>0.3779</td>
<td>0.2727</td>
<td>0.3831</td>
<td>0.3864</td>
<td>0.3511</td>
<td>0.3983</td>
<td>0.3676</td>
<td>0.2761</td>
<td>0.3637</td>
<td>0.4268</td>
<td>0.3555</td>
<td>0.4580</td>
<td>0.3266</td>
<td>0.3549</td>
<td>0.3763</td>
<td>0.2157</td>
<td>0.3028</td>
<td>0.3278</td>
<td>0.3896</td>
<td>0.3111</td>
<td>0.3159</td>
<td>0.3126</td>
<td>0.2395</td>
<td>0.3747</td>
<td>0.3838</td>
<td>0.4030</td>
<td>0.2731</td>
<td>0.2909</td>
<td>0.4092</td>
<td>0.3404</td>
<td>0.3530</td>
<td>0.2808</td>
<td>0.3102</td>
<td>0.3229</td>
<td>0.3713</td>
<td>0.2645</td>
<td>0.3182</td>
<td>0.1977</td>
<td>0.2985</td>
<td>0.3502</td>
<td>0.1191</td>
<td>0.3316</td>
<td>0.2976</td>
<td>0.3445</td>
<td>0.2403</td>
<td>0.3450</td>
<td>0.3203</td>
<td>0.3484</td>
<td>0.2768</td>
<td>0.2783</td>
<td>0.3200</td>
<td>0.3668</td>
<td>0.3803</td>
<td>0.3470</td>
<td>0.2606</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>SD0015</td>
<td>Batch_1</td>
<td>LumA</td>
<td>HR+/HER2-</td>
<td>HR+</td>
<td>HER2-</td>
<td>46.0</td>
<td>41-50</td>
<td>1.0</td>
<td>2.0</td>
<td>1.8</td>
<td>4.0</td>
<td>11.48</td>
<td>16.0</td>
<td>0.25</td>
<td>150.0</td>
<td>2.4</td>
<td>0.0042</td>
<td>154.0</td>
<td>3123.055856</td>
<td>8.0</td>
<td>0.162653</td>
<td>0.235337</td>
<td>0.279972</td>
<td>0.3556</td>
<td>0.3782</td>
<td>0.3363</td>
<td>0.4718</td>
<td>0.3015</td>
<td>0.2659</td>
<td>0.2274</td>
<td>0.3180</td>
<td>0.3025</td>
<td>0.3124</td>
<td>0.2622</td>
<td>0.2304</td>
<td>0.2706</td>
<td>0.3761</td>
<td>0.4613</td>
<td>0.3814</td>
<td>0.3055</td>
<td>0.2764</td>
<td>0.3211</td>
<td>0.3784</td>
<td>-0.1955</td>
<td>0.3122</td>
<td>0.1932</td>
<td>0.2485</td>
<td>0.2211</td>
<td>0.2004</td>
<td>0.2478</td>
<td>0.3040</td>
<td>0.3316</td>
<td>0.3646</td>
<td>0.3483</td>
<td>0.3012</td>
<td>0.4038</td>
<td>0.3875</td>
<td>0.3158</td>
<td>0.3986</td>
<td>0.4391</td>
<td>0.1509</td>
<td>0.3958</td>
<td>0.2886</td>
<td>0.2535</td>
<td>0.3764</td>
<td>0.4054</td>
<td>0.4601</td>
<td>0.2509</td>
<td>0.2830</td>
<td>0.2712</td>
<td>0.3801</td>
<td>0.1750</td>
<td>0.3987</td>
<td>0.3063</td>
<td>0.4239</td>
<td>0.4616</td>
<td>0.3587</td>
<td>0.2955</td>
<td>0.3431</td>
<td>0.2278</td>
<td>0.3599</td>
<td>0.3549</td>
<td>0.4011</td>
<td>0.3865</td>
<td>0.3661</td>
<td>0.2671</td>
<td>0.3591</td>
<td>0.4313</td>
<td>0.3489</td>
<td>0.4442</td>
<td>0.2985</td>
<td>0.3383</td>
<td>0.3370</td>
<td>0.2609</td>
<td>0.2706</td>
<td>0.3312</td>
<td>0.3792</td>
<td>0.2851</td>
<td>0.2897</td>
<td>0.2984</td>
<td>0.0936</td>
<td>0.3370</td>
<td>0.3880</td>
<td>0.4038</td>
<td>0.2799</td>
<td>0.2873</td>
<td>0.4159</td>
<td>0.3520</td>
<td>0.3560</td>
<td>0.2600</td>
<td>0.3116</td>
<td>0.3225</td>
<td>0.3762</td>
<td>0.2370</td>
<td>0.2251</td>
<td>0.2021</td>
<td>0.2720</td>
<td>0.3434</td>
<td>0.0626</td>
<td>0.3025</td>
<td>0.2670</td>
<td>0.3212</td>
<td>0.2098</td>
<td>0.2967</td>
<td>0.3236</td>
<td>0.3266</td>
<td>0.2455</td>
<td>0.2522</td>
<td>0.3107</td>
<td>0.3372</td>
<td>0.3793</td>
<td>0.3522</td>
<td>0.2564</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>SD0016</td>
<td>Batch_1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>41.0</td>
<td>41-50</td>
<td>0.0</td>
<td>NaN</td>
<td>11.0</td>
<td>1.0</td>
<td>43.92</td>
<td>15.0</td>
<td>0.066666667</td>
<td>218.0</td>
<td>2.8</td>
<td>0.0027</td>
<td>219.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>SD0017</td>
<td>Batch_1</td>
<td>LumB</td>
<td>HR+/HER2-</td>
<td>HR+</td>
<td>HER2-</td>
<td>54.0</td>
<td>51-60</td>
<td>2.0</td>
<td>2.0</td>
<td>2.5</td>
<td>19.0</td>
<td>15.11</td>
<td>47.0</td>
<td>0.404255319</td>
<td>1369.0</td>
<td>1.7</td>
<td>0.0030</td>
<td>1388.0</td>
<td>5275.497847</td>
<td>11.0</td>
<td>0.155523</td>
<td>0.148387</td>
<td>0.128777</td>
<td>0.4314</td>
<td>0.4482</td>
<td>0.4080</td>
<td>0.4980</td>
<td>0.3912</td>
<td>0.3120</td>
<td>0.2934</td>
<td>0.3864</td>
<td>0.3957</td>
<td>0.3131</td>
<td>0.3589</td>
<td>0.3341</td>
<td>0.3654</td>
<td>0.3842</td>
<td>0.4957</td>
<td>0.4328</td>
<td>0.3533</td>
<td>0.3732</td>
<td>0.4177</td>
<td>0.4350</td>
<td>0.1401</td>
<td>0.4006</td>
<td>0.3023</td>
<td>0.3429</td>
<td>0.3228</td>
<td>0.2922</td>
<td>0.3591</td>
<td>0.3671</td>
<td>0.3926</td>
<td>0.4113</td>
<td>0.4082</td>
<td>0.3325</td>
<td>0.4092</td>
<td>0.4129</td>
<td>0.3338</td>
<td>0.4190</td>
<td>0.4248</td>
<td>0.1319</td>
<td>0.4878</td>
<td>0.3797</td>
<td>0.1889</td>
<td>0.4601</td>
<td>0.4445</td>
<td>0.4859</td>
<td>0.3224</td>
<td>0.3693</td>
<td>0.3003</td>
<td>0.4095</td>
<td>0.2938</td>
<td>0.4707</td>
<td>0.3968</td>
<td>0.4616</td>
<td>0.4893</td>
<td>0.4644</td>
<td>0.2735</td>
<td>0.3955</td>
<td>0.3234</td>
<td>0.4165</td>
<td>0.4337</td>
<td>0.4190</td>
<td>0.4511</td>
<td>0.3758</td>
<td>0.3174</td>
<td>0.3679</td>
<td>0.4314</td>
<td>0.3648</td>
<td>0.4439</td>
<td>0.2886</td>
<td>0.3688</td>
<td>0.4143</td>
<td>0.2489</td>
<td>0.3562</td>
<td>0.3498</td>
<td>0.4563</td>
<td>0.3576</td>
<td>0.3706</td>
<td>0.3377</td>
<td>0.2758</td>
<td>0.4006</td>
<td>0.4000</td>
<td>0.4062</td>
<td>0.3182</td>
<td>0.3460</td>
<td>0.4170</td>
<td>0.3275</td>
<td>0.3432</td>
<td>0.2914</td>
<td>0.3307</td>
<td>0.3525</td>
<td>0.3879</td>
<td>0.2212</td>
<td>0.3330</td>
<td>0.2251</td>
<td>0.3151</td>
<td>0.3495</td>
<td>0.1939</td>
<td>0.2953</td>
<td>0.3010</td>
<td>0.3467</td>
<td>0.2547</td>
<td>0.3313</td>
<td>0.3230</td>
<td>0.3597</td>
<td>0.2726</td>
<td>0.2648</td>
<td>0.3309</td>
<td>0.4165</td>
<td>0.3997</td>
<td>0.3468</td>
<td>0.2682</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="data-preprocessing" class="level4">
<h4 class="anchored" data-anchor-id="data-preprocessing"><strong>Data Preprocessing</strong></h4>
<p>Decide all the clinical variables and neoantigen-related variables to keep in the X matrix (features).</p>
<ol type="1">
<li><p><code>Subtype</code> column has already been encoded categorically by <code>HR_status</code> and <code>HER_status</code> columns so we can drop this column. (Alternatively, keep <code>Subtype</code> and remove <code>HR_status</code> and <code>HER_status</code>) <strong><em>UPDATE: due to their lesser importance, both <code>PAM50</code> and <code>Subtype</code> columns should be dropped as well.</em></strong></p></li>
<li><p><code>AgeGroup</code> is just a binned information of <code>Age</code> column so for now we can drop this column as it is redundant.</p></li>
<li><p>Drop <code>FusionNeo_bestScore</code>, <code>FusionTransscript_Count</code>, <code>Fusion_T2NeoRate</code> columns as well as the <code>SNVindelNeo_IC50</code> and <code>SNVindelNeo_IC50Percentile</code> columns for now to reduce complexity. ***UPDATE: Exclude <code>TotalNeo_Count</code>, and include <code>Fusion_T2NeoRate</code> and <code>SNVindelNeo_IC50</code> columns. Also, rename <code>Fusion_T2NeoRate</code> to <code>FN/FT_Ratio</code>.</p></li>
</ol>
<p><strong>Sanity Check:</strong> Check to make sure there is no duplicated index rows in the dataset.</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>dfd2 <span class="op">=</span> df.drop(columns <span class="op">=</span> [<span class="st">'PAM50'</span>, <span class="st">'Subtype'</span>, <span class="st">'HR_status'</span>, <span class="st">'HER_status'</span>, <span class="st">'AgeGroup'</span>, <span class="st">'FusionNeo_bestScore'</span>, <span class="st">'TotalNeo_Count'</span>, <span class="st">'SNVindelNeo_IC50Percentile'</span>])</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dfd2.shape)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>dfd2.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(953, 126)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">Batch</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Stage</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionTransscript_Count</th>
<th data-quarto-table-cell-role="th">Fusion_T2NeoRate</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
<th data-quarto-table-cell-role="th">ESTIMATE</th>
<th data-quarto-table-cell-role="th">IMPRES</th>
<th data-quarto-table-cell-role="th">C_Bcellsnaive</th>
<th data-quarto-table-cell-role="th">C_TcellsCD4memoryresting</th>
<th data-quarto-table-cell-role="th">C_MacrophagesM2</th>
<th data-quarto-table-cell-role="th">S_Attractors_LYM</th>
<th data-quarto-table-cell-role="th">S_Attractors_IFIT3</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_GIMAP4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_HLA.DPA1</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SLAMF6</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_LILRB4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SIGLEC9</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CYTH4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CD3E</th>
<th data-quarto-table-cell-role="th">S_Lymph_Vessels</th>
<th data-quarto-table-cell-role="th">S_ICR_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_INHIB_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_ACT_SCORE</th>
<th data-quarto-table-cell-role="th">S_Angiogenesis</th>
<th data-quarto-table-cell-role="th">S_APM1</th>
<th data-quarto-table-cell-role="th">S_APM2</th>
<th data-quarto-table-cell-role="th">S_ICS5_score</th>
<th data-quarto-table-cell-role="th">S_LIexpression_score</th>
<th data-quarto-table-cell-role="th">S_Chemokine12_score</th>
<th data-quarto-table-cell-role="th">S_NHI_5gene_score</th>
<th data-quarto-table-cell-role="th">S_CD68</th>
<th data-quarto-table-cell-role="th">S_CD8A</th>
<th data-quarto-table-cell-role="th">S_PD1_data</th>
<th data-quarto-table-cell-role="th">S_PDL1_data</th>
<th data-quarto-table-cell-role="th">S_PD1_PDL1_score</th>
<th data-quarto-table-cell-role="th">S_CTLA4_data</th>
<th data-quarto-table-cell-role="th">S_Bcell_mg_IGJ</th>
<th data-quarto-table-cell-role="th">S_Bcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_STAT1_score</th>
<th data-quarto-table-cell-role="th">S_CSF1_response</th>
<th data-quarto-table-cell-role="th">S_TcClassII_score</th>
<th data-quarto-table-cell-role="th">S_IL12_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL4_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL2_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL13_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IFNG_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TGFB_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TREM1_data</th>
<th data-quarto-table-cell-role="th">S_DAP12_data</th>
<th data-quarto-table-cell-role="th">S_Tcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_IL8_21978456</th>
<th data-quarto-table-cell-role="th">S_IFN_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC1_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC2_21978456</th>
<th data-quarto-table-cell-role="th">S_Bcell_21978456</th>
<th data-quarto-table-cell-role="th">S_Tcell_21978456</th>
<th data-quarto-table-cell-role="th">S_CD103pos_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_CD103neg_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_IgG_19272155</th>
<th data-quarto-table-cell-role="th">S_Interferon_19272155</th>
<th data-quarto-table-cell-role="th">S_LCK_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.I_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.II_19272155</th>
<th data-quarto-table-cell-role="th">S_STAT1_19272155</th>
<th data-quarto-table-cell-role="th">S_Troester_WoundSig_19887484</th>
<th data-quarto-table-cell-role="th">S_MDACC.FNA.1_20805453</th>
<th data-quarto-table-cell-role="th">S_IGG_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Minterferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Immune_cell_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_MCD3_CD8_21214954</th>
<th data-quarto-table-cell-role="th">S_Interferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_B_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_CD8_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_GRANS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_LYMPHS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_T_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_TGFB_PCA_17349583</th>
<th data-quarto-table-cell-role="th">S_Rotterdam_ERneg_PCA_15721472</th>
<th data-quarto-table-cell-role="th">S_HER2_Immune_PCA_18006808</th>
<th data-quarto-table-cell-role="th">S_IR7_score</th>
<th data-quarto-table-cell-role="th">S_Buck14_score</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_score</th>
<th data-quarto-table-cell-role="th">S_Immune_NSCLC_score</th>
<th data-quarto-table-cell-role="th">S_Module3_IFN_score</th>
<th data-quarto-table-cell-role="th">S_Module4_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module5_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module11_Prolif_score</th>
<th data-quarto-table-cell-role="th">S_CD8_CD68_ratio</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_TcClassII_ratio</th>
<th data-quarto-table-cell-role="th">S_CHANG_CORE_SERUM_RESPONSE_UP</th>
<th data-quarto-table-cell-role="th">S_CSR_Activated_15701700</th>
<th data-quarto-table-cell-role="th">S_B_cells</th>
<th data-quarto-table-cell-role="th">S_T_cells</th>
<th data-quarto-table-cell-role="th">S_T_helper</th>
<th data-quarto-table-cell-role="th">S_Tcm</th>
<th data-quarto-table-cell-role="th">S_Tem</th>
<th data-quarto-table-cell-role="th">S_Th1</th>
<th data-quarto-table-cell-role="th">S_Th2</th>
<th data-quarto-table-cell-role="th">S_TFH</th>
<th data-quarto-table-cell-role="th">S_CD8_Tcells</th>
<th data-quarto-table-cell-role="th">S_Th17</th>
<th data-quarto-table-cell-role="th">S_Treg</th>
<th data-quarto-table-cell-role="th">S_Tgd</th>
<th data-quarto-table-cell-role="th">S_Cytotoxic_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cd56dim</th>
<th data-quarto-table-cell-role="th">S_NK_cd56bright</th>
<th data-quarto-table-cell-role="th">S_DC</th>
<th data-quarto-table-cell-role="th">S_iDC</th>
<th data-quarto-table-cell-role="th">S_aDC</th>
<th data-quarto-table-cell-role="th">S_pDC</th>
<th data-quarto-table-cell-role="th">S_Eosinophils</th>
<th data-quarto-table-cell-role="th">S_Macrophages</th>
<th data-quarto-table-cell-role="th">S_Mast</th>
<th data-quarto-table-cell-role="th">S_Neutrophils</th>
<th data-quarto-table-cell-role="th">S_Bindea_full</th>
<th data-quarto-table-cell-role="th">S_Expanded_IFNg</th>
<th data-quarto-table-cell-role="th">S_KEGG_MMR</th>
<th data-quarto-table-cell-role="th">S_KEGG_TGF_Beta</th>
<th data-quarto-table-cell-role="th">S_KEGG_Cytosolic_DNA_Sensing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>SD0012</td>
<td>Batch_1</td>
<td>50.0</td>
<td>2.0</td>
<td>2.0</td>
<td>2.3</td>
<td>20.0</td>
<td>42.0</td>
<td>0.476190476</td>
<td>357.0</td>
<td>1.7</td>
<td>2895.605487</td>
<td>9.0</td>
<td>0.120394</td>
<td>0.117468</td>
<td>0.448450</td>
<td>0.3620</td>
<td>0.4216</td>
<td>0.3034</td>
<td>0.4425</td>
<td>0.2749</td>
<td>0.2983</td>
<td>0.2756</td>
<td>0.3121</td>
<td>0.2765</td>
<td>0.3203</td>
<td>0.2463</td>
<td>0.2341</td>
<td>0.2495</td>
<td>0.3571</td>
<td>0.4591</td>
<td>0.3985</td>
<td>0.2130</td>
<td>0.2223</td>
<td>0.2766</td>
<td>0.3573</td>
<td>0.1561</td>
<td>0.2942</td>
<td>0.1536</td>
<td>0.2530</td>
<td>0.2042</td>
<td>0.2061</td>
<td>0.1942</td>
<td>0.2764</td>
<td>0.3327</td>
<td>0.3795</td>
<td>0.3435</td>
<td>0.2846</td>
<td>0.3797</td>
<td>0.3761</td>
<td>0.3197</td>
<td>0.4008</td>
<td>0.4403</td>
<td>0.2907</td>
<td>0.4011</td>
<td>0.2526</td>
<td>0.2237</td>
<td>0.4256</td>
<td>0.3971</td>
<td>0.4477</td>
<td>0.1852</td>
<td>0.2516</td>
<td>0.2262</td>
<td>0.3854</td>
<td>0.1591</td>
<td>0.4462</td>
<td>0.2912</td>
<td>0.4211</td>
<td>0.4502</td>
<td>0.3610</td>
<td>0.2711</td>
<td>0.3414</td>
<td>0.2183</td>
<td>0.3728</td>
<td>0.3512</td>
<td>0.3529</td>
<td>0.4162</td>
<td>0.3612</td>
<td>0.2215</td>
<td>0.3614</td>
<td>0.4294</td>
<td>0.3451</td>
<td>0.4648</td>
<td>0.2937</td>
<td>0.3338</td>
<td>0.2999</td>
<td>0.2094</td>
<td>0.2743</td>
<td>0.3203</td>
<td>0.4136</td>
<td>0.2546</td>
<td>0.2730</td>
<td>0.3697</td>
<td>0.2268</td>
<td>0.3335</td>
<td>0.3959</td>
<td>0.4066</td>
<td>0.2199</td>
<td>0.2395</td>
<td>0.4132</td>
<td>0.3633</td>
<td>0.3210</td>
<td>0.2599</td>
<td>0.3561</td>
<td>0.3112</td>
<td>0.3645</td>
<td>0.2810</td>
<td>0.2348</td>
<td>0.1945</td>
<td>0.2188</td>
<td>0.3281</td>
<td>0.0602</td>
<td>0.2038</td>
<td>0.2445</td>
<td>0.3220</td>
<td>0.2212</td>
<td>0.2866</td>
<td>0.3030</td>
<td>0.3657</td>
<td>0.2499</td>
<td>0.2531</td>
<td>0.3031</td>
<td>0.3097</td>
<td>0.4053</td>
<td>0.3537</td>
<td>0.2530</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>SD0014</td>
<td>Batch_1</td>
<td>58.0</td>
<td>2.0</td>
<td>2.0</td>
<td>2.5</td>
<td>10.0</td>
<td>17.0</td>
<td>0.588235294</td>
<td>85.0</td>
<td>4.1</td>
<td>4257.831526</td>
<td>11.0</td>
<td>0.165023</td>
<td>0.207531</td>
<td>0.124223</td>
<td>0.4126</td>
<td>0.3815</td>
<td>0.3619</td>
<td>0.4760</td>
<td>0.3343</td>
<td>0.3001</td>
<td>0.2769</td>
<td>0.3761</td>
<td>0.3525</td>
<td>0.3452</td>
<td>0.3051</td>
<td>0.2701</td>
<td>0.3143</td>
<td>0.3803</td>
<td>0.4819</td>
<td>0.4125</td>
<td>0.3002</td>
<td>0.3106</td>
<td>0.3646</td>
<td>0.3753</td>
<td>0.1030</td>
<td>0.3644</td>
<td>0.2726</td>
<td>0.2377</td>
<td>0.2553</td>
<td>0.2513</td>
<td>0.2820</td>
<td>0.3079</td>
<td>0.3515</td>
<td>0.3869</td>
<td>0.3868</td>
<td>0.3133</td>
<td>0.4051</td>
<td>0.4031</td>
<td>0.3308</td>
<td>0.4120</td>
<td>0.4496</td>
<td>0.2012</td>
<td>0.4360</td>
<td>0.3290</td>
<td>0.2562</td>
<td>0.3882</td>
<td>0.4310</td>
<td>0.4682</td>
<td>0.2990</td>
<td>0.3007</td>
<td>0.2859</td>
<td>0.3998</td>
<td>0.2225</td>
<td>0.4068</td>
<td>0.3481</td>
<td>0.4494</td>
<td>0.4710</td>
<td>0.4011</td>
<td>0.2840</td>
<td>0.3779</td>
<td>0.2727</td>
<td>0.3831</td>
<td>0.3864</td>
<td>0.3511</td>
<td>0.3983</td>
<td>0.3676</td>
<td>0.2761</td>
<td>0.3637</td>
<td>0.4268</td>
<td>0.3555</td>
<td>0.4580</td>
<td>0.3266</td>
<td>0.3549</td>
<td>0.3763</td>
<td>0.2157</td>
<td>0.3028</td>
<td>0.3278</td>
<td>0.3896</td>
<td>0.3111</td>
<td>0.3159</td>
<td>0.3126</td>
<td>0.2395</td>
<td>0.3747</td>
<td>0.3838</td>
<td>0.4030</td>
<td>0.2731</td>
<td>0.2909</td>
<td>0.4092</td>
<td>0.3404</td>
<td>0.3530</td>
<td>0.2808</td>
<td>0.3102</td>
<td>0.3229</td>
<td>0.3713</td>
<td>0.2645</td>
<td>0.3182</td>
<td>0.1977</td>
<td>0.2985</td>
<td>0.3502</td>
<td>0.1191</td>
<td>0.3316</td>
<td>0.2976</td>
<td>0.3445</td>
<td>0.2403</td>
<td>0.3450</td>
<td>0.3203</td>
<td>0.3484</td>
<td>0.2768</td>
<td>0.2783</td>
<td>0.3200</td>
<td>0.3668</td>
<td>0.3803</td>
<td>0.3470</td>
<td>0.2606</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>SD0015</td>
<td>Batch_1</td>
<td>46.0</td>
<td>1.0</td>
<td>2.0</td>
<td>1.8</td>
<td>4.0</td>
<td>16.0</td>
<td>0.25</td>
<td>150.0</td>
<td>2.4</td>
<td>3123.055856</td>
<td>8.0</td>
<td>0.162653</td>
<td>0.235337</td>
<td>0.279972</td>
<td>0.3556</td>
<td>0.3782</td>
<td>0.3363</td>
<td>0.4718</td>
<td>0.3015</td>
<td>0.2659</td>
<td>0.2274</td>
<td>0.3180</td>
<td>0.3025</td>
<td>0.3124</td>
<td>0.2622</td>
<td>0.2304</td>
<td>0.2706</td>
<td>0.3761</td>
<td>0.4613</td>
<td>0.3814</td>
<td>0.3055</td>
<td>0.2764</td>
<td>0.3211</td>
<td>0.3784</td>
<td>-0.1955</td>
<td>0.3122</td>
<td>0.1932</td>
<td>0.2485</td>
<td>0.2211</td>
<td>0.2004</td>
<td>0.2478</td>
<td>0.3040</td>
<td>0.3316</td>
<td>0.3646</td>
<td>0.3483</td>
<td>0.3012</td>
<td>0.4038</td>
<td>0.3875</td>
<td>0.3158</td>
<td>0.3986</td>
<td>0.4391</td>
<td>0.1509</td>
<td>0.3958</td>
<td>0.2886</td>
<td>0.2535</td>
<td>0.3764</td>
<td>0.4054</td>
<td>0.4601</td>
<td>0.2509</td>
<td>0.2830</td>
<td>0.2712</td>
<td>0.3801</td>
<td>0.1750</td>
<td>0.3987</td>
<td>0.3063</td>
<td>0.4239</td>
<td>0.4616</td>
<td>0.3587</td>
<td>0.2955</td>
<td>0.3431</td>
<td>0.2278</td>
<td>0.3599</td>
<td>0.3549</td>
<td>0.4011</td>
<td>0.3865</td>
<td>0.3661</td>
<td>0.2671</td>
<td>0.3591</td>
<td>0.4313</td>
<td>0.3489</td>
<td>0.4442</td>
<td>0.2985</td>
<td>0.3383</td>
<td>0.3370</td>
<td>0.2609</td>
<td>0.2706</td>
<td>0.3312</td>
<td>0.3792</td>
<td>0.2851</td>
<td>0.2897</td>
<td>0.2984</td>
<td>0.0936</td>
<td>0.3370</td>
<td>0.3880</td>
<td>0.4038</td>
<td>0.2799</td>
<td>0.2873</td>
<td>0.4159</td>
<td>0.3520</td>
<td>0.3560</td>
<td>0.2600</td>
<td>0.3116</td>
<td>0.3225</td>
<td>0.3762</td>
<td>0.2370</td>
<td>0.2251</td>
<td>0.2021</td>
<td>0.2720</td>
<td>0.3434</td>
<td>0.0626</td>
<td>0.3025</td>
<td>0.2670</td>
<td>0.3212</td>
<td>0.2098</td>
<td>0.2967</td>
<td>0.3236</td>
<td>0.3266</td>
<td>0.2455</td>
<td>0.2522</td>
<td>0.3107</td>
<td>0.3372</td>
<td>0.3793</td>
<td>0.3522</td>
<td>0.2564</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>SD0016</td>
<td>Batch_1</td>
<td>41.0</td>
<td>0.0</td>
<td>NaN</td>
<td>11.0</td>
<td>1.0</td>
<td>15.0</td>
<td>0.066666667</td>
<td>218.0</td>
<td>2.8</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>SD0017</td>
<td>Batch_1</td>
<td>54.0</td>
<td>2.0</td>
<td>2.0</td>
<td>2.5</td>
<td>19.0</td>
<td>47.0</td>
<td>0.404255319</td>
<td>1369.0</td>
<td>1.7</td>
<td>5275.497847</td>
<td>11.0</td>
<td>0.155523</td>
<td>0.148387</td>
<td>0.128777</td>
<td>0.4314</td>
<td>0.4482</td>
<td>0.4080</td>
<td>0.4980</td>
<td>0.3912</td>
<td>0.3120</td>
<td>0.2934</td>
<td>0.3864</td>
<td>0.3957</td>
<td>0.3131</td>
<td>0.3589</td>
<td>0.3341</td>
<td>0.3654</td>
<td>0.3842</td>
<td>0.4957</td>
<td>0.4328</td>
<td>0.3533</td>
<td>0.3732</td>
<td>0.4177</td>
<td>0.4350</td>
<td>0.1401</td>
<td>0.4006</td>
<td>0.3023</td>
<td>0.3429</td>
<td>0.3228</td>
<td>0.2922</td>
<td>0.3591</td>
<td>0.3671</td>
<td>0.3926</td>
<td>0.4113</td>
<td>0.4082</td>
<td>0.3325</td>
<td>0.4092</td>
<td>0.4129</td>
<td>0.3338</td>
<td>0.4190</td>
<td>0.4248</td>
<td>0.1319</td>
<td>0.4878</td>
<td>0.3797</td>
<td>0.1889</td>
<td>0.4601</td>
<td>0.4445</td>
<td>0.4859</td>
<td>0.3224</td>
<td>0.3693</td>
<td>0.3003</td>
<td>0.4095</td>
<td>0.2938</td>
<td>0.4707</td>
<td>0.3968</td>
<td>0.4616</td>
<td>0.4893</td>
<td>0.4644</td>
<td>0.2735</td>
<td>0.3955</td>
<td>0.3234</td>
<td>0.4165</td>
<td>0.4337</td>
<td>0.4190</td>
<td>0.4511</td>
<td>0.3758</td>
<td>0.3174</td>
<td>0.3679</td>
<td>0.4314</td>
<td>0.3648</td>
<td>0.4439</td>
<td>0.2886</td>
<td>0.3688</td>
<td>0.4143</td>
<td>0.2489</td>
<td>0.3562</td>
<td>0.3498</td>
<td>0.4563</td>
<td>0.3576</td>
<td>0.3706</td>
<td>0.3377</td>
<td>0.2758</td>
<td>0.4006</td>
<td>0.4000</td>
<td>0.4062</td>
<td>0.3182</td>
<td>0.3460</td>
<td>0.4170</td>
<td>0.3275</td>
<td>0.3432</td>
<td>0.2914</td>
<td>0.3307</td>
<td>0.3525</td>
<td>0.3879</td>
<td>0.2212</td>
<td>0.3330</td>
<td>0.2251</td>
<td>0.3151</td>
<td>0.3495</td>
<td>0.1939</td>
<td>0.2953</td>
<td>0.3010</td>
<td>0.3467</td>
<td>0.2547</td>
<td>0.3313</td>
<td>0.3230</td>
<td>0.3597</td>
<td>0.2726</td>
<td>0.2648</td>
<td>0.3309</td>
<td>0.4165</td>
<td>0.3997</td>
<td>0.3468</td>
<td>0.2682</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># let's drop all NaN for now and set col 'ID' as index</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>dfx2 <span class="op">=</span> dfd2.dropna().set_index(<span class="st">'ID'</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dfx2.shape)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>dfx2.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(693, 125)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Batch</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Stage</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionTransscript_Count</th>
<th data-quarto-table-cell-role="th">Fusion_T2NeoRate</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
<th data-quarto-table-cell-role="th">ESTIMATE</th>
<th data-quarto-table-cell-role="th">IMPRES</th>
<th data-quarto-table-cell-role="th">C_Bcellsnaive</th>
<th data-quarto-table-cell-role="th">C_TcellsCD4memoryresting</th>
<th data-quarto-table-cell-role="th">C_MacrophagesM2</th>
<th data-quarto-table-cell-role="th">S_Attractors_LYM</th>
<th data-quarto-table-cell-role="th">S_Attractors_IFIT3</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_GIMAP4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_HLA.DPA1</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SLAMF6</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_LILRB4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SIGLEC9</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CYTH4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CD3E</th>
<th data-quarto-table-cell-role="th">S_Lymph_Vessels</th>
<th data-quarto-table-cell-role="th">S_ICR_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_INHIB_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_ACT_SCORE</th>
<th data-quarto-table-cell-role="th">S_Angiogenesis</th>
<th data-quarto-table-cell-role="th">S_APM1</th>
<th data-quarto-table-cell-role="th">S_APM2</th>
<th data-quarto-table-cell-role="th">S_ICS5_score</th>
<th data-quarto-table-cell-role="th">S_LIexpression_score</th>
<th data-quarto-table-cell-role="th">S_Chemokine12_score</th>
<th data-quarto-table-cell-role="th">S_NHI_5gene_score</th>
<th data-quarto-table-cell-role="th">S_CD68</th>
<th data-quarto-table-cell-role="th">S_CD8A</th>
<th data-quarto-table-cell-role="th">S_PD1_data</th>
<th data-quarto-table-cell-role="th">S_PDL1_data</th>
<th data-quarto-table-cell-role="th">S_PD1_PDL1_score</th>
<th data-quarto-table-cell-role="th">S_CTLA4_data</th>
<th data-quarto-table-cell-role="th">S_Bcell_mg_IGJ</th>
<th data-quarto-table-cell-role="th">S_Bcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_STAT1_score</th>
<th data-quarto-table-cell-role="th">S_CSF1_response</th>
<th data-quarto-table-cell-role="th">S_TcClassII_score</th>
<th data-quarto-table-cell-role="th">S_IL12_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL4_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL2_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL13_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IFNG_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TGFB_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TREM1_data</th>
<th data-quarto-table-cell-role="th">S_DAP12_data</th>
<th data-quarto-table-cell-role="th">S_Tcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_IL8_21978456</th>
<th data-quarto-table-cell-role="th">S_IFN_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC1_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC2_21978456</th>
<th data-quarto-table-cell-role="th">S_Bcell_21978456</th>
<th data-quarto-table-cell-role="th">S_Tcell_21978456</th>
<th data-quarto-table-cell-role="th">S_CD103pos_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_CD103neg_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_IgG_19272155</th>
<th data-quarto-table-cell-role="th">S_Interferon_19272155</th>
<th data-quarto-table-cell-role="th">S_LCK_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.I_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.II_19272155</th>
<th data-quarto-table-cell-role="th">S_STAT1_19272155</th>
<th data-quarto-table-cell-role="th">S_Troester_WoundSig_19887484</th>
<th data-quarto-table-cell-role="th">S_MDACC.FNA.1_20805453</th>
<th data-quarto-table-cell-role="th">S_IGG_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Minterferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Immune_cell_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_MCD3_CD8_21214954</th>
<th data-quarto-table-cell-role="th">S_Interferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_B_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_CD8_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_GRANS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_LYMPHS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_T_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_TGFB_PCA_17349583</th>
<th data-quarto-table-cell-role="th">S_Rotterdam_ERneg_PCA_15721472</th>
<th data-quarto-table-cell-role="th">S_HER2_Immune_PCA_18006808</th>
<th data-quarto-table-cell-role="th">S_IR7_score</th>
<th data-quarto-table-cell-role="th">S_Buck14_score</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_score</th>
<th data-quarto-table-cell-role="th">S_Immune_NSCLC_score</th>
<th data-quarto-table-cell-role="th">S_Module3_IFN_score</th>
<th data-quarto-table-cell-role="th">S_Module4_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module5_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module11_Prolif_score</th>
<th data-quarto-table-cell-role="th">S_CD8_CD68_ratio</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_TcClassII_ratio</th>
<th data-quarto-table-cell-role="th">S_CHANG_CORE_SERUM_RESPONSE_UP</th>
<th data-quarto-table-cell-role="th">S_CSR_Activated_15701700</th>
<th data-quarto-table-cell-role="th">S_B_cells</th>
<th data-quarto-table-cell-role="th">S_T_cells</th>
<th data-quarto-table-cell-role="th">S_T_helper</th>
<th data-quarto-table-cell-role="th">S_Tcm</th>
<th data-quarto-table-cell-role="th">S_Tem</th>
<th data-quarto-table-cell-role="th">S_Th1</th>
<th data-quarto-table-cell-role="th">S_Th2</th>
<th data-quarto-table-cell-role="th">S_TFH</th>
<th data-quarto-table-cell-role="th">S_CD8_Tcells</th>
<th data-quarto-table-cell-role="th">S_Th17</th>
<th data-quarto-table-cell-role="th">S_Treg</th>
<th data-quarto-table-cell-role="th">S_Tgd</th>
<th data-quarto-table-cell-role="th">S_Cytotoxic_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cd56dim</th>
<th data-quarto-table-cell-role="th">S_NK_cd56bright</th>
<th data-quarto-table-cell-role="th">S_DC</th>
<th data-quarto-table-cell-role="th">S_iDC</th>
<th data-quarto-table-cell-role="th">S_aDC</th>
<th data-quarto-table-cell-role="th">S_pDC</th>
<th data-quarto-table-cell-role="th">S_Eosinophils</th>
<th data-quarto-table-cell-role="th">S_Macrophages</th>
<th data-quarto-table-cell-role="th">S_Mast</th>
<th data-quarto-table-cell-role="th">S_Neutrophils</th>
<th data-quarto-table-cell-role="th">S_Bindea_full</th>
<th data-quarto-table-cell-role="th">S_Expanded_IFNg</th>
<th data-quarto-table-cell-role="th">S_KEGG_MMR</th>
<th data-quarto-table-cell-role="th">S_KEGG_TGF_Beta</th>
<th data-quarto-table-cell-role="th">S_KEGG_Cytosolic_DNA_Sensing</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0012</td>
<td>Batch_1</td>
<td>50.0</td>
<td>2.0</td>
<td>2.0</td>
<td>2.3</td>
<td>20.0</td>
<td>42.0</td>
<td>0.476190476</td>
<td>357.0</td>
<td>1.7</td>
<td>2895.605487</td>
<td>9.0</td>
<td>0.120394</td>
<td>0.117468</td>
<td>0.448450</td>
<td>0.3620</td>
<td>0.4216</td>
<td>0.3034</td>
<td>0.4425</td>
<td>0.2749</td>
<td>0.2983</td>
<td>0.2756</td>
<td>0.3121</td>
<td>0.2765</td>
<td>0.3203</td>
<td>0.2463</td>
<td>0.2341</td>
<td>0.2495</td>
<td>0.3571</td>
<td>0.4591</td>
<td>0.3985</td>
<td>0.2130</td>
<td>0.2223</td>
<td>0.2766</td>
<td>0.3573</td>
<td>0.1561</td>
<td>0.2942</td>
<td>0.1536</td>
<td>0.2530</td>
<td>0.2042</td>
<td>0.2061</td>
<td>0.1942</td>
<td>0.2764</td>
<td>0.3327</td>
<td>0.3795</td>
<td>0.3435</td>
<td>0.2846</td>
<td>0.3797</td>
<td>0.3761</td>
<td>0.3197</td>
<td>0.4008</td>
<td>0.4403</td>
<td>0.2907</td>
<td>0.4011</td>
<td>0.2526</td>
<td>0.2237</td>
<td>0.4256</td>
<td>0.3971</td>
<td>0.4477</td>
<td>0.1852</td>
<td>0.2516</td>
<td>0.2262</td>
<td>0.3854</td>
<td>0.1591</td>
<td>0.4462</td>
<td>0.2912</td>
<td>0.4211</td>
<td>0.4502</td>
<td>0.3610</td>
<td>0.2711</td>
<td>0.3414</td>
<td>0.2183</td>
<td>0.3728</td>
<td>0.3512</td>
<td>0.3529</td>
<td>0.4162</td>
<td>0.3612</td>
<td>0.2215</td>
<td>0.3614</td>
<td>0.4294</td>
<td>0.3451</td>
<td>0.4648</td>
<td>0.2937</td>
<td>0.3338</td>
<td>0.2999</td>
<td>0.2094</td>
<td>0.2743</td>
<td>0.3203</td>
<td>0.4136</td>
<td>0.2546</td>
<td>0.2730</td>
<td>0.3697</td>
<td>0.2268</td>
<td>0.3335</td>
<td>0.3959</td>
<td>0.4066</td>
<td>0.2199</td>
<td>0.2395</td>
<td>0.4132</td>
<td>0.3633</td>
<td>0.3210</td>
<td>0.2599</td>
<td>0.3561</td>
<td>0.3112</td>
<td>0.3645</td>
<td>0.2810</td>
<td>0.2348</td>
<td>0.1945</td>
<td>0.2188</td>
<td>0.3281</td>
<td>0.0602</td>
<td>0.2038</td>
<td>0.2445</td>
<td>0.3220</td>
<td>0.2212</td>
<td>0.2866</td>
<td>0.3030</td>
<td>0.3657</td>
<td>0.2499</td>
<td>0.2531</td>
<td>0.3031</td>
<td>0.3097</td>
<td>0.4053</td>
<td>0.3537</td>
<td>0.2530</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0014</td>
<td>Batch_1</td>
<td>58.0</td>
<td>2.0</td>
<td>2.0</td>
<td>2.5</td>
<td>10.0</td>
<td>17.0</td>
<td>0.588235294</td>
<td>85.0</td>
<td>4.1</td>
<td>4257.831526</td>
<td>11.0</td>
<td>0.165023</td>
<td>0.207531</td>
<td>0.124223</td>
<td>0.4126</td>
<td>0.3815</td>
<td>0.3619</td>
<td>0.4760</td>
<td>0.3343</td>
<td>0.3001</td>
<td>0.2769</td>
<td>0.3761</td>
<td>0.3525</td>
<td>0.3452</td>
<td>0.3051</td>
<td>0.2701</td>
<td>0.3143</td>
<td>0.3803</td>
<td>0.4819</td>
<td>0.4125</td>
<td>0.3002</td>
<td>0.3106</td>
<td>0.3646</td>
<td>0.3753</td>
<td>0.1030</td>
<td>0.3644</td>
<td>0.2726</td>
<td>0.2377</td>
<td>0.2553</td>
<td>0.2513</td>
<td>0.2820</td>
<td>0.3079</td>
<td>0.3515</td>
<td>0.3869</td>
<td>0.3868</td>
<td>0.3133</td>
<td>0.4051</td>
<td>0.4031</td>
<td>0.3308</td>
<td>0.4120</td>
<td>0.4496</td>
<td>0.2012</td>
<td>0.4360</td>
<td>0.3290</td>
<td>0.2562</td>
<td>0.3882</td>
<td>0.4310</td>
<td>0.4682</td>
<td>0.2990</td>
<td>0.3007</td>
<td>0.2859</td>
<td>0.3998</td>
<td>0.2225</td>
<td>0.4068</td>
<td>0.3481</td>
<td>0.4494</td>
<td>0.4710</td>
<td>0.4011</td>
<td>0.2840</td>
<td>0.3779</td>
<td>0.2727</td>
<td>0.3831</td>
<td>0.3864</td>
<td>0.3511</td>
<td>0.3983</td>
<td>0.3676</td>
<td>0.2761</td>
<td>0.3637</td>
<td>0.4268</td>
<td>0.3555</td>
<td>0.4580</td>
<td>0.3266</td>
<td>0.3549</td>
<td>0.3763</td>
<td>0.2157</td>
<td>0.3028</td>
<td>0.3278</td>
<td>0.3896</td>
<td>0.3111</td>
<td>0.3159</td>
<td>0.3126</td>
<td>0.2395</td>
<td>0.3747</td>
<td>0.3838</td>
<td>0.4030</td>
<td>0.2731</td>
<td>0.2909</td>
<td>0.4092</td>
<td>0.3404</td>
<td>0.3530</td>
<td>0.2808</td>
<td>0.3102</td>
<td>0.3229</td>
<td>0.3713</td>
<td>0.2645</td>
<td>0.3182</td>
<td>0.1977</td>
<td>0.2985</td>
<td>0.3502</td>
<td>0.1191</td>
<td>0.3316</td>
<td>0.2976</td>
<td>0.3445</td>
<td>0.2403</td>
<td>0.3450</td>
<td>0.3203</td>
<td>0.3484</td>
<td>0.2768</td>
<td>0.2783</td>
<td>0.3200</td>
<td>0.3668</td>
<td>0.3803</td>
<td>0.3470</td>
<td>0.2606</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0015</td>
<td>Batch_1</td>
<td>46.0</td>
<td>1.0</td>
<td>2.0</td>
<td>1.8</td>
<td>4.0</td>
<td>16.0</td>
<td>0.25</td>
<td>150.0</td>
<td>2.4</td>
<td>3123.055856</td>
<td>8.0</td>
<td>0.162653</td>
<td>0.235337</td>
<td>0.279972</td>
<td>0.3556</td>
<td>0.3782</td>
<td>0.3363</td>
<td>0.4718</td>
<td>0.3015</td>
<td>0.2659</td>
<td>0.2274</td>
<td>0.3180</td>
<td>0.3025</td>
<td>0.3124</td>
<td>0.2622</td>
<td>0.2304</td>
<td>0.2706</td>
<td>0.3761</td>
<td>0.4613</td>
<td>0.3814</td>
<td>0.3055</td>
<td>0.2764</td>
<td>0.3211</td>
<td>0.3784</td>
<td>-0.1955</td>
<td>0.3122</td>
<td>0.1932</td>
<td>0.2485</td>
<td>0.2211</td>
<td>0.2004</td>
<td>0.2478</td>
<td>0.3040</td>
<td>0.3316</td>
<td>0.3646</td>
<td>0.3483</td>
<td>0.3012</td>
<td>0.4038</td>
<td>0.3875</td>
<td>0.3158</td>
<td>0.3986</td>
<td>0.4391</td>
<td>0.1509</td>
<td>0.3958</td>
<td>0.2886</td>
<td>0.2535</td>
<td>0.3764</td>
<td>0.4054</td>
<td>0.4601</td>
<td>0.2509</td>
<td>0.2830</td>
<td>0.2712</td>
<td>0.3801</td>
<td>0.1750</td>
<td>0.3987</td>
<td>0.3063</td>
<td>0.4239</td>
<td>0.4616</td>
<td>0.3587</td>
<td>0.2955</td>
<td>0.3431</td>
<td>0.2278</td>
<td>0.3599</td>
<td>0.3549</td>
<td>0.4011</td>
<td>0.3865</td>
<td>0.3661</td>
<td>0.2671</td>
<td>0.3591</td>
<td>0.4313</td>
<td>0.3489</td>
<td>0.4442</td>
<td>0.2985</td>
<td>0.3383</td>
<td>0.3370</td>
<td>0.2609</td>
<td>0.2706</td>
<td>0.3312</td>
<td>0.3792</td>
<td>0.2851</td>
<td>0.2897</td>
<td>0.2984</td>
<td>0.0936</td>
<td>0.3370</td>
<td>0.3880</td>
<td>0.4038</td>
<td>0.2799</td>
<td>0.2873</td>
<td>0.4159</td>
<td>0.3520</td>
<td>0.3560</td>
<td>0.2600</td>
<td>0.3116</td>
<td>0.3225</td>
<td>0.3762</td>
<td>0.2370</td>
<td>0.2251</td>
<td>0.2021</td>
<td>0.2720</td>
<td>0.3434</td>
<td>0.0626</td>
<td>0.3025</td>
<td>0.2670</td>
<td>0.3212</td>
<td>0.2098</td>
<td>0.2967</td>
<td>0.3236</td>
<td>0.3266</td>
<td>0.2455</td>
<td>0.2522</td>
<td>0.3107</td>
<td>0.3372</td>
<td>0.3793</td>
<td>0.3522</td>
<td>0.2564</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0017</td>
<td>Batch_1</td>
<td>54.0</td>
<td>2.0</td>
<td>2.0</td>
<td>2.5</td>
<td>19.0</td>
<td>47.0</td>
<td>0.404255319</td>
<td>1369.0</td>
<td>1.7</td>
<td>5275.497847</td>
<td>11.0</td>
<td>0.155523</td>
<td>0.148387</td>
<td>0.128777</td>
<td>0.4314</td>
<td>0.4482</td>
<td>0.4080</td>
<td>0.4980</td>
<td>0.3912</td>
<td>0.3120</td>
<td>0.2934</td>
<td>0.3864</td>
<td>0.3957</td>
<td>0.3131</td>
<td>0.3589</td>
<td>0.3341</td>
<td>0.3654</td>
<td>0.3842</td>
<td>0.4957</td>
<td>0.4328</td>
<td>0.3533</td>
<td>0.3732</td>
<td>0.4177</td>
<td>0.4350</td>
<td>0.1401</td>
<td>0.4006</td>
<td>0.3023</td>
<td>0.3429</td>
<td>0.3228</td>
<td>0.2922</td>
<td>0.3591</td>
<td>0.3671</td>
<td>0.3926</td>
<td>0.4113</td>
<td>0.4082</td>
<td>0.3325</td>
<td>0.4092</td>
<td>0.4129</td>
<td>0.3338</td>
<td>0.4190</td>
<td>0.4248</td>
<td>0.1319</td>
<td>0.4878</td>
<td>0.3797</td>
<td>0.1889</td>
<td>0.4601</td>
<td>0.4445</td>
<td>0.4859</td>
<td>0.3224</td>
<td>0.3693</td>
<td>0.3003</td>
<td>0.4095</td>
<td>0.2938</td>
<td>0.4707</td>
<td>0.3968</td>
<td>0.4616</td>
<td>0.4893</td>
<td>0.4644</td>
<td>0.2735</td>
<td>0.3955</td>
<td>0.3234</td>
<td>0.4165</td>
<td>0.4337</td>
<td>0.4190</td>
<td>0.4511</td>
<td>0.3758</td>
<td>0.3174</td>
<td>0.3679</td>
<td>0.4314</td>
<td>0.3648</td>
<td>0.4439</td>
<td>0.2886</td>
<td>0.3688</td>
<td>0.4143</td>
<td>0.2489</td>
<td>0.3562</td>
<td>0.3498</td>
<td>0.4563</td>
<td>0.3576</td>
<td>0.3706</td>
<td>0.3377</td>
<td>0.2758</td>
<td>0.4006</td>
<td>0.4000</td>
<td>0.4062</td>
<td>0.3182</td>
<td>0.3460</td>
<td>0.4170</td>
<td>0.3275</td>
<td>0.3432</td>
<td>0.2914</td>
<td>0.3307</td>
<td>0.3525</td>
<td>0.3879</td>
<td>0.2212</td>
<td>0.3330</td>
<td>0.2251</td>
<td>0.3151</td>
<td>0.3495</td>
<td>0.1939</td>
<td>0.2953</td>
<td>0.3010</td>
<td>0.3467</td>
<td>0.2547</td>
<td>0.3313</td>
<td>0.3230</td>
<td>0.3597</td>
<td>0.2726</td>
<td>0.2648</td>
<td>0.3309</td>
<td>0.4165</td>
<td>0.3997</td>
<td>0.3468</td>
<td>0.2682</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0018</td>
<td>Batch_1</td>
<td>58.0</td>
<td>2.0</td>
<td>3.0</td>
<td>3.0</td>
<td>39.0</td>
<td>126.0</td>
<td>0.30952381</td>
<td>382.0</td>
<td>1.6</td>
<td>3548.348220</td>
<td>11.0</td>
<td>0.129397</td>
<td>0.133531</td>
<td>0.304963</td>
<td>0.3701</td>
<td>0.3859</td>
<td>0.3067</td>
<td>0.4858</td>
<td>0.3141</td>
<td>0.2980</td>
<td>0.2006</td>
<td>0.3222</td>
<td>0.3017</td>
<td>0.3358</td>
<td>0.2870</td>
<td>0.2544</td>
<td>0.2955</td>
<td>0.3292</td>
<td>0.4758</td>
<td>0.4200</td>
<td>0.2892</td>
<td>0.2845</td>
<td>0.3767</td>
<td>0.4084</td>
<td>0.1187</td>
<td>0.2786</td>
<td>0.2363</td>
<td>0.2357</td>
<td>0.2360</td>
<td>0.2310</td>
<td>0.3125</td>
<td>0.3054</td>
<td>0.3430</td>
<td>0.3742</td>
<td>0.3709</td>
<td>0.2860</td>
<td>0.3689</td>
<td>0.3880</td>
<td>0.3172</td>
<td>0.4095</td>
<td>0.4343</td>
<td>0.2824</td>
<td>0.4664</td>
<td>0.2799</td>
<td>0.2613</td>
<td>0.3975</td>
<td>0.4264</td>
<td>0.4805</td>
<td>0.3210</td>
<td>0.2670</td>
<td>0.2429</td>
<td>0.3952</td>
<td>0.2321</td>
<td>0.4166</td>
<td>0.3061</td>
<td>0.4446</td>
<td>0.4658</td>
<td>0.4181</td>
<td>0.2747</td>
<td>0.3910</td>
<td>0.3019</td>
<td>0.3722</td>
<td>0.3716</td>
<td>0.3075</td>
<td>0.3931</td>
<td>0.3605</td>
<td>0.2308</td>
<td>0.3603</td>
<td>0.4258</td>
<td>0.3393</td>
<td>0.4654</td>
<td>0.2920</td>
<td>0.3385</td>
<td>0.3668</td>
<td>0.2237</td>
<td>0.3404</td>
<td>0.3264</td>
<td>0.3909</td>
<td>0.2758</td>
<td>0.3050</td>
<td>0.3770</td>
<td>0.2009</td>
<td>0.3664</td>
<td>0.4026</td>
<td>0.4092</td>
<td>0.2699</td>
<td>0.2530</td>
<td>0.3955</td>
<td>0.3185</td>
<td>0.3066</td>
<td>0.2713</td>
<td>0.3333</td>
<td>0.3041</td>
<td>0.3523</td>
<td>0.2401</td>
<td>0.2709</td>
<td>0.1413</td>
<td>0.2636</td>
<td>0.3061</td>
<td>0.0764</td>
<td>0.2639</td>
<td>0.2623</td>
<td>0.3348</td>
<td>0.2124</td>
<td>0.2731</td>
<td>0.3020</td>
<td>0.3540</td>
<td>0.2233</td>
<td>0.2182</td>
<td>0.2979</td>
<td>0.3530</td>
<td>0.4033</td>
<td>0.3444</td>
<td>0.2496</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the column `Fusion_T2NeoRate` to `FN/FT_Ratio`</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>dfx2.rename(columns<span class="op">=</span>{<span class="st">'Fusion_T2NeoRate'</span>: <span class="st">'FN/FT_Ratio'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>dfx2.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Batch</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Stage</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionTransscript_Count</th>
<th data-quarto-table-cell-role="th">FN/FT_Ratio</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
<th data-quarto-table-cell-role="th">ESTIMATE</th>
<th data-quarto-table-cell-role="th">IMPRES</th>
<th data-quarto-table-cell-role="th">C_Bcellsnaive</th>
<th data-quarto-table-cell-role="th">C_TcellsCD4memoryresting</th>
<th data-quarto-table-cell-role="th">C_MacrophagesM2</th>
<th data-quarto-table-cell-role="th">S_Attractors_LYM</th>
<th data-quarto-table-cell-role="th">S_Attractors_IFIT3</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_GIMAP4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_HLA.DPA1</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SLAMF6</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_LILRB4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SIGLEC9</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CYTH4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CD3E</th>
<th data-quarto-table-cell-role="th">S_Lymph_Vessels</th>
<th data-quarto-table-cell-role="th">S_ICR_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_INHIB_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_ACT_SCORE</th>
<th data-quarto-table-cell-role="th">S_Angiogenesis</th>
<th data-quarto-table-cell-role="th">S_APM1</th>
<th data-quarto-table-cell-role="th">S_APM2</th>
<th data-quarto-table-cell-role="th">S_ICS5_score</th>
<th data-quarto-table-cell-role="th">S_LIexpression_score</th>
<th data-quarto-table-cell-role="th">S_Chemokine12_score</th>
<th data-quarto-table-cell-role="th">S_NHI_5gene_score</th>
<th data-quarto-table-cell-role="th">S_CD68</th>
<th data-quarto-table-cell-role="th">S_CD8A</th>
<th data-quarto-table-cell-role="th">S_PD1_data</th>
<th data-quarto-table-cell-role="th">S_PDL1_data</th>
<th data-quarto-table-cell-role="th">S_PD1_PDL1_score</th>
<th data-quarto-table-cell-role="th">S_CTLA4_data</th>
<th data-quarto-table-cell-role="th">S_Bcell_mg_IGJ</th>
<th data-quarto-table-cell-role="th">S_Bcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_STAT1_score</th>
<th data-quarto-table-cell-role="th">S_CSF1_response</th>
<th data-quarto-table-cell-role="th">S_TcClassII_score</th>
<th data-quarto-table-cell-role="th">S_IL12_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL4_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL2_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL13_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IFNG_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TGFB_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TREM1_data</th>
<th data-quarto-table-cell-role="th">S_DAP12_data</th>
<th data-quarto-table-cell-role="th">S_Tcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_IL8_21978456</th>
<th data-quarto-table-cell-role="th">S_IFN_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC1_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC2_21978456</th>
<th data-quarto-table-cell-role="th">S_Bcell_21978456</th>
<th data-quarto-table-cell-role="th">S_Tcell_21978456</th>
<th data-quarto-table-cell-role="th">S_CD103pos_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_CD103neg_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_IgG_19272155</th>
<th data-quarto-table-cell-role="th">S_Interferon_19272155</th>
<th data-quarto-table-cell-role="th">S_LCK_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.I_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.II_19272155</th>
<th data-quarto-table-cell-role="th">S_STAT1_19272155</th>
<th data-quarto-table-cell-role="th">S_Troester_WoundSig_19887484</th>
<th data-quarto-table-cell-role="th">S_MDACC.FNA.1_20805453</th>
<th data-quarto-table-cell-role="th">S_IGG_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Minterferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Immune_cell_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_MCD3_CD8_21214954</th>
<th data-quarto-table-cell-role="th">S_Interferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_B_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_CD8_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_GRANS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_LYMPHS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_T_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_TGFB_PCA_17349583</th>
<th data-quarto-table-cell-role="th">S_Rotterdam_ERneg_PCA_15721472</th>
<th data-quarto-table-cell-role="th">S_HER2_Immune_PCA_18006808</th>
<th data-quarto-table-cell-role="th">S_IR7_score</th>
<th data-quarto-table-cell-role="th">S_Buck14_score</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_score</th>
<th data-quarto-table-cell-role="th">S_Immune_NSCLC_score</th>
<th data-quarto-table-cell-role="th">S_Module3_IFN_score</th>
<th data-quarto-table-cell-role="th">S_Module4_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module5_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module11_Prolif_score</th>
<th data-quarto-table-cell-role="th">S_CD8_CD68_ratio</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_TcClassII_ratio</th>
<th data-quarto-table-cell-role="th">S_CHANG_CORE_SERUM_RESPONSE_UP</th>
<th data-quarto-table-cell-role="th">S_CSR_Activated_15701700</th>
<th data-quarto-table-cell-role="th">S_B_cells</th>
<th data-quarto-table-cell-role="th">S_T_cells</th>
<th data-quarto-table-cell-role="th">S_T_helper</th>
<th data-quarto-table-cell-role="th">S_Tcm</th>
<th data-quarto-table-cell-role="th">S_Tem</th>
<th data-quarto-table-cell-role="th">S_Th1</th>
<th data-quarto-table-cell-role="th">S_Th2</th>
<th data-quarto-table-cell-role="th">S_TFH</th>
<th data-quarto-table-cell-role="th">S_CD8_Tcells</th>
<th data-quarto-table-cell-role="th">S_Th17</th>
<th data-quarto-table-cell-role="th">S_Treg</th>
<th data-quarto-table-cell-role="th">S_Tgd</th>
<th data-quarto-table-cell-role="th">S_Cytotoxic_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cd56dim</th>
<th data-quarto-table-cell-role="th">S_NK_cd56bright</th>
<th data-quarto-table-cell-role="th">S_DC</th>
<th data-quarto-table-cell-role="th">S_iDC</th>
<th data-quarto-table-cell-role="th">S_aDC</th>
<th data-quarto-table-cell-role="th">S_pDC</th>
<th data-quarto-table-cell-role="th">S_Eosinophils</th>
<th data-quarto-table-cell-role="th">S_Macrophages</th>
<th data-quarto-table-cell-role="th">S_Mast</th>
<th data-quarto-table-cell-role="th">S_Neutrophils</th>
<th data-quarto-table-cell-role="th">S_Bindea_full</th>
<th data-quarto-table-cell-role="th">S_Expanded_IFNg</th>
<th data-quarto-table-cell-role="th">S_KEGG_MMR</th>
<th data-quarto-table-cell-role="th">S_KEGG_TGF_Beta</th>
<th data-quarto-table-cell-role="th">S_KEGG_Cytosolic_DNA_Sensing</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0012</td>
<td>Batch_1</td>
<td>50.0</td>
<td>2.0</td>
<td>2.0</td>
<td>2.3</td>
<td>20.0</td>
<td>42.0</td>
<td>0.476190476</td>
<td>357.0</td>
<td>1.7</td>
<td>2895.605487</td>
<td>9.0</td>
<td>0.120394</td>
<td>0.117468</td>
<td>0.448450</td>
<td>0.3620</td>
<td>0.4216</td>
<td>0.3034</td>
<td>0.4425</td>
<td>0.2749</td>
<td>0.2983</td>
<td>0.2756</td>
<td>0.3121</td>
<td>0.2765</td>
<td>0.3203</td>
<td>0.2463</td>
<td>0.2341</td>
<td>0.2495</td>
<td>0.3571</td>
<td>0.4591</td>
<td>0.3985</td>
<td>0.2130</td>
<td>0.2223</td>
<td>0.2766</td>
<td>0.3573</td>
<td>0.1561</td>
<td>0.2942</td>
<td>0.1536</td>
<td>0.2530</td>
<td>0.2042</td>
<td>0.2061</td>
<td>0.1942</td>
<td>0.2764</td>
<td>0.3327</td>
<td>0.3795</td>
<td>0.3435</td>
<td>0.2846</td>
<td>0.3797</td>
<td>0.3761</td>
<td>0.3197</td>
<td>0.4008</td>
<td>0.4403</td>
<td>0.2907</td>
<td>0.4011</td>
<td>0.2526</td>
<td>0.2237</td>
<td>0.4256</td>
<td>0.3971</td>
<td>0.4477</td>
<td>0.1852</td>
<td>0.2516</td>
<td>0.2262</td>
<td>0.3854</td>
<td>0.1591</td>
<td>0.4462</td>
<td>0.2912</td>
<td>0.4211</td>
<td>0.4502</td>
<td>0.3610</td>
<td>0.2711</td>
<td>0.3414</td>
<td>0.2183</td>
<td>0.3728</td>
<td>0.3512</td>
<td>0.3529</td>
<td>0.4162</td>
<td>0.3612</td>
<td>0.2215</td>
<td>0.3614</td>
<td>0.4294</td>
<td>0.3451</td>
<td>0.4648</td>
<td>0.2937</td>
<td>0.3338</td>
<td>0.2999</td>
<td>0.2094</td>
<td>0.2743</td>
<td>0.3203</td>
<td>0.4136</td>
<td>0.2546</td>
<td>0.2730</td>
<td>0.3697</td>
<td>0.2268</td>
<td>0.3335</td>
<td>0.3959</td>
<td>0.4066</td>
<td>0.2199</td>
<td>0.2395</td>
<td>0.4132</td>
<td>0.3633</td>
<td>0.3210</td>
<td>0.2599</td>
<td>0.3561</td>
<td>0.3112</td>
<td>0.3645</td>
<td>0.2810</td>
<td>0.2348</td>
<td>0.1945</td>
<td>0.2188</td>
<td>0.3281</td>
<td>0.0602</td>
<td>0.2038</td>
<td>0.2445</td>
<td>0.3220</td>
<td>0.2212</td>
<td>0.2866</td>
<td>0.3030</td>
<td>0.3657</td>
<td>0.2499</td>
<td>0.2531</td>
<td>0.3031</td>
<td>0.3097</td>
<td>0.4053</td>
<td>0.3537</td>
<td>0.2530</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0014</td>
<td>Batch_1</td>
<td>58.0</td>
<td>2.0</td>
<td>2.0</td>
<td>2.5</td>
<td>10.0</td>
<td>17.0</td>
<td>0.588235294</td>
<td>85.0</td>
<td>4.1</td>
<td>4257.831526</td>
<td>11.0</td>
<td>0.165023</td>
<td>0.207531</td>
<td>0.124223</td>
<td>0.4126</td>
<td>0.3815</td>
<td>0.3619</td>
<td>0.4760</td>
<td>0.3343</td>
<td>0.3001</td>
<td>0.2769</td>
<td>0.3761</td>
<td>0.3525</td>
<td>0.3452</td>
<td>0.3051</td>
<td>0.2701</td>
<td>0.3143</td>
<td>0.3803</td>
<td>0.4819</td>
<td>0.4125</td>
<td>0.3002</td>
<td>0.3106</td>
<td>0.3646</td>
<td>0.3753</td>
<td>0.1030</td>
<td>0.3644</td>
<td>0.2726</td>
<td>0.2377</td>
<td>0.2553</td>
<td>0.2513</td>
<td>0.2820</td>
<td>0.3079</td>
<td>0.3515</td>
<td>0.3869</td>
<td>0.3868</td>
<td>0.3133</td>
<td>0.4051</td>
<td>0.4031</td>
<td>0.3308</td>
<td>0.4120</td>
<td>0.4496</td>
<td>0.2012</td>
<td>0.4360</td>
<td>0.3290</td>
<td>0.2562</td>
<td>0.3882</td>
<td>0.4310</td>
<td>0.4682</td>
<td>0.2990</td>
<td>0.3007</td>
<td>0.2859</td>
<td>0.3998</td>
<td>0.2225</td>
<td>0.4068</td>
<td>0.3481</td>
<td>0.4494</td>
<td>0.4710</td>
<td>0.4011</td>
<td>0.2840</td>
<td>0.3779</td>
<td>0.2727</td>
<td>0.3831</td>
<td>0.3864</td>
<td>0.3511</td>
<td>0.3983</td>
<td>0.3676</td>
<td>0.2761</td>
<td>0.3637</td>
<td>0.4268</td>
<td>0.3555</td>
<td>0.4580</td>
<td>0.3266</td>
<td>0.3549</td>
<td>0.3763</td>
<td>0.2157</td>
<td>0.3028</td>
<td>0.3278</td>
<td>0.3896</td>
<td>0.3111</td>
<td>0.3159</td>
<td>0.3126</td>
<td>0.2395</td>
<td>0.3747</td>
<td>0.3838</td>
<td>0.4030</td>
<td>0.2731</td>
<td>0.2909</td>
<td>0.4092</td>
<td>0.3404</td>
<td>0.3530</td>
<td>0.2808</td>
<td>0.3102</td>
<td>0.3229</td>
<td>0.3713</td>
<td>0.2645</td>
<td>0.3182</td>
<td>0.1977</td>
<td>0.2985</td>
<td>0.3502</td>
<td>0.1191</td>
<td>0.3316</td>
<td>0.2976</td>
<td>0.3445</td>
<td>0.2403</td>
<td>0.3450</td>
<td>0.3203</td>
<td>0.3484</td>
<td>0.2768</td>
<td>0.2783</td>
<td>0.3200</td>
<td>0.3668</td>
<td>0.3803</td>
<td>0.3470</td>
<td>0.2606</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0015</td>
<td>Batch_1</td>
<td>46.0</td>
<td>1.0</td>
<td>2.0</td>
<td>1.8</td>
<td>4.0</td>
<td>16.0</td>
<td>0.25</td>
<td>150.0</td>
<td>2.4</td>
<td>3123.055856</td>
<td>8.0</td>
<td>0.162653</td>
<td>0.235337</td>
<td>0.279972</td>
<td>0.3556</td>
<td>0.3782</td>
<td>0.3363</td>
<td>0.4718</td>
<td>0.3015</td>
<td>0.2659</td>
<td>0.2274</td>
<td>0.3180</td>
<td>0.3025</td>
<td>0.3124</td>
<td>0.2622</td>
<td>0.2304</td>
<td>0.2706</td>
<td>0.3761</td>
<td>0.4613</td>
<td>0.3814</td>
<td>0.3055</td>
<td>0.2764</td>
<td>0.3211</td>
<td>0.3784</td>
<td>-0.1955</td>
<td>0.3122</td>
<td>0.1932</td>
<td>0.2485</td>
<td>0.2211</td>
<td>0.2004</td>
<td>0.2478</td>
<td>0.3040</td>
<td>0.3316</td>
<td>0.3646</td>
<td>0.3483</td>
<td>0.3012</td>
<td>0.4038</td>
<td>0.3875</td>
<td>0.3158</td>
<td>0.3986</td>
<td>0.4391</td>
<td>0.1509</td>
<td>0.3958</td>
<td>0.2886</td>
<td>0.2535</td>
<td>0.3764</td>
<td>0.4054</td>
<td>0.4601</td>
<td>0.2509</td>
<td>0.2830</td>
<td>0.2712</td>
<td>0.3801</td>
<td>0.1750</td>
<td>0.3987</td>
<td>0.3063</td>
<td>0.4239</td>
<td>0.4616</td>
<td>0.3587</td>
<td>0.2955</td>
<td>0.3431</td>
<td>0.2278</td>
<td>0.3599</td>
<td>0.3549</td>
<td>0.4011</td>
<td>0.3865</td>
<td>0.3661</td>
<td>0.2671</td>
<td>0.3591</td>
<td>0.4313</td>
<td>0.3489</td>
<td>0.4442</td>
<td>0.2985</td>
<td>0.3383</td>
<td>0.3370</td>
<td>0.2609</td>
<td>0.2706</td>
<td>0.3312</td>
<td>0.3792</td>
<td>0.2851</td>
<td>0.2897</td>
<td>0.2984</td>
<td>0.0936</td>
<td>0.3370</td>
<td>0.3880</td>
<td>0.4038</td>
<td>0.2799</td>
<td>0.2873</td>
<td>0.4159</td>
<td>0.3520</td>
<td>0.3560</td>
<td>0.2600</td>
<td>0.3116</td>
<td>0.3225</td>
<td>0.3762</td>
<td>0.2370</td>
<td>0.2251</td>
<td>0.2021</td>
<td>0.2720</td>
<td>0.3434</td>
<td>0.0626</td>
<td>0.3025</td>
<td>0.2670</td>
<td>0.3212</td>
<td>0.2098</td>
<td>0.2967</td>
<td>0.3236</td>
<td>0.3266</td>
<td>0.2455</td>
<td>0.2522</td>
<td>0.3107</td>
<td>0.3372</td>
<td>0.3793</td>
<td>0.3522</td>
<td>0.2564</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0017</td>
<td>Batch_1</td>
<td>54.0</td>
<td>2.0</td>
<td>2.0</td>
<td>2.5</td>
<td>19.0</td>
<td>47.0</td>
<td>0.404255319</td>
<td>1369.0</td>
<td>1.7</td>
<td>5275.497847</td>
<td>11.0</td>
<td>0.155523</td>
<td>0.148387</td>
<td>0.128777</td>
<td>0.4314</td>
<td>0.4482</td>
<td>0.4080</td>
<td>0.4980</td>
<td>0.3912</td>
<td>0.3120</td>
<td>0.2934</td>
<td>0.3864</td>
<td>0.3957</td>
<td>0.3131</td>
<td>0.3589</td>
<td>0.3341</td>
<td>0.3654</td>
<td>0.3842</td>
<td>0.4957</td>
<td>0.4328</td>
<td>0.3533</td>
<td>0.3732</td>
<td>0.4177</td>
<td>0.4350</td>
<td>0.1401</td>
<td>0.4006</td>
<td>0.3023</td>
<td>0.3429</td>
<td>0.3228</td>
<td>0.2922</td>
<td>0.3591</td>
<td>0.3671</td>
<td>0.3926</td>
<td>0.4113</td>
<td>0.4082</td>
<td>0.3325</td>
<td>0.4092</td>
<td>0.4129</td>
<td>0.3338</td>
<td>0.4190</td>
<td>0.4248</td>
<td>0.1319</td>
<td>0.4878</td>
<td>0.3797</td>
<td>0.1889</td>
<td>0.4601</td>
<td>0.4445</td>
<td>0.4859</td>
<td>0.3224</td>
<td>0.3693</td>
<td>0.3003</td>
<td>0.4095</td>
<td>0.2938</td>
<td>0.4707</td>
<td>0.3968</td>
<td>0.4616</td>
<td>0.4893</td>
<td>0.4644</td>
<td>0.2735</td>
<td>0.3955</td>
<td>0.3234</td>
<td>0.4165</td>
<td>0.4337</td>
<td>0.4190</td>
<td>0.4511</td>
<td>0.3758</td>
<td>0.3174</td>
<td>0.3679</td>
<td>0.4314</td>
<td>0.3648</td>
<td>0.4439</td>
<td>0.2886</td>
<td>0.3688</td>
<td>0.4143</td>
<td>0.2489</td>
<td>0.3562</td>
<td>0.3498</td>
<td>0.4563</td>
<td>0.3576</td>
<td>0.3706</td>
<td>0.3377</td>
<td>0.2758</td>
<td>0.4006</td>
<td>0.4000</td>
<td>0.4062</td>
<td>0.3182</td>
<td>0.3460</td>
<td>0.4170</td>
<td>0.3275</td>
<td>0.3432</td>
<td>0.2914</td>
<td>0.3307</td>
<td>0.3525</td>
<td>0.3879</td>
<td>0.2212</td>
<td>0.3330</td>
<td>0.2251</td>
<td>0.3151</td>
<td>0.3495</td>
<td>0.1939</td>
<td>0.2953</td>
<td>0.3010</td>
<td>0.3467</td>
<td>0.2547</td>
<td>0.3313</td>
<td>0.3230</td>
<td>0.3597</td>
<td>0.2726</td>
<td>0.2648</td>
<td>0.3309</td>
<td>0.4165</td>
<td>0.3997</td>
<td>0.3468</td>
<td>0.2682</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0018</td>
<td>Batch_1</td>
<td>58.0</td>
<td>2.0</td>
<td>3.0</td>
<td>3.0</td>
<td>39.0</td>
<td>126.0</td>
<td>0.30952381</td>
<td>382.0</td>
<td>1.6</td>
<td>3548.348220</td>
<td>11.0</td>
<td>0.129397</td>
<td>0.133531</td>
<td>0.304963</td>
<td>0.3701</td>
<td>0.3859</td>
<td>0.3067</td>
<td>0.4858</td>
<td>0.3141</td>
<td>0.2980</td>
<td>0.2006</td>
<td>0.3222</td>
<td>0.3017</td>
<td>0.3358</td>
<td>0.2870</td>
<td>0.2544</td>
<td>0.2955</td>
<td>0.3292</td>
<td>0.4758</td>
<td>0.4200</td>
<td>0.2892</td>
<td>0.2845</td>
<td>0.3767</td>
<td>0.4084</td>
<td>0.1187</td>
<td>0.2786</td>
<td>0.2363</td>
<td>0.2357</td>
<td>0.2360</td>
<td>0.2310</td>
<td>0.3125</td>
<td>0.3054</td>
<td>0.3430</td>
<td>0.3742</td>
<td>0.3709</td>
<td>0.2860</td>
<td>0.3689</td>
<td>0.3880</td>
<td>0.3172</td>
<td>0.4095</td>
<td>0.4343</td>
<td>0.2824</td>
<td>0.4664</td>
<td>0.2799</td>
<td>0.2613</td>
<td>0.3975</td>
<td>0.4264</td>
<td>0.4805</td>
<td>0.3210</td>
<td>0.2670</td>
<td>0.2429</td>
<td>0.3952</td>
<td>0.2321</td>
<td>0.4166</td>
<td>0.3061</td>
<td>0.4446</td>
<td>0.4658</td>
<td>0.4181</td>
<td>0.2747</td>
<td>0.3910</td>
<td>0.3019</td>
<td>0.3722</td>
<td>0.3716</td>
<td>0.3075</td>
<td>0.3931</td>
<td>0.3605</td>
<td>0.2308</td>
<td>0.3603</td>
<td>0.4258</td>
<td>0.3393</td>
<td>0.4654</td>
<td>0.2920</td>
<td>0.3385</td>
<td>0.3668</td>
<td>0.2237</td>
<td>0.3404</td>
<td>0.3264</td>
<td>0.3909</td>
<td>0.2758</td>
<td>0.3050</td>
<td>0.3770</td>
<td>0.2009</td>
<td>0.3664</td>
<td>0.4026</td>
<td>0.4092</td>
<td>0.2699</td>
<td>0.2530</td>
<td>0.3955</td>
<td>0.3185</td>
<td>0.3066</td>
<td>0.2713</td>
<td>0.3333</td>
<td>0.3041</td>
<td>0.3523</td>
<td>0.2401</td>
<td>0.2709</td>
<td>0.1413</td>
<td>0.2636</td>
<td>0.3061</td>
<td>0.0764</td>
<td>0.2639</td>
<td>0.2623</td>
<td>0.3348</td>
<td>0.2124</td>
<td>0.2731</td>
<td>0.3020</td>
<td>0.3540</td>
<td>0.2233</td>
<td>0.2182</td>
<td>0.2979</td>
<td>0.3530</td>
<td>0.4033</td>
<td>0.3444</td>
<td>0.2496</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dfx2.index[dfx2.index.duplicated()].unique())</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>rows_dupe <span class="op">=</span> <span class="bu">list</span>(dfx2.index[dfx2.index.duplicated()].unique())</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>rows_dupe</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index([], dtype='object', name='ID')</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>[]</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>NOTE</strong>: <del>Initially we put <code>IMPRES</code> score as part of the target variable set, but it might be more informative to put this column as part of the X variable set, as they describe predictions on ICI response of patients (responders or not). In other words we are not exactly asking the question, “does neoantigen count correlate with patient response to ICI?” (though this is a valid question), so including IMPRES as Y variable might muddle our modeling. Similarly, <code>ESTIMATE</code> score is a hybrid tumor purity score that serves as a function of two components derived from ssGSEA: the immune score and the stromal score associated with a tumor sample. So, in this manner, this attribute is closer to being a relevant, potentially informative clinical variable to be used as a feature than a response/target variable.</del></p>
</blockquote>
<blockquote class="blockquote">
<p><strong>UPDATE</strong>: I have decided to keep these two columns as part of the Y variable set.</p>
</blockquote>
<p>Now we can encode categorical variables and integer variables accordingly so they are more amenable to machine learning algorithms.</p>
<p>Modify the values in the Batch column and then check data types of the resulting cleaned up dataFrame.</p>
<p>We need to encode the two <code>object</code> columns into categorical numerics.</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>dfx2[<span class="st">'Batch'</span>] <span class="op">=</span> dfx2[<span class="st">'Batch'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">1</span> <span class="cf">if</span> x <span class="op">==</span> <span class="st">'Batch_1'</span> <span class="cf">else</span> <span class="dv">2</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>dfx2.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 693 entries, SD0012 to SD2418
Columns: 125 entries, Batch to S_KEGG_Cytosolic_DNA_Sensing
dtypes: float64(123), int64(1), object(1)
memory usage: 698.3+ KB</code></pre>
</div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_rows'</span>, <span class="va">None</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dfx2.dtypes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Batch                               int64
Age                               float64
Stage                             float64
TumorGrade                        float64
TumourSize                        float64
FusionNeo_Count                   float64
FusionTransscript_Count           float64
FN/FT_Ratio                        object
SNVindelNeo_Count                 float64
SNVindelNeo_IC50                  float64
ESTIMATE                          float64
IMPRES                            float64
C_Bcellsnaive                     float64
C_TcellsCD4memoryresting          float64
C_MacrophagesM2                   float64
S_Attractors_LYM                  float64
S_Attractors_IFIT3                float64
S_Attractors_G_GIMAP4             float64
S_Attractors_G_HLA.DPA1           float64
S_Attractors_G_SLAMF6             float64
S_Attractors_G_LILRB4             float64
S_Attractors_G_SIGLEC9            float64
S_Attractors_G_CYTH4              float64
S_Attractors_G_CD3E               float64
S_Lymph_Vessels                   float64
S_ICR_SCORE                       float64
S_ICR_INHIB_SCORE                 float64
S_ICR_ACT_SCORE                   float64
S_Angiogenesis                    float64
S_APM1                            float64
S_APM2                            float64
S_ICS5_score                      float64
S_LIexpression_score              float64
S_Chemokine12_score               float64
S_NHI_5gene_score                 float64
S_CD68                            float64
S_CD8A                            float64
S_PD1_data                        float64
S_PDL1_data                       float64
S_PD1_PDL1_score                  float64
S_CTLA4_data                      float64
S_Bcell_mg_IGJ                    float64
S_Bcell_receptors_score           float64
S_STAT1_score                     float64
S_CSF1_response                   float64
S_TcClassII_score                 float64
S_IL12_score_21050467             float64
S_IL4_score_21050467              float64
S_IL2_score_21050467              float64
S_IL13_score_21050467             float64
S_IFNG_score_21050467             float64
S_TGFB_score_21050467             float64
S_TREM1_data                      float64
S_DAP12_data                      float64
S_Tcell_receptors_score           float64
S_IL8_21978456                    float64
S_IFN_21978456                    float64
S_MHC1_21978456                   float64
S_MHC2_21978456                   float64
S_Bcell_21978456                  float64
S_Tcell_21978456                  float64
S_CD103pos_mean_25446897          float64
S_CD103neg_mean_25446897          float64
S_IgG_19272155                    float64
S_Interferon_19272155             float64
S_LCK_19272155                    float64
S_MHC.I_19272155                  float64
S_MHC.II_19272155                 float64
S_STAT1_19272155                  float64
S_Troester_WoundSig_19887484      float64
S_MDACC.FNA.1_20805453            float64
S_IGG_Cluster_21214954            float64
S_Minterferon_Cluster_21214954    float64
S_Immune_cell_Cluster_21214954    float64
S_MCD3_CD8_21214954               float64
S_Interferon_Cluster_21214954     float64
S_B_cell_PCA_16704732             float64
S_CD8_PCA_16704732                float64
S_GRANS_PCA_16704732              float64
S_LYMPHS_PCA_16704732             float64
S_T_cell_PCA_16704732             float64
S_TGFB_PCA_17349583               float64
S_Rotterdam_ERneg_PCA_15721472    float64
S_HER2_Immune_PCA_18006808        float64
S_IR7_score                       float64
S_Buck14_score                    float64
S_TAMsurr_score                   float64
S_Immune_NSCLC_score              float64
S_Module3_IFN_score               float64
S_Module4_TcellBcell_score        float64
S_Module5_TcellBcell_score        float64
S_Module11_Prolif_score           float64
S_CD8_CD68_ratio                  float64
S_TAMsurr_TcClassII_ratio         float64
S_CHANG_CORE_SERUM_RESPONSE_UP    float64
S_CSR_Activated_15701700          float64
S_B_cells                         float64
S_T_cells                         float64
S_T_helper                        float64
S_Tcm                             float64
S_Tem                             float64
S_Th1                             float64
S_Th2                             float64
S_TFH                             float64
S_CD8_Tcells                      float64
S_Th17                            float64
S_Treg                            float64
S_Tgd                             float64
S_Cytotoxic_cells                 float64
S_NK_cells                        float64
S_NK_cd56dim                      float64
S_NK_cd56bright                   float64
S_DC                              float64
S_iDC                             float64
S_aDC                             float64
S_pDC                             float64
S_Eosinophils                     float64
S_Macrophages                     float64
S_Mast                            float64
S_Neutrophils                     float64
S_Bindea_full                     float64
S_Expanded_IFNg                   float64
S_KEGG_MMR                        float64
S_KEGG_TGF_Beta                   float64
S_KEGG_Cytosolic_DNA_Sensing      float64
dtype: object</code></pre>
</div>
</div>
<p>We need to encode the <code>object</code> columns into appropriate types. Change <code>Stage</code>, <code>Age</code>, and <code>IMPRES</code> into <code>int64</code> as well as all <code>*_Count</code> columns because they are discrete variables. Change the <code>FN/FT_Ratio</code> into <code>float64</code>.</p>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># change Stage and Age column into int64</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>dfx2[<span class="st">'Stage'</span>] <span class="op">=</span> dfx2[<span class="st">'Stage'</span>].astype(<span class="st">'int64'</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>dfx2[<span class="st">'Age'</span>] <span class="op">=</span> dfx2[<span class="st">'Age'</span>].astype(<span class="st">'int64'</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>dfx2[<span class="st">'IMPRES'</span>] <span class="op">=</span> dfx2[<span class="st">'IMPRES'</span>].astype(<span class="st">'int64'</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>dfx2[<span class="st">'FusionNeo_Count'</span>] <span class="op">=</span> dfx2[<span class="st">'FusionNeo_Count'</span>].astype(<span class="st">'int64'</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>dfx2[<span class="st">'FusionTransscript_Count'</span>] <span class="op">=</span> dfx2[<span class="st">'FusionTransscript_Count'</span>].astype(<span class="st">'int64'</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>dfx2[<span class="st">'SNVindelNeo_Count'</span>] <span class="op">=</span> dfx2[<span class="st">'SNVindelNeo_Count'</span>].astype(<span class="st">'int64'</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>dfx2[<span class="st">'FN/FT_Ratio'</span>] <span class="op">=</span> dfx2[<span class="st">'FN/FT_Ratio'</span>].astype(<span class="st">'float64'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dfx2.dtypes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Batch                               int64
Age                                 int64
Stage                               int64
TumorGrade                        float64
TumourSize                        float64
FusionNeo_Count                     int64
FusionTransscript_Count             int64
FN/FT_Ratio                       float64
SNVindelNeo_Count                   int64
SNVindelNeo_IC50                  float64
ESTIMATE                          float64
IMPRES                              int64
C_Bcellsnaive                     float64
C_TcellsCD4memoryresting          float64
C_MacrophagesM2                   float64
S_Attractors_LYM                  float64
S_Attractors_IFIT3                float64
S_Attractors_G_GIMAP4             float64
S_Attractors_G_HLA.DPA1           float64
S_Attractors_G_SLAMF6             float64
S_Attractors_G_LILRB4             float64
S_Attractors_G_SIGLEC9            float64
S_Attractors_G_CYTH4              float64
S_Attractors_G_CD3E               float64
S_Lymph_Vessels                   float64
S_ICR_SCORE                       float64
S_ICR_INHIB_SCORE                 float64
S_ICR_ACT_SCORE                   float64
S_Angiogenesis                    float64
S_APM1                            float64
S_APM2                            float64
S_ICS5_score                      float64
S_LIexpression_score              float64
S_Chemokine12_score               float64
S_NHI_5gene_score                 float64
S_CD68                            float64
S_CD8A                            float64
S_PD1_data                        float64
S_PDL1_data                       float64
S_PD1_PDL1_score                  float64
S_CTLA4_data                      float64
S_Bcell_mg_IGJ                    float64
S_Bcell_receptors_score           float64
S_STAT1_score                     float64
S_CSF1_response                   float64
S_TcClassII_score                 float64
S_IL12_score_21050467             float64
S_IL4_score_21050467              float64
S_IL2_score_21050467              float64
S_IL13_score_21050467             float64
S_IFNG_score_21050467             float64
S_TGFB_score_21050467             float64
S_TREM1_data                      float64
S_DAP12_data                      float64
S_Tcell_receptors_score           float64
S_IL8_21978456                    float64
S_IFN_21978456                    float64
S_MHC1_21978456                   float64
S_MHC2_21978456                   float64
S_Bcell_21978456                  float64
S_Tcell_21978456                  float64
S_CD103pos_mean_25446897          float64
S_CD103neg_mean_25446897          float64
S_IgG_19272155                    float64
S_Interferon_19272155             float64
S_LCK_19272155                    float64
S_MHC.I_19272155                  float64
S_MHC.II_19272155                 float64
S_STAT1_19272155                  float64
S_Troester_WoundSig_19887484      float64
S_MDACC.FNA.1_20805453            float64
S_IGG_Cluster_21214954            float64
S_Minterferon_Cluster_21214954    float64
S_Immune_cell_Cluster_21214954    float64
S_MCD3_CD8_21214954               float64
S_Interferon_Cluster_21214954     float64
S_B_cell_PCA_16704732             float64
S_CD8_PCA_16704732                float64
S_GRANS_PCA_16704732              float64
S_LYMPHS_PCA_16704732             float64
S_T_cell_PCA_16704732             float64
S_TGFB_PCA_17349583               float64
S_Rotterdam_ERneg_PCA_15721472    float64
S_HER2_Immune_PCA_18006808        float64
S_IR7_score                       float64
S_Buck14_score                    float64
S_TAMsurr_score                   float64
S_Immune_NSCLC_score              float64
S_Module3_IFN_score               float64
S_Module4_TcellBcell_score        float64
S_Module5_TcellBcell_score        float64
S_Module11_Prolif_score           float64
S_CD8_CD68_ratio                  float64
S_TAMsurr_TcClassII_ratio         float64
S_CHANG_CORE_SERUM_RESPONSE_UP    float64
S_CSR_Activated_15701700          float64
S_B_cells                         float64
S_T_cells                         float64
S_T_helper                        float64
S_Tcm                             float64
S_Tem                             float64
S_Th1                             float64
S_Th2                             float64
S_TFH                             float64
S_CD8_Tcells                      float64
S_Th17                            float64
S_Treg                            float64
S_Tgd                             float64
S_Cytotoxic_cells                 float64
S_NK_cells                        float64
S_NK_cd56dim                      float64
S_NK_cd56bright                   float64
S_DC                              float64
S_iDC                             float64
S_aDC                             float64
S_pDC                             float64
S_Eosinophils                     float64
S_Macrophages                     float64
S_Mast                            float64
S_Neutrophils                     float64
S_Bindea_full                     float64
S_Expanded_IFNg                   float64
S_KEGG_MMR                        float64
S_KEGG_TGF_Beta                   float64
S_KEGG_Cytosolic_DNA_Sensing      float64
dtype: object</code></pre>
</div>
</div>
<p>::: {.content-hidden} Now we can use Feature_Engine’s <code>OneHotEncoder()</code> to create a <code>k</code> dummy variable set for <code>PAM50</code> and <code>Subtype</code>.</p>
<p><strong>NOTE</strong>: The encoded columns will be appended at the end of the dataFrame.</p>
<p>::: {.content-hidden} Below is the categorically-encoded dataframe.</p>
<p>::: {.content-hidden} And below is the original, unencoded dataframe.</p>
</section>
<section id="spearman-correlation-heatmap" class="level4">
<h4 class="anchored" data-anchor-id="spearman-correlation-heatmap"><strong>Spearman Correlation Heatmap</strong></h4>
<p>Before moving on with XGBoost, we can plot a Spearman correlation matrix between the clinical variables (X features) and the immune score variables (Y labels).</p>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df_dropcat <span class="op">=</span> dfx2.drop(columns<span class="op">=</span>[<span class="st">'Batch'</span>])</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_dropcat.shape)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>df_dropcat.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(693, 124)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="43">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Stage</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionTransscript_Count</th>
<th data-quarto-table-cell-role="th">FN/FT_Ratio</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
<th data-quarto-table-cell-role="th">ESTIMATE</th>
<th data-quarto-table-cell-role="th">IMPRES</th>
<th data-quarto-table-cell-role="th">C_Bcellsnaive</th>
<th data-quarto-table-cell-role="th">C_TcellsCD4memoryresting</th>
<th data-quarto-table-cell-role="th">C_MacrophagesM2</th>
<th data-quarto-table-cell-role="th">S_Attractors_LYM</th>
<th data-quarto-table-cell-role="th">S_Attractors_IFIT3</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_GIMAP4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_HLA.DPA1</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SLAMF6</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_LILRB4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SIGLEC9</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CYTH4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CD3E</th>
<th data-quarto-table-cell-role="th">S_Lymph_Vessels</th>
<th data-quarto-table-cell-role="th">S_ICR_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_INHIB_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_ACT_SCORE</th>
<th data-quarto-table-cell-role="th">S_Angiogenesis</th>
<th data-quarto-table-cell-role="th">S_APM1</th>
<th data-quarto-table-cell-role="th">S_APM2</th>
<th data-quarto-table-cell-role="th">S_ICS5_score</th>
<th data-quarto-table-cell-role="th">S_LIexpression_score</th>
<th data-quarto-table-cell-role="th">S_Chemokine12_score</th>
<th data-quarto-table-cell-role="th">S_NHI_5gene_score</th>
<th data-quarto-table-cell-role="th">S_CD68</th>
<th data-quarto-table-cell-role="th">S_CD8A</th>
<th data-quarto-table-cell-role="th">S_PD1_data</th>
<th data-quarto-table-cell-role="th">S_PDL1_data</th>
<th data-quarto-table-cell-role="th">S_PD1_PDL1_score</th>
<th data-quarto-table-cell-role="th">S_CTLA4_data</th>
<th data-quarto-table-cell-role="th">S_Bcell_mg_IGJ</th>
<th data-quarto-table-cell-role="th">S_Bcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_STAT1_score</th>
<th data-quarto-table-cell-role="th">S_CSF1_response</th>
<th data-quarto-table-cell-role="th">S_TcClassII_score</th>
<th data-quarto-table-cell-role="th">S_IL12_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL4_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL2_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL13_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IFNG_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TGFB_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TREM1_data</th>
<th data-quarto-table-cell-role="th">S_DAP12_data</th>
<th data-quarto-table-cell-role="th">S_Tcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_IL8_21978456</th>
<th data-quarto-table-cell-role="th">S_IFN_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC1_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC2_21978456</th>
<th data-quarto-table-cell-role="th">S_Bcell_21978456</th>
<th data-quarto-table-cell-role="th">S_Tcell_21978456</th>
<th data-quarto-table-cell-role="th">S_CD103pos_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_CD103neg_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_IgG_19272155</th>
<th data-quarto-table-cell-role="th">S_Interferon_19272155</th>
<th data-quarto-table-cell-role="th">S_LCK_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.I_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.II_19272155</th>
<th data-quarto-table-cell-role="th">S_STAT1_19272155</th>
<th data-quarto-table-cell-role="th">S_Troester_WoundSig_19887484</th>
<th data-quarto-table-cell-role="th">S_MDACC.FNA.1_20805453</th>
<th data-quarto-table-cell-role="th">S_IGG_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Minterferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Immune_cell_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_MCD3_CD8_21214954</th>
<th data-quarto-table-cell-role="th">S_Interferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_B_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_CD8_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_GRANS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_LYMPHS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_T_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_TGFB_PCA_17349583</th>
<th data-quarto-table-cell-role="th">S_Rotterdam_ERneg_PCA_15721472</th>
<th data-quarto-table-cell-role="th">S_HER2_Immune_PCA_18006808</th>
<th data-quarto-table-cell-role="th">S_IR7_score</th>
<th data-quarto-table-cell-role="th">S_Buck14_score</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_score</th>
<th data-quarto-table-cell-role="th">S_Immune_NSCLC_score</th>
<th data-quarto-table-cell-role="th">S_Module3_IFN_score</th>
<th data-quarto-table-cell-role="th">S_Module4_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module5_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module11_Prolif_score</th>
<th data-quarto-table-cell-role="th">S_CD8_CD68_ratio</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_TcClassII_ratio</th>
<th data-quarto-table-cell-role="th">S_CHANG_CORE_SERUM_RESPONSE_UP</th>
<th data-quarto-table-cell-role="th">S_CSR_Activated_15701700</th>
<th data-quarto-table-cell-role="th">S_B_cells</th>
<th data-quarto-table-cell-role="th">S_T_cells</th>
<th data-quarto-table-cell-role="th">S_T_helper</th>
<th data-quarto-table-cell-role="th">S_Tcm</th>
<th data-quarto-table-cell-role="th">S_Tem</th>
<th data-quarto-table-cell-role="th">S_Th1</th>
<th data-quarto-table-cell-role="th">S_Th2</th>
<th data-quarto-table-cell-role="th">S_TFH</th>
<th data-quarto-table-cell-role="th">S_CD8_Tcells</th>
<th data-quarto-table-cell-role="th">S_Th17</th>
<th data-quarto-table-cell-role="th">S_Treg</th>
<th data-quarto-table-cell-role="th">S_Tgd</th>
<th data-quarto-table-cell-role="th">S_Cytotoxic_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cd56dim</th>
<th data-quarto-table-cell-role="th">S_NK_cd56bright</th>
<th data-quarto-table-cell-role="th">S_DC</th>
<th data-quarto-table-cell-role="th">S_iDC</th>
<th data-quarto-table-cell-role="th">S_aDC</th>
<th data-quarto-table-cell-role="th">S_pDC</th>
<th data-quarto-table-cell-role="th">S_Eosinophils</th>
<th data-quarto-table-cell-role="th">S_Macrophages</th>
<th data-quarto-table-cell-role="th">S_Mast</th>
<th data-quarto-table-cell-role="th">S_Neutrophils</th>
<th data-quarto-table-cell-role="th">S_Bindea_full</th>
<th data-quarto-table-cell-role="th">S_Expanded_IFNg</th>
<th data-quarto-table-cell-role="th">S_KEGG_MMR</th>
<th data-quarto-table-cell-role="th">S_KEGG_TGF_Beta</th>
<th data-quarto-table-cell-role="th">S_KEGG_Cytosolic_DNA_Sensing</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0012</td>
<td>50</td>
<td>2</td>
<td>2.0</td>
<td>2.3</td>
<td>20</td>
<td>42</td>
<td>0.476190</td>
<td>357</td>
<td>1.7</td>
<td>2895.605487</td>
<td>9</td>
<td>0.120394</td>
<td>0.117468</td>
<td>0.448450</td>
<td>0.3620</td>
<td>0.4216</td>
<td>0.3034</td>
<td>0.4425</td>
<td>0.2749</td>
<td>0.2983</td>
<td>0.2756</td>
<td>0.3121</td>
<td>0.2765</td>
<td>0.3203</td>
<td>0.2463</td>
<td>0.2341</td>
<td>0.2495</td>
<td>0.3571</td>
<td>0.4591</td>
<td>0.3985</td>
<td>0.2130</td>
<td>0.2223</td>
<td>0.2766</td>
<td>0.3573</td>
<td>0.1561</td>
<td>0.2942</td>
<td>0.1536</td>
<td>0.2530</td>
<td>0.2042</td>
<td>0.2061</td>
<td>0.1942</td>
<td>0.2764</td>
<td>0.3327</td>
<td>0.3795</td>
<td>0.3435</td>
<td>0.2846</td>
<td>0.3797</td>
<td>0.3761</td>
<td>0.3197</td>
<td>0.4008</td>
<td>0.4403</td>
<td>0.2907</td>
<td>0.4011</td>
<td>0.2526</td>
<td>0.2237</td>
<td>0.4256</td>
<td>0.3971</td>
<td>0.4477</td>
<td>0.1852</td>
<td>0.2516</td>
<td>0.2262</td>
<td>0.3854</td>
<td>0.1591</td>
<td>0.4462</td>
<td>0.2912</td>
<td>0.4211</td>
<td>0.4502</td>
<td>0.3610</td>
<td>0.2711</td>
<td>0.3414</td>
<td>0.2183</td>
<td>0.3728</td>
<td>0.3512</td>
<td>0.3529</td>
<td>0.4162</td>
<td>0.3612</td>
<td>0.2215</td>
<td>0.3614</td>
<td>0.4294</td>
<td>0.3451</td>
<td>0.4648</td>
<td>0.2937</td>
<td>0.3338</td>
<td>0.2999</td>
<td>0.2094</td>
<td>0.2743</td>
<td>0.3203</td>
<td>0.4136</td>
<td>0.2546</td>
<td>0.2730</td>
<td>0.3697</td>
<td>0.2268</td>
<td>0.3335</td>
<td>0.3959</td>
<td>0.4066</td>
<td>0.2199</td>
<td>0.2395</td>
<td>0.4132</td>
<td>0.3633</td>
<td>0.3210</td>
<td>0.2599</td>
<td>0.3561</td>
<td>0.3112</td>
<td>0.3645</td>
<td>0.2810</td>
<td>0.2348</td>
<td>0.1945</td>
<td>0.2188</td>
<td>0.3281</td>
<td>0.0602</td>
<td>0.2038</td>
<td>0.2445</td>
<td>0.3220</td>
<td>0.2212</td>
<td>0.2866</td>
<td>0.3030</td>
<td>0.3657</td>
<td>0.2499</td>
<td>0.2531</td>
<td>0.3031</td>
<td>0.3097</td>
<td>0.4053</td>
<td>0.3537</td>
<td>0.2530</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0014</td>
<td>58</td>
<td>2</td>
<td>2.0</td>
<td>2.5</td>
<td>10</td>
<td>17</td>
<td>0.588235</td>
<td>85</td>
<td>4.1</td>
<td>4257.831526</td>
<td>11</td>
<td>0.165023</td>
<td>0.207531</td>
<td>0.124223</td>
<td>0.4126</td>
<td>0.3815</td>
<td>0.3619</td>
<td>0.4760</td>
<td>0.3343</td>
<td>0.3001</td>
<td>0.2769</td>
<td>0.3761</td>
<td>0.3525</td>
<td>0.3452</td>
<td>0.3051</td>
<td>0.2701</td>
<td>0.3143</td>
<td>0.3803</td>
<td>0.4819</td>
<td>0.4125</td>
<td>0.3002</td>
<td>0.3106</td>
<td>0.3646</td>
<td>0.3753</td>
<td>0.1030</td>
<td>0.3644</td>
<td>0.2726</td>
<td>0.2377</td>
<td>0.2553</td>
<td>0.2513</td>
<td>0.2820</td>
<td>0.3079</td>
<td>0.3515</td>
<td>0.3869</td>
<td>0.3868</td>
<td>0.3133</td>
<td>0.4051</td>
<td>0.4031</td>
<td>0.3308</td>
<td>0.4120</td>
<td>0.4496</td>
<td>0.2012</td>
<td>0.4360</td>
<td>0.3290</td>
<td>0.2562</td>
<td>0.3882</td>
<td>0.4310</td>
<td>0.4682</td>
<td>0.2990</td>
<td>0.3007</td>
<td>0.2859</td>
<td>0.3998</td>
<td>0.2225</td>
<td>0.4068</td>
<td>0.3481</td>
<td>0.4494</td>
<td>0.4710</td>
<td>0.4011</td>
<td>0.2840</td>
<td>0.3779</td>
<td>0.2727</td>
<td>0.3831</td>
<td>0.3864</td>
<td>0.3511</td>
<td>0.3983</td>
<td>0.3676</td>
<td>0.2761</td>
<td>0.3637</td>
<td>0.4268</td>
<td>0.3555</td>
<td>0.4580</td>
<td>0.3266</td>
<td>0.3549</td>
<td>0.3763</td>
<td>0.2157</td>
<td>0.3028</td>
<td>0.3278</td>
<td>0.3896</td>
<td>0.3111</td>
<td>0.3159</td>
<td>0.3126</td>
<td>0.2395</td>
<td>0.3747</td>
<td>0.3838</td>
<td>0.4030</td>
<td>0.2731</td>
<td>0.2909</td>
<td>0.4092</td>
<td>0.3404</td>
<td>0.3530</td>
<td>0.2808</td>
<td>0.3102</td>
<td>0.3229</td>
<td>0.3713</td>
<td>0.2645</td>
<td>0.3182</td>
<td>0.1977</td>
<td>0.2985</td>
<td>0.3502</td>
<td>0.1191</td>
<td>0.3316</td>
<td>0.2976</td>
<td>0.3445</td>
<td>0.2403</td>
<td>0.3450</td>
<td>0.3203</td>
<td>0.3484</td>
<td>0.2768</td>
<td>0.2783</td>
<td>0.3200</td>
<td>0.3668</td>
<td>0.3803</td>
<td>0.3470</td>
<td>0.2606</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0015</td>
<td>46</td>
<td>1</td>
<td>2.0</td>
<td>1.8</td>
<td>4</td>
<td>16</td>
<td>0.250000</td>
<td>150</td>
<td>2.4</td>
<td>3123.055856</td>
<td>8</td>
<td>0.162653</td>
<td>0.235337</td>
<td>0.279972</td>
<td>0.3556</td>
<td>0.3782</td>
<td>0.3363</td>
<td>0.4718</td>
<td>0.3015</td>
<td>0.2659</td>
<td>0.2274</td>
<td>0.3180</td>
<td>0.3025</td>
<td>0.3124</td>
<td>0.2622</td>
<td>0.2304</td>
<td>0.2706</td>
<td>0.3761</td>
<td>0.4613</td>
<td>0.3814</td>
<td>0.3055</td>
<td>0.2764</td>
<td>0.3211</td>
<td>0.3784</td>
<td>-0.1955</td>
<td>0.3122</td>
<td>0.1932</td>
<td>0.2485</td>
<td>0.2211</td>
<td>0.2004</td>
<td>0.2478</td>
<td>0.3040</td>
<td>0.3316</td>
<td>0.3646</td>
<td>0.3483</td>
<td>0.3012</td>
<td>0.4038</td>
<td>0.3875</td>
<td>0.3158</td>
<td>0.3986</td>
<td>0.4391</td>
<td>0.1509</td>
<td>0.3958</td>
<td>0.2886</td>
<td>0.2535</td>
<td>0.3764</td>
<td>0.4054</td>
<td>0.4601</td>
<td>0.2509</td>
<td>0.2830</td>
<td>0.2712</td>
<td>0.3801</td>
<td>0.1750</td>
<td>0.3987</td>
<td>0.3063</td>
<td>0.4239</td>
<td>0.4616</td>
<td>0.3587</td>
<td>0.2955</td>
<td>0.3431</td>
<td>0.2278</td>
<td>0.3599</td>
<td>0.3549</td>
<td>0.4011</td>
<td>0.3865</td>
<td>0.3661</td>
<td>0.2671</td>
<td>0.3591</td>
<td>0.4313</td>
<td>0.3489</td>
<td>0.4442</td>
<td>0.2985</td>
<td>0.3383</td>
<td>0.3370</td>
<td>0.2609</td>
<td>0.2706</td>
<td>0.3312</td>
<td>0.3792</td>
<td>0.2851</td>
<td>0.2897</td>
<td>0.2984</td>
<td>0.0936</td>
<td>0.3370</td>
<td>0.3880</td>
<td>0.4038</td>
<td>0.2799</td>
<td>0.2873</td>
<td>0.4159</td>
<td>0.3520</td>
<td>0.3560</td>
<td>0.2600</td>
<td>0.3116</td>
<td>0.3225</td>
<td>0.3762</td>
<td>0.2370</td>
<td>0.2251</td>
<td>0.2021</td>
<td>0.2720</td>
<td>0.3434</td>
<td>0.0626</td>
<td>0.3025</td>
<td>0.2670</td>
<td>0.3212</td>
<td>0.2098</td>
<td>0.2967</td>
<td>0.3236</td>
<td>0.3266</td>
<td>0.2455</td>
<td>0.2522</td>
<td>0.3107</td>
<td>0.3372</td>
<td>0.3793</td>
<td>0.3522</td>
<td>0.2564</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0017</td>
<td>54</td>
<td>2</td>
<td>2.0</td>
<td>2.5</td>
<td>19</td>
<td>47</td>
<td>0.404255</td>
<td>1369</td>
<td>1.7</td>
<td>5275.497847</td>
<td>11</td>
<td>0.155523</td>
<td>0.148387</td>
<td>0.128777</td>
<td>0.4314</td>
<td>0.4482</td>
<td>0.4080</td>
<td>0.4980</td>
<td>0.3912</td>
<td>0.3120</td>
<td>0.2934</td>
<td>0.3864</td>
<td>0.3957</td>
<td>0.3131</td>
<td>0.3589</td>
<td>0.3341</td>
<td>0.3654</td>
<td>0.3842</td>
<td>0.4957</td>
<td>0.4328</td>
<td>0.3533</td>
<td>0.3732</td>
<td>0.4177</td>
<td>0.4350</td>
<td>0.1401</td>
<td>0.4006</td>
<td>0.3023</td>
<td>0.3429</td>
<td>0.3228</td>
<td>0.2922</td>
<td>0.3591</td>
<td>0.3671</td>
<td>0.3926</td>
<td>0.4113</td>
<td>0.4082</td>
<td>0.3325</td>
<td>0.4092</td>
<td>0.4129</td>
<td>0.3338</td>
<td>0.4190</td>
<td>0.4248</td>
<td>0.1319</td>
<td>0.4878</td>
<td>0.3797</td>
<td>0.1889</td>
<td>0.4601</td>
<td>0.4445</td>
<td>0.4859</td>
<td>0.3224</td>
<td>0.3693</td>
<td>0.3003</td>
<td>0.4095</td>
<td>0.2938</td>
<td>0.4707</td>
<td>0.3968</td>
<td>0.4616</td>
<td>0.4893</td>
<td>0.4644</td>
<td>0.2735</td>
<td>0.3955</td>
<td>0.3234</td>
<td>0.4165</td>
<td>0.4337</td>
<td>0.4190</td>
<td>0.4511</td>
<td>0.3758</td>
<td>0.3174</td>
<td>0.3679</td>
<td>0.4314</td>
<td>0.3648</td>
<td>0.4439</td>
<td>0.2886</td>
<td>0.3688</td>
<td>0.4143</td>
<td>0.2489</td>
<td>0.3562</td>
<td>0.3498</td>
<td>0.4563</td>
<td>0.3576</td>
<td>0.3706</td>
<td>0.3377</td>
<td>0.2758</td>
<td>0.4006</td>
<td>0.4000</td>
<td>0.4062</td>
<td>0.3182</td>
<td>0.3460</td>
<td>0.4170</td>
<td>0.3275</td>
<td>0.3432</td>
<td>0.2914</td>
<td>0.3307</td>
<td>0.3525</td>
<td>0.3879</td>
<td>0.2212</td>
<td>0.3330</td>
<td>0.2251</td>
<td>0.3151</td>
<td>0.3495</td>
<td>0.1939</td>
<td>0.2953</td>
<td>0.3010</td>
<td>0.3467</td>
<td>0.2547</td>
<td>0.3313</td>
<td>0.3230</td>
<td>0.3597</td>
<td>0.2726</td>
<td>0.2648</td>
<td>0.3309</td>
<td>0.4165</td>
<td>0.3997</td>
<td>0.3468</td>
<td>0.2682</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0018</td>
<td>58</td>
<td>2</td>
<td>3.0</td>
<td>3.0</td>
<td>39</td>
<td>126</td>
<td>0.309524</td>
<td>382</td>
<td>1.6</td>
<td>3548.348220</td>
<td>11</td>
<td>0.129397</td>
<td>0.133531</td>
<td>0.304963</td>
<td>0.3701</td>
<td>0.3859</td>
<td>0.3067</td>
<td>0.4858</td>
<td>0.3141</td>
<td>0.2980</td>
<td>0.2006</td>
<td>0.3222</td>
<td>0.3017</td>
<td>0.3358</td>
<td>0.2870</td>
<td>0.2544</td>
<td>0.2955</td>
<td>0.3292</td>
<td>0.4758</td>
<td>0.4200</td>
<td>0.2892</td>
<td>0.2845</td>
<td>0.3767</td>
<td>0.4084</td>
<td>0.1187</td>
<td>0.2786</td>
<td>0.2363</td>
<td>0.2357</td>
<td>0.2360</td>
<td>0.2310</td>
<td>0.3125</td>
<td>0.3054</td>
<td>0.3430</td>
<td>0.3742</td>
<td>0.3709</td>
<td>0.2860</td>
<td>0.3689</td>
<td>0.3880</td>
<td>0.3172</td>
<td>0.4095</td>
<td>0.4343</td>
<td>0.2824</td>
<td>0.4664</td>
<td>0.2799</td>
<td>0.2613</td>
<td>0.3975</td>
<td>0.4264</td>
<td>0.4805</td>
<td>0.3210</td>
<td>0.2670</td>
<td>0.2429</td>
<td>0.3952</td>
<td>0.2321</td>
<td>0.4166</td>
<td>0.3061</td>
<td>0.4446</td>
<td>0.4658</td>
<td>0.4181</td>
<td>0.2747</td>
<td>0.3910</td>
<td>0.3019</td>
<td>0.3722</td>
<td>0.3716</td>
<td>0.3075</td>
<td>0.3931</td>
<td>0.3605</td>
<td>0.2308</td>
<td>0.3603</td>
<td>0.4258</td>
<td>0.3393</td>
<td>0.4654</td>
<td>0.2920</td>
<td>0.3385</td>
<td>0.3668</td>
<td>0.2237</td>
<td>0.3404</td>
<td>0.3264</td>
<td>0.3909</td>
<td>0.2758</td>
<td>0.3050</td>
<td>0.3770</td>
<td>0.2009</td>
<td>0.3664</td>
<td>0.4026</td>
<td>0.4092</td>
<td>0.2699</td>
<td>0.2530</td>
<td>0.3955</td>
<td>0.3185</td>
<td>0.3066</td>
<td>0.2713</td>
<td>0.3333</td>
<td>0.3041</td>
<td>0.3523</td>
<td>0.2401</td>
<td>0.2709</td>
<td>0.1413</td>
<td>0.2636</td>
<td>0.3061</td>
<td>0.0764</td>
<td>0.2639</td>
<td>0.2623</td>
<td>0.3348</td>
<td>0.2124</td>
<td>0.2731</td>
<td>0.3020</td>
<td>0.3540</td>
<td>0.2233</td>
<td>0.2182</td>
<td>0.2979</td>
<td>0.3530</td>
<td>0.4033</td>
<td>0.3444</td>
<td>0.2496</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># replot heatmap on transformed data</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>corr_df <span class="op">=</span> df_dropcat.corr(method<span class="op">=</span><span class="st">'spearman'</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>corr_df <span class="op">=</span> corr_df.<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a mask for the upper triangle</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> np.triu(np.ones_like(corr_df, dtype<span class="op">=</span><span class="bu">bool</span>))</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">46</span>, <span class="dv">36</span>))</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the correlation matrix and represent it as a heatmap.</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>hm <span class="op">=</span> sns.heatmap(corr_df, annot <span class="op">=</span> <span class="va">False</span>, cmap <span class="op">=</span> <span class="st">'RdBu_r'</span>, square <span class="op">=</span> <span class="va">True</span>, linewidths<span class="op">=</span><span class="fl">0.5</span>, center<span class="op">=</span><span class="dv">0</span>, mask<span class="op">=</span>mask, cbar_kws<span class="op">=</span>{<span class="st">"shrink"</span>: <span class="fl">.5</span>})</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get current labels</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>ylabels <span class="op">=</span> hm.get_yticklabels()</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>xlabels <span class="op">=</span> hm.get_xticklabels()</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Hide the first y-axis label and the last x-axis label</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>ylabels[<span class="dv">0</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>xlabels[<span class="op">-</span><span class="dv">1</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Rotate and align the tick labels</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>plt.setp(xlabels, rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Define columns to highlight and their colors</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>highlight_cols <span class="op">=</span> {</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"TotalNeo_Count"</span>: <span class="st">"crimson"</span>,</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"FusionNeo_Count"</span>: <span class="st">"olive"</span>,</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SNVindelNeo_Count"</span>: <span class="st">"darkviolet"</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Change color of specific x-axis and y-axis labels</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> label <span class="kw">in</span> xlabels:</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> label.get_text() <span class="kw">in</span> highlight_cols:</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>        label.set_color(highlight_cols[label.get_text()])</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>        label.set_fontweight(<span class="st">'bold'</span>)</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> label <span class="kw">in</span> ylabels:</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> label.get_text() <span class="kw">in</span> highlight_cols:</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>        label.set_color(highlight_cols[label.get_text()])</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>        label.set_fontweight(<span class="st">'bold'</span>)</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Removes all ticks</span></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>hm.tick_params(left<span class="op">=</span><span class="va">False</span>, bottom<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>hm.set_title(<span class="st">'Dataframe Correlation Heatmap'</span>, fontsize<span class="op">=</span><span class="dv">30</span>, x<span class="op">=</span><span class="fl">0.45</span>)</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="xgboost_files/figure-html/cell-28-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>:::{.content-hidden} #### <strong>Distributions of Neoantigen Counts by Subtype and PAM50 Classes</strong></p>
<p>:::{.content-hidden} Then, plot the distributions of <code>FusionNeo_Count</code>, <code>SNVindelNeo_Count</code>, <code>TotalNeo_Count</code> hued by <code>Subtype</code> as boxplots.</p>
<p>:::{.content-hidden} Nothing strikes as interesting here. In a way this might be good, because this shows that there probably isn’t any multicollinearity between the neoantigen count X variables and the subtype X variables.</p>
</section>
<section id="yeo-johnson-transformation-and-z-score-standardization" class="level4">
<h4 class="anchored" data-anchor-id="yeo-johnson-transformation-and-z-score-standardization"><strong>Yeo-Johnson Transformation and Z-Score Standardization</strong></h4>
<p>Yeo-Johnson transformation is an extension of the Box-Cox transformation, which falls under the power transformation family. YJ algorithm is designed to handle both positive and negative values in the dataset. Similar to Box-Cox, the Yeo-Johnson transformation aims to stabilize variance, make the data more symmetric, and bring it closer to a normal distribution.</p>
<p>Instead of doing a simple log transformation we will use YJ transformation.</p>
<p><strong>NOTE</strong>: <del>MH also performed z-score standardization following YJ transformation but that might be unnecessary.</del> I changed my mind. Z-score helped center the data which would be useful for some machine learning algorithms. Let’s do that.</p>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>dfc <span class="op">=</span> df_dropcat.copy()</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dfc.shape)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>dfc.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(693, 124)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="47">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Stage</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionTransscript_Count</th>
<th data-quarto-table-cell-role="th">FN/FT_Ratio</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
<th data-quarto-table-cell-role="th">ESTIMATE</th>
<th data-quarto-table-cell-role="th">IMPRES</th>
<th data-quarto-table-cell-role="th">C_Bcellsnaive</th>
<th data-quarto-table-cell-role="th">C_TcellsCD4memoryresting</th>
<th data-quarto-table-cell-role="th">C_MacrophagesM2</th>
<th data-quarto-table-cell-role="th">S_Attractors_LYM</th>
<th data-quarto-table-cell-role="th">S_Attractors_IFIT3</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_GIMAP4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_HLA.DPA1</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SLAMF6</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_LILRB4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SIGLEC9</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CYTH4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CD3E</th>
<th data-quarto-table-cell-role="th">S_Lymph_Vessels</th>
<th data-quarto-table-cell-role="th">S_ICR_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_INHIB_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_ACT_SCORE</th>
<th data-quarto-table-cell-role="th">S_Angiogenesis</th>
<th data-quarto-table-cell-role="th">S_APM1</th>
<th data-quarto-table-cell-role="th">S_APM2</th>
<th data-quarto-table-cell-role="th">S_ICS5_score</th>
<th data-quarto-table-cell-role="th">S_LIexpression_score</th>
<th data-quarto-table-cell-role="th">S_Chemokine12_score</th>
<th data-quarto-table-cell-role="th">S_NHI_5gene_score</th>
<th data-quarto-table-cell-role="th">S_CD68</th>
<th data-quarto-table-cell-role="th">S_CD8A</th>
<th data-quarto-table-cell-role="th">S_PD1_data</th>
<th data-quarto-table-cell-role="th">S_PDL1_data</th>
<th data-quarto-table-cell-role="th">S_PD1_PDL1_score</th>
<th data-quarto-table-cell-role="th">S_CTLA4_data</th>
<th data-quarto-table-cell-role="th">S_Bcell_mg_IGJ</th>
<th data-quarto-table-cell-role="th">S_Bcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_STAT1_score</th>
<th data-quarto-table-cell-role="th">S_CSF1_response</th>
<th data-quarto-table-cell-role="th">S_TcClassII_score</th>
<th data-quarto-table-cell-role="th">S_IL12_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL4_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL2_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL13_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IFNG_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TGFB_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TREM1_data</th>
<th data-quarto-table-cell-role="th">S_DAP12_data</th>
<th data-quarto-table-cell-role="th">S_Tcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_IL8_21978456</th>
<th data-quarto-table-cell-role="th">S_IFN_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC1_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC2_21978456</th>
<th data-quarto-table-cell-role="th">S_Bcell_21978456</th>
<th data-quarto-table-cell-role="th">S_Tcell_21978456</th>
<th data-quarto-table-cell-role="th">S_CD103pos_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_CD103neg_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_IgG_19272155</th>
<th data-quarto-table-cell-role="th">S_Interferon_19272155</th>
<th data-quarto-table-cell-role="th">S_LCK_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.I_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.II_19272155</th>
<th data-quarto-table-cell-role="th">S_STAT1_19272155</th>
<th data-quarto-table-cell-role="th">S_Troester_WoundSig_19887484</th>
<th data-quarto-table-cell-role="th">S_MDACC.FNA.1_20805453</th>
<th data-quarto-table-cell-role="th">S_IGG_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Minterferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Immune_cell_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_MCD3_CD8_21214954</th>
<th data-quarto-table-cell-role="th">S_Interferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_B_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_CD8_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_GRANS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_LYMPHS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_T_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_TGFB_PCA_17349583</th>
<th data-quarto-table-cell-role="th">S_Rotterdam_ERneg_PCA_15721472</th>
<th data-quarto-table-cell-role="th">S_HER2_Immune_PCA_18006808</th>
<th data-quarto-table-cell-role="th">S_IR7_score</th>
<th data-quarto-table-cell-role="th">S_Buck14_score</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_score</th>
<th data-quarto-table-cell-role="th">S_Immune_NSCLC_score</th>
<th data-quarto-table-cell-role="th">S_Module3_IFN_score</th>
<th data-quarto-table-cell-role="th">S_Module4_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module5_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module11_Prolif_score</th>
<th data-quarto-table-cell-role="th">S_CD8_CD68_ratio</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_TcClassII_ratio</th>
<th data-quarto-table-cell-role="th">S_CHANG_CORE_SERUM_RESPONSE_UP</th>
<th data-quarto-table-cell-role="th">S_CSR_Activated_15701700</th>
<th data-quarto-table-cell-role="th">S_B_cells</th>
<th data-quarto-table-cell-role="th">S_T_cells</th>
<th data-quarto-table-cell-role="th">S_T_helper</th>
<th data-quarto-table-cell-role="th">S_Tcm</th>
<th data-quarto-table-cell-role="th">S_Tem</th>
<th data-quarto-table-cell-role="th">S_Th1</th>
<th data-quarto-table-cell-role="th">S_Th2</th>
<th data-quarto-table-cell-role="th">S_TFH</th>
<th data-quarto-table-cell-role="th">S_CD8_Tcells</th>
<th data-quarto-table-cell-role="th">S_Th17</th>
<th data-quarto-table-cell-role="th">S_Treg</th>
<th data-quarto-table-cell-role="th">S_Tgd</th>
<th data-quarto-table-cell-role="th">S_Cytotoxic_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cd56dim</th>
<th data-quarto-table-cell-role="th">S_NK_cd56bright</th>
<th data-quarto-table-cell-role="th">S_DC</th>
<th data-quarto-table-cell-role="th">S_iDC</th>
<th data-quarto-table-cell-role="th">S_aDC</th>
<th data-quarto-table-cell-role="th">S_pDC</th>
<th data-quarto-table-cell-role="th">S_Eosinophils</th>
<th data-quarto-table-cell-role="th">S_Macrophages</th>
<th data-quarto-table-cell-role="th">S_Mast</th>
<th data-quarto-table-cell-role="th">S_Neutrophils</th>
<th data-quarto-table-cell-role="th">S_Bindea_full</th>
<th data-quarto-table-cell-role="th">S_Expanded_IFNg</th>
<th data-quarto-table-cell-role="th">S_KEGG_MMR</th>
<th data-quarto-table-cell-role="th">S_KEGG_TGF_Beta</th>
<th data-quarto-table-cell-role="th">S_KEGG_Cytosolic_DNA_Sensing</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0012</td>
<td>50</td>
<td>2</td>
<td>2.0</td>
<td>2.3</td>
<td>20</td>
<td>42</td>
<td>0.476190</td>
<td>357</td>
<td>1.7</td>
<td>2895.605487</td>
<td>9</td>
<td>0.120394</td>
<td>0.117468</td>
<td>0.448450</td>
<td>0.3620</td>
<td>0.4216</td>
<td>0.3034</td>
<td>0.4425</td>
<td>0.2749</td>
<td>0.2983</td>
<td>0.2756</td>
<td>0.3121</td>
<td>0.2765</td>
<td>0.3203</td>
<td>0.2463</td>
<td>0.2341</td>
<td>0.2495</td>
<td>0.3571</td>
<td>0.4591</td>
<td>0.3985</td>
<td>0.2130</td>
<td>0.2223</td>
<td>0.2766</td>
<td>0.3573</td>
<td>0.1561</td>
<td>0.2942</td>
<td>0.1536</td>
<td>0.2530</td>
<td>0.2042</td>
<td>0.2061</td>
<td>0.1942</td>
<td>0.2764</td>
<td>0.3327</td>
<td>0.3795</td>
<td>0.3435</td>
<td>0.2846</td>
<td>0.3797</td>
<td>0.3761</td>
<td>0.3197</td>
<td>0.4008</td>
<td>0.4403</td>
<td>0.2907</td>
<td>0.4011</td>
<td>0.2526</td>
<td>0.2237</td>
<td>0.4256</td>
<td>0.3971</td>
<td>0.4477</td>
<td>0.1852</td>
<td>0.2516</td>
<td>0.2262</td>
<td>0.3854</td>
<td>0.1591</td>
<td>0.4462</td>
<td>0.2912</td>
<td>0.4211</td>
<td>0.4502</td>
<td>0.3610</td>
<td>0.2711</td>
<td>0.3414</td>
<td>0.2183</td>
<td>0.3728</td>
<td>0.3512</td>
<td>0.3529</td>
<td>0.4162</td>
<td>0.3612</td>
<td>0.2215</td>
<td>0.3614</td>
<td>0.4294</td>
<td>0.3451</td>
<td>0.4648</td>
<td>0.2937</td>
<td>0.3338</td>
<td>0.2999</td>
<td>0.2094</td>
<td>0.2743</td>
<td>0.3203</td>
<td>0.4136</td>
<td>0.2546</td>
<td>0.2730</td>
<td>0.3697</td>
<td>0.2268</td>
<td>0.3335</td>
<td>0.3959</td>
<td>0.4066</td>
<td>0.2199</td>
<td>0.2395</td>
<td>0.4132</td>
<td>0.3633</td>
<td>0.3210</td>
<td>0.2599</td>
<td>0.3561</td>
<td>0.3112</td>
<td>0.3645</td>
<td>0.2810</td>
<td>0.2348</td>
<td>0.1945</td>
<td>0.2188</td>
<td>0.3281</td>
<td>0.0602</td>
<td>0.2038</td>
<td>0.2445</td>
<td>0.3220</td>
<td>0.2212</td>
<td>0.2866</td>
<td>0.3030</td>
<td>0.3657</td>
<td>0.2499</td>
<td>0.2531</td>
<td>0.3031</td>
<td>0.3097</td>
<td>0.4053</td>
<td>0.3537</td>
<td>0.2530</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0014</td>
<td>58</td>
<td>2</td>
<td>2.0</td>
<td>2.5</td>
<td>10</td>
<td>17</td>
<td>0.588235</td>
<td>85</td>
<td>4.1</td>
<td>4257.831526</td>
<td>11</td>
<td>0.165023</td>
<td>0.207531</td>
<td>0.124223</td>
<td>0.4126</td>
<td>0.3815</td>
<td>0.3619</td>
<td>0.4760</td>
<td>0.3343</td>
<td>0.3001</td>
<td>0.2769</td>
<td>0.3761</td>
<td>0.3525</td>
<td>0.3452</td>
<td>0.3051</td>
<td>0.2701</td>
<td>0.3143</td>
<td>0.3803</td>
<td>0.4819</td>
<td>0.4125</td>
<td>0.3002</td>
<td>0.3106</td>
<td>0.3646</td>
<td>0.3753</td>
<td>0.1030</td>
<td>0.3644</td>
<td>0.2726</td>
<td>0.2377</td>
<td>0.2553</td>
<td>0.2513</td>
<td>0.2820</td>
<td>0.3079</td>
<td>0.3515</td>
<td>0.3869</td>
<td>0.3868</td>
<td>0.3133</td>
<td>0.4051</td>
<td>0.4031</td>
<td>0.3308</td>
<td>0.4120</td>
<td>0.4496</td>
<td>0.2012</td>
<td>0.4360</td>
<td>0.3290</td>
<td>0.2562</td>
<td>0.3882</td>
<td>0.4310</td>
<td>0.4682</td>
<td>0.2990</td>
<td>0.3007</td>
<td>0.2859</td>
<td>0.3998</td>
<td>0.2225</td>
<td>0.4068</td>
<td>0.3481</td>
<td>0.4494</td>
<td>0.4710</td>
<td>0.4011</td>
<td>0.2840</td>
<td>0.3779</td>
<td>0.2727</td>
<td>0.3831</td>
<td>0.3864</td>
<td>0.3511</td>
<td>0.3983</td>
<td>0.3676</td>
<td>0.2761</td>
<td>0.3637</td>
<td>0.4268</td>
<td>0.3555</td>
<td>0.4580</td>
<td>0.3266</td>
<td>0.3549</td>
<td>0.3763</td>
<td>0.2157</td>
<td>0.3028</td>
<td>0.3278</td>
<td>0.3896</td>
<td>0.3111</td>
<td>0.3159</td>
<td>0.3126</td>
<td>0.2395</td>
<td>0.3747</td>
<td>0.3838</td>
<td>0.4030</td>
<td>0.2731</td>
<td>0.2909</td>
<td>0.4092</td>
<td>0.3404</td>
<td>0.3530</td>
<td>0.2808</td>
<td>0.3102</td>
<td>0.3229</td>
<td>0.3713</td>
<td>0.2645</td>
<td>0.3182</td>
<td>0.1977</td>
<td>0.2985</td>
<td>0.3502</td>
<td>0.1191</td>
<td>0.3316</td>
<td>0.2976</td>
<td>0.3445</td>
<td>0.2403</td>
<td>0.3450</td>
<td>0.3203</td>
<td>0.3484</td>
<td>0.2768</td>
<td>0.2783</td>
<td>0.3200</td>
<td>0.3668</td>
<td>0.3803</td>
<td>0.3470</td>
<td>0.2606</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0015</td>
<td>46</td>
<td>1</td>
<td>2.0</td>
<td>1.8</td>
<td>4</td>
<td>16</td>
<td>0.250000</td>
<td>150</td>
<td>2.4</td>
<td>3123.055856</td>
<td>8</td>
<td>0.162653</td>
<td>0.235337</td>
<td>0.279972</td>
<td>0.3556</td>
<td>0.3782</td>
<td>0.3363</td>
<td>0.4718</td>
<td>0.3015</td>
<td>0.2659</td>
<td>0.2274</td>
<td>0.3180</td>
<td>0.3025</td>
<td>0.3124</td>
<td>0.2622</td>
<td>0.2304</td>
<td>0.2706</td>
<td>0.3761</td>
<td>0.4613</td>
<td>0.3814</td>
<td>0.3055</td>
<td>0.2764</td>
<td>0.3211</td>
<td>0.3784</td>
<td>-0.1955</td>
<td>0.3122</td>
<td>0.1932</td>
<td>0.2485</td>
<td>0.2211</td>
<td>0.2004</td>
<td>0.2478</td>
<td>0.3040</td>
<td>0.3316</td>
<td>0.3646</td>
<td>0.3483</td>
<td>0.3012</td>
<td>0.4038</td>
<td>0.3875</td>
<td>0.3158</td>
<td>0.3986</td>
<td>0.4391</td>
<td>0.1509</td>
<td>0.3958</td>
<td>0.2886</td>
<td>0.2535</td>
<td>0.3764</td>
<td>0.4054</td>
<td>0.4601</td>
<td>0.2509</td>
<td>0.2830</td>
<td>0.2712</td>
<td>0.3801</td>
<td>0.1750</td>
<td>0.3987</td>
<td>0.3063</td>
<td>0.4239</td>
<td>0.4616</td>
<td>0.3587</td>
<td>0.2955</td>
<td>0.3431</td>
<td>0.2278</td>
<td>0.3599</td>
<td>0.3549</td>
<td>0.4011</td>
<td>0.3865</td>
<td>0.3661</td>
<td>0.2671</td>
<td>0.3591</td>
<td>0.4313</td>
<td>0.3489</td>
<td>0.4442</td>
<td>0.2985</td>
<td>0.3383</td>
<td>0.3370</td>
<td>0.2609</td>
<td>0.2706</td>
<td>0.3312</td>
<td>0.3792</td>
<td>0.2851</td>
<td>0.2897</td>
<td>0.2984</td>
<td>0.0936</td>
<td>0.3370</td>
<td>0.3880</td>
<td>0.4038</td>
<td>0.2799</td>
<td>0.2873</td>
<td>0.4159</td>
<td>0.3520</td>
<td>0.3560</td>
<td>0.2600</td>
<td>0.3116</td>
<td>0.3225</td>
<td>0.3762</td>
<td>0.2370</td>
<td>0.2251</td>
<td>0.2021</td>
<td>0.2720</td>
<td>0.3434</td>
<td>0.0626</td>
<td>0.3025</td>
<td>0.2670</td>
<td>0.3212</td>
<td>0.2098</td>
<td>0.2967</td>
<td>0.3236</td>
<td>0.3266</td>
<td>0.2455</td>
<td>0.2522</td>
<td>0.3107</td>
<td>0.3372</td>
<td>0.3793</td>
<td>0.3522</td>
<td>0.2564</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0017</td>
<td>54</td>
<td>2</td>
<td>2.0</td>
<td>2.5</td>
<td>19</td>
<td>47</td>
<td>0.404255</td>
<td>1369</td>
<td>1.7</td>
<td>5275.497847</td>
<td>11</td>
<td>0.155523</td>
<td>0.148387</td>
<td>0.128777</td>
<td>0.4314</td>
<td>0.4482</td>
<td>0.4080</td>
<td>0.4980</td>
<td>0.3912</td>
<td>0.3120</td>
<td>0.2934</td>
<td>0.3864</td>
<td>0.3957</td>
<td>0.3131</td>
<td>0.3589</td>
<td>0.3341</td>
<td>0.3654</td>
<td>0.3842</td>
<td>0.4957</td>
<td>0.4328</td>
<td>0.3533</td>
<td>0.3732</td>
<td>0.4177</td>
<td>0.4350</td>
<td>0.1401</td>
<td>0.4006</td>
<td>0.3023</td>
<td>0.3429</td>
<td>0.3228</td>
<td>0.2922</td>
<td>0.3591</td>
<td>0.3671</td>
<td>0.3926</td>
<td>0.4113</td>
<td>0.4082</td>
<td>0.3325</td>
<td>0.4092</td>
<td>0.4129</td>
<td>0.3338</td>
<td>0.4190</td>
<td>0.4248</td>
<td>0.1319</td>
<td>0.4878</td>
<td>0.3797</td>
<td>0.1889</td>
<td>0.4601</td>
<td>0.4445</td>
<td>0.4859</td>
<td>0.3224</td>
<td>0.3693</td>
<td>0.3003</td>
<td>0.4095</td>
<td>0.2938</td>
<td>0.4707</td>
<td>0.3968</td>
<td>0.4616</td>
<td>0.4893</td>
<td>0.4644</td>
<td>0.2735</td>
<td>0.3955</td>
<td>0.3234</td>
<td>0.4165</td>
<td>0.4337</td>
<td>0.4190</td>
<td>0.4511</td>
<td>0.3758</td>
<td>0.3174</td>
<td>0.3679</td>
<td>0.4314</td>
<td>0.3648</td>
<td>0.4439</td>
<td>0.2886</td>
<td>0.3688</td>
<td>0.4143</td>
<td>0.2489</td>
<td>0.3562</td>
<td>0.3498</td>
<td>0.4563</td>
<td>0.3576</td>
<td>0.3706</td>
<td>0.3377</td>
<td>0.2758</td>
<td>0.4006</td>
<td>0.4000</td>
<td>0.4062</td>
<td>0.3182</td>
<td>0.3460</td>
<td>0.4170</td>
<td>0.3275</td>
<td>0.3432</td>
<td>0.2914</td>
<td>0.3307</td>
<td>0.3525</td>
<td>0.3879</td>
<td>0.2212</td>
<td>0.3330</td>
<td>0.2251</td>
<td>0.3151</td>
<td>0.3495</td>
<td>0.1939</td>
<td>0.2953</td>
<td>0.3010</td>
<td>0.3467</td>
<td>0.2547</td>
<td>0.3313</td>
<td>0.3230</td>
<td>0.3597</td>
<td>0.2726</td>
<td>0.2648</td>
<td>0.3309</td>
<td>0.4165</td>
<td>0.3997</td>
<td>0.3468</td>
<td>0.2682</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0018</td>
<td>58</td>
<td>2</td>
<td>3.0</td>
<td>3.0</td>
<td>39</td>
<td>126</td>
<td>0.309524</td>
<td>382</td>
<td>1.6</td>
<td>3548.348220</td>
<td>11</td>
<td>0.129397</td>
<td>0.133531</td>
<td>0.304963</td>
<td>0.3701</td>
<td>0.3859</td>
<td>0.3067</td>
<td>0.4858</td>
<td>0.3141</td>
<td>0.2980</td>
<td>0.2006</td>
<td>0.3222</td>
<td>0.3017</td>
<td>0.3358</td>
<td>0.2870</td>
<td>0.2544</td>
<td>0.2955</td>
<td>0.3292</td>
<td>0.4758</td>
<td>0.4200</td>
<td>0.2892</td>
<td>0.2845</td>
<td>0.3767</td>
<td>0.4084</td>
<td>0.1187</td>
<td>0.2786</td>
<td>0.2363</td>
<td>0.2357</td>
<td>0.2360</td>
<td>0.2310</td>
<td>0.3125</td>
<td>0.3054</td>
<td>0.3430</td>
<td>0.3742</td>
<td>0.3709</td>
<td>0.2860</td>
<td>0.3689</td>
<td>0.3880</td>
<td>0.3172</td>
<td>0.4095</td>
<td>0.4343</td>
<td>0.2824</td>
<td>0.4664</td>
<td>0.2799</td>
<td>0.2613</td>
<td>0.3975</td>
<td>0.4264</td>
<td>0.4805</td>
<td>0.3210</td>
<td>0.2670</td>
<td>0.2429</td>
<td>0.3952</td>
<td>0.2321</td>
<td>0.4166</td>
<td>0.3061</td>
<td>0.4446</td>
<td>0.4658</td>
<td>0.4181</td>
<td>0.2747</td>
<td>0.3910</td>
<td>0.3019</td>
<td>0.3722</td>
<td>0.3716</td>
<td>0.3075</td>
<td>0.3931</td>
<td>0.3605</td>
<td>0.2308</td>
<td>0.3603</td>
<td>0.4258</td>
<td>0.3393</td>
<td>0.4654</td>
<td>0.2920</td>
<td>0.3385</td>
<td>0.3668</td>
<td>0.2237</td>
<td>0.3404</td>
<td>0.3264</td>
<td>0.3909</td>
<td>0.2758</td>
<td>0.3050</td>
<td>0.3770</td>
<td>0.2009</td>
<td>0.3664</td>
<td>0.4026</td>
<td>0.4092</td>
<td>0.2699</td>
<td>0.2530</td>
<td>0.3955</td>
<td>0.3185</td>
<td>0.3066</td>
<td>0.2713</td>
<td>0.3333</td>
<td>0.3041</td>
<td>0.3523</td>
<td>0.2401</td>
<td>0.2709</td>
<td>0.1413</td>
<td>0.2636</td>
<td>0.3061</td>
<td>0.0764</td>
<td>0.2639</td>
<td>0.2623</td>
<td>0.3348</td>
<td>0.2124</td>
<td>0.2731</td>
<td>0.3020</td>
<td>0.3540</td>
<td>0.2233</td>
<td>0.2182</td>
<td>0.2979</td>
<td>0.3530</td>
<td>0.4033</td>
<td>0.3444</td>
<td>0.2496</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>First define a plotting function.</p>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># visualise distributions</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine the number of rows and columns for the subplot grid</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>nrows <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>ncols <span class="op">=</span> <span class="dv">13</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co">#define the plotting function</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> visualize_distribution(df, naming_class, colr):</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a figure and a grid of subplots</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Flatten the axes array for easy iteration</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span>nrows, ncols<span class="op">=</span>ncols, figsize<span class="op">=</span>(<span class="dv">30</span>, <span class="dv">22</span>))</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    axes <span class="op">=</span> axes.flatten()</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot histograms for each column</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, column <span class="kw">in</span> <span class="bu">enumerate</span>(df.columns):</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>        sns.histplot(df[column], kde<span class="op">=</span><span class="va">False</span>, ax<span class="op">=</span>axes[i], color<span class="op">=</span>colr)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>        axes[i].set_title(column)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>        axes[i].set_xlabel(<span class="st">''</span>)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>        axes[i].set_ylabel(<span class="st">''</span>)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Hide any remaining empty subplots</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(axes)):</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>        fig.delaxes(axes[j])</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adjust the layout</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>    plt.subplots_adjust(top<span class="op">=</span><span class="fl">0.92</span>) </span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>    plt.suptitle(<span class="ss">f'</span><span class="sc">{</span>naming_class<span class="sc">}</span><span class="ss"> Distributions of the Dataset'</span>, fontsize<span class="op">=</span><span class="dv">20</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plt.savefig(f'Distribution_before.png',dpi=300)</span></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="original-unscaled-distribution" class="level5">
<h5 class="anchored" data-anchor-id="original-unscaled-distribution">Original Unscaled Distribution</h5>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#execute the function</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>visualize_distribution(dfc, <span class="st">'Original'</span>, <span class="st">'green'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="xgboost_files/figure-html/cell-33-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> feature_engine.transformation <span class="im">import</span> YeoJohnsonTransformer</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply Yeo-Johnson transformation to each numeric column</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>yjt <span class="op">=</span> YeoJohnsonTransformer()</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>yjt.fit(dfc)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>df_transformed <span class="op">=</span> yjt.transform(dfc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="power-transformed-distribution-yj" class="level5">
<h5 class="anchored" data-anchor-id="power-transformed-distribution-yj">Power-Transformed Distribution (YJ)</h5>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#execute the function</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>visualize_distribution(df_transformed, <span class="st">'YJ-Transformed'</span>, <span class="st">'orange'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="xgboost_files/figure-html/cell-35-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply Z-score normalization to the transformed data</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># using lambda function to apply z-score to each column and then join the resulting dataframes</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>zscore <span class="op">=</span> <span class="kw">lambda</span> x : stats.zscore(x)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>df_tfz <span class="op">=</span> df_transformed.<span class="bu">apply</span>(zscore)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="power-transformed-z-scaled-distribution-yj-z" class="level5">
<h5 class="anchored" data-anchor-id="power-transformed-z-scaled-distribution-yj-z">Power-Transformed, Z-Scaled Distribution (YJ-Z)</h5>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#execute the function</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>visualize_distribution(df_tfz, <span class="st">'YJZ-Transformed'</span>, <span class="st">'purple'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="xgboost_files/figure-html/cell-37-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><em>Conclusion</em>: The distributions after the power transformation and standardization looks variance-stabilized now with a centered data around 0. Let us proceed with the dataset splitting and then data scaling using YJ and Z-score.</p>
</section>
</section>
<section id="split-dataset-with-train_test_split" class="level4">
<h4 class="anchored" data-anchor-id="split-dataset-with-train_test_split"><strong>Split dataset with <code>train_test_split</code></strong></h4>
<p>Going back to the original dataframe, we need to split the dataset before modeling to avoid information leakage, then transform the data accordingly as above. First, load the cleaned up dataframe. <strong>UPDATE:</strong> Use the dataFrame without <code>PAM50</code> and <code>Subtype</code> information.</p>
<div class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_rows'</span>, <span class="dv">8</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>dfc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Stage</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionTransscript_Count</th>
<th data-quarto-table-cell-role="th">FN/FT_Ratio</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
<th data-quarto-table-cell-role="th">ESTIMATE</th>
<th data-quarto-table-cell-role="th">IMPRES</th>
<th data-quarto-table-cell-role="th">C_Bcellsnaive</th>
<th data-quarto-table-cell-role="th">C_TcellsCD4memoryresting</th>
<th data-quarto-table-cell-role="th">C_MacrophagesM2</th>
<th data-quarto-table-cell-role="th">S_Attractors_LYM</th>
<th data-quarto-table-cell-role="th">S_Attractors_IFIT3</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_GIMAP4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_HLA.DPA1</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SLAMF6</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_LILRB4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SIGLEC9</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CYTH4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CD3E</th>
<th data-quarto-table-cell-role="th">S_Lymph_Vessels</th>
<th data-quarto-table-cell-role="th">S_ICR_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_INHIB_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_ACT_SCORE</th>
<th data-quarto-table-cell-role="th">S_Angiogenesis</th>
<th data-quarto-table-cell-role="th">S_APM1</th>
<th data-quarto-table-cell-role="th">S_APM2</th>
<th data-quarto-table-cell-role="th">S_ICS5_score</th>
<th data-quarto-table-cell-role="th">S_LIexpression_score</th>
<th data-quarto-table-cell-role="th">S_Chemokine12_score</th>
<th data-quarto-table-cell-role="th">S_NHI_5gene_score</th>
<th data-quarto-table-cell-role="th">S_CD68</th>
<th data-quarto-table-cell-role="th">S_CD8A</th>
<th data-quarto-table-cell-role="th">S_PD1_data</th>
<th data-quarto-table-cell-role="th">S_PDL1_data</th>
<th data-quarto-table-cell-role="th">S_PD1_PDL1_score</th>
<th data-quarto-table-cell-role="th">S_CTLA4_data</th>
<th data-quarto-table-cell-role="th">S_Bcell_mg_IGJ</th>
<th data-quarto-table-cell-role="th">S_Bcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_STAT1_score</th>
<th data-quarto-table-cell-role="th">S_CSF1_response</th>
<th data-quarto-table-cell-role="th">S_TcClassII_score</th>
<th data-quarto-table-cell-role="th">S_IL12_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL4_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL2_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL13_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IFNG_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TGFB_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TREM1_data</th>
<th data-quarto-table-cell-role="th">S_DAP12_data</th>
<th data-quarto-table-cell-role="th">S_Tcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_IL8_21978456</th>
<th data-quarto-table-cell-role="th">S_IFN_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC1_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC2_21978456</th>
<th data-quarto-table-cell-role="th">S_Bcell_21978456</th>
<th data-quarto-table-cell-role="th">S_Tcell_21978456</th>
<th data-quarto-table-cell-role="th">S_CD103pos_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_CD103neg_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_IgG_19272155</th>
<th data-quarto-table-cell-role="th">S_Interferon_19272155</th>
<th data-quarto-table-cell-role="th">S_LCK_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.I_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.II_19272155</th>
<th data-quarto-table-cell-role="th">S_STAT1_19272155</th>
<th data-quarto-table-cell-role="th">S_Troester_WoundSig_19887484</th>
<th data-quarto-table-cell-role="th">S_MDACC.FNA.1_20805453</th>
<th data-quarto-table-cell-role="th">S_IGG_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Minterferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Immune_cell_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_MCD3_CD8_21214954</th>
<th data-quarto-table-cell-role="th">S_Interferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_B_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_CD8_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_GRANS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_LYMPHS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_T_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_TGFB_PCA_17349583</th>
<th data-quarto-table-cell-role="th">S_Rotterdam_ERneg_PCA_15721472</th>
<th data-quarto-table-cell-role="th">S_HER2_Immune_PCA_18006808</th>
<th data-quarto-table-cell-role="th">S_IR7_score</th>
<th data-quarto-table-cell-role="th">S_Buck14_score</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_score</th>
<th data-quarto-table-cell-role="th">S_Immune_NSCLC_score</th>
<th data-quarto-table-cell-role="th">S_Module3_IFN_score</th>
<th data-quarto-table-cell-role="th">S_Module4_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module5_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module11_Prolif_score</th>
<th data-quarto-table-cell-role="th">S_CD8_CD68_ratio</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_TcClassII_ratio</th>
<th data-quarto-table-cell-role="th">S_CHANG_CORE_SERUM_RESPONSE_UP</th>
<th data-quarto-table-cell-role="th">S_CSR_Activated_15701700</th>
<th data-quarto-table-cell-role="th">S_B_cells</th>
<th data-quarto-table-cell-role="th">S_T_cells</th>
<th data-quarto-table-cell-role="th">S_T_helper</th>
<th data-quarto-table-cell-role="th">S_Tcm</th>
<th data-quarto-table-cell-role="th">S_Tem</th>
<th data-quarto-table-cell-role="th">S_Th1</th>
<th data-quarto-table-cell-role="th">S_Th2</th>
<th data-quarto-table-cell-role="th">S_TFH</th>
<th data-quarto-table-cell-role="th">S_CD8_Tcells</th>
<th data-quarto-table-cell-role="th">S_Th17</th>
<th data-quarto-table-cell-role="th">S_Treg</th>
<th data-quarto-table-cell-role="th">S_Tgd</th>
<th data-quarto-table-cell-role="th">S_Cytotoxic_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cd56dim</th>
<th data-quarto-table-cell-role="th">S_NK_cd56bright</th>
<th data-quarto-table-cell-role="th">S_DC</th>
<th data-quarto-table-cell-role="th">S_iDC</th>
<th data-quarto-table-cell-role="th">S_aDC</th>
<th data-quarto-table-cell-role="th">S_pDC</th>
<th data-quarto-table-cell-role="th">S_Eosinophils</th>
<th data-quarto-table-cell-role="th">S_Macrophages</th>
<th data-quarto-table-cell-role="th">S_Mast</th>
<th data-quarto-table-cell-role="th">S_Neutrophils</th>
<th data-quarto-table-cell-role="th">S_Bindea_full</th>
<th data-quarto-table-cell-role="th">S_Expanded_IFNg</th>
<th data-quarto-table-cell-role="th">S_KEGG_MMR</th>
<th data-quarto-table-cell-role="th">S_KEGG_TGF_Beta</th>
<th data-quarto-table-cell-role="th">S_KEGG_Cytosolic_DNA_Sensing</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0012</td>
<td>50</td>
<td>2</td>
<td>2.0</td>
<td>2.3</td>
<td>20</td>
<td>42</td>
<td>0.476190</td>
<td>357</td>
<td>1.7</td>
<td>2895.605487</td>
<td>9</td>
<td>0.120394</td>
<td>0.117468</td>
<td>0.448450</td>
<td>0.3620</td>
<td>0.4216</td>
<td>0.3034</td>
<td>0.4425</td>
<td>0.2749</td>
<td>0.2983</td>
<td>0.2756</td>
<td>0.3121</td>
<td>0.2765</td>
<td>0.3203</td>
<td>0.2463</td>
<td>0.2341</td>
<td>0.2495</td>
<td>0.3571</td>
<td>0.4591</td>
<td>0.3985</td>
<td>0.2130</td>
<td>0.2223</td>
<td>0.2766</td>
<td>0.3573</td>
<td>0.1561</td>
<td>0.2942</td>
<td>0.1536</td>
<td>0.2530</td>
<td>0.2042</td>
<td>0.2061</td>
<td>0.1942</td>
<td>0.2764</td>
<td>0.3327</td>
<td>0.3795</td>
<td>0.3435</td>
<td>0.2846</td>
<td>0.3797</td>
<td>0.3761</td>
<td>0.3197</td>
<td>0.4008</td>
<td>0.4403</td>
<td>0.2907</td>
<td>0.4011</td>
<td>0.2526</td>
<td>0.2237</td>
<td>0.4256</td>
<td>0.3971</td>
<td>0.4477</td>
<td>0.1852</td>
<td>0.2516</td>
<td>0.2262</td>
<td>0.3854</td>
<td>0.1591</td>
<td>0.4462</td>
<td>0.2912</td>
<td>0.4211</td>
<td>0.4502</td>
<td>0.3610</td>
<td>0.2711</td>
<td>0.3414</td>
<td>0.2183</td>
<td>0.3728</td>
<td>0.3512</td>
<td>0.3529</td>
<td>0.4162</td>
<td>0.3612</td>
<td>0.2215</td>
<td>0.3614</td>
<td>0.4294</td>
<td>0.3451</td>
<td>0.4648</td>
<td>0.2937</td>
<td>0.3338</td>
<td>0.2999</td>
<td>0.2094</td>
<td>0.2743</td>
<td>0.3203</td>
<td>0.4136</td>
<td>0.2546</td>
<td>0.2730</td>
<td>0.3697</td>
<td>0.2268</td>
<td>0.3335</td>
<td>0.3959</td>
<td>0.4066</td>
<td>0.2199</td>
<td>0.2395</td>
<td>0.4132</td>
<td>0.3633</td>
<td>0.3210</td>
<td>0.2599</td>
<td>0.3561</td>
<td>0.3112</td>
<td>0.3645</td>
<td>0.2810</td>
<td>0.2348</td>
<td>0.1945</td>
<td>0.2188</td>
<td>0.3281</td>
<td>0.0602</td>
<td>0.2038</td>
<td>0.2445</td>
<td>0.3220</td>
<td>0.2212</td>
<td>0.2866</td>
<td>0.3030</td>
<td>0.3657</td>
<td>0.2499</td>
<td>0.2531</td>
<td>0.3031</td>
<td>0.3097</td>
<td>0.4053</td>
<td>0.3537</td>
<td>0.2530</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0014</td>
<td>58</td>
<td>2</td>
<td>2.0</td>
<td>2.5</td>
<td>10</td>
<td>17</td>
<td>0.588235</td>
<td>85</td>
<td>4.1</td>
<td>4257.831526</td>
<td>11</td>
<td>0.165023</td>
<td>0.207531</td>
<td>0.124223</td>
<td>0.4126</td>
<td>0.3815</td>
<td>0.3619</td>
<td>0.4760</td>
<td>0.3343</td>
<td>0.3001</td>
<td>0.2769</td>
<td>0.3761</td>
<td>0.3525</td>
<td>0.3452</td>
<td>0.3051</td>
<td>0.2701</td>
<td>0.3143</td>
<td>0.3803</td>
<td>0.4819</td>
<td>0.4125</td>
<td>0.3002</td>
<td>0.3106</td>
<td>0.3646</td>
<td>0.3753</td>
<td>0.1030</td>
<td>0.3644</td>
<td>0.2726</td>
<td>0.2377</td>
<td>0.2553</td>
<td>0.2513</td>
<td>0.2820</td>
<td>0.3079</td>
<td>0.3515</td>
<td>0.3869</td>
<td>0.3868</td>
<td>0.3133</td>
<td>0.4051</td>
<td>0.4031</td>
<td>0.3308</td>
<td>0.4120</td>
<td>0.4496</td>
<td>0.2012</td>
<td>0.4360</td>
<td>0.3290</td>
<td>0.2562</td>
<td>0.3882</td>
<td>0.4310</td>
<td>0.4682</td>
<td>0.2990</td>
<td>0.3007</td>
<td>0.2859</td>
<td>0.3998</td>
<td>0.2225</td>
<td>0.4068</td>
<td>0.3481</td>
<td>0.4494</td>
<td>0.4710</td>
<td>0.4011</td>
<td>0.2840</td>
<td>0.3779</td>
<td>0.2727</td>
<td>0.3831</td>
<td>0.3864</td>
<td>0.3511</td>
<td>0.3983</td>
<td>0.3676</td>
<td>0.2761</td>
<td>0.3637</td>
<td>0.4268</td>
<td>0.3555</td>
<td>0.4580</td>
<td>0.3266</td>
<td>0.3549</td>
<td>0.3763</td>
<td>0.2157</td>
<td>0.3028</td>
<td>0.3278</td>
<td>0.3896</td>
<td>0.3111</td>
<td>0.3159</td>
<td>0.3126</td>
<td>0.2395</td>
<td>0.3747</td>
<td>0.3838</td>
<td>0.4030</td>
<td>0.2731</td>
<td>0.2909</td>
<td>0.4092</td>
<td>0.3404</td>
<td>0.3530</td>
<td>0.2808</td>
<td>0.3102</td>
<td>0.3229</td>
<td>0.3713</td>
<td>0.2645</td>
<td>0.3182</td>
<td>0.1977</td>
<td>0.2985</td>
<td>0.3502</td>
<td>0.1191</td>
<td>0.3316</td>
<td>0.2976</td>
<td>0.3445</td>
<td>0.2403</td>
<td>0.3450</td>
<td>0.3203</td>
<td>0.3484</td>
<td>0.2768</td>
<td>0.2783</td>
<td>0.3200</td>
<td>0.3668</td>
<td>0.3803</td>
<td>0.3470</td>
<td>0.2606</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0015</td>
<td>46</td>
<td>1</td>
<td>2.0</td>
<td>1.8</td>
<td>4</td>
<td>16</td>
<td>0.250000</td>
<td>150</td>
<td>2.4</td>
<td>3123.055856</td>
<td>8</td>
<td>0.162653</td>
<td>0.235337</td>
<td>0.279972</td>
<td>0.3556</td>
<td>0.3782</td>
<td>0.3363</td>
<td>0.4718</td>
<td>0.3015</td>
<td>0.2659</td>
<td>0.2274</td>
<td>0.3180</td>
<td>0.3025</td>
<td>0.3124</td>
<td>0.2622</td>
<td>0.2304</td>
<td>0.2706</td>
<td>0.3761</td>
<td>0.4613</td>
<td>0.3814</td>
<td>0.3055</td>
<td>0.2764</td>
<td>0.3211</td>
<td>0.3784</td>
<td>-0.1955</td>
<td>0.3122</td>
<td>0.1932</td>
<td>0.2485</td>
<td>0.2211</td>
<td>0.2004</td>
<td>0.2478</td>
<td>0.3040</td>
<td>0.3316</td>
<td>0.3646</td>
<td>0.3483</td>
<td>0.3012</td>
<td>0.4038</td>
<td>0.3875</td>
<td>0.3158</td>
<td>0.3986</td>
<td>0.4391</td>
<td>0.1509</td>
<td>0.3958</td>
<td>0.2886</td>
<td>0.2535</td>
<td>0.3764</td>
<td>0.4054</td>
<td>0.4601</td>
<td>0.2509</td>
<td>0.2830</td>
<td>0.2712</td>
<td>0.3801</td>
<td>0.1750</td>
<td>0.3987</td>
<td>0.3063</td>
<td>0.4239</td>
<td>0.4616</td>
<td>0.3587</td>
<td>0.2955</td>
<td>0.3431</td>
<td>0.2278</td>
<td>0.3599</td>
<td>0.3549</td>
<td>0.4011</td>
<td>0.3865</td>
<td>0.3661</td>
<td>0.2671</td>
<td>0.3591</td>
<td>0.4313</td>
<td>0.3489</td>
<td>0.4442</td>
<td>0.2985</td>
<td>0.3383</td>
<td>0.3370</td>
<td>0.2609</td>
<td>0.2706</td>
<td>0.3312</td>
<td>0.3792</td>
<td>0.2851</td>
<td>0.2897</td>
<td>0.2984</td>
<td>0.0936</td>
<td>0.3370</td>
<td>0.3880</td>
<td>0.4038</td>
<td>0.2799</td>
<td>0.2873</td>
<td>0.4159</td>
<td>0.3520</td>
<td>0.3560</td>
<td>0.2600</td>
<td>0.3116</td>
<td>0.3225</td>
<td>0.3762</td>
<td>0.2370</td>
<td>0.2251</td>
<td>0.2021</td>
<td>0.2720</td>
<td>0.3434</td>
<td>0.0626</td>
<td>0.3025</td>
<td>0.2670</td>
<td>0.3212</td>
<td>0.2098</td>
<td>0.2967</td>
<td>0.3236</td>
<td>0.3266</td>
<td>0.2455</td>
<td>0.2522</td>
<td>0.3107</td>
<td>0.3372</td>
<td>0.3793</td>
<td>0.3522</td>
<td>0.2564</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0017</td>
<td>54</td>
<td>2</td>
<td>2.0</td>
<td>2.5</td>
<td>19</td>
<td>47</td>
<td>0.404255</td>
<td>1369</td>
<td>1.7</td>
<td>5275.497847</td>
<td>11</td>
<td>0.155523</td>
<td>0.148387</td>
<td>0.128777</td>
<td>0.4314</td>
<td>0.4482</td>
<td>0.4080</td>
<td>0.4980</td>
<td>0.3912</td>
<td>0.3120</td>
<td>0.2934</td>
<td>0.3864</td>
<td>0.3957</td>
<td>0.3131</td>
<td>0.3589</td>
<td>0.3341</td>
<td>0.3654</td>
<td>0.3842</td>
<td>0.4957</td>
<td>0.4328</td>
<td>0.3533</td>
<td>0.3732</td>
<td>0.4177</td>
<td>0.4350</td>
<td>0.1401</td>
<td>0.4006</td>
<td>0.3023</td>
<td>0.3429</td>
<td>0.3228</td>
<td>0.2922</td>
<td>0.3591</td>
<td>0.3671</td>
<td>0.3926</td>
<td>0.4113</td>
<td>0.4082</td>
<td>0.3325</td>
<td>0.4092</td>
<td>0.4129</td>
<td>0.3338</td>
<td>0.4190</td>
<td>0.4248</td>
<td>0.1319</td>
<td>0.4878</td>
<td>0.3797</td>
<td>0.1889</td>
<td>0.4601</td>
<td>0.4445</td>
<td>0.4859</td>
<td>0.3224</td>
<td>0.3693</td>
<td>0.3003</td>
<td>0.4095</td>
<td>0.2938</td>
<td>0.4707</td>
<td>0.3968</td>
<td>0.4616</td>
<td>0.4893</td>
<td>0.4644</td>
<td>0.2735</td>
<td>0.3955</td>
<td>0.3234</td>
<td>0.4165</td>
<td>0.4337</td>
<td>0.4190</td>
<td>0.4511</td>
<td>0.3758</td>
<td>0.3174</td>
<td>0.3679</td>
<td>0.4314</td>
<td>0.3648</td>
<td>0.4439</td>
<td>0.2886</td>
<td>0.3688</td>
<td>0.4143</td>
<td>0.2489</td>
<td>0.3562</td>
<td>0.3498</td>
<td>0.4563</td>
<td>0.3576</td>
<td>0.3706</td>
<td>0.3377</td>
<td>0.2758</td>
<td>0.4006</td>
<td>0.4000</td>
<td>0.4062</td>
<td>0.3182</td>
<td>0.3460</td>
<td>0.4170</td>
<td>0.3275</td>
<td>0.3432</td>
<td>0.2914</td>
<td>0.3307</td>
<td>0.3525</td>
<td>0.3879</td>
<td>0.2212</td>
<td>0.3330</td>
<td>0.2251</td>
<td>0.3151</td>
<td>0.3495</td>
<td>0.1939</td>
<td>0.2953</td>
<td>0.3010</td>
<td>0.3467</td>
<td>0.2547</td>
<td>0.3313</td>
<td>0.3230</td>
<td>0.3597</td>
<td>0.2726</td>
<td>0.2648</td>
<td>0.3309</td>
<td>0.4165</td>
<td>0.3997</td>
<td>0.3468</td>
<td>0.2682</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD2406</td>
<td>72</td>
<td>4</td>
<td>2.0</td>
<td>3.0</td>
<td>13</td>
<td>33</td>
<td>0.393939</td>
<td>512</td>
<td>1.8</td>
<td>2758.511524</td>
<td>9</td>
<td>0.040575</td>
<td>0.157374</td>
<td>0.372476</td>
<td>0.3538</td>
<td>0.3675</td>
<td>0.3196</td>
<td>0.4475</td>
<td>0.2878</td>
<td>0.2987</td>
<td>0.2249</td>
<td>0.2977</td>
<td>0.2772</td>
<td>0.3157</td>
<td>0.2587</td>
<td>0.2404</td>
<td>0.2636</td>
<td>0.3613</td>
<td>0.4659</td>
<td>0.3922</td>
<td>0.1966</td>
<td>0.2316</td>
<td>0.2923</td>
<td>0.2813</td>
<td>0.1748</td>
<td>0.2810</td>
<td>0.2205</td>
<td>0.2491</td>
<td>0.2348</td>
<td>0.2304</td>
<td>0.0588</td>
<td>0.2951</td>
<td>0.3204</td>
<td>0.3760</td>
<td>0.3382</td>
<td>0.2889</td>
<td>0.3728</td>
<td>0.3790</td>
<td>0.3174</td>
<td>0.3849</td>
<td>0.4309</td>
<td>0.3109</td>
<td>0.4362</td>
<td>0.2583</td>
<td>0.2269</td>
<td>0.3813</td>
<td>0.4082</td>
<td>0.4513</td>
<td>0.0401</td>
<td>0.2631</td>
<td>0.2357</td>
<td>0.3879</td>
<td>0.0211</td>
<td>0.3995</td>
<td>0.2916</td>
<td>0.4247</td>
<td>0.4515</td>
<td>0.3606</td>
<td>0.2608</td>
<td>0.3098</td>
<td>0.1564</td>
<td>0.3513</td>
<td>0.3567</td>
<td>0.3750</td>
<td>0.3842</td>
<td>0.3501</td>
<td>0.2271</td>
<td>0.3615</td>
<td>0.4321</td>
<td>0.3351</td>
<td>0.4546</td>
<td>0.2928</td>
<td>0.3272</td>
<td>0.2899</td>
<td>0.1731</td>
<td>0.2730</td>
<td>0.3076</td>
<td>0.3788</td>
<td>0.2516</td>
<td>0.2696</td>
<td>0.3959</td>
<td>0.2289</td>
<td>0.3288</td>
<td>0.4173</td>
<td>0.4145</td>
<td>0.1935</td>
<td>0.2306</td>
<td>0.4093</td>
<td>0.3427</td>
<td>0.2848</td>
<td>0.2491</td>
<td>0.3534</td>
<td>0.2957</td>
<td>0.3566</td>
<td>0.1893</td>
<td>0.2477</td>
<td>-0.0057</td>
<td>0.2601</td>
<td>0.3146</td>
<td>0.0602</td>
<td>0.2081</td>
<td>0.2756</td>
<td>0.3329</td>
<td>0.1981</td>
<td>0.3020</td>
<td>0.3171</td>
<td>0.3629</td>
<td>0.2257</td>
<td>0.2302</td>
<td>0.2934</td>
<td>0.3086</td>
<td>0.4236</td>
<td>0.3489</td>
<td>0.2568</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD2409</td>
<td>50</td>
<td>1</td>
<td>2.0</td>
<td>2.0</td>
<td>4</td>
<td>3</td>
<td>1.333333</td>
<td>26</td>
<td>2.6</td>
<td>5379.451341</td>
<td>11</td>
<td>0.098933</td>
<td>0.065574</td>
<td>0.336374</td>
<td>0.4315</td>
<td>0.4001</td>
<td>0.4281</td>
<td>0.4980</td>
<td>0.3670</td>
<td>0.3599</td>
<td>0.3109</td>
<td>0.3885</td>
<td>0.3636</td>
<td>0.4058</td>
<td>0.3074</td>
<td>0.2588</td>
<td>0.3201</td>
<td>0.4278</td>
<td>0.4789</td>
<td>0.4486</td>
<td>0.2958</td>
<td>0.3271</td>
<td>0.3578</td>
<td>0.4093</td>
<td>0.2096</td>
<td>0.3742</td>
<td>0.2676</td>
<td>0.2780</td>
<td>0.2728</td>
<td>0.2282</td>
<td>0.3606</td>
<td>0.3481</td>
<td>0.3615</td>
<td>0.4254</td>
<td>0.3986</td>
<td>0.3114</td>
<td>0.4257</td>
<td>0.4138</td>
<td>0.3804</td>
<td>0.4204</td>
<td>0.4438</td>
<td>0.2689</td>
<td>0.5003</td>
<td>0.3371</td>
<td>0.3379</td>
<td>0.4041</td>
<td>0.4373</td>
<td>0.4943</td>
<td>0.3594</td>
<td>0.3169</td>
<td>0.3037</td>
<td>0.4367</td>
<td>0.2960</td>
<td>0.4184</td>
<td>0.3754</td>
<td>0.4485</td>
<td>0.4846</td>
<td>0.3863</td>
<td>0.3134</td>
<td>0.4283</td>
<td>0.3230</td>
<td>0.3787</td>
<td>0.4163</td>
<td>0.4373</td>
<td>0.4103</td>
<td>0.3737</td>
<td>0.2959</td>
<td>0.3780</td>
<td>0.4324</td>
<td>0.3626</td>
<td>0.4790</td>
<td>0.3242</td>
<td>0.3694</td>
<td>0.4018</td>
<td>0.1984</td>
<td>0.2949</td>
<td>0.3494</td>
<td>0.3979</td>
<td>0.3243</td>
<td>0.3352</td>
<td>0.2980</td>
<td>0.2940</td>
<td>0.3837</td>
<td>0.3991</td>
<td>0.4168</td>
<td>0.2902</td>
<td>0.3016</td>
<td>0.4070</td>
<td>0.3236</td>
<td>0.3370</td>
<td>0.2773</td>
<td>0.3046</td>
<td>0.3263</td>
<td>0.3789</td>
<td>0.2107</td>
<td>0.2569</td>
<td>0.2197</td>
<td>0.3364</td>
<td>0.3517</td>
<td>0.1525</td>
<td>0.3144</td>
<td>0.3632</td>
<td>0.3714</td>
<td>0.2620</td>
<td>0.4239</td>
<td>0.3225</td>
<td>0.3916</td>
<td>0.3130</td>
<td>0.3030</td>
<td>0.3316</td>
<td>0.3701</td>
<td>0.3928</td>
<td>0.3509</td>
<td>0.2660</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD2412</td>
<td>49</td>
<td>2</td>
<td>2.0</td>
<td>3.5</td>
<td>12</td>
<td>52</td>
<td>0.230769</td>
<td>80</td>
<td>5.1</td>
<td>4225.584090</td>
<td>10</td>
<td>0.173398</td>
<td>0.207518</td>
<td>0.206046</td>
<td>0.4012</td>
<td>0.4299</td>
<td>0.3902</td>
<td>0.4827</td>
<td>0.3308</td>
<td>0.2883</td>
<td>0.2645</td>
<td>0.3532</td>
<td>0.3307</td>
<td>0.3501</td>
<td>0.2914</td>
<td>0.2594</td>
<td>0.2998</td>
<td>0.4215</td>
<td>0.4689</td>
<td>0.4101</td>
<td>0.2921</td>
<td>0.2960</td>
<td>0.3519</td>
<td>0.4009</td>
<td>0.1197</td>
<td>0.3624</td>
<td>0.2331</td>
<td>0.2785</td>
<td>0.2560</td>
<td>0.2199</td>
<td>0.2859</td>
<td>0.3213</td>
<td>0.3555</td>
<td>0.3963</td>
<td>0.3732</td>
<td>0.3114</td>
<td>0.4212</td>
<td>0.4116</td>
<td>0.3613</td>
<td>0.4112</td>
<td>0.4515</td>
<td>0.1930</td>
<td>0.4146</td>
<td>0.3027</td>
<td>0.2417</td>
<td>0.4171</td>
<td>0.4003</td>
<td>0.4708</td>
<td>0.3035</td>
<td>0.3050</td>
<td>0.3060</td>
<td>0.4193</td>
<td>0.2516</td>
<td>0.4358</td>
<td>0.3525</td>
<td>0.4096</td>
<td>0.4776</td>
<td>0.4012</td>
<td>0.3032</td>
<td>0.3910</td>
<td>0.2762</td>
<td>0.3900</td>
<td>0.3891</td>
<td>0.4143</td>
<td>0.4119</td>
<td>0.3790</td>
<td>0.2756</td>
<td>0.3649</td>
<td>0.4301</td>
<td>0.3595</td>
<td>0.4676</td>
<td>0.3259</td>
<td>0.3577</td>
<td>0.3666</td>
<td>0.2383</td>
<td>0.3118</td>
<td>0.3334</td>
<td>0.4189</td>
<td>0.3155</td>
<td>0.3162</td>
<td>0.3044</td>
<td>0.2460</td>
<td>0.3643</td>
<td>0.3864</td>
<td>0.4062</td>
<td>0.2942</td>
<td>0.3026</td>
<td>0.4215</td>
<td>0.3600</td>
<td>0.3633</td>
<td>0.2781</td>
<td>0.3185</td>
<td>0.3387</td>
<td>0.3711</td>
<td>0.2080</td>
<td>0.2333</td>
<td>0.1697</td>
<td>0.2862</td>
<td>0.3441</td>
<td>0.1187</td>
<td>0.2648</td>
<td>0.3162</td>
<td>0.3431</td>
<td>0.2301</td>
<td>0.3355</td>
<td>0.3413</td>
<td>0.3496</td>
<td>0.2730</td>
<td>0.2748</td>
<td>0.3238</td>
<td>0.3560</td>
<td>0.3815</td>
<td>0.3596</td>
<td>0.2491</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD2418</td>
<td>74</td>
<td>3</td>
<td>2.0</td>
<td>2.2</td>
<td>17</td>
<td>22</td>
<td>0.772727</td>
<td>264</td>
<td>2.7</td>
<td>4774.602798</td>
<td>9</td>
<td>0.117058</td>
<td>0.243782</td>
<td>0.277604</td>
<td>0.4254</td>
<td>0.4221</td>
<td>0.3631</td>
<td>0.4951</td>
<td>0.3487</td>
<td>0.3314</td>
<td>0.3077</td>
<td>0.3607</td>
<td>0.3500</td>
<td>0.3505</td>
<td>0.3235</td>
<td>0.2908</td>
<td>0.3320</td>
<td>0.3746</td>
<td>0.4853</td>
<td>0.4419</td>
<td>0.2960</td>
<td>0.3042</td>
<td>0.3473</td>
<td>0.4130</td>
<td>0.1257</td>
<td>0.3791</td>
<td>0.2575</td>
<td>0.2910</td>
<td>0.2744</td>
<td>0.2594</td>
<td>0.3583</td>
<td>0.3261</td>
<td>0.3722</td>
<td>0.4154</td>
<td>0.3925</td>
<td>0.3258</td>
<td>0.4092</td>
<td>0.4006</td>
<td>0.3251</td>
<td>0.4131</td>
<td>0.4466</td>
<td>0.2654</td>
<td>0.4736</td>
<td>0.3285</td>
<td>0.1966</td>
<td>0.4315</td>
<td>0.4426</td>
<td>0.4951</td>
<td>0.3212</td>
<td>0.3321</td>
<td>0.2835</td>
<td>0.4145</td>
<td>0.2408</td>
<td>0.4493</td>
<td>0.3538</td>
<td>0.4528</td>
<td>0.4865</td>
<td>0.4305</td>
<td>0.2833</td>
<td>0.4032</td>
<td>0.3058</td>
<td>0.3931</td>
<td>0.4101</td>
<td>0.3594</td>
<td>0.4195</td>
<td>0.3746</td>
<td>0.2839</td>
<td>0.3682</td>
<td>0.4237</td>
<td>0.3598</td>
<td>0.4645</td>
<td>0.3018</td>
<td>0.3602</td>
<td>0.3782</td>
<td>0.2253</td>
<td>0.3274</td>
<td>0.3475</td>
<td>0.4265</td>
<td>0.3162</td>
<td>0.3365</td>
<td>0.3433</td>
<td>0.2577</td>
<td>0.3831</td>
<td>0.3977</td>
<td>0.4108</td>
<td>0.2873</td>
<td>0.3153</td>
<td>0.4120</td>
<td>0.3498</td>
<td>0.3359</td>
<td>0.2841</td>
<td>0.3405</td>
<td>0.3247</td>
<td>0.3672</td>
<td>0.2736</td>
<td>0.3118</td>
<td>0.1389</td>
<td>0.2862</td>
<td>0.3378</td>
<td>0.0954</td>
<td>0.1935</td>
<td>0.2901</td>
<td>0.3575</td>
<td>0.2500</td>
<td>0.3003</td>
<td>0.3100</td>
<td>0.3676</td>
<td>0.2489</td>
<td>0.2636</td>
<td>0.3191</td>
<td>0.3735</td>
<td>0.4077</td>
<td>0.3418</td>
<td>0.2582</td>
</tr>
</tbody>
</table>

<p>693 rows × 124 columns</p>
</div>
</div>
</div>
<p>Now list all the clinical features that would be the X variables.</p>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>clin_features <span class="op">=</span> [<span class="st">'Age'</span>, <span class="st">'Stage'</span>, <span class="st">'TumorGrade'</span>, <span class="st">'TumourSize'</span>, <span class="st">'FusionNeo_Count'</span>, <span class="st">'FusionTransscript_Count'</span>, <span class="st">'FN/FT_Ratio'</span>, <span class="st">'SNVindelNeo_Count'</span>, <span class="st">'SNVindelNeo_IC50'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Grab the X features that we will use for the modeling from the cleaned up dataframe.</p>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define X features; use the clin_features list generated before</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> dfc[clin_features]</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Stage</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionTransscript_Count</th>
<th data-quarto-table-cell-role="th">FN/FT_Ratio</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0012</td>
<td>50</td>
<td>2</td>
<td>2.0</td>
<td>2.3</td>
<td>20</td>
<td>42</td>
<td>0.476190</td>
<td>357</td>
<td>1.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0014</td>
<td>58</td>
<td>2</td>
<td>2.0</td>
<td>2.5</td>
<td>10</td>
<td>17</td>
<td>0.588235</td>
<td>85</td>
<td>4.1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0015</td>
<td>46</td>
<td>1</td>
<td>2.0</td>
<td>1.8</td>
<td>4</td>
<td>16</td>
<td>0.250000</td>
<td>150</td>
<td>2.4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0017</td>
<td>54</td>
<td>2</td>
<td>2.0</td>
<td>2.5</td>
<td>19</td>
<td>47</td>
<td>0.404255</td>
<td>1369</td>
<td>1.7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0018</td>
<td>58</td>
<td>2</td>
<td>3.0</td>
<td>3.0</td>
<td>39</td>
<td>126</td>
<td>0.309524</td>
<td>382</td>
<td>1.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD2403</td>
<td>46</td>
<td>2</td>
<td>3.0</td>
<td>2.8</td>
<td>11</td>
<td>34</td>
<td>0.323529</td>
<td>2315</td>
<td>1.8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD2406</td>
<td>72</td>
<td>4</td>
<td>2.0</td>
<td>3.0</td>
<td>13</td>
<td>33</td>
<td>0.393939</td>
<td>512</td>
<td>1.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD2409</td>
<td>50</td>
<td>1</td>
<td>2.0</td>
<td>2.0</td>
<td>4</td>
<td>3</td>
<td>1.333333</td>
<td>26</td>
<td>2.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD2412</td>
<td>49</td>
<td>2</td>
<td>2.0</td>
<td>3.5</td>
<td>12</td>
<td>52</td>
<td>0.230769</td>
<td>80</td>
<td>5.1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD2418</td>
<td>74</td>
<td>3</td>
<td>2.0</td>
<td>2.2</td>
<td>17</td>
<td>22</td>
<td>0.772727</td>
<td>264</td>
<td>2.7</td>
</tr>
</tbody>
</table>

<p>693 rows × 9 columns</p>
</div>
</div>
</div>
<p>Now grab the Y targets (do this as a whole, but we will train on each column individually later).</p>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get the Y variable set</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>cols_y <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> dfc.columns <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> X.columns]</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> dfc[<span class="bu">list</span>(cols_y)]</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>Y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ESTIMATE</th>
<th data-quarto-table-cell-role="th">IMPRES</th>
<th data-quarto-table-cell-role="th">C_Bcellsnaive</th>
<th data-quarto-table-cell-role="th">C_TcellsCD4memoryresting</th>
<th data-quarto-table-cell-role="th">C_MacrophagesM2</th>
<th data-quarto-table-cell-role="th">S_Attractors_LYM</th>
<th data-quarto-table-cell-role="th">S_Attractors_IFIT3</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_GIMAP4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_HLA.DPA1</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SLAMF6</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_LILRB4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SIGLEC9</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CYTH4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CD3E</th>
<th data-quarto-table-cell-role="th">S_Lymph_Vessels</th>
<th data-quarto-table-cell-role="th">S_ICR_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_INHIB_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_ACT_SCORE</th>
<th data-quarto-table-cell-role="th">S_Angiogenesis</th>
<th data-quarto-table-cell-role="th">S_APM1</th>
<th data-quarto-table-cell-role="th">S_APM2</th>
<th data-quarto-table-cell-role="th">S_ICS5_score</th>
<th data-quarto-table-cell-role="th">S_LIexpression_score</th>
<th data-quarto-table-cell-role="th">S_Chemokine12_score</th>
<th data-quarto-table-cell-role="th">S_NHI_5gene_score</th>
<th data-quarto-table-cell-role="th">S_CD68</th>
<th data-quarto-table-cell-role="th">S_CD8A</th>
<th data-quarto-table-cell-role="th">S_PD1_data</th>
<th data-quarto-table-cell-role="th">S_PDL1_data</th>
<th data-quarto-table-cell-role="th">S_PD1_PDL1_score</th>
<th data-quarto-table-cell-role="th">S_CTLA4_data</th>
<th data-quarto-table-cell-role="th">S_Bcell_mg_IGJ</th>
<th data-quarto-table-cell-role="th">S_Bcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_STAT1_score</th>
<th data-quarto-table-cell-role="th">S_CSF1_response</th>
<th data-quarto-table-cell-role="th">S_TcClassII_score</th>
<th data-quarto-table-cell-role="th">S_IL12_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL4_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL2_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL13_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IFNG_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TGFB_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TREM1_data</th>
<th data-quarto-table-cell-role="th">S_DAP12_data</th>
<th data-quarto-table-cell-role="th">S_Tcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_IL8_21978456</th>
<th data-quarto-table-cell-role="th">S_IFN_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC1_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC2_21978456</th>
<th data-quarto-table-cell-role="th">S_Bcell_21978456</th>
<th data-quarto-table-cell-role="th">S_Tcell_21978456</th>
<th data-quarto-table-cell-role="th">S_CD103pos_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_CD103neg_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_IgG_19272155</th>
<th data-quarto-table-cell-role="th">S_Interferon_19272155</th>
<th data-quarto-table-cell-role="th">S_LCK_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.I_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.II_19272155</th>
<th data-quarto-table-cell-role="th">S_STAT1_19272155</th>
<th data-quarto-table-cell-role="th">S_Troester_WoundSig_19887484</th>
<th data-quarto-table-cell-role="th">S_MDACC.FNA.1_20805453</th>
<th data-quarto-table-cell-role="th">S_IGG_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Minterferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Immune_cell_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_MCD3_CD8_21214954</th>
<th data-quarto-table-cell-role="th">S_Interferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_B_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_CD8_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_GRANS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_LYMPHS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_T_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_TGFB_PCA_17349583</th>
<th data-quarto-table-cell-role="th">S_Rotterdam_ERneg_PCA_15721472</th>
<th data-quarto-table-cell-role="th">S_HER2_Immune_PCA_18006808</th>
<th data-quarto-table-cell-role="th">S_IR7_score</th>
<th data-quarto-table-cell-role="th">S_Buck14_score</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_score</th>
<th data-quarto-table-cell-role="th">S_Immune_NSCLC_score</th>
<th data-quarto-table-cell-role="th">S_Module3_IFN_score</th>
<th data-quarto-table-cell-role="th">S_Module4_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module5_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module11_Prolif_score</th>
<th data-quarto-table-cell-role="th">S_CD8_CD68_ratio</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_TcClassII_ratio</th>
<th data-quarto-table-cell-role="th">S_CHANG_CORE_SERUM_RESPONSE_UP</th>
<th data-quarto-table-cell-role="th">S_CSR_Activated_15701700</th>
<th data-quarto-table-cell-role="th">S_B_cells</th>
<th data-quarto-table-cell-role="th">S_T_cells</th>
<th data-quarto-table-cell-role="th">S_T_helper</th>
<th data-quarto-table-cell-role="th">S_Tcm</th>
<th data-quarto-table-cell-role="th">S_Tem</th>
<th data-quarto-table-cell-role="th">S_Th1</th>
<th data-quarto-table-cell-role="th">S_Th2</th>
<th data-quarto-table-cell-role="th">S_TFH</th>
<th data-quarto-table-cell-role="th">S_CD8_Tcells</th>
<th data-quarto-table-cell-role="th">S_Th17</th>
<th data-quarto-table-cell-role="th">S_Treg</th>
<th data-quarto-table-cell-role="th">S_Tgd</th>
<th data-quarto-table-cell-role="th">S_Cytotoxic_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cd56dim</th>
<th data-quarto-table-cell-role="th">S_NK_cd56bright</th>
<th data-quarto-table-cell-role="th">S_DC</th>
<th data-quarto-table-cell-role="th">S_iDC</th>
<th data-quarto-table-cell-role="th">S_aDC</th>
<th data-quarto-table-cell-role="th">S_pDC</th>
<th data-quarto-table-cell-role="th">S_Eosinophils</th>
<th data-quarto-table-cell-role="th">S_Macrophages</th>
<th data-quarto-table-cell-role="th">S_Mast</th>
<th data-quarto-table-cell-role="th">S_Neutrophils</th>
<th data-quarto-table-cell-role="th">S_Bindea_full</th>
<th data-quarto-table-cell-role="th">S_Expanded_IFNg</th>
<th data-quarto-table-cell-role="th">S_KEGG_MMR</th>
<th data-quarto-table-cell-role="th">S_KEGG_TGF_Beta</th>
<th data-quarto-table-cell-role="th">S_KEGG_Cytosolic_DNA_Sensing</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0012</td>
<td>2895.605487</td>
<td>9</td>
<td>0.120394</td>
<td>0.117468</td>
<td>0.448450</td>
<td>0.3620</td>
<td>0.4216</td>
<td>0.3034</td>
<td>0.4425</td>
<td>0.2749</td>
<td>0.2983</td>
<td>0.2756</td>
<td>0.3121</td>
<td>0.2765</td>
<td>0.3203</td>
<td>0.2463</td>
<td>0.2341</td>
<td>0.2495</td>
<td>0.3571</td>
<td>0.4591</td>
<td>0.3985</td>
<td>0.2130</td>
<td>0.2223</td>
<td>0.2766</td>
<td>0.3573</td>
<td>0.1561</td>
<td>0.2942</td>
<td>0.1536</td>
<td>0.2530</td>
<td>0.2042</td>
<td>0.2061</td>
<td>0.1942</td>
<td>0.2764</td>
<td>0.3327</td>
<td>0.3795</td>
<td>0.3435</td>
<td>0.2846</td>
<td>0.3797</td>
<td>0.3761</td>
<td>0.3197</td>
<td>0.4008</td>
<td>0.4403</td>
<td>0.2907</td>
<td>0.4011</td>
<td>0.2526</td>
<td>0.2237</td>
<td>0.4256</td>
<td>0.3971</td>
<td>0.4477</td>
<td>0.1852</td>
<td>0.2516</td>
<td>0.2262</td>
<td>0.3854</td>
<td>0.1591</td>
<td>0.4462</td>
<td>0.2912</td>
<td>0.4211</td>
<td>0.4502</td>
<td>0.3610</td>
<td>0.2711</td>
<td>0.3414</td>
<td>0.2183</td>
<td>0.3728</td>
<td>0.3512</td>
<td>0.3529</td>
<td>0.4162</td>
<td>0.3612</td>
<td>0.2215</td>
<td>0.3614</td>
<td>0.4294</td>
<td>0.3451</td>
<td>0.4648</td>
<td>0.2937</td>
<td>0.3338</td>
<td>0.2999</td>
<td>0.2094</td>
<td>0.2743</td>
<td>0.3203</td>
<td>0.4136</td>
<td>0.2546</td>
<td>0.2730</td>
<td>0.3697</td>
<td>0.2268</td>
<td>0.3335</td>
<td>0.3959</td>
<td>0.4066</td>
<td>0.2199</td>
<td>0.2395</td>
<td>0.4132</td>
<td>0.3633</td>
<td>0.3210</td>
<td>0.2599</td>
<td>0.3561</td>
<td>0.3112</td>
<td>0.3645</td>
<td>0.2810</td>
<td>0.2348</td>
<td>0.1945</td>
<td>0.2188</td>
<td>0.3281</td>
<td>0.0602</td>
<td>0.2038</td>
<td>0.2445</td>
<td>0.3220</td>
<td>0.2212</td>
<td>0.2866</td>
<td>0.3030</td>
<td>0.3657</td>
<td>0.2499</td>
<td>0.2531</td>
<td>0.3031</td>
<td>0.3097</td>
<td>0.4053</td>
<td>0.3537</td>
<td>0.2530</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0014</td>
<td>4257.831526</td>
<td>11</td>
<td>0.165023</td>
<td>0.207531</td>
<td>0.124223</td>
<td>0.4126</td>
<td>0.3815</td>
<td>0.3619</td>
<td>0.4760</td>
<td>0.3343</td>
<td>0.3001</td>
<td>0.2769</td>
<td>0.3761</td>
<td>0.3525</td>
<td>0.3452</td>
<td>0.3051</td>
<td>0.2701</td>
<td>0.3143</td>
<td>0.3803</td>
<td>0.4819</td>
<td>0.4125</td>
<td>0.3002</td>
<td>0.3106</td>
<td>0.3646</td>
<td>0.3753</td>
<td>0.1030</td>
<td>0.3644</td>
<td>0.2726</td>
<td>0.2377</td>
<td>0.2553</td>
<td>0.2513</td>
<td>0.2820</td>
<td>0.3079</td>
<td>0.3515</td>
<td>0.3869</td>
<td>0.3868</td>
<td>0.3133</td>
<td>0.4051</td>
<td>0.4031</td>
<td>0.3308</td>
<td>0.4120</td>
<td>0.4496</td>
<td>0.2012</td>
<td>0.4360</td>
<td>0.3290</td>
<td>0.2562</td>
<td>0.3882</td>
<td>0.4310</td>
<td>0.4682</td>
<td>0.2990</td>
<td>0.3007</td>
<td>0.2859</td>
<td>0.3998</td>
<td>0.2225</td>
<td>0.4068</td>
<td>0.3481</td>
<td>0.4494</td>
<td>0.4710</td>
<td>0.4011</td>
<td>0.2840</td>
<td>0.3779</td>
<td>0.2727</td>
<td>0.3831</td>
<td>0.3864</td>
<td>0.3511</td>
<td>0.3983</td>
<td>0.3676</td>
<td>0.2761</td>
<td>0.3637</td>
<td>0.4268</td>
<td>0.3555</td>
<td>0.4580</td>
<td>0.3266</td>
<td>0.3549</td>
<td>0.3763</td>
<td>0.2157</td>
<td>0.3028</td>
<td>0.3278</td>
<td>0.3896</td>
<td>0.3111</td>
<td>0.3159</td>
<td>0.3126</td>
<td>0.2395</td>
<td>0.3747</td>
<td>0.3838</td>
<td>0.4030</td>
<td>0.2731</td>
<td>0.2909</td>
<td>0.4092</td>
<td>0.3404</td>
<td>0.3530</td>
<td>0.2808</td>
<td>0.3102</td>
<td>0.3229</td>
<td>0.3713</td>
<td>0.2645</td>
<td>0.3182</td>
<td>0.1977</td>
<td>0.2985</td>
<td>0.3502</td>
<td>0.1191</td>
<td>0.3316</td>
<td>0.2976</td>
<td>0.3445</td>
<td>0.2403</td>
<td>0.3450</td>
<td>0.3203</td>
<td>0.3484</td>
<td>0.2768</td>
<td>0.2783</td>
<td>0.3200</td>
<td>0.3668</td>
<td>0.3803</td>
<td>0.3470</td>
<td>0.2606</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0015</td>
<td>3123.055856</td>
<td>8</td>
<td>0.162653</td>
<td>0.235337</td>
<td>0.279972</td>
<td>0.3556</td>
<td>0.3782</td>
<td>0.3363</td>
<td>0.4718</td>
<td>0.3015</td>
<td>0.2659</td>
<td>0.2274</td>
<td>0.3180</td>
<td>0.3025</td>
<td>0.3124</td>
<td>0.2622</td>
<td>0.2304</td>
<td>0.2706</td>
<td>0.3761</td>
<td>0.4613</td>
<td>0.3814</td>
<td>0.3055</td>
<td>0.2764</td>
<td>0.3211</td>
<td>0.3784</td>
<td>-0.1955</td>
<td>0.3122</td>
<td>0.1932</td>
<td>0.2485</td>
<td>0.2211</td>
<td>0.2004</td>
<td>0.2478</td>
<td>0.3040</td>
<td>0.3316</td>
<td>0.3646</td>
<td>0.3483</td>
<td>0.3012</td>
<td>0.4038</td>
<td>0.3875</td>
<td>0.3158</td>
<td>0.3986</td>
<td>0.4391</td>
<td>0.1509</td>
<td>0.3958</td>
<td>0.2886</td>
<td>0.2535</td>
<td>0.3764</td>
<td>0.4054</td>
<td>0.4601</td>
<td>0.2509</td>
<td>0.2830</td>
<td>0.2712</td>
<td>0.3801</td>
<td>0.1750</td>
<td>0.3987</td>
<td>0.3063</td>
<td>0.4239</td>
<td>0.4616</td>
<td>0.3587</td>
<td>0.2955</td>
<td>0.3431</td>
<td>0.2278</td>
<td>0.3599</td>
<td>0.3549</td>
<td>0.4011</td>
<td>0.3865</td>
<td>0.3661</td>
<td>0.2671</td>
<td>0.3591</td>
<td>0.4313</td>
<td>0.3489</td>
<td>0.4442</td>
<td>0.2985</td>
<td>0.3383</td>
<td>0.3370</td>
<td>0.2609</td>
<td>0.2706</td>
<td>0.3312</td>
<td>0.3792</td>
<td>0.2851</td>
<td>0.2897</td>
<td>0.2984</td>
<td>0.0936</td>
<td>0.3370</td>
<td>0.3880</td>
<td>0.4038</td>
<td>0.2799</td>
<td>0.2873</td>
<td>0.4159</td>
<td>0.3520</td>
<td>0.3560</td>
<td>0.2600</td>
<td>0.3116</td>
<td>0.3225</td>
<td>0.3762</td>
<td>0.2370</td>
<td>0.2251</td>
<td>0.2021</td>
<td>0.2720</td>
<td>0.3434</td>
<td>0.0626</td>
<td>0.3025</td>
<td>0.2670</td>
<td>0.3212</td>
<td>0.2098</td>
<td>0.2967</td>
<td>0.3236</td>
<td>0.3266</td>
<td>0.2455</td>
<td>0.2522</td>
<td>0.3107</td>
<td>0.3372</td>
<td>0.3793</td>
<td>0.3522</td>
<td>0.2564</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0017</td>
<td>5275.497847</td>
<td>11</td>
<td>0.155523</td>
<td>0.148387</td>
<td>0.128777</td>
<td>0.4314</td>
<td>0.4482</td>
<td>0.4080</td>
<td>0.4980</td>
<td>0.3912</td>
<td>0.3120</td>
<td>0.2934</td>
<td>0.3864</td>
<td>0.3957</td>
<td>0.3131</td>
<td>0.3589</td>
<td>0.3341</td>
<td>0.3654</td>
<td>0.3842</td>
<td>0.4957</td>
<td>0.4328</td>
<td>0.3533</td>
<td>0.3732</td>
<td>0.4177</td>
<td>0.4350</td>
<td>0.1401</td>
<td>0.4006</td>
<td>0.3023</td>
<td>0.3429</td>
<td>0.3228</td>
<td>0.2922</td>
<td>0.3591</td>
<td>0.3671</td>
<td>0.3926</td>
<td>0.4113</td>
<td>0.4082</td>
<td>0.3325</td>
<td>0.4092</td>
<td>0.4129</td>
<td>0.3338</td>
<td>0.4190</td>
<td>0.4248</td>
<td>0.1319</td>
<td>0.4878</td>
<td>0.3797</td>
<td>0.1889</td>
<td>0.4601</td>
<td>0.4445</td>
<td>0.4859</td>
<td>0.3224</td>
<td>0.3693</td>
<td>0.3003</td>
<td>0.4095</td>
<td>0.2938</td>
<td>0.4707</td>
<td>0.3968</td>
<td>0.4616</td>
<td>0.4893</td>
<td>0.4644</td>
<td>0.2735</td>
<td>0.3955</td>
<td>0.3234</td>
<td>0.4165</td>
<td>0.4337</td>
<td>0.4190</td>
<td>0.4511</td>
<td>0.3758</td>
<td>0.3174</td>
<td>0.3679</td>
<td>0.4314</td>
<td>0.3648</td>
<td>0.4439</td>
<td>0.2886</td>
<td>0.3688</td>
<td>0.4143</td>
<td>0.2489</td>
<td>0.3562</td>
<td>0.3498</td>
<td>0.4563</td>
<td>0.3576</td>
<td>0.3706</td>
<td>0.3377</td>
<td>0.2758</td>
<td>0.4006</td>
<td>0.4000</td>
<td>0.4062</td>
<td>0.3182</td>
<td>0.3460</td>
<td>0.4170</td>
<td>0.3275</td>
<td>0.3432</td>
<td>0.2914</td>
<td>0.3307</td>
<td>0.3525</td>
<td>0.3879</td>
<td>0.2212</td>
<td>0.3330</td>
<td>0.2251</td>
<td>0.3151</td>
<td>0.3495</td>
<td>0.1939</td>
<td>0.2953</td>
<td>0.3010</td>
<td>0.3467</td>
<td>0.2547</td>
<td>0.3313</td>
<td>0.3230</td>
<td>0.3597</td>
<td>0.2726</td>
<td>0.2648</td>
<td>0.3309</td>
<td>0.4165</td>
<td>0.3997</td>
<td>0.3468</td>
<td>0.2682</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0018</td>
<td>3548.348220</td>
<td>11</td>
<td>0.129397</td>
<td>0.133531</td>
<td>0.304963</td>
<td>0.3701</td>
<td>0.3859</td>
<td>0.3067</td>
<td>0.4858</td>
<td>0.3141</td>
<td>0.2980</td>
<td>0.2006</td>
<td>0.3222</td>
<td>0.3017</td>
<td>0.3358</td>
<td>0.2870</td>
<td>0.2544</td>
<td>0.2955</td>
<td>0.3292</td>
<td>0.4758</td>
<td>0.4200</td>
<td>0.2892</td>
<td>0.2845</td>
<td>0.3767</td>
<td>0.4084</td>
<td>0.1187</td>
<td>0.2786</td>
<td>0.2363</td>
<td>0.2357</td>
<td>0.2360</td>
<td>0.2310</td>
<td>0.3125</td>
<td>0.3054</td>
<td>0.3430</td>
<td>0.3742</td>
<td>0.3709</td>
<td>0.2860</td>
<td>0.3689</td>
<td>0.3880</td>
<td>0.3172</td>
<td>0.4095</td>
<td>0.4343</td>
<td>0.2824</td>
<td>0.4664</td>
<td>0.2799</td>
<td>0.2613</td>
<td>0.3975</td>
<td>0.4264</td>
<td>0.4805</td>
<td>0.3210</td>
<td>0.2670</td>
<td>0.2429</td>
<td>0.3952</td>
<td>0.2321</td>
<td>0.4166</td>
<td>0.3061</td>
<td>0.4446</td>
<td>0.4658</td>
<td>0.4181</td>
<td>0.2747</td>
<td>0.3910</td>
<td>0.3019</td>
<td>0.3722</td>
<td>0.3716</td>
<td>0.3075</td>
<td>0.3931</td>
<td>0.3605</td>
<td>0.2308</td>
<td>0.3603</td>
<td>0.4258</td>
<td>0.3393</td>
<td>0.4654</td>
<td>0.2920</td>
<td>0.3385</td>
<td>0.3668</td>
<td>0.2237</td>
<td>0.3404</td>
<td>0.3264</td>
<td>0.3909</td>
<td>0.2758</td>
<td>0.3050</td>
<td>0.3770</td>
<td>0.2009</td>
<td>0.3664</td>
<td>0.4026</td>
<td>0.4092</td>
<td>0.2699</td>
<td>0.2530</td>
<td>0.3955</td>
<td>0.3185</td>
<td>0.3066</td>
<td>0.2713</td>
<td>0.3333</td>
<td>0.3041</td>
<td>0.3523</td>
<td>0.2401</td>
<td>0.2709</td>
<td>0.1413</td>
<td>0.2636</td>
<td>0.3061</td>
<td>0.0764</td>
<td>0.2639</td>
<td>0.2623</td>
<td>0.3348</td>
<td>0.2124</td>
<td>0.2731</td>
<td>0.3020</td>
<td>0.3540</td>
<td>0.2233</td>
<td>0.2182</td>
<td>0.2979</td>
<td>0.3530</td>
<td>0.4033</td>
<td>0.3444</td>
<td>0.2496</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD2403</td>
<td>4683.240599</td>
<td>12</td>
<td>0.108310</td>
<td>0.201245</td>
<td>0.196665</td>
<td>0.4078</td>
<td>0.4817</td>
<td>0.3924</td>
<td>0.4873</td>
<td>0.3664</td>
<td>0.3205</td>
<td>0.2372</td>
<td>0.3464</td>
<td>0.3573</td>
<td>0.3331</td>
<td>0.3343</td>
<td>0.3130</td>
<td>0.3399</td>
<td>0.3692</td>
<td>0.4927</td>
<td>0.4329</td>
<td>0.3315</td>
<td>0.3308</td>
<td>0.4115</td>
<td>0.4220</td>
<td>0.1520</td>
<td>0.4166</td>
<td>0.2818</td>
<td>0.2797</td>
<td>0.2807</td>
<td>0.2954</td>
<td>0.3097</td>
<td>0.3324</td>
<td>0.3866</td>
<td>0.4074</td>
<td>0.3872</td>
<td>0.3180</td>
<td>0.4217</td>
<td>0.4157</td>
<td>0.3276</td>
<td>0.4185</td>
<td>0.4302</td>
<td>0.2450</td>
<td>0.4812</td>
<td>0.3447</td>
<td>0.1897</td>
<td>0.4855</td>
<td>0.4305</td>
<td>0.4885</td>
<td>0.3212</td>
<td>0.3415</td>
<td>0.3026</td>
<td>0.4018</td>
<td>0.2560</td>
<td>0.4944</td>
<td>0.3639</td>
<td>0.4487</td>
<td>0.4836</td>
<td>0.4610</td>
<td>0.2758</td>
<td>0.4010</td>
<td>0.2836</td>
<td>0.4273</td>
<td>0.4210</td>
<td>0.4068</td>
<td>0.4674</td>
<td>0.3733</td>
<td>0.2978</td>
<td>0.3643</td>
<td>0.4306</td>
<td>0.3561</td>
<td>0.4511</td>
<td>0.2961</td>
<td>0.3587</td>
<td>0.3860</td>
<td>0.1907</td>
<td>0.3834</td>
<td>0.3561</td>
<td>0.4742</td>
<td>0.3357</td>
<td>0.3526</td>
<td>0.4044</td>
<td>0.2899</td>
<td>0.3867</td>
<td>0.4162</td>
<td>0.4142</td>
<td>0.2898</td>
<td>0.3256</td>
<td>0.4124</td>
<td>0.3287</td>
<td>0.3335</td>
<td>0.2831</td>
<td>0.3479</td>
<td>0.3374</td>
<td>0.3707</td>
<td>0.1404</td>
<td>0.2935</td>
<td>0.2213</td>
<td>0.3112</td>
<td>0.3356</td>
<td>0.2145</td>
<td>0.3097</td>
<td>0.2728</td>
<td>0.3353</td>
<td>0.2574</td>
<td>0.2916</td>
<td>0.3308</td>
<td>0.3564</td>
<td>0.2627</td>
<td>0.2654</td>
<td>0.3233</td>
<td>0.3989</td>
<td>0.4142</td>
<td>0.3444</td>
<td>0.2684</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD2406</td>
<td>2758.511524</td>
<td>9</td>
<td>0.040575</td>
<td>0.157374</td>
<td>0.372476</td>
<td>0.3538</td>
<td>0.3675</td>
<td>0.3196</td>
<td>0.4475</td>
<td>0.2878</td>
<td>0.2987</td>
<td>0.2249</td>
<td>0.2977</td>
<td>0.2772</td>
<td>0.3157</td>
<td>0.2587</td>
<td>0.2404</td>
<td>0.2636</td>
<td>0.3613</td>
<td>0.4659</td>
<td>0.3922</td>
<td>0.1966</td>
<td>0.2316</td>
<td>0.2923</td>
<td>0.2813</td>
<td>0.1748</td>
<td>0.2810</td>
<td>0.2205</td>
<td>0.2491</td>
<td>0.2348</td>
<td>0.2304</td>
<td>0.0588</td>
<td>0.2951</td>
<td>0.3204</td>
<td>0.3760</td>
<td>0.3382</td>
<td>0.2889</td>
<td>0.3728</td>
<td>0.3790</td>
<td>0.3174</td>
<td>0.3849</td>
<td>0.4309</td>
<td>0.3109</td>
<td>0.4362</td>
<td>0.2583</td>
<td>0.2269</td>
<td>0.3813</td>
<td>0.4082</td>
<td>0.4513</td>
<td>0.0401</td>
<td>0.2631</td>
<td>0.2357</td>
<td>0.3879</td>
<td>0.0211</td>
<td>0.3995</td>
<td>0.2916</td>
<td>0.4247</td>
<td>0.4515</td>
<td>0.3606</td>
<td>0.2608</td>
<td>0.3098</td>
<td>0.1564</td>
<td>0.3513</td>
<td>0.3567</td>
<td>0.3750</td>
<td>0.3842</td>
<td>0.3501</td>
<td>0.2271</td>
<td>0.3615</td>
<td>0.4321</td>
<td>0.3351</td>
<td>0.4546</td>
<td>0.2928</td>
<td>0.3272</td>
<td>0.2899</td>
<td>0.1731</td>
<td>0.2730</td>
<td>0.3076</td>
<td>0.3788</td>
<td>0.2516</td>
<td>0.2696</td>
<td>0.3959</td>
<td>0.2289</td>
<td>0.3288</td>
<td>0.4173</td>
<td>0.4145</td>
<td>0.1935</td>
<td>0.2306</td>
<td>0.4093</td>
<td>0.3427</td>
<td>0.2848</td>
<td>0.2491</td>
<td>0.3534</td>
<td>0.2957</td>
<td>0.3566</td>
<td>0.1893</td>
<td>0.2477</td>
<td>-0.0057</td>
<td>0.2601</td>
<td>0.3146</td>
<td>0.0602</td>
<td>0.2081</td>
<td>0.2756</td>
<td>0.3329</td>
<td>0.1981</td>
<td>0.3020</td>
<td>0.3171</td>
<td>0.3629</td>
<td>0.2257</td>
<td>0.2302</td>
<td>0.2934</td>
<td>0.3086</td>
<td>0.4236</td>
<td>0.3489</td>
<td>0.2568</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD2409</td>
<td>5379.451341</td>
<td>11</td>
<td>0.098933</td>
<td>0.065574</td>
<td>0.336374</td>
<td>0.4315</td>
<td>0.4001</td>
<td>0.4281</td>
<td>0.4980</td>
<td>0.3670</td>
<td>0.3599</td>
<td>0.3109</td>
<td>0.3885</td>
<td>0.3636</td>
<td>0.4058</td>
<td>0.3074</td>
<td>0.2588</td>
<td>0.3201</td>
<td>0.4278</td>
<td>0.4789</td>
<td>0.4486</td>
<td>0.2958</td>
<td>0.3271</td>
<td>0.3578</td>
<td>0.4093</td>
<td>0.2096</td>
<td>0.3742</td>
<td>0.2676</td>
<td>0.2780</td>
<td>0.2728</td>
<td>0.2282</td>
<td>0.3606</td>
<td>0.3481</td>
<td>0.3615</td>
<td>0.4254</td>
<td>0.3986</td>
<td>0.3114</td>
<td>0.4257</td>
<td>0.4138</td>
<td>0.3804</td>
<td>0.4204</td>
<td>0.4438</td>
<td>0.2689</td>
<td>0.5003</td>
<td>0.3371</td>
<td>0.3379</td>
<td>0.4041</td>
<td>0.4373</td>
<td>0.4943</td>
<td>0.3594</td>
<td>0.3169</td>
<td>0.3037</td>
<td>0.4367</td>
<td>0.2960</td>
<td>0.4184</td>
<td>0.3754</td>
<td>0.4485</td>
<td>0.4846</td>
<td>0.3863</td>
<td>0.3134</td>
<td>0.4283</td>
<td>0.3230</td>
<td>0.3787</td>
<td>0.4163</td>
<td>0.4373</td>
<td>0.4103</td>
<td>0.3737</td>
<td>0.2959</td>
<td>0.3780</td>
<td>0.4324</td>
<td>0.3626</td>
<td>0.4790</td>
<td>0.3242</td>
<td>0.3694</td>
<td>0.4018</td>
<td>0.1984</td>
<td>0.2949</td>
<td>0.3494</td>
<td>0.3979</td>
<td>0.3243</td>
<td>0.3352</td>
<td>0.2980</td>
<td>0.2940</td>
<td>0.3837</td>
<td>0.3991</td>
<td>0.4168</td>
<td>0.2902</td>
<td>0.3016</td>
<td>0.4070</td>
<td>0.3236</td>
<td>0.3370</td>
<td>0.2773</td>
<td>0.3046</td>
<td>0.3263</td>
<td>0.3789</td>
<td>0.2107</td>
<td>0.2569</td>
<td>0.2197</td>
<td>0.3364</td>
<td>0.3517</td>
<td>0.1525</td>
<td>0.3144</td>
<td>0.3632</td>
<td>0.3714</td>
<td>0.2620</td>
<td>0.4239</td>
<td>0.3225</td>
<td>0.3916</td>
<td>0.3130</td>
<td>0.3030</td>
<td>0.3316</td>
<td>0.3701</td>
<td>0.3928</td>
<td>0.3509</td>
<td>0.2660</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD2412</td>
<td>4225.584090</td>
<td>10</td>
<td>0.173398</td>
<td>0.207518</td>
<td>0.206046</td>
<td>0.4012</td>
<td>0.4299</td>
<td>0.3902</td>
<td>0.4827</td>
<td>0.3308</td>
<td>0.2883</td>
<td>0.2645</td>
<td>0.3532</td>
<td>0.3307</td>
<td>0.3501</td>
<td>0.2914</td>
<td>0.2594</td>
<td>0.2998</td>
<td>0.4215</td>
<td>0.4689</td>
<td>0.4101</td>
<td>0.2921</td>
<td>0.2960</td>
<td>0.3519</td>
<td>0.4009</td>
<td>0.1197</td>
<td>0.3624</td>
<td>0.2331</td>
<td>0.2785</td>
<td>0.2560</td>
<td>0.2199</td>
<td>0.2859</td>
<td>0.3213</td>
<td>0.3555</td>
<td>0.3963</td>
<td>0.3732</td>
<td>0.3114</td>
<td>0.4212</td>
<td>0.4116</td>
<td>0.3613</td>
<td>0.4112</td>
<td>0.4515</td>
<td>0.1930</td>
<td>0.4146</td>
<td>0.3027</td>
<td>0.2417</td>
<td>0.4171</td>
<td>0.4003</td>
<td>0.4708</td>
<td>0.3035</td>
<td>0.3050</td>
<td>0.3060</td>
<td>0.4193</td>
<td>0.2516</td>
<td>0.4358</td>
<td>0.3525</td>
<td>0.4096</td>
<td>0.4776</td>
<td>0.4012</td>
<td>0.3032</td>
<td>0.3910</td>
<td>0.2762</td>
<td>0.3900</td>
<td>0.3891</td>
<td>0.4143</td>
<td>0.4119</td>
<td>0.3790</td>
<td>0.2756</td>
<td>0.3649</td>
<td>0.4301</td>
<td>0.3595</td>
<td>0.4676</td>
<td>0.3259</td>
<td>0.3577</td>
<td>0.3666</td>
<td>0.2383</td>
<td>0.3118</td>
<td>0.3334</td>
<td>0.4189</td>
<td>0.3155</td>
<td>0.3162</td>
<td>0.3044</td>
<td>0.2460</td>
<td>0.3643</td>
<td>0.3864</td>
<td>0.4062</td>
<td>0.2942</td>
<td>0.3026</td>
<td>0.4215</td>
<td>0.3600</td>
<td>0.3633</td>
<td>0.2781</td>
<td>0.3185</td>
<td>0.3387</td>
<td>0.3711</td>
<td>0.2080</td>
<td>0.2333</td>
<td>0.1697</td>
<td>0.2862</td>
<td>0.3441</td>
<td>0.1187</td>
<td>0.2648</td>
<td>0.3162</td>
<td>0.3431</td>
<td>0.2301</td>
<td>0.3355</td>
<td>0.3413</td>
<td>0.3496</td>
<td>0.2730</td>
<td>0.2748</td>
<td>0.3238</td>
<td>0.3560</td>
<td>0.3815</td>
<td>0.3596</td>
<td>0.2491</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD2418</td>
<td>4774.602798</td>
<td>9</td>
<td>0.117058</td>
<td>0.243782</td>
<td>0.277604</td>
<td>0.4254</td>
<td>0.4221</td>
<td>0.3631</td>
<td>0.4951</td>
<td>0.3487</td>
<td>0.3314</td>
<td>0.3077</td>
<td>0.3607</td>
<td>0.3500</td>
<td>0.3505</td>
<td>0.3235</td>
<td>0.2908</td>
<td>0.3320</td>
<td>0.3746</td>
<td>0.4853</td>
<td>0.4419</td>
<td>0.2960</td>
<td>0.3042</td>
<td>0.3473</td>
<td>0.4130</td>
<td>0.1257</td>
<td>0.3791</td>
<td>0.2575</td>
<td>0.2910</td>
<td>0.2744</td>
<td>0.2594</td>
<td>0.3583</td>
<td>0.3261</td>
<td>0.3722</td>
<td>0.4154</td>
<td>0.3925</td>
<td>0.3258</td>
<td>0.4092</td>
<td>0.4006</td>
<td>0.3251</td>
<td>0.4131</td>
<td>0.4466</td>
<td>0.2654</td>
<td>0.4736</td>
<td>0.3285</td>
<td>0.1966</td>
<td>0.4315</td>
<td>0.4426</td>
<td>0.4951</td>
<td>0.3212</td>
<td>0.3321</td>
<td>0.2835</td>
<td>0.4145</td>
<td>0.2408</td>
<td>0.4493</td>
<td>0.3538</td>
<td>0.4528</td>
<td>0.4865</td>
<td>0.4305</td>
<td>0.2833</td>
<td>0.4032</td>
<td>0.3058</td>
<td>0.3931</td>
<td>0.4101</td>
<td>0.3594</td>
<td>0.4195</td>
<td>0.3746</td>
<td>0.2839</td>
<td>0.3682</td>
<td>0.4237</td>
<td>0.3598</td>
<td>0.4645</td>
<td>0.3018</td>
<td>0.3602</td>
<td>0.3782</td>
<td>0.2253</td>
<td>0.3274</td>
<td>0.3475</td>
<td>0.4265</td>
<td>0.3162</td>
<td>0.3365</td>
<td>0.3433</td>
<td>0.2577</td>
<td>0.3831</td>
<td>0.3977</td>
<td>0.4108</td>
<td>0.2873</td>
<td>0.3153</td>
<td>0.4120</td>
<td>0.3498</td>
<td>0.3359</td>
<td>0.2841</td>
<td>0.3405</td>
<td>0.3247</td>
<td>0.3672</td>
<td>0.2736</td>
<td>0.3118</td>
<td>0.1389</td>
<td>0.2862</td>
<td>0.3378</td>
<td>0.0954</td>
<td>0.1935</td>
<td>0.2901</td>
<td>0.3575</td>
<td>0.2500</td>
<td>0.3003</td>
<td>0.3100</td>
<td>0.3676</td>
<td>0.2489</td>
<td>0.2636</td>
<td>0.3191</td>
<td>0.3735</td>
<td>0.4077</td>
<td>0.3418</td>
<td>0.2582</td>
</tr>
</tbody>
</table>

<p>693 rows × 115 columns</p>
</div>
</div>
</div>
<p>Now we perform train test split on the X and Y variables.</p>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform train-test split</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>X_train, X_test, Y_train, Y_test <span class="op">=</span> skl.model_selection.train_test_split(X, Y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>X_train.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Stage</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionTransscript_Count</th>
<th data-quarto-table-cell-role="th">FN/FT_Ratio</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0356</td>
<td>45</td>
<td>2</td>
<td>2.0</td>
<td>4.0</td>
<td>13</td>
<td>22</td>
<td>0.590909</td>
<td>3624</td>
<td>1.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0247</td>
<td>22</td>
<td>2</td>
<td>3.0</td>
<td>1.4</td>
<td>23</td>
<td>46</td>
<td>0.500000</td>
<td>138</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0128</td>
<td>61</td>
<td>3</td>
<td>3.0</td>
<td>9.0</td>
<td>25</td>
<td>47</td>
<td>0.531915</td>
<td>2481</td>
<td>1.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0848</td>
<td>65</td>
<td>2</td>
<td>2.0</td>
<td>2.5</td>
<td>6</td>
<td>39</td>
<td>0.153846</td>
<td>293</td>
<td>1.9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD2051</td>
<td>35</td>
<td>3</td>
<td>3.0</td>
<td>1.0</td>
<td>6</td>
<td>39</td>
<td>0.153846</td>
<td>48</td>
<td>1.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>X_test.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Stage</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionTransscript_Count</th>
<th data-quarto-table-cell-role="th">FN/FT_Ratio</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD1380</td>
<td>45</td>
<td>2</td>
<td>2.0</td>
<td>3.0</td>
<td>61</td>
<td>133</td>
<td>0.458647</td>
<td>3615</td>
<td>1.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD2265</td>
<td>72</td>
<td>2</td>
<td>2.0</td>
<td>2.5</td>
<td>16</td>
<td>22</td>
<td>0.727273</td>
<td>650</td>
<td>2.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0946</td>
<td>54</td>
<td>3</td>
<td>3.0</td>
<td>3.0</td>
<td>149</td>
<td>95</td>
<td>1.568421</td>
<td>67</td>
<td>4.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD1225</td>
<td>57</td>
<td>2</td>
<td>3.0</td>
<td>3.0</td>
<td>30</td>
<td>51</td>
<td>0.588235</td>
<td>732</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD1164</td>
<td>50</td>
<td>3</td>
<td>3.0</td>
<td>3.0</td>
<td>9</td>
<td>46</td>
<td>0.195652</td>
<td>63</td>
<td>2.2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>X_train.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 554 entries, SD0356 to SD0325
Data columns (total 9 columns):
 #   Column                   Non-Null Count  Dtype  
---  ------                   --------------  -----  
 0   Age                      554 non-null    int64  
 1   Stage                    554 non-null    int64  
 2   TumorGrade               554 non-null    float64
 3   TumourSize               554 non-null    float64
 4   FusionNeo_Count          554 non-null    int64  
 5   FusionTransscript_Count  554 non-null    int64  
 6   FN/FT_Ratio              554 non-null    float64
 7   SNVindelNeo_Count        554 non-null    int64  
 8   SNVindelNeo_IC50         554 non-null    float64
dtypes: float64(4), int64(5)
memory usage: 43.3+ KB</code></pre>
</div>
</div>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>X_test.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 139 entries, SD1380 to SD1238
Data columns (total 9 columns):
 #   Column                   Non-Null Count  Dtype  
---  ------                   --------------  -----  
 0   Age                      139 non-null    int64  
 1   Stage                    139 non-null    int64  
 2   TumorGrade               139 non-null    float64
 3   TumourSize               139 non-null    float64
 4   FusionNeo_Count          139 non-null    int64  
 5   FusionTransscript_Count  139 non-null    int64  
 6   FN/FT_Ratio              139 non-null    float64
 7   SNVindelNeo_Count        139 non-null    int64  
 8   SNVindelNeo_IC50         139 non-null    float64
dtypes: float64(4), int64(5)
memory usage: 10.9+ KB</code></pre>
</div>
</div>
<p>As we don’t want to transform all the X columns (because some of them are discrete numerical data and some of them are one-hot encoded categorical variables), we need to specify the columns to transform.</p>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>X_vars_to_transform <span class="op">=</span> [<span class="st">'TumourSize'</span>, <span class="st">'FusionNeo_Count'</span>, <span class="st">'FusionTransscript_Count'</span>, <span class="st">'FN/FT_Ratio'</span>, <span class="st">'SNVindelNeo_Count'</span>, <span class="st">'SNVindelNeo_IC50'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>First, apply the Yeo-Johnson transformation on the split datasets.</p>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> feature_engine.transformation <span class="im">import</span> YeoJohnsonTransformer</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize Yeo-Johnson transformer for features to transform</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>yj_transformer_X <span class="op">=</span> YeoJohnsonTransformer(variables<span class="op">=</span>X_vars_to_transform)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize Yeo-Johnson transformer for target</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>yj_transformer_Y <span class="op">=</span> YeoJohnsonTransformer()</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit and transform the training data (features)</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>X_train_tf <span class="op">=</span> yj_transformer_X.fit_transform(X_train)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform the test data using the fitted transformer (features)</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>X_test_tf <span class="op">=</span> yj_transformer_X.transform(X_test)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit and transform the training data (targets)</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>Y_train_tf <span class="op">=</span> yj_transformer_Y.fit_transform(Y_train)</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform the test data using the fitted transformer (targets)</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>Y_test_tf <span class="op">=</span> yj_transformer_Y.transform(Y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>X_train_tf.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Stage</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionTransscript_Count</th>
<th data-quarto-table-cell-role="th">FN/FT_Ratio</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0356</td>
<td>45</td>
<td>2</td>
<td>2.0</td>
<td>1.064878</td>
<td>3.132858</td>
<td>4.251031</td>
<td>0.408944</td>
<td>5.354147</td>
<td>0.464435</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0247</td>
<td>22</td>
<td>2</td>
<td>3.0</td>
<td>0.693650</td>
<td>3.911662</td>
<td>5.616745</td>
<td>0.362799</td>
<td>3.786930</td>
<td>0.488265</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0128</td>
<td>61</td>
<td>3</td>
<td>3.0</td>
<td>1.300780</td>
<td>4.031911</td>
<td>5.659784</td>
<td>0.379485</td>
<td>5.200202</td>
<td>0.438699</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0848</td>
<td>65</td>
<td>2</td>
<td>2.0</td>
<td>0.903238</td>
<td>2.206276</td>
<td>5.292579</td>
<td>0.137527</td>
<td>4.199360</td>
<td>0.483146</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD2051</td>
<td>35</td>
<td>3</td>
<td>3.0</td>
<td>0.575547</td>
<td>2.206276</td>
<td>5.292579</td>
<td>0.137527</td>
<td>3.151851</td>
<td>0.483146</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>X_test_tf.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Stage</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionTransscript_Count</th>
<th data-quarto-table-cell-role="th">FN/FT_Ratio</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD1380</td>
<td>45</td>
<td>2</td>
<td>2.0</td>
<td>0.967522</td>
<td>5.418928</td>
<td>7.975810</td>
<td>0.340338</td>
<td>5.353158</td>
<td>0.456793</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD2265</td>
<td>72</td>
<td>2</td>
<td>2.0</td>
<td>0.903238</td>
<td>3.407299</td>
<td>4.251031</td>
<td>0.470947</td>
<td>4.600636</td>
<td>0.508071</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0946</td>
<td>54</td>
<td>3</td>
<td>3.0</td>
<td>0.967522</td>
<td>6.994318</td>
<td>7.174681</td>
<td>0.733105</td>
<td>3.359526</td>
<td>0.543955</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD1225</td>
<td>57</td>
<td>2</td>
<td>3.0</td>
<td>0.967522</td>
<td>4.300470</td>
<td>5.824953</td>
<td>0.407646</td>
<td>4.657506</td>
<td>0.488265</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD1164</td>
<td>50</td>
<td>3</td>
<td>3.0</td>
<td>0.967522</td>
<td>2.672922</td>
<td>5.616745</td>
<td>0.170057</td>
<td>3.321680</td>
<td>0.497211</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>Y_train_tf.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ESTIMATE</th>
<th data-quarto-table-cell-role="th">IMPRES</th>
<th data-quarto-table-cell-role="th">C_Bcellsnaive</th>
<th data-quarto-table-cell-role="th">C_TcellsCD4memoryresting</th>
<th data-quarto-table-cell-role="th">C_MacrophagesM2</th>
<th data-quarto-table-cell-role="th">S_Attractors_LYM</th>
<th data-quarto-table-cell-role="th">S_Attractors_IFIT3</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_GIMAP4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_HLA.DPA1</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SLAMF6</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_LILRB4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SIGLEC9</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CYTH4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CD3E</th>
<th data-quarto-table-cell-role="th">S_Lymph_Vessels</th>
<th data-quarto-table-cell-role="th">S_ICR_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_INHIB_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_ACT_SCORE</th>
<th data-quarto-table-cell-role="th">S_Angiogenesis</th>
<th data-quarto-table-cell-role="th">S_APM1</th>
<th data-quarto-table-cell-role="th">S_APM2</th>
<th data-quarto-table-cell-role="th">S_ICS5_score</th>
<th data-quarto-table-cell-role="th">S_LIexpression_score</th>
<th data-quarto-table-cell-role="th">S_Chemokine12_score</th>
<th data-quarto-table-cell-role="th">S_NHI_5gene_score</th>
<th data-quarto-table-cell-role="th">S_CD68</th>
<th data-quarto-table-cell-role="th">S_CD8A</th>
<th data-quarto-table-cell-role="th">S_PD1_data</th>
<th data-quarto-table-cell-role="th">S_PDL1_data</th>
<th data-quarto-table-cell-role="th">S_PD1_PDL1_score</th>
<th data-quarto-table-cell-role="th">S_CTLA4_data</th>
<th data-quarto-table-cell-role="th">S_Bcell_mg_IGJ</th>
<th data-quarto-table-cell-role="th">S_Bcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_STAT1_score</th>
<th data-quarto-table-cell-role="th">S_CSF1_response</th>
<th data-quarto-table-cell-role="th">S_TcClassII_score</th>
<th data-quarto-table-cell-role="th">S_IL12_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL4_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL2_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL13_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IFNG_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TGFB_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TREM1_data</th>
<th data-quarto-table-cell-role="th">S_DAP12_data</th>
<th data-quarto-table-cell-role="th">S_Tcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_IL8_21978456</th>
<th data-quarto-table-cell-role="th">S_IFN_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC1_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC2_21978456</th>
<th data-quarto-table-cell-role="th">S_Bcell_21978456</th>
<th data-quarto-table-cell-role="th">S_Tcell_21978456</th>
<th data-quarto-table-cell-role="th">S_CD103pos_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_CD103neg_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_IgG_19272155</th>
<th data-quarto-table-cell-role="th">S_Interferon_19272155</th>
<th data-quarto-table-cell-role="th">S_LCK_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.I_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.II_19272155</th>
<th data-quarto-table-cell-role="th">S_STAT1_19272155</th>
<th data-quarto-table-cell-role="th">S_Troester_WoundSig_19887484</th>
<th data-quarto-table-cell-role="th">S_MDACC.FNA.1_20805453</th>
<th data-quarto-table-cell-role="th">S_IGG_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Minterferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Immune_cell_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_MCD3_CD8_21214954</th>
<th data-quarto-table-cell-role="th">S_Interferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_B_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_CD8_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_GRANS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_LYMPHS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_T_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_TGFB_PCA_17349583</th>
<th data-quarto-table-cell-role="th">S_Rotterdam_ERneg_PCA_15721472</th>
<th data-quarto-table-cell-role="th">S_HER2_Immune_PCA_18006808</th>
<th data-quarto-table-cell-role="th">S_IR7_score</th>
<th data-quarto-table-cell-role="th">S_Buck14_score</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_score</th>
<th data-quarto-table-cell-role="th">S_Immune_NSCLC_score</th>
<th data-quarto-table-cell-role="th">S_Module3_IFN_score</th>
<th data-quarto-table-cell-role="th">S_Module4_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module5_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module11_Prolif_score</th>
<th data-quarto-table-cell-role="th">S_CD8_CD68_ratio</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_TcClassII_ratio</th>
<th data-quarto-table-cell-role="th">S_CHANG_CORE_SERUM_RESPONSE_UP</th>
<th data-quarto-table-cell-role="th">S_CSR_Activated_15701700</th>
<th data-quarto-table-cell-role="th">S_B_cells</th>
<th data-quarto-table-cell-role="th">S_T_cells</th>
<th data-quarto-table-cell-role="th">S_T_helper</th>
<th data-quarto-table-cell-role="th">S_Tcm</th>
<th data-quarto-table-cell-role="th">S_Tem</th>
<th data-quarto-table-cell-role="th">S_Th1</th>
<th data-quarto-table-cell-role="th">S_Th2</th>
<th data-quarto-table-cell-role="th">S_TFH</th>
<th data-quarto-table-cell-role="th">S_CD8_Tcells</th>
<th data-quarto-table-cell-role="th">S_Th17</th>
<th data-quarto-table-cell-role="th">S_Treg</th>
<th data-quarto-table-cell-role="th">S_Tgd</th>
<th data-quarto-table-cell-role="th">S_Cytotoxic_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cd56dim</th>
<th data-quarto-table-cell-role="th">S_NK_cd56bright</th>
<th data-quarto-table-cell-role="th">S_DC</th>
<th data-quarto-table-cell-role="th">S_iDC</th>
<th data-quarto-table-cell-role="th">S_aDC</th>
<th data-quarto-table-cell-role="th">S_pDC</th>
<th data-quarto-table-cell-role="th">S_Eosinophils</th>
<th data-quarto-table-cell-role="th">S_Macrophages</th>
<th data-quarto-table-cell-role="th">S_Mast</th>
<th data-quarto-table-cell-role="th">S_Neutrophils</th>
<th data-quarto-table-cell-role="th">S_Bindea_full</th>
<th data-quarto-table-cell-role="th">S_Expanded_IFNg</th>
<th data-quarto-table-cell-role="th">S_KEGG_MMR</th>
<th data-quarto-table-cell-role="th">S_KEGG_TGF_Beta</th>
<th data-quarto-table-cell-role="th">S_KEGG_Cytosolic_DNA_Sensing</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0356</td>
<td>971.780461</td>
<td>34.293190</td>
<td>0.133762</td>
<td>0.074679</td>
<td>0.123564</td>
<td>0.381731</td>
<td>1.578841</td>
<td>0.224718</td>
<td>6085.872384</td>
<td>0.336989</td>
<td>0.269941</td>
<td>0.586720</td>
<td>0.135175</td>
<td>0.476859</td>
<td>0.906360</td>
<td>0.440555</td>
<td>0.258467</td>
<td>0.521225</td>
<td>0.342248</td>
<td>9.366199</td>
<td>7.445723</td>
<td>1.097833</td>
<td>0.302936</td>
<td>0.702013</td>
<td>4.909231</td>
<td>0.248588</td>
<td>0.213797</td>
<td>0.746239</td>
<td>0.134792</td>
<td>0.706049</td>
<td>0.685650</td>
<td>0.759077</td>
<td>0.183868</td>
<td>0.374832</td>
<td>0.457671</td>
<td>0.749925</td>
<td>0.376787</td>
<td>0.654897</td>
<td>0.126346</td>
<td>0.471739</td>
<td>0.391199</td>
<td>19718.673342</td>
<td>0.259917</td>
<td>13.364747</td>
<td>0.495230</td>
<td>0.235059</td>
<td>1.698965</td>
<td>4.616742</td>
<td>2881.685319</td>
<td>1.104188</td>
<td>0.324049</td>
<td>0.752323</td>
<td>2.393765</td>
<td>0.524159</td>
<td>5.067345</td>
<td>0.286401</td>
<td>31.193144</td>
<td>1037.638675</td>
<td>0.637904</td>
<td>0.998511</td>
<td>2.637505</td>
<td>0.300113</td>
<td>0.608491</td>
<td>0.306288</td>
<td>0.269259</td>
<td>0.826629</td>
<td>0.516925</td>
<td>0.266682</td>
<td>134.112830</td>
<td>4353.465391</td>
<td>0.336246</td>
<td>299.503717</td>
<td>1.807192</td>
<td>0.246105</td>
<td>4.459392</td>
<td>0.810051</td>
<td>0.340829</td>
<td>3.869113</td>
<td>1.100136</td>
<td>0.315335</td>
<td>0.320965</td>
<td>0.796126</td>
<td>0.486400</td>
<td>0.600969</td>
<td>0.138977</td>
<td>3211.979228</td>
<td>0.525795</td>
<td>0.369500</td>
<td>20.006589</td>
<td>110.064091</td>
<td>0.368787</td>
<td>1.013305</td>
<td>6.961054</td>
<td>11.301921</td>
<td>0.201873</td>
<td>0.106182</td>
<td>0.242861</td>
<td>0.972306</td>
<td>0.319225</td>
<td>318.552488</td>
<td>0.151396</td>
<td>0.462059</td>
<td>0.568848</td>
<td>2.155400</td>
<td>0.161037</td>
<td>0.079610</td>
<td>0.890317</td>
<td>1.173896</td>
<td>0.592027</td>
<td>0.336131</td>
<td>1.720195</td>
<td>0.288287</td>
<td>0.137886</td>
<td>10.548561</td>
<td>0.051381</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0247</td>
<td>689.377449</td>
<td>17.348564</td>
<td>0.088814</td>
<td>0.180381</td>
<td>0.220479</td>
<td>0.334901</td>
<td>1.770117</td>
<td>0.204510</td>
<td>4177.616524</td>
<td>0.272886</td>
<td>0.248231</td>
<td>0.508237</td>
<td>0.127157</td>
<td>0.339881</td>
<td>0.930435</td>
<td>0.308143</td>
<td>0.208073</td>
<td>0.346984</td>
<td>0.368562</td>
<td>8.309606</td>
<td>4.871566</td>
<td>0.636628</td>
<td>0.230832</td>
<td>0.461903</td>
<td>3.910847</td>
<td>0.246568</td>
<td>0.176679</td>
<td>0.362201</td>
<td>0.121687</td>
<td>0.381884</td>
<td>0.478267</td>
<td>0.624042</td>
<td>0.168604</td>
<td>0.338828</td>
<td>0.424313</td>
<td>0.565481</td>
<td>0.330351</td>
<td>0.653932</td>
<td>0.124487</td>
<td>0.480188</td>
<td>0.375306</td>
<td>27509.257112</td>
<td>0.261121</td>
<td>9.285383</td>
<td>0.332501</td>
<td>0.217113</td>
<td>1.767160</td>
<td>3.750011</td>
<td>1854.632732</td>
<td>0.774508</td>
<td>0.282546</td>
<td>0.604104</td>
<td>2.526826</td>
<td>0.335943</td>
<td>5.688702</td>
<td>0.251481</td>
<td>23.451134</td>
<td>881.642683</td>
<td>0.546669</td>
<td>1.076604</td>
<td>2.254974</td>
<td>0.227287</td>
<td>0.565881</td>
<td>0.276972</td>
<td>0.290289</td>
<td>0.831204</td>
<td>0.506832</td>
<td>0.198740</td>
<td>123.937561</td>
<td>3446.521543</td>
<td>0.317491</td>
<td>345.406921</td>
<td>3.407548</td>
<td>0.233089</td>
<td>2.756319</td>
<td>0.597326</td>
<td>0.291599</td>
<td>3.432185</td>
<td>1.165656</td>
<td>0.254970</td>
<td>0.267598</td>
<td>0.880134</td>
<td>0.326343</td>
<td>0.470524</td>
<td>0.138273</td>
<td>3281.613731</td>
<td>0.485873</td>
<td>0.277757</td>
<td>20.489443</td>
<td>241.588084</td>
<td>0.379326</td>
<td>0.867384</td>
<td>7.958652</td>
<td>9.312172</td>
<td>0.198073</td>
<td>0.106957</td>
<td>0.219225</td>
<td>0.309046</td>
<td>0.236549</td>
<td>241.907238</td>
<td>0.131005</td>
<td>0.537909</td>
<td>0.410002</td>
<td>1.459346</td>
<td>0.152646</td>
<td>0.077681</td>
<td>0.880006</td>
<td>1.153706</td>
<td>0.659379</td>
<td>0.277247</td>
<td>1.502656</td>
<td>0.239707</td>
<td>0.137857</td>
<td>15.440631</td>
<td>0.051170</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0128</td>
<td>868.262348</td>
<td>30.613962</td>
<td>0.085674</td>
<td>0.098674</td>
<td>0.116543</td>
<td>0.364025</td>
<td>1.582703</td>
<td>0.216489</td>
<td>5457.418459</td>
<td>0.314352</td>
<td>0.257847</td>
<td>0.353869</td>
<td>0.132199</td>
<td>0.425190</td>
<td>0.635750</td>
<td>0.401104</td>
<td>0.244375</td>
<td>0.468307</td>
<td>0.327692</td>
<td>9.285839</td>
<td>4.851381</td>
<td>0.943597</td>
<td>0.274725</td>
<td>0.581783</td>
<td>3.895609</td>
<td>0.252401</td>
<td>0.209997</td>
<td>0.680486</td>
<td>0.130582</td>
<td>0.598581</td>
<td>0.612261</td>
<td>0.857455</td>
<td>0.174700</td>
<td>0.368032</td>
<td>0.437144</td>
<td>0.688850</td>
<td>0.370375</td>
<td>0.661912</td>
<td>0.126458</td>
<td>0.479784</td>
<td>0.397427</td>
<td>14055.096888</td>
<td>0.218136</td>
<td>11.596605</td>
<td>0.431425</td>
<td>0.266561</td>
<td>1.640786</td>
<td>4.360531</td>
<td>1711.971374</td>
<td>1.203175</td>
<td>0.303150</td>
<td>0.699223</td>
<td>2.168065</td>
<td>0.522160</td>
<td>4.897246</td>
<td>0.276800</td>
<td>27.445010</td>
<td>992.491903</td>
<td>0.616963</td>
<td>0.900065</td>
<td>2.771044</td>
<td>0.330930</td>
<td>0.589487</td>
<td>0.295533</td>
<td>0.238977</td>
<td>0.813271</td>
<td>0.502605</td>
<td>0.248586</td>
<td>120.033552</td>
<td>3790.111029</td>
<td>0.328167</td>
<td>189.109853</td>
<td>2.023224</td>
<td>0.239868</td>
<td>3.761532</td>
<td>0.699259</td>
<td>0.343339</td>
<td>3.774624</td>
<td>1.118980</td>
<td>0.292954</td>
<td>0.307701</td>
<td>0.979145</td>
<td>0.466420</td>
<td>0.565361</td>
<td>0.139405</td>
<td>3227.328565</td>
<td>0.587690</td>
<td>0.340513</td>
<td>18.114480</td>
<td>107.938470</td>
<td>0.423032</td>
<td>0.906452</td>
<td>7.793259</td>
<td>10.161420</td>
<td>0.199462</td>
<td>0.115235</td>
<td>0.237794</td>
<td>0.944928</td>
<td>0.280134</td>
<td>315.503568</td>
<td>0.132666</td>
<td>0.339546</td>
<td>0.497065</td>
<td>1.436405</td>
<td>0.163603</td>
<td>0.078623</td>
<td>0.831538</td>
<td>1.185081</td>
<td>0.417119</td>
<td>0.292887</td>
<td>1.556334</td>
<td>0.279977</td>
<td>0.137996</td>
<td>9.436206</td>
<td>0.051495</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0848</td>
<td>739.326128</td>
<td>20.434190</td>
<td>0.093931</td>
<td>0.153871</td>
<td>0.130851</td>
<td>0.341296</td>
<td>1.855141</td>
<td>0.213510</td>
<td>3132.656809</td>
<td>0.292463</td>
<td>0.222038</td>
<td>0.445283</td>
<td>0.129513</td>
<td>0.374755</td>
<td>0.809430</td>
<td>0.329901</td>
<td>0.202707</td>
<td>0.385005</td>
<td>0.388725</td>
<td>8.603773</td>
<td>4.815237</td>
<td>0.744495</td>
<td>0.256856</td>
<td>0.509004</td>
<td>3.415910</td>
<td>0.024845</td>
<td>0.192541</td>
<td>0.398516</td>
<td>0.118576</td>
<td>0.372896</td>
<td>0.427179</td>
<td>0.839982</td>
<td>0.173346</td>
<td>0.349177</td>
<td>0.411514</td>
<td>0.601710</td>
<td>0.329432</td>
<td>0.609173</td>
<td>0.125947</td>
<td>0.437833</td>
<td>0.381997</td>
<td>25435.258604</td>
<td>0.175309</td>
<td>6.914614</td>
<td>0.375783</td>
<td>0.210467</td>
<td>1.789221</td>
<td>3.917899</td>
<td>1539.079638</td>
<td>0.895354</td>
<td>0.288762</td>
<td>0.692197</td>
<td>2.096483</td>
<td>0.468772</td>
<td>6.066075</td>
<td>0.261753</td>
<td>27.292033</td>
<td>756.126448</td>
<td>0.556318</td>
<td>1.088285</td>
<td>2.439819</td>
<td>0.311778</td>
<td>0.587854</td>
<td>0.279102</td>
<td>0.328990</td>
<td>0.855456</td>
<td>0.515149</td>
<td>0.227097</td>
<td>116.028771</td>
<td>4147.627179</td>
<td>0.323390</td>
<td>333.200714</td>
<td>4.284414</td>
<td>0.236570</td>
<td>2.956922</td>
<td>0.601796</td>
<td>0.284111</td>
<td>4.086377</td>
<td>1.172164</td>
<td>0.279701</td>
<td>0.279824</td>
<td>0.773663</td>
<td>0.271030</td>
<td>0.490585</td>
<td>0.137876</td>
<td>3313.030509</td>
<td>0.525495</td>
<td>0.327387</td>
<td>20.246666</td>
<td>176.559464</td>
<td>0.400893</td>
<td>0.836340</td>
<td>6.961054</td>
<td>11.589157</td>
<td>0.201564</td>
<td>0.109423</td>
<td>0.216019</td>
<td>1.267086</td>
<td>0.269396</td>
<td>321.629941</td>
<td>0.090258</td>
<td>0.578836</td>
<td>0.425372</td>
<td>1.819102</td>
<td>0.156509</td>
<td>0.077028</td>
<td>1.068965</td>
<td>1.024936</td>
<td>0.869475</td>
<td>0.254978</td>
<td>1.610297</td>
<td>0.250111</td>
<td>0.137277</td>
<td>16.731532</td>
<td>0.051212</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD2051</td>
<td>981.998269</td>
<td>30.613962</td>
<td>0.108551</td>
<td>0.203820</td>
<td>0.153981</td>
<td>0.381069</td>
<td>1.006911</td>
<td>0.224470</td>
<td>5414.244775</td>
<td>0.329013</td>
<td>0.246914</td>
<td>0.548890</td>
<td>0.136092</td>
<td>0.445265</td>
<td>0.982067</td>
<td>0.356461</td>
<td>0.224267</td>
<td>0.411815</td>
<td>0.409713</td>
<td>8.011823</td>
<td>6.523833</td>
<td>0.865934</td>
<td>0.303270</td>
<td>0.578873</td>
<td>3.542521</td>
<td>0.243556</td>
<td>0.195169</td>
<td>0.601565</td>
<td>0.118699</td>
<td>0.443842</td>
<td>0.664127</td>
<td>0.652462</td>
<td>0.186985</td>
<td>0.343790</td>
<td>0.454226</td>
<td>0.676521</td>
<td>0.373171</td>
<td>0.721193</td>
<td>0.127081</td>
<td>0.641012</td>
<td>0.370383</td>
<td>27152.510635</td>
<td>0.190402</td>
<td>11.868769</td>
<td>0.458520</td>
<td>0.315659</td>
<td>1.008921</td>
<td>3.841836</td>
<td>2244.476377</td>
<td>1.076200</td>
<td>0.337134</td>
<td>0.938680</td>
<td>2.393765</td>
<td>0.460769</td>
<td>2.551606</td>
<td>0.295670</td>
<td>22.464992</td>
<td>1097.787155</td>
<td>0.498145</td>
<td>1.218849</td>
<td>2.566537</td>
<td>0.345916</td>
<td>0.480823</td>
<td>0.300267</td>
<td>0.320139</td>
<td>0.633463</td>
<td>0.527452</td>
<td>0.233860</td>
<td>137.937731</td>
<td>4414.073314</td>
<td>0.340486</td>
<td>364.522610</td>
<td>2.859298</td>
<td>0.245141</td>
<td>3.402782</td>
<td>0.633811</td>
<td>0.270657</td>
<td>4.165678</td>
<td>0.762297</td>
<td>0.323145</td>
<td>0.299137</td>
<td>0.768023</td>
<td>0.391624</td>
<td>0.531725</td>
<td>0.138401</td>
<td>3482.816496</td>
<td>0.680047</td>
<td>0.371096</td>
<td>20.883572</td>
<td>130.820266</td>
<td>0.445898</td>
<td>0.888354</td>
<td>7.243767</td>
<td>11.605314</td>
<td>0.204388</td>
<td>0.101549</td>
<td>0.238539</td>
<td>0.828727</td>
<td>0.286975</td>
<td>382.209058</td>
<td>0.121923</td>
<td>0.419642</td>
<td>0.826385</td>
<td>2.765470</td>
<td>0.177455</td>
<td>0.080434</td>
<td>1.355215</td>
<td>1.131866</td>
<td>0.897136</td>
<td>0.327996</td>
<td>1.915564</td>
<td>0.269105</td>
<td>0.137169</td>
<td>14.143502</td>
<td>0.051287</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>Y_test_tf.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ESTIMATE</th>
<th data-quarto-table-cell-role="th">IMPRES</th>
<th data-quarto-table-cell-role="th">C_Bcellsnaive</th>
<th data-quarto-table-cell-role="th">C_TcellsCD4memoryresting</th>
<th data-quarto-table-cell-role="th">C_MacrophagesM2</th>
<th data-quarto-table-cell-role="th">S_Attractors_LYM</th>
<th data-quarto-table-cell-role="th">S_Attractors_IFIT3</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_GIMAP4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_HLA.DPA1</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SLAMF6</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_LILRB4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SIGLEC9</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CYTH4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CD3E</th>
<th data-quarto-table-cell-role="th">S_Lymph_Vessels</th>
<th data-quarto-table-cell-role="th">S_ICR_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_INHIB_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_ACT_SCORE</th>
<th data-quarto-table-cell-role="th">S_Angiogenesis</th>
<th data-quarto-table-cell-role="th">S_APM1</th>
<th data-quarto-table-cell-role="th">S_APM2</th>
<th data-quarto-table-cell-role="th">S_ICS5_score</th>
<th data-quarto-table-cell-role="th">S_LIexpression_score</th>
<th data-quarto-table-cell-role="th">S_Chemokine12_score</th>
<th data-quarto-table-cell-role="th">S_NHI_5gene_score</th>
<th data-quarto-table-cell-role="th">S_CD68</th>
<th data-quarto-table-cell-role="th">S_CD8A</th>
<th data-quarto-table-cell-role="th">S_PD1_data</th>
<th data-quarto-table-cell-role="th">S_PDL1_data</th>
<th data-quarto-table-cell-role="th">S_PD1_PDL1_score</th>
<th data-quarto-table-cell-role="th">S_CTLA4_data</th>
<th data-quarto-table-cell-role="th">S_Bcell_mg_IGJ</th>
<th data-quarto-table-cell-role="th">S_Bcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_STAT1_score</th>
<th data-quarto-table-cell-role="th">S_CSF1_response</th>
<th data-quarto-table-cell-role="th">S_TcClassII_score</th>
<th data-quarto-table-cell-role="th">S_IL12_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL4_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL2_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL13_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IFNG_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TGFB_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TREM1_data</th>
<th data-quarto-table-cell-role="th">S_DAP12_data</th>
<th data-quarto-table-cell-role="th">S_Tcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_IL8_21978456</th>
<th data-quarto-table-cell-role="th">S_IFN_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC1_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC2_21978456</th>
<th data-quarto-table-cell-role="th">S_Bcell_21978456</th>
<th data-quarto-table-cell-role="th">S_Tcell_21978456</th>
<th data-quarto-table-cell-role="th">S_CD103pos_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_CD103neg_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_IgG_19272155</th>
<th data-quarto-table-cell-role="th">S_Interferon_19272155</th>
<th data-quarto-table-cell-role="th">S_LCK_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.I_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.II_19272155</th>
<th data-quarto-table-cell-role="th">S_STAT1_19272155</th>
<th data-quarto-table-cell-role="th">S_Troester_WoundSig_19887484</th>
<th data-quarto-table-cell-role="th">S_MDACC.FNA.1_20805453</th>
<th data-quarto-table-cell-role="th">S_IGG_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Minterferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Immune_cell_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_MCD3_CD8_21214954</th>
<th data-quarto-table-cell-role="th">S_Interferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_B_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_CD8_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_GRANS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_LYMPHS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_T_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_TGFB_PCA_17349583</th>
<th data-quarto-table-cell-role="th">S_Rotterdam_ERneg_PCA_15721472</th>
<th data-quarto-table-cell-role="th">S_HER2_Immune_PCA_18006808</th>
<th data-quarto-table-cell-role="th">S_IR7_score</th>
<th data-quarto-table-cell-role="th">S_Buck14_score</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_score</th>
<th data-quarto-table-cell-role="th">S_Immune_NSCLC_score</th>
<th data-quarto-table-cell-role="th">S_Module3_IFN_score</th>
<th data-quarto-table-cell-role="th">S_Module4_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module5_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module11_Prolif_score</th>
<th data-quarto-table-cell-role="th">S_CD8_CD68_ratio</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_TcClassII_ratio</th>
<th data-quarto-table-cell-role="th">S_CHANG_CORE_SERUM_RESPONSE_UP</th>
<th data-quarto-table-cell-role="th">S_CSR_Activated_15701700</th>
<th data-quarto-table-cell-role="th">S_B_cells</th>
<th data-quarto-table-cell-role="th">S_T_cells</th>
<th data-quarto-table-cell-role="th">S_T_helper</th>
<th data-quarto-table-cell-role="th">S_Tcm</th>
<th data-quarto-table-cell-role="th">S_Tem</th>
<th data-quarto-table-cell-role="th">S_Th1</th>
<th data-quarto-table-cell-role="th">S_Th2</th>
<th data-quarto-table-cell-role="th">S_TFH</th>
<th data-quarto-table-cell-role="th">S_CD8_Tcells</th>
<th data-quarto-table-cell-role="th">S_Th17</th>
<th data-quarto-table-cell-role="th">S_Treg</th>
<th data-quarto-table-cell-role="th">S_Tgd</th>
<th data-quarto-table-cell-role="th">S_Cytotoxic_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cd56dim</th>
<th data-quarto-table-cell-role="th">S_NK_cd56bright</th>
<th data-quarto-table-cell-role="th">S_DC</th>
<th data-quarto-table-cell-role="th">S_iDC</th>
<th data-quarto-table-cell-role="th">S_aDC</th>
<th data-quarto-table-cell-role="th">S_pDC</th>
<th data-quarto-table-cell-role="th">S_Eosinophils</th>
<th data-quarto-table-cell-role="th">S_Macrophages</th>
<th data-quarto-table-cell-role="th">S_Mast</th>
<th data-quarto-table-cell-role="th">S_Neutrophils</th>
<th data-quarto-table-cell-role="th">S_Bindea_full</th>
<th data-quarto-table-cell-role="th">S_Expanded_IFNg</th>
<th data-quarto-table-cell-role="th">S_KEGG_MMR</th>
<th data-quarto-table-cell-role="th">S_KEGG_TGF_Beta</th>
<th data-quarto-table-cell-role="th">S_KEGG_Cytosolic_DNA_Sensing</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD1380</td>
<td>1023.916679</td>
<td>30.613962</td>
<td>0.092577</td>
<td>0.342959</td>
<td>0.099920</td>
<td>0.384818</td>
<td>1.702834</td>
<td>0.237654</td>
<td>4795.351624</td>
<td>0.341714</td>
<td>0.248340</td>
<td>0.369829</td>
<td>0.134197</td>
<td>0.490209</td>
<td>0.672956</td>
<td>0.409710</td>
<td>0.247340</td>
<td>0.479951</td>
<td>0.367378</td>
<td>8.428829</td>
<td>5.895400</td>
<td>0.936281</td>
<td>0.301062</td>
<td>0.625975</td>
<td>3.481460</td>
<td>0.233421</td>
<td>0.209465</td>
<td>0.517834</td>
<td>0.123669</td>
<td>0.457063</td>
<td>0.804408</td>
<td>0.482402</td>
<td>0.180611</td>
<td>0.373800</td>
<td>0.452893</td>
<td>0.690065</td>
<td>0.381927</td>
<td>0.668234</td>
<td>0.127028</td>
<td>0.548924</td>
<td>0.380389</td>
<td>15837.245216</td>
<td>0.180534</td>
<td>12.188452</td>
<td>0.514326</td>
<td>0.220339</td>
<td>1.733634</td>
<td>4.248295</td>
<td>2282.063806</td>
<td>0.745649</td>
<td>0.350999</td>
<td>0.924174</td>
<td>2.271445</td>
<td>0.307462</td>
<td>5.302274</td>
<td>0.304826</td>
<td>27.414350</td>
<td>1068.217523</td>
<td>0.610742</td>
<td>1.020580</td>
<td>2.318504</td>
<td>0.293166</td>
<td>0.575028</td>
<td>0.309534</td>
<td>0.320280</td>
<td>0.820930</td>
<td>0.521732</td>
<td>0.279969</td>
<td>124.404797</td>
<td>4579.721998</td>
<td>0.350039</td>
<td>299.996479</td>
<td>3.839802</td>
<td>0.245267</td>
<td>3.668088</td>
<td>0.504703</td>
<td>0.333922</td>
<td>3.919264</td>
<td>1.121690</td>
<td>0.334963</td>
<td>0.315968</td>
<td>0.832628</td>
<td>0.455430</td>
<td>0.562429</td>
<td>0.138504</td>
<td>3219.645021</td>
<td>0.588012</td>
<td>0.389851</td>
<td>25.087845</td>
<td>255.716927</td>
<td>0.448903</td>
<td>0.882597</td>
<td>8.738870</td>
<td>11.883256</td>
<td>0.203291</td>
<td>0.112443</td>
<td>0.243313</td>
<td>1.314332</td>
<td>0.328604</td>
<td>292.814082</td>
<td>0.146989</td>
<td>0.517526</td>
<td>0.602154</td>
<td>1.991400</td>
<td>0.183042</td>
<td>0.080036</td>
<td>1.032973</td>
<td>0.955727</td>
<td>0.728888</td>
<td>0.284209</td>
<td>1.814148</td>
<td>0.285630</td>
<td>0.138185</td>
<td>12.986687</td>
<td>0.051319</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD2265</td>
<td>899.222980</td>
<td>27.073805</td>
<td>0.151838</td>
<td>0.261540</td>
<td>0.137161</td>
<td>0.357219</td>
<td>1.635169</td>
<td>0.233181</td>
<td>4194.386877</td>
<td>0.308480</td>
<td>0.224797</td>
<td>0.415292</td>
<td>0.130807</td>
<td>0.412194</td>
<td>0.894491</td>
<td>0.346039</td>
<td>0.225661</td>
<td>0.394274</td>
<td>0.439258</td>
<td>8.165961</td>
<td>4.940760</td>
<td>0.902511</td>
<td>0.279780</td>
<td>0.604891</td>
<td>4.015875</td>
<td>0.162799</td>
<td>0.190331</td>
<td>0.431390</td>
<td>0.121928</td>
<td>0.410333</td>
<td>0.649545</td>
<td>0.502739</td>
<td>0.180402</td>
<td>0.354639</td>
<td>0.438141</td>
<td>0.614030</td>
<td>0.356896</td>
<td>0.693582</td>
<td>0.126151</td>
<td>0.561227</td>
<td>0.378866</td>
<td>27870.564803</td>
<td>0.248753</td>
<td>8.563503</td>
<td>0.415774</td>
<td>0.319594</td>
<td>1.577961</td>
<td>3.879703</td>
<td>1686.623292</td>
<td>0.821953</td>
<td>0.324977</td>
<td>0.837935</td>
<td>2.064351</td>
<td>0.393148</td>
<td>4.988745</td>
<td>0.284144</td>
<td>23.932263</td>
<td>1025.293378</td>
<td>0.565700</td>
<td>1.260041</td>
<td>2.202385</td>
<td>0.271711</td>
<td>0.563559</td>
<td>0.295196</td>
<td>0.330177</td>
<td>0.790813</td>
<td>0.538601</td>
<td>0.236717</td>
<td>136.395358</td>
<td>4353.465391</td>
<td>0.341672</td>
<td>344.279804</td>
<td>3.510272</td>
<td>0.241583</td>
<td>3.212464</td>
<td>0.661680</td>
<td>0.301731</td>
<td>4.029964</td>
<td>1.080625</td>
<td>0.309036</td>
<td>0.293925</td>
<td>0.764512</td>
<td>0.338311</td>
<td>0.504282</td>
<td>0.138289</td>
<td>3704.751106</td>
<td>0.638888</td>
<td>0.353134</td>
<td>25.624522</td>
<td>282.827223</td>
<td>0.435350</td>
<td>0.940820</td>
<td>8.289089</td>
<td>11.460658</td>
<td>0.201480</td>
<td>0.101442</td>
<td>0.226326</td>
<td>0.752309</td>
<td>0.278678</td>
<td>300.678081</td>
<td>0.118268</td>
<td>0.496133</td>
<td>0.550333</td>
<td>2.004112</td>
<td>0.173923</td>
<td>0.079793</td>
<td>1.016682</td>
<td>1.131866</td>
<td>0.658853</td>
<td>0.293007</td>
<td>1.763027</td>
<td>0.262251</td>
<td>0.135849</td>
<td>17.598645</td>
<td>0.051126</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0946</td>
<td>1053.730798</td>
<td>23.678400</td>
<td>0.099900</td>
<td>0.246297</td>
<td>0.118742</td>
<td>0.390676</td>
<td>1.950585</td>
<td>0.236538</td>
<td>5990.298235</td>
<td>0.351092</td>
<td>0.259442</td>
<td>0.546076</td>
<td>0.135963</td>
<td>0.460241</td>
<td>0.896461</td>
<td>0.397457</td>
<td>0.244375</td>
<td>0.462365</td>
<td>0.405379</td>
<td>9.206105</td>
<td>4.751578</td>
<td>1.201915</td>
<td>0.304605</td>
<td>0.682124</td>
<td>6.137687</td>
<td>0.300826</td>
<td>0.211774</td>
<td>0.598032</td>
<td>0.127962</td>
<td>0.532604</td>
<td>0.632680</td>
<td>0.832511</td>
<td>0.187110</td>
<td>0.386928</td>
<td>0.478276</td>
<td>0.637636</td>
<td>0.384266</td>
<td>0.676057</td>
<td>0.127112</td>
<td>0.562747</td>
<td>0.390609</td>
<td>28607.091344</td>
<td>0.214033</td>
<td>12.462629</td>
<td>0.462884</td>
<td>0.243133</td>
<td>1.936091</td>
<td>4.357288</td>
<td>2277.857658</td>
<td>1.432838</td>
<td>0.343857</td>
<td>0.965817</td>
<td>3.071075</td>
<td>0.652933</td>
<td>6.150994</td>
<td>0.296820</td>
<td>28.411533</td>
<td>1205.548966</td>
<td>0.641389</td>
<td>1.334105</td>
<td>3.005885</td>
<td>0.384525</td>
<td>0.632389</td>
<td>0.311146</td>
<td>0.340865</td>
<td>0.896157</td>
<td>0.557506</td>
<td>0.263472</td>
<td>154.024555</td>
<td>3843.099506</td>
<td>0.345225</td>
<td>345.971804</td>
<td>4.098547</td>
<td>0.250615</td>
<td>4.574187</td>
<td>0.771911</td>
<td>0.356351</td>
<td>5.157358</td>
<td>1.273291</td>
<td>0.333817</td>
<td>0.328366</td>
<td>0.804066</td>
<td>0.495825</td>
<td>0.539343</td>
<td>0.138201</td>
<td>3661.032175</td>
<td>0.746980</td>
<td>0.373970</td>
<td>23.568224</td>
<td>245.177027</td>
<td>0.450910</td>
<td>1.037689</td>
<td>8.268704</td>
<td>12.252258</td>
<td>0.204143</td>
<td>0.104756</td>
<td>0.240820</td>
<td>1.361565</td>
<td>0.305240</td>
<td>303.588132</td>
<td>0.106766</td>
<td>0.415343</td>
<td>0.587433</td>
<td>1.999337</td>
<td>0.186551</td>
<td>0.079132</td>
<td>1.020059</td>
<td>1.301460</td>
<td>0.741470</td>
<td>0.337985</td>
<td>1.926435</td>
<td>0.281945</td>
<td>0.136919</td>
<td>16.176046</td>
<td>0.051326</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD1225</td>
<td>764.152781</td>
<td>23.678400</td>
<td>0.090577</td>
<td>0.183488</td>
<td>0.206813</td>
<td>0.339928</td>
<td>1.715964</td>
<td>0.212831</td>
<td>3543.148859</td>
<td>0.293851</td>
<td>0.238569</td>
<td>0.472309</td>
<td>0.126464</td>
<td>0.360444</td>
<td>0.967406</td>
<td>0.339573</td>
<td>0.215218</td>
<td>0.391516</td>
<td>0.375563</td>
<td>9.249519</td>
<td>5.650443</td>
<td>0.821246</td>
<td>0.250706</td>
<td>0.620375</td>
<td>3.728501</td>
<td>-0.111466</td>
<td>0.191915</td>
<td>0.306848</td>
<td>0.119199</td>
<td>0.341328</td>
<td>0.440410</td>
<td>0.669011</td>
<td>0.173062</td>
<td>0.356544</td>
<td>0.430172</td>
<td>0.615177</td>
<td>0.330580</td>
<td>0.595066</td>
<td>0.124931</td>
<td>0.518203</td>
<td>0.386476</td>
<td>21963.407988</td>
<td>0.236618</td>
<td>11.155658</td>
<td>0.362312</td>
<td>0.271897</td>
<td>1.728648</td>
<td>4.289681</td>
<td>1928.402891</td>
<td>0.950218</td>
<td>0.263879</td>
<td>0.636916</td>
<td>2.295156</td>
<td>0.445777</td>
<td>5.227843</td>
<td>0.257111</td>
<td>28.316624</td>
<td>820.100720</td>
<td>0.609108</td>
<td>1.152990</td>
<td>2.226158</td>
<td>0.252436</td>
<td>0.556613</td>
<td>0.288772</td>
<td>0.305552</td>
<td>0.821214</td>
<td>0.500145</td>
<td>0.226373</td>
<td>139.235831</td>
<td>4062.328982</td>
<td>0.322195</td>
<td>363.928742</td>
<td>3.667651</td>
<td>0.237051</td>
<td>3.594238</td>
<td>0.548759</td>
<td>0.343141</td>
<td>4.365478</td>
<td>1.150413</td>
<td>0.268966</td>
<td>0.290130</td>
<td>0.878217</td>
<td>0.140333</td>
<td>0.520117</td>
<td>0.139083</td>
<td>3713.555476</td>
<td>0.457425</td>
<td>0.308483</td>
<td>18.465635</td>
<td>144.724931</td>
<td>0.395336</td>
<td>0.960421</td>
<td>5.944716</td>
<td>8.279410</td>
<td>0.197429</td>
<td>0.108368</td>
<td>0.211681</td>
<td>0.885734</td>
<td>0.257904</td>
<td>266.506218</td>
<td>0.131798</td>
<td>0.328153</td>
<td>0.503371</td>
<td>1.702215</td>
<td>0.157910</td>
<td>0.079132</td>
<td>0.635782</td>
<td>1.137617</td>
<td>0.488042</td>
<td>0.300270</td>
<td>1.455453</td>
<td>0.261076</td>
<td>0.136895</td>
<td>14.716017</td>
<td>0.051300</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD1164</td>
<td>973.613493</td>
<td>30.613962</td>
<td>0.108028</td>
<td>0.308614</td>
<td>0.129578</td>
<td>0.380333</td>
<td>1.662301</td>
<td>0.231905</td>
<td>5371.401233</td>
<td>0.326058</td>
<td>0.239356</td>
<td>0.340854</td>
<td>0.134275</td>
<td>0.438004</td>
<td>0.804854</td>
<td>0.375546</td>
<td>0.220409</td>
<td>0.445578</td>
<td>0.421970</td>
<td>9.134157</td>
<td>6.508070</td>
<td>0.920112</td>
<td>0.286716</td>
<td>0.636633</td>
<td>5.091528</td>
<td>-0.119025</td>
<td>0.214408</td>
<td>0.609386</td>
<td>0.122246</td>
<td>0.474919</td>
<td>0.510234</td>
<td>0.579445</td>
<td>0.179841</td>
<td>0.361560</td>
<td>0.453559</td>
<td>0.678930</td>
<td>0.371307</td>
<td>0.720940</td>
<td>0.126745</td>
<td>0.499134</td>
<td>0.380051</td>
<td>30373.737625</td>
<td>0.118550</td>
<td>11.330163</td>
<td>0.436866</td>
<td>0.233191</td>
<td>1.617005</td>
<td>3.406982</td>
<td>2567.398844</td>
<td>0.968414</td>
<td>0.325596</td>
<td>0.841158</td>
<td>2.538915</td>
<td>0.413114</td>
<td>5.052973</td>
<td>0.284790</td>
<td>17.842335</td>
<td>1124.304285</td>
<td>0.607639</td>
<td>1.325583</td>
<td>2.420941</td>
<td>0.314667</td>
<td>0.584230</td>
<td>0.301025</td>
<td>0.305982</td>
<td>0.790256</td>
<td>0.532117</td>
<td>0.262787</td>
<td>142.933259</td>
<td>3422.602817</td>
<td>0.342010</td>
<td>334.293064</td>
<td>4.094107</td>
<td>0.242648</td>
<td>3.801344</td>
<td>0.537356</td>
<td>0.320875</td>
<td>3.864961</td>
<td>1.097016</td>
<td>0.310828</td>
<td>0.302479</td>
<td>0.728930</td>
<td>0.214212</td>
<td>0.550758</td>
<td>0.137120</td>
<td>3507.750526</td>
<td>0.590590</td>
<td>0.348889</td>
<td>20.246666</td>
<td>224.865053</td>
<td>0.443041</td>
<td>0.921531</td>
<td>5.165497</td>
<td>10.868398</td>
<td>0.202320</td>
<td>0.112542</td>
<td>0.223597</td>
<td>0.909455</td>
<td>0.297276</td>
<td>349.814943</td>
<td>0.133814</td>
<td>0.399446</td>
<td>0.443396</td>
<td>1.734333</td>
<td>0.166073</td>
<td>0.079280</td>
<td>0.888490</td>
<td>1.002629</td>
<td>0.746665</td>
<td>0.296151</td>
<td>1.658985</td>
<td>0.272334</td>
<td>0.136076</td>
<td>15.462445</td>
<td>0.051162</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Then, apply z-score standardization.</p>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> zscore</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply Z-score normalization to Yeo-Johnson transformed columns</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> X_vars_to_transform:</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    X_train_tf[col] <span class="op">=</span> zscore(X_train_tf[col])</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    X_test_tf[col] <span class="op">=</span> zscore(X_test_tf[col])</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>X_train_tfz <span class="op">=</span> X_train_tf.copy()</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>X_test_tfz <span class="op">=</span> X_test_tf.copy()</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="co"># using lambda function to apply z-score to each column</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>zs <span class="op">=</span> <span class="kw">lambda</span> x : zscore(x)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>Y_train_tfz <span class="op">=</span> Y_train_tf.<span class="bu">apply</span>(zs)</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>Y_test_tfz <span class="op">=</span> Y_test_tf.<span class="bu">apply</span>(zs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>X_train_tfz.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Stage</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionTransscript_Count</th>
<th data-quarto-table-cell-role="th">FN/FT_Ratio</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0356</td>
<td>45</td>
<td>2</td>
<td>2.0</td>
<td>0.716810</td>
<td>-0.319390</td>
<td>-0.684516</td>
<td>0.564466</td>
<td>1.985853</td>
<td>-0.905162</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0247</td>
<td>22</td>
<td>2</td>
<td>3.0</td>
<td>-1.387736</td>
<td>0.283627</td>
<td>0.183853</td>
<td>0.158183</td>
<td>-0.825651</td>
<td>-0.165050</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0128</td>
<td>61</td>
<td>3</td>
<td>3.0</td>
<td>2.054170</td>
<td>0.376734</td>
<td>0.211218</td>
<td>0.305091</td>
<td>1.709684</td>
<td>-1.704444</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0848</td>
<td>65</td>
<td>2</td>
<td>2.0</td>
<td>-0.199553</td>
<td>-1.036828</td>
<td>-0.022264</td>
<td>-1.825239</td>
<td>-0.085773</td>
<td>-0.324037</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD2051</td>
<td>35</td>
<td>3</td>
<td>3.0</td>
<td>-2.057277</td>
<td>-1.036828</td>
<td>-0.022264</td>
<td>-1.825239</td>
<td>-1.964948</td>
<td>-0.324037</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>X_test_tfz.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Stage</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionTransscript_Count</th>
<th data-quarto-table-cell-role="th">FN/FT_Ratio</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD1380</td>
<td>45</td>
<td>2</td>
<td>2.0</td>
<td>0.142567</td>
<td>1.432089</td>
<td>1.742520</td>
<td>0.033581</td>
<td>1.711317</td>
<td>-1.084667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD2265</td>
<td>72</td>
<td>2</td>
<td>2.0</td>
<td>-0.219642</td>
<td>-0.069470</td>
<td>-0.656690</td>
<td>1.254476</td>
<td>0.513889</td>
<td>0.533373</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0946</td>
<td>54</td>
<td>3</td>
<td>3.0</td>
<td>0.142567</td>
<td>2.608023</td>
<td>1.226495</td>
<td>3.705055</td>
<td>-1.460990</td>
<td>1.665641</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD1225</td>
<td>57</td>
<td>2</td>
<td>3.0</td>
<td>0.142567</td>
<td>0.597229</td>
<td>0.357106</td>
<td>0.662757</td>
<td>0.604381</td>
<td>-0.091595</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD1164</td>
<td>50</td>
<td>3</td>
<td>3.0</td>
<td>0.142567</td>
<td>-0.617638</td>
<td>0.222996</td>
<td>-1.558147</td>
<td>-1.521213</td>
<td>0.190672</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>Y_train_tfz.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ESTIMATE</th>
<th data-quarto-table-cell-role="th">IMPRES</th>
<th data-quarto-table-cell-role="th">C_Bcellsnaive</th>
<th data-quarto-table-cell-role="th">C_TcellsCD4memoryresting</th>
<th data-quarto-table-cell-role="th">C_MacrophagesM2</th>
<th data-quarto-table-cell-role="th">S_Attractors_LYM</th>
<th data-quarto-table-cell-role="th">S_Attractors_IFIT3</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_GIMAP4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_HLA.DPA1</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SLAMF6</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_LILRB4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SIGLEC9</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CYTH4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CD3E</th>
<th data-quarto-table-cell-role="th">S_Lymph_Vessels</th>
<th data-quarto-table-cell-role="th">S_ICR_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_INHIB_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_ACT_SCORE</th>
<th data-quarto-table-cell-role="th">S_Angiogenesis</th>
<th data-quarto-table-cell-role="th">S_APM1</th>
<th data-quarto-table-cell-role="th">S_APM2</th>
<th data-quarto-table-cell-role="th">S_ICS5_score</th>
<th data-quarto-table-cell-role="th">S_LIexpression_score</th>
<th data-quarto-table-cell-role="th">S_Chemokine12_score</th>
<th data-quarto-table-cell-role="th">S_NHI_5gene_score</th>
<th data-quarto-table-cell-role="th">S_CD68</th>
<th data-quarto-table-cell-role="th">S_CD8A</th>
<th data-quarto-table-cell-role="th">S_PD1_data</th>
<th data-quarto-table-cell-role="th">S_PDL1_data</th>
<th data-quarto-table-cell-role="th">S_PD1_PDL1_score</th>
<th data-quarto-table-cell-role="th">S_CTLA4_data</th>
<th data-quarto-table-cell-role="th">S_Bcell_mg_IGJ</th>
<th data-quarto-table-cell-role="th">S_Bcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_STAT1_score</th>
<th data-quarto-table-cell-role="th">S_CSF1_response</th>
<th data-quarto-table-cell-role="th">S_TcClassII_score</th>
<th data-quarto-table-cell-role="th">S_IL12_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL4_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL2_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL13_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IFNG_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TGFB_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TREM1_data</th>
<th data-quarto-table-cell-role="th">S_DAP12_data</th>
<th data-quarto-table-cell-role="th">S_Tcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_IL8_21978456</th>
<th data-quarto-table-cell-role="th">S_IFN_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC1_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC2_21978456</th>
<th data-quarto-table-cell-role="th">S_Bcell_21978456</th>
<th data-quarto-table-cell-role="th">S_Tcell_21978456</th>
<th data-quarto-table-cell-role="th">S_CD103pos_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_CD103neg_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_IgG_19272155</th>
<th data-quarto-table-cell-role="th">S_Interferon_19272155</th>
<th data-quarto-table-cell-role="th">S_LCK_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.I_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.II_19272155</th>
<th data-quarto-table-cell-role="th">S_STAT1_19272155</th>
<th data-quarto-table-cell-role="th">S_Troester_WoundSig_19887484</th>
<th data-quarto-table-cell-role="th">S_MDACC.FNA.1_20805453</th>
<th data-quarto-table-cell-role="th">S_IGG_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Minterferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Immune_cell_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_MCD3_CD8_21214954</th>
<th data-quarto-table-cell-role="th">S_Interferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_B_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_CD8_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_GRANS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_LYMPHS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_T_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_TGFB_PCA_17349583</th>
<th data-quarto-table-cell-role="th">S_Rotterdam_ERneg_PCA_15721472</th>
<th data-quarto-table-cell-role="th">S_HER2_Immune_PCA_18006808</th>
<th data-quarto-table-cell-role="th">S_IR7_score</th>
<th data-quarto-table-cell-role="th">S_Buck14_score</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_score</th>
<th data-quarto-table-cell-role="th">S_Immune_NSCLC_score</th>
<th data-quarto-table-cell-role="th">S_Module3_IFN_score</th>
<th data-quarto-table-cell-role="th">S_Module4_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module5_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module11_Prolif_score</th>
<th data-quarto-table-cell-role="th">S_CD8_CD68_ratio</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_TcClassII_ratio</th>
<th data-quarto-table-cell-role="th">S_CHANG_CORE_SERUM_RESPONSE_UP</th>
<th data-quarto-table-cell-role="th">S_CSR_Activated_15701700</th>
<th data-quarto-table-cell-role="th">S_B_cells</th>
<th data-quarto-table-cell-role="th">S_T_cells</th>
<th data-quarto-table-cell-role="th">S_T_helper</th>
<th data-quarto-table-cell-role="th">S_Tcm</th>
<th data-quarto-table-cell-role="th">S_Tem</th>
<th data-quarto-table-cell-role="th">S_Th1</th>
<th data-quarto-table-cell-role="th">S_Th2</th>
<th data-quarto-table-cell-role="th">S_TFH</th>
<th data-quarto-table-cell-role="th">S_CD8_Tcells</th>
<th data-quarto-table-cell-role="th">S_Th17</th>
<th data-quarto-table-cell-role="th">S_Treg</th>
<th data-quarto-table-cell-role="th">S_Tgd</th>
<th data-quarto-table-cell-role="th">S_Cytotoxic_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cd56dim</th>
<th data-quarto-table-cell-role="th">S_NK_cd56bright</th>
<th data-quarto-table-cell-role="th">S_DC</th>
<th data-quarto-table-cell-role="th">S_iDC</th>
<th data-quarto-table-cell-role="th">S_aDC</th>
<th data-quarto-table-cell-role="th">S_pDC</th>
<th data-quarto-table-cell-role="th">S_Eosinophils</th>
<th data-quarto-table-cell-role="th">S_Macrophages</th>
<th data-quarto-table-cell-role="th">S_Mast</th>
<th data-quarto-table-cell-role="th">S_Neutrophils</th>
<th data-quarto-table-cell-role="th">S_Bindea_full</th>
<th data-quarto-table-cell-role="th">S_Expanded_IFNg</th>
<th data-quarto-table-cell-role="th">S_KEGG_MMR</th>
<th data-quarto-table-cell-role="th">S_KEGG_TGF_Beta</th>
<th data-quarto-table-cell-role="th">S_KEGG_Cytosolic_DNA_Sensing</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0356</td>
<td>1.253487</td>
<td>2.311773</td>
<td>0.511778</td>
<td>-1.412522</td>
<td>-0.797344</td>
<td>1.261913</td>
<td>0.483852</td>
<td>0.907942</td>
<td>1.650720</td>
<td>1.414544</td>
<td>1.843919</td>
<td>1.921385</td>
<td>1.410108</td>
<td>1.647650</td>
<td>0.468151</td>
<td>1.950793</td>
<td>1.935431</td>
<td>1.935610</td>
<td>-1.468399</td>
<td>1.326895</td>
<td>2.069165</td>
<td>1.575164</td>
<td>1.346903</td>
<td>1.881403</td>
<td>1.628240</td>
<td>0.680361</td>
<td>1.513518</td>
<td>1.773705</td>
<td>2.771608</td>
<td>2.939472</td>
<td>1.369364</td>
<td>1.064564</td>
<td>1.299453</td>
<td>1.419821</td>
<td>1.291821</td>
<td>1.961122</td>
<td>1.240100</td>
<td>0.087180</td>
<td>0.864215</td>
<td>-0.675797</td>
<td>1.620054</td>
<td>-0.618990</td>
<td>1.307400</td>
<td>1.628473</td>
<td>1.669753</td>
<td>0.326855</td>
<td>0.788214</td>
<td>1.669740</td>
<td>1.971674</td>
<td>0.735719</td>
<td>1.221593</td>
<td>0.509711</td>
<td>0.377073</td>
<td>1.069399</td>
<td>0.624576</td>
<td>1.117972</td>
<td>1.754449</td>
<td>1.020711</td>
<td>1.487096</td>
<td>-0.383558</td>
<td>1.087018</td>
<td>0.497267</td>
<td>1.373449</td>
<td>1.459461</td>
<td>-0.875007</td>
<td>0.913181</td>
<td>0.455473</td>
<td>1.534195</td>
<td>0.899971</td>
<td>1.214908</td>
<td>1.050903</td>
<td>-0.361498</td>
<td>-2.240998</td>
<td>1.353779</td>
<td>1.745729</td>
<td>1.333452</td>
<td>1.395907</td>
<td>-0.200277</td>
<td>0.682137</td>
<td>1.178490</td>
<td>1.527771</td>
<td>0.558954</td>
<td>1.466953</td>
<td>1.904480</td>
<td>1.379314</td>
<td>0.272089</td>
<td>0.122607</td>
<td>1.370748</td>
<td>0.073507</td>
<td>-1.181168</td>
<td>-0.934761</td>
<td>1.600633</td>
<td>0.121203</td>
<td>0.674721</td>
<td>0.350293</td>
<td>-0.314628</td>
<td>1.084829</td>
<td>0.852767</td>
<td>1.766290</td>
<td>0.136233</td>
<td>1.771103</td>
<td>-0.263756</td>
<td>1.260933</td>
<td>1.551737</td>
<td>0.127691</td>
<td>1.071034</td>
<td>-0.321574</td>
<td>0.982698</td>
<td>-0.320929</td>
<td>1.354025</td>
<td>0.964177</td>
<td>1.769044</td>
<td>1.269761</td>
<td>-1.628330</td>
<td>1.660424</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0247</td>
<td>-0.238091</td>
<td>-1.456199</td>
<td>-0.544449</td>
<td>0.035999</td>
<td>1.444420</td>
<td>-0.190700</td>
<td>1.081277</td>
<td>-0.596123</td>
<td>0.345097</td>
<td>-0.289447</td>
<td>0.787092</td>
<td>1.067716</td>
<td>-0.489532</td>
<td>-0.380148</td>
<td>0.623113</td>
<td>-0.223479</td>
<td>0.031379</td>
<td>-0.284098</td>
<td>-0.534859</td>
<td>0.022405</td>
<td>-0.079591</td>
<td>-0.322662</td>
<td>-0.490490</td>
<td>-0.346705</td>
<td>0.434342</td>
<td>0.665947</td>
<td>-0.618225</td>
<td>-0.451572</td>
<td>0.367621</td>
<td>-0.162117</td>
<td>0.076415</td>
<td>0.367220</td>
<td>-0.277316</td>
<td>0.157748</td>
<td>0.275220</td>
<td>-0.336461</td>
<td>-0.009796</td>
<td>0.063490</td>
<td>-0.928168</td>
<td>-0.514303</td>
<td>0.044850</td>
<td>0.578242</td>
<td>1.339932</td>
<td>0.160794</td>
<td>-0.353604</td>
<td>-0.000847</td>
<td>1.005009</td>
<td>-0.191272</td>
<td>0.272722</td>
<td>-0.281597</td>
<td>0.229216</td>
<td>-0.416150</td>
<td>0.751120</td>
<td>-0.250469</td>
<td>1.143212</td>
<td>-0.142820</td>
<td>-0.017288</td>
<td>0.421643</td>
<td>0.242086</td>
<td>0.143875</td>
<td>0.197411</td>
<td>-0.841717</td>
<td>0.580989</td>
<td>-0.051308</td>
<td>-0.180327</td>
<td>0.965254</td>
<td>0.061177</td>
<td>-0.852856</td>
<td>0.320004</td>
<td>-1.008395</td>
<td>-0.472443</td>
<td>0.261178</td>
<td>0.117839</td>
<td>-0.173003</td>
<td>-0.099246</td>
<td>-0.243952</td>
<td>0.293178</td>
<td>-1.019328</td>
<td>1.077966</td>
<td>-0.388629</td>
<td>-0.095003</td>
<td>1.338400</td>
<td>0.054789</td>
<td>-0.205671</td>
<td>0.455067</td>
<td>0.457719</td>
<td>-0.206445</td>
<td>-0.365640</td>
<td>0.270460</td>
<td>1.524677</td>
<td>-0.518507</td>
<td>0.471070</td>
<td>0.918425</td>
<td>-0.286557</td>
<td>-1.005075</td>
<td>-0.208450</td>
<td>0.065052</td>
<td>-1.136532</td>
<td>-0.871534</td>
<td>-0.751502</td>
<td>1.083981</td>
<td>0.407152</td>
<td>-0.599837</td>
<td>-1.114364</td>
<td>-0.407128</td>
<td>-1.389215</td>
<td>-0.420385</td>
<td>0.832864</td>
<td>0.118579</td>
<td>-0.413131</td>
<td>-0.148745</td>
<td>-0.406038</td>
<td>1.239073</td>
<td>0.319269</td>
<td>-0.381366</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0128</td>
<td>0.706732</td>
<td>1.493624</td>
<td>-0.618239</td>
<td>-1.083701</td>
<td>-0.959753</td>
<td>0.712696</td>
<td>0.495916</td>
<td>0.295448</td>
<td>1.220734</td>
<td>0.812812</td>
<td>1.255207</td>
<td>-0.611352</td>
<td>0.705010</td>
<td>0.882752</td>
<td>-1.273636</td>
<td>1.302987</td>
<td>1.402978</td>
<td>1.261477</td>
<td>-1.984816</td>
<td>1.227682</td>
<td>-0.096440</td>
<td>0.940496</td>
<td>0.628007</td>
<td>0.765724</td>
<td>0.416120</td>
<td>0.707568</td>
<td>1.295276</td>
<td>1.392706</td>
<td>1.999420</td>
<td>1.911225</td>
<td>0.911814</td>
<td>1.572607</td>
<td>0.352402</td>
<td>1.181437</td>
<td>0.666246</td>
<td>1.200325</td>
<td>1.067511</td>
<td>0.259471</td>
<td>0.972812</td>
<td>-0.522023</td>
<td>2.237345</td>
<td>-1.489350</td>
<td>0.178361</td>
<td>0.992329</td>
<td>0.876409</td>
<td>0.902106</td>
<td>0.603258</td>
<td>1.119614</td>
<td>0.036731</td>
<td>1.041171</td>
<td>0.721863</td>
<td>0.178015</td>
<td>-0.257391</td>
<td>1.055378</td>
<td>0.482597</td>
<td>0.771329</td>
<td>0.896699</td>
<td>0.847335</td>
<td>1.201330</td>
<td>-1.048455</td>
<td>1.397574</td>
<td>1.063858</td>
<td>1.020014</td>
<td>0.905225</td>
<td>-1.875288</td>
<td>0.761144</td>
<td>-0.103963</td>
<td>0.898406</td>
<td>0.097484</td>
<td>-0.166112</td>
<td>0.394687</td>
<td>-1.858987</td>
<td>-1.922579</td>
<td>0.622117</td>
<td>0.989723</td>
<td>0.511905</td>
<td>1.452111</td>
<td>-0.377405</td>
<td>0.795983</td>
<td>0.597472</td>
<td>1.124434</td>
<td>2.257038</td>
<td>1.290675</td>
<td>1.328458</td>
<td>1.942487</td>
<td>0.313007</td>
<td>0.632754</td>
<td>0.822127</td>
<td>-0.698274</td>
<td>-1.224899</td>
<td>1.207786</td>
<td>0.773495</td>
<td>0.786253</td>
<td>0.123728</td>
<td>-0.509717</td>
<td>0.926489</td>
<td>0.866220</td>
<td>0.770654</td>
<td>0.519069</td>
<td>0.100919</td>
<td>1.139955</td>
<td>-1.347404</td>
<td>0.420041</td>
<td>-1.202234</td>
<td>0.291177</td>
<td>-0.187852</td>
<td>-0.884854</td>
<td>1.065706</td>
<td>-1.462287</td>
<td>0.056225</td>
<td>0.125867</td>
<td>1.396961</td>
<td>1.384266</td>
<td>-2.071173</td>
<td>2.775021</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0848</td>
<td>0.025725</td>
<td>-0.770049</td>
<td>-0.424227</td>
<td>-0.327295</td>
<td>-0.628794</td>
<td>0.007656</td>
<td>1.346836</td>
<td>0.073737</td>
<td>-0.369861</td>
<td>0.230966</td>
<td>-0.487913</td>
<td>0.382969</td>
<td>0.068745</td>
<td>0.136122</td>
<td>-0.155739</td>
<td>0.133797</td>
<td>-0.171365</td>
<td>0.200267</td>
<td>0.180447</td>
<td>0.385590</td>
<td>-0.126611</td>
<td>0.121204</td>
<td>0.172682</td>
<td>0.090369</td>
<td>-0.157517</td>
<td>-0.916210</td>
<td>0.292789</td>
<td>-0.241148</td>
<td>-0.202916</td>
<td>-0.248116</td>
<td>-0.242100</td>
<td>1.482376</td>
<td>0.212548</td>
<td>0.520497</td>
<td>-0.114854</td>
<td>0.114838</td>
<td>-0.034532</td>
<td>-1.035771</td>
<td>0.479629</td>
<td>-1.323918</td>
<td>0.707994</td>
<td>0.259516</td>
<td>-0.978969</td>
<td>-0.692164</td>
<td>0.184569</td>
<td>-0.122205</td>
<td>1.075142</td>
<td>0.169211</td>
<td>-0.249266</td>
<td>0.091307</td>
<td>0.377837</td>
<td>0.134130</td>
<td>-0.458613</td>
<td>0.680994</td>
<td>1.458199</td>
<td>0.228064</td>
<td>0.861691</td>
<td>-0.060375</td>
<td>0.373753</td>
<td>0.222772</td>
<td>0.627284</td>
<td>0.711727</td>
<td>0.989632</td>
<td>0.058465</td>
<td>1.098047</td>
<td>1.241290</td>
<td>0.386085</td>
<td>0.143420</td>
<td>-0.130780</td>
<td>0.710312</td>
<td>0.006734</td>
<td>0.095601</td>
<td>1.410292</td>
<td>0.235346</td>
<td>0.118072</td>
<td>-0.210805</td>
<td>0.125446</td>
<td>0.206998</td>
<td>1.117284</td>
<td>0.253412</td>
<td>0.276768</td>
<td>0.350543</td>
<td>-0.433231</td>
<td>0.118847</td>
<td>-0.066884</td>
<td>0.541468</td>
<td>0.120130</td>
<td>0.573686</td>
<td>0.171433</td>
<td>0.186842</td>
<td>0.333347</td>
<td>0.230756</td>
<td>0.121203</td>
<td>0.813489</td>
<td>0.240217</td>
<td>0.129748</td>
<td>-0.073277</td>
<td>1.736895</td>
<td>0.176460</td>
<td>0.171877</td>
<td>-0.289111</td>
<td>0.769154</td>
<td>-0.419785</td>
<td>0.263610</td>
<td>-0.160949</td>
<td>-2.221613</td>
<td>1.390422</td>
<td>-0.122776</td>
<td>1.489553</td>
<td>-1.081439</td>
<td>0.401941</td>
<td>0.059786</td>
<td>0.635452</td>
<td>0.833195</td>
<td>0.026667</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD2051</td>
<td>1.307455</td>
<td>1.493624</td>
<td>-0.080668</td>
<td>0.357197</td>
<td>-0.093754</td>
<td>1.241368</td>
<td>-1.302490</td>
<td>0.889474</td>
<td>1.191194</td>
<td>1.202531</td>
<td>0.722979</td>
<td>1.509900</td>
<td>1.627554</td>
<td>1.179945</td>
<td>0.955441</td>
<td>0.569924</td>
<td>0.643221</td>
<td>0.541808</td>
<td>0.925030</td>
<td>-0.345244</td>
<td>1.299625</td>
<td>0.620915</td>
<td>1.355416</td>
<td>0.738718</td>
<td>-0.006113</td>
<td>0.644452</td>
<td>0.443698</td>
<td>0.935402</td>
<td>-0.180421</td>
<td>0.430697</td>
<td>1.235177</td>
<td>0.513983</td>
<td>1.621471</td>
<td>0.331676</td>
<td>1.186828</td>
<td>1.046742</td>
<td>1.142778</td>
<td>1.715410</td>
<td>1.573246</td>
<td>2.559888</td>
<td>-0.443154</td>
<td>0.523418</td>
<td>-0.571101</td>
<td>1.090248</td>
<td>1.213303</td>
<td>1.798674</td>
<td>-1.405480</td>
<td>0.005891</td>
<td>0.917602</td>
<td>0.649356</td>
<td>1.534468</td>
<td>1.673800</td>
<td>0.377073</td>
<td>0.624872</td>
<td>-1.475270</td>
<td>1.452612</td>
<td>-0.242964</td>
<td>1.251698</td>
<td>-0.420091</td>
<td>1.104593</td>
<td>0.921976</td>
<td>1.339406</td>
<td>-1.000926</td>
<td>1.149161</td>
<td>0.805681</td>
<td>-1.285402</td>
<td>0.866708</td>
<td>0.381030</td>
<td>1.117982</td>
<td>1.363484</td>
<td>1.395317</td>
<td>0.520481</td>
<td>-0.690251</td>
<td>1.240706</td>
<td>0.601081</td>
<td>0.026592</td>
<td>-0.175921</td>
<td>0.355653</td>
<td>-1.358860</td>
<td>1.381260</td>
<td>0.864035</td>
<td>0.298216</td>
<td>0.630758</td>
<td>0.784345</td>
<td>0.622594</td>
<td>0.994078</td>
<td>1.393982</td>
<td>1.400958</td>
<td>0.431223</td>
<td>-0.754151</td>
<td>2.110924</td>
<td>0.633399</td>
<td>0.347131</td>
<td>0.821295</td>
<td>1.247326</td>
<td>-0.949864</td>
<td>0.898340</td>
<td>0.422134</td>
<td>0.737333</td>
<td>0.873527</td>
<td>0.777934</td>
<td>-0.638936</td>
<td>4.277803</td>
<td>3.888490</td>
<td>1.174055</td>
<td>2.122659</td>
<td>4.133578</td>
<td>0.670784</td>
<td>1.670055</td>
<td>1.109881</td>
<td>1.963682</td>
<td>0.910193</td>
<td>0.523024</td>
<td>-0.197135</td>
<td>0.753165</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>Y_test_tfz.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ESTIMATE</th>
<th data-quarto-table-cell-role="th">IMPRES</th>
<th data-quarto-table-cell-role="th">C_Bcellsnaive</th>
<th data-quarto-table-cell-role="th">C_TcellsCD4memoryresting</th>
<th data-quarto-table-cell-role="th">C_MacrophagesM2</th>
<th data-quarto-table-cell-role="th">S_Attractors_LYM</th>
<th data-quarto-table-cell-role="th">S_Attractors_IFIT3</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_GIMAP4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_HLA.DPA1</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SLAMF6</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_LILRB4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SIGLEC9</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CYTH4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CD3E</th>
<th data-quarto-table-cell-role="th">S_Lymph_Vessels</th>
<th data-quarto-table-cell-role="th">S_ICR_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_INHIB_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_ACT_SCORE</th>
<th data-quarto-table-cell-role="th">S_Angiogenesis</th>
<th data-quarto-table-cell-role="th">S_APM1</th>
<th data-quarto-table-cell-role="th">S_APM2</th>
<th data-quarto-table-cell-role="th">S_ICS5_score</th>
<th data-quarto-table-cell-role="th">S_LIexpression_score</th>
<th data-quarto-table-cell-role="th">S_Chemokine12_score</th>
<th data-quarto-table-cell-role="th">S_NHI_5gene_score</th>
<th data-quarto-table-cell-role="th">S_CD68</th>
<th data-quarto-table-cell-role="th">S_CD8A</th>
<th data-quarto-table-cell-role="th">S_PD1_data</th>
<th data-quarto-table-cell-role="th">S_PDL1_data</th>
<th data-quarto-table-cell-role="th">S_PD1_PDL1_score</th>
<th data-quarto-table-cell-role="th">S_CTLA4_data</th>
<th data-quarto-table-cell-role="th">S_Bcell_mg_IGJ</th>
<th data-quarto-table-cell-role="th">S_Bcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_STAT1_score</th>
<th data-quarto-table-cell-role="th">S_CSF1_response</th>
<th data-quarto-table-cell-role="th">S_TcClassII_score</th>
<th data-quarto-table-cell-role="th">S_IL12_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL4_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL2_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL13_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IFNG_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TGFB_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TREM1_data</th>
<th data-quarto-table-cell-role="th">S_DAP12_data</th>
<th data-quarto-table-cell-role="th">S_Tcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_IL8_21978456</th>
<th data-quarto-table-cell-role="th">S_IFN_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC1_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC2_21978456</th>
<th data-quarto-table-cell-role="th">S_Bcell_21978456</th>
<th data-quarto-table-cell-role="th">S_Tcell_21978456</th>
<th data-quarto-table-cell-role="th">S_CD103pos_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_CD103neg_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_IgG_19272155</th>
<th data-quarto-table-cell-role="th">S_Interferon_19272155</th>
<th data-quarto-table-cell-role="th">S_LCK_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.I_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.II_19272155</th>
<th data-quarto-table-cell-role="th">S_STAT1_19272155</th>
<th data-quarto-table-cell-role="th">S_Troester_WoundSig_19887484</th>
<th data-quarto-table-cell-role="th">S_MDACC.FNA.1_20805453</th>
<th data-quarto-table-cell-role="th">S_IGG_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Minterferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Immune_cell_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_MCD3_CD8_21214954</th>
<th data-quarto-table-cell-role="th">S_Interferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_B_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_CD8_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_GRANS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_LYMPHS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_T_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_TGFB_PCA_17349583</th>
<th data-quarto-table-cell-role="th">S_Rotterdam_ERneg_PCA_15721472</th>
<th data-quarto-table-cell-role="th">S_HER2_Immune_PCA_18006808</th>
<th data-quarto-table-cell-role="th">S_IR7_score</th>
<th data-quarto-table-cell-role="th">S_Buck14_score</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_score</th>
<th data-quarto-table-cell-role="th">S_Immune_NSCLC_score</th>
<th data-quarto-table-cell-role="th">S_Module3_IFN_score</th>
<th data-quarto-table-cell-role="th">S_Module4_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module5_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module11_Prolif_score</th>
<th data-quarto-table-cell-role="th">S_CD8_CD68_ratio</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_TcClassII_ratio</th>
<th data-quarto-table-cell-role="th">S_CHANG_CORE_SERUM_RESPONSE_UP</th>
<th data-quarto-table-cell-role="th">S_CSR_Activated_15701700</th>
<th data-quarto-table-cell-role="th">S_B_cells</th>
<th data-quarto-table-cell-role="th">S_T_cells</th>
<th data-quarto-table-cell-role="th">S_T_helper</th>
<th data-quarto-table-cell-role="th">S_Tcm</th>
<th data-quarto-table-cell-role="th">S_Tem</th>
<th data-quarto-table-cell-role="th">S_Th1</th>
<th data-quarto-table-cell-role="th">S_Th2</th>
<th data-quarto-table-cell-role="th">S_TFH</th>
<th data-quarto-table-cell-role="th">S_CD8_Tcells</th>
<th data-quarto-table-cell-role="th">S_Th17</th>
<th data-quarto-table-cell-role="th">S_Treg</th>
<th data-quarto-table-cell-role="th">S_Tgd</th>
<th data-quarto-table-cell-role="th">S_Cytotoxic_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cd56dim</th>
<th data-quarto-table-cell-role="th">S_NK_cd56bright</th>
<th data-quarto-table-cell-role="th">S_DC</th>
<th data-quarto-table-cell-role="th">S_iDC</th>
<th data-quarto-table-cell-role="th">S_aDC</th>
<th data-quarto-table-cell-role="th">S_pDC</th>
<th data-quarto-table-cell-role="th">S_Eosinophils</th>
<th data-quarto-table-cell-role="th">S_Macrophages</th>
<th data-quarto-table-cell-role="th">S_Mast</th>
<th data-quarto-table-cell-role="th">S_Neutrophils</th>
<th data-quarto-table-cell-role="th">S_Bindea_full</th>
<th data-quarto-table-cell-role="th">S_Expanded_IFNg</th>
<th data-quarto-table-cell-role="th">S_KEGG_MMR</th>
<th data-quarto-table-cell-role="th">S_KEGG_TGF_Beta</th>
<th data-quarto-table-cell-role="th">S_KEGG_Cytosolic_DNA_Sensing</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD1380</td>
<td>1.502341</td>
<td>1.498721</td>
<td>-0.337191</td>
<td>2.167540</td>
<td>-1.413114</td>
<td>1.321224</td>
<td>0.709892</td>
<td>1.764309</td>
<td>0.780305</td>
<td>1.547670</td>
<td>0.829145</td>
<td>-0.537893</td>
<td>1.138588</td>
<td>1.885112</td>
<td>-0.968685</td>
<td>1.406651</td>
<td>1.451242</td>
<td>1.373951</td>
<td>-0.581824</td>
<td>0.004905</td>
<td>0.934165</td>
<td>0.869757</td>
<td>1.353238</td>
<td>1.150575</td>
<td>-0.130514</td>
<td>0.507604</td>
<td>1.258557</td>
<td>0.404113</td>
<td>0.626166</td>
<td>0.492053</td>
<td>2.147637</td>
<td>-0.338000</td>
<td>1.012185</td>
<td>1.317094</td>
<td>1.092588</td>
<td>1.309270</td>
<td>1.333996</td>
<td>0.430719</td>
<td>1.463860</td>
<td>0.870033</td>
<td>0.458955</td>
<td>-1.291454</td>
<td>-0.820775</td>
<td>1.305687</td>
<td>1.970427</td>
<td>0.007852</td>
<td>0.773598</td>
<td>0.810102</td>
<td>1.085663</td>
<td>-0.322708</td>
<td>1.821415</td>
<td>1.574973</td>
<td>0.017414</td>
<td>-0.396808</td>
<td>0.667358</td>
<td>1.765751</td>
<td>0.794135</td>
<td>1.091565</td>
<td>0.990014</td>
<td>-0.297733</td>
<td>0.339319</td>
<td>0.368119</td>
<td>0.610801</td>
<td>1.567230</td>
<td>0.781433</td>
<td>0.710272</td>
<td>0.617188</td>
<td>1.904144</td>
<td>0.284084</td>
<td>1.592215</td>
<td>2.057647</td>
<td>-0.257962</td>
<td>0.733991</td>
<td>1.228489</td>
<td>0.878577</td>
<td>-1.164827</td>
<td>1.151028</td>
<td>-0.113986</td>
<td>0.669866</td>
<td>1.662128</td>
<td>1.327000</td>
<td>0.813822</td>
<td>1.140298</td>
<td>1.330439</td>
<td>0.790826</td>
<td>0.237888</td>
<td>0.638471</td>
<td>1.740690</td>
<td>1.876630</td>
<td>1.699685</td>
<td>1.929048</td>
<td>0.521820</td>
<td>1.449398</td>
<td>0.852521</td>
<td>0.879671</td>
<td>0.420313</td>
<td>1.188723</td>
<td>1.590741</td>
<td>2.041029</td>
<td>-0.099966</td>
<td>1.488696</td>
<td>0.415652</td>
<td>1.795034</td>
<td>1.149137</td>
<td>1.616096</td>
<td>1.944139</td>
<td>0.893642</td>
<td>-0.693095</td>
<td>0.518689</td>
<td>-0.312363</td>
<td>1.388810</td>
<td>1.618573</td>
<td>1.600766</td>
<td>-0.891407</td>
<td>1.047409</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD2265</td>
<td>0.849868</td>
<td>0.675678</td>
<td>1.134872</td>
<td>1.082271</td>
<td>-0.502873</td>
<td>0.475196</td>
<td>0.505549</td>
<td>1.443116</td>
<td>0.362347</td>
<td>0.654757</td>
<td>-0.392572</td>
<td>-0.003742</td>
<td>0.345088</td>
<td>0.708382</td>
<td>0.554091</td>
<td>0.356064</td>
<td>0.656309</td>
<td>0.272152</td>
<td>2.045878</td>
<td>-0.330630</td>
<td>0.083313</td>
<td>0.731388</td>
<td>0.812184</td>
<td>0.959114</td>
<td>0.480242</td>
<td>0.027956</td>
<td>0.139116</td>
<td>-0.084556</td>
<td>0.287924</td>
<td>0.039494</td>
<td>1.170484</td>
<td>-0.230837</td>
<td>0.990642</td>
<td>0.649595</td>
<td>0.654441</td>
<td>0.299155</td>
<td>0.639387</td>
<td>1.008264</td>
<td>0.622068</td>
<td>1.136838</td>
<td>0.306652</td>
<td>0.719537</td>
<td>1.085208</td>
<td>-0.090565</td>
<td>0.721770</td>
<td>1.697823</td>
<td>0.288097</td>
<td>0.021866</td>
<td>0.061012</td>
<td>-0.081104</td>
<td>1.211759</td>
<td>1.038415</td>
<td>-0.567239</td>
<td>0.189416</td>
<td>0.414733</td>
<td>1.032916</td>
<td>0.022344</td>
<td>0.927331</td>
<td>0.393998</td>
<td>1.316160</td>
<td>0.052996</td>
<td>-0.031965</td>
<td>0.399638</td>
<td>0.847173</td>
<td>1.083315</td>
<td>0.378220</td>
<td>1.291235</td>
<td>0.413634</td>
<td>0.986953</td>
<td>1.098319</td>
<td>1.398566</td>
<td>0.341318</td>
<td>0.279335</td>
<td>0.796531</td>
<td>0.381221</td>
<td>0.115166</td>
<td>0.441533</td>
<td>0.082077</td>
<td>0.426851</td>
<td>1.005680</td>
<td>0.668882</td>
<td>0.223948</td>
<td>0.137265</td>
<td>0.346519</td>
<td>0.511850</td>
<td>1.460170</td>
<td>1.050105</td>
<td>1.056345</td>
<td>2.072787</td>
<td>2.269800</td>
<td>1.452208</td>
<td>0.970411</td>
<td>1.111863</td>
<td>0.650848</td>
<td>0.238522</td>
<td>-1.237094</td>
<td>0.430232</td>
<td>0.114326</td>
<td>0.490285</td>
<td>-0.004035</td>
<td>0.603131</td>
<td>0.220865</td>
<td>1.159012</td>
<td>1.199197</td>
<td>0.980712</td>
<td>1.563919</td>
<td>0.742915</td>
<td>0.594948</td>
<td>0.107346</td>
<td>-0.039891</td>
<td>1.134158</td>
<td>0.580831</td>
<td>-0.854526</td>
<td>1.247854</td>
<td>-0.869419</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0946</td>
<td>1.658346</td>
<td>-0.113712</td>
<td>-0.155296</td>
<td>0.879085</td>
<td>-0.953066</td>
<td>1.500811</td>
<td>1.458088</td>
<td>1.684173</td>
<td>1.611365</td>
<td>1.799623</td>
<td>1.405262</td>
<td>1.532869</td>
<td>1.552019</td>
<td>1.433089</td>
<td>0.567635</td>
<td>1.204466</td>
<td>1.342521</td>
<td>1.147804</td>
<td>0.807373</td>
<td>0.997051</td>
<td>-0.085301</td>
<td>1.958149</td>
<td>1.443294</td>
<td>1.660470</td>
<td>2.905156</td>
<td>0.965404</td>
<td>1.393671</td>
<td>0.857474</td>
<td>1.459987</td>
<td>1.223633</td>
<td>1.064066</td>
<td>1.506787</td>
<td>1.681913</td>
<td>1.774404</td>
<td>1.846494</td>
<td>0.612753</td>
<td>1.398904</td>
<td>0.608965</td>
<td>1.544333</td>
<td>1.169796</td>
<td>1.480357</td>
<td>0.842624</td>
<td>0.115171</td>
<td>1.411294</td>
<td>1.318647</td>
<td>0.395968</td>
<td>1.405011</td>
<td>1.043185</td>
<td>1.078425</td>
<td>1.853156</td>
<td>1.654077</td>
<td>1.834060</td>
<td>2.274872</td>
<td>1.966756</td>
<td>1.351212</td>
<td>1.482061</td>
<td>1.015157</td>
<td>1.617014</td>
<td>1.395551</td>
<td>1.815331</td>
<td>2.034256</td>
<td>2.071761</td>
<td>1.666935</td>
<td>1.648147</td>
<td>1.409311</td>
<td>1.539679</td>
<td>2.046613</td>
<td>1.335630</td>
<td>2.020351</td>
<td>-0.015760</td>
<td>1.678480</td>
<td>0.364216</td>
<td>1.090984</td>
<td>1.855452</td>
<td>1.867668</td>
<td>1.013996</td>
<td>1.645386</td>
<td>2.078826</td>
<td>1.567014</td>
<td>1.633105</td>
<td>1.697153</td>
<td>0.566482</td>
<td>1.486246</td>
<td>0.939803</td>
<td>0.397049</td>
<td>1.350015</td>
<td>1.924653</td>
<td>1.444700</td>
<td>1.321204</td>
<td>1.478037</td>
<td>1.999640</td>
<td>1.716759</td>
<td>1.096565</td>
<td>1.028617</td>
<td>1.181142</td>
<td>-0.737791</td>
<td>1.077398</td>
<td>1.714822</td>
<td>1.315336</td>
<td>0.031464</td>
<td>0.248489</td>
<td>-0.514747</td>
<td>1.614360</td>
<td>1.180393</td>
<td>1.860639</td>
<td>0.531399</td>
<td>0.774164</td>
<td>1.835125</td>
<td>0.592588</td>
<td>1.352924</td>
<td>1.948144</td>
<td>1.454999</td>
<td>0.269560</td>
<td>0.587980</td>
<td>1.121475</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD1225</td>
<td>0.143100</td>
<td>-0.113712</td>
<td>-0.386883</td>
<td>0.041891</td>
<td>1.199557</td>
<td>-0.054837</td>
<td>0.749546</td>
<td>-0.018396</td>
<td>-0.090576</td>
<td>0.261741</td>
<td>0.322064</td>
<td>0.666163</td>
<td>-0.671699</td>
<td>-0.072199</td>
<td>1.055294</td>
<td>0.249373</td>
<td>0.273400</td>
<td>0.236685</td>
<td>-0.282617</td>
<td>1.052467</td>
<td>0.715839</td>
<td>0.398420</td>
<td>0.073063</td>
<td>1.099727</td>
<td>0.151817</td>
<td>-1.834802</td>
<td>0.231810</td>
<td>-0.788589</td>
<td>-0.242195</td>
<td>-0.628783</td>
<td>-0.149112</td>
<td>0.645275</td>
<td>0.234209</td>
<td>0.715955</td>
<td>0.417754</td>
<td>0.314391</td>
<td>-0.090886</td>
<td>-1.236346</td>
<td>-0.548567</td>
<td>0.203791</td>
<td>1.067234</td>
<td>-0.267659</td>
<td>0.746156</td>
<td>0.907877</td>
<td>0.044399</td>
<td>0.885716</td>
<td>0.758048</td>
<td>0.898605</td>
<td>0.477073</td>
<td>0.325026</td>
<td>-0.219696</td>
<td>-0.212274</td>
<td>0.084352</td>
<td>0.549481</td>
<td>0.607385</td>
<td>0.075031</td>
<td>0.994121</td>
<td>0.142236</td>
<td>0.968397</td>
<td>0.594672</td>
<td>0.111614</td>
<td>-0.391399</td>
<td>0.271753</td>
<td>0.524562</td>
<td>0.332198</td>
<td>0.713408</td>
<td>-0.245398</td>
<td>0.057178</td>
<td>1.153457</td>
<td>0.462797</td>
<td>-0.135608</td>
<td>0.607225</td>
<td>0.496472</td>
<td>0.265127</td>
<td>0.797963</td>
<td>-0.805600</td>
<td>1.354220</td>
<td>0.676312</td>
<td>0.839842</td>
<td>-0.008848</td>
<td>0.555591</td>
<td>1.208604</td>
<td>-1.558256</td>
<td>0.614470</td>
<td>1.545286</td>
<td>1.482353</td>
<td>-0.418077</td>
<td>0.224109</td>
<td>-0.543808</td>
<td>-0.634417</td>
<td>0.044410</td>
<td>1.121434</td>
<td>-0.647450</td>
<td>-0.867314</td>
<td>-1.195575</td>
<td>-0.193588</td>
<td>-0.223702</td>
<td>0.464829</td>
<td>-0.154953</td>
<td>-0.420888</td>
<td>1.020306</td>
<td>-1.308629</td>
<td>0.582633</td>
<td>0.010309</td>
<td>-0.134992</td>
<td>0.531399</td>
<td>-2.781228</td>
<td>0.636999</td>
<td>-0.895881</td>
<td>0.185007</td>
<td>-0.397956</td>
<td>0.528662</td>
<td>0.244690</td>
<td>-0.089255</td>
<td>0.856988</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD1164</td>
<td>1.239124</td>
<td>1.498721</td>
<td>0.046610</td>
<td>1.709743</td>
<td>-0.688209</td>
<td>1.183736</td>
<td>0.587487</td>
<td>1.351412</td>
<td>1.180935</td>
<td>1.127021</td>
<td>0.362916</td>
<td>-0.878327</td>
<td>1.156771</td>
<td>1.097676</td>
<td>-0.062049</td>
<td>0.842939</td>
<td>0.463746</td>
<td>0.931920</td>
<td>1.413882</td>
<td>0.905214</td>
<td>1.480226</td>
<td>0.803506</td>
<td>0.988521</td>
<td>1.247360</td>
<td>1.709553</td>
<td>-1.886136</td>
<td>1.547784</td>
<td>0.921657</td>
<td>0.349631</td>
<td>0.664979</td>
<td>0.291462</td>
<td>0.173338</td>
<td>0.932858</td>
<td>0.890680</td>
<td>1.112383</td>
<td>1.161337</td>
<td>1.039294</td>
<td>1.631594</td>
<td>1.191891</td>
<td>-0.209744</td>
<td>0.425118</td>
<td>1.137863</td>
<td>-2.552530</td>
<td>0.975093</td>
<td>0.989001</td>
<td>0.226684</td>
<td>0.409862</td>
<td>-0.989050</td>
<td>1.576676</td>
<td>0.382638</td>
<td>1.226244</td>
<td>1.058465</td>
<td>0.772516</td>
<td>0.326021</td>
<td>0.466484</td>
<td>1.055815</td>
<td>-1.327464</td>
<td>1.306161</td>
<td>0.948958</td>
<td>1.757895</td>
<td>0.591907</td>
<td>0.769077</td>
<td>0.780230</td>
<td>1.139914</td>
<td>0.345322</td>
<td>0.372079</td>
<td>1.032116</td>
<td>1.312024</td>
<td>1.370195</td>
<td>-0.933663</td>
<td>1.425244</td>
<td>0.206169</td>
<td>1.084859</td>
<td>0.921422</td>
<td>1.024039</td>
<td>-0.898578</td>
<td>0.863465</td>
<td>-0.210164</td>
<td>0.523849</td>
<td>1.051043</td>
<td>0.924275</td>
<td>-0.084179</td>
<td>-0.925543</td>
<td>1.132944</td>
<td>-1.011587</td>
<td>0.963803</td>
<td>0.659330</td>
<td>0.977230</td>
<td>0.107165</td>
<td>1.050887</td>
<td>1.722789</td>
<td>0.821797</td>
<td>-1.232208</td>
<td>0.368208</td>
<td>0.535969</td>
<td>0.435165</td>
<td>0.308368</td>
<td>0.527144</td>
<td>1.067961</td>
<td>0.595372</td>
<td>1.082460</td>
<td>-0.659492</td>
<td>-0.153468</td>
<td>0.136792</td>
<td>0.433763</td>
<td>0.763169</td>
<td>-0.443128</td>
<td>-0.350118</td>
<td>0.623097</td>
<td>0.057460</td>
<td>0.615897</td>
<td>1.028363</td>
<td>-0.616330</td>
<td>0.256976</td>
<td>-0.510403</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="xgboost-learning" class="level4">
<h4 class="anchored" data-anchor-id="xgboost-learning"><strong>XGBoost Learning</strong></h4>
<p>Time to test XGBoost. Select <code>ESTIMATE</code> column as the first target/label (<code>y</code>) variable first.</p>
<div class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract ESTIMATE column as y label</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>y_index <span class="op">=</span> <span class="st">'ESTIMATE'</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>Y_train_ix <span class="op">=</span> Y_train_tfz[y_index]</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>Y_test_ix <span class="op">=</span> Y_test_tfz[y_index]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Y_train_ix.shape)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Y_test_ix.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(554,)
(139,)</code></pre>
</div>
</div>
<p>With <code>y</code> label selected, create DMatrix objects for XGBoost corresponding to the <code>X_train_tfz</code> and <code>X_test _tfz</code> sets.</p>
<div class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create DMatrix for XGBoost; enable_categorical=True if there are categorical encoded columns</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>dtrain <span class="op">=</span> xgb.DMatrix(X_train_tfz, label<span class="op">=</span>Y_train_ix)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>dtest <span class="op">=</span> xgb.DMatrix(X_test_tfz, label<span class="op">=</span>Y_test_ix)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co"># XGBoost parameters</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'objective'</span>: <span class="st">'reg:squarederror'</span>,</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'eval_metric'</span>: <span class="st">'rmse'</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the model</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>num_rounds <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> xgb.train(params, dtrain, num_rounds)</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>preds_tf <span class="op">=</span> model.predict(dtest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(preds_tf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="77">
<pre><code>139</code></pre>
</div>
</div>
<p>Now that XGBoost training and modeling have been completed, we can reverse the Z-score scaling and YJ transformation in the order they were applied. Make sure to use the pre-scaled mean and standard deviation for the z-score reversal.</p>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>mean_y <span class="op">=</span> Y_train_tf[y_index].mean()</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_y)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>std_y <span class="op">=</span> Y_train_tf[y_index].std()</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(std_y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>734.455654074439
189.50281576341493</code></pre>
</div>
</div>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Reverse Z-score normalization</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>preds_rev_z <span class="op">=</span> (preds_tf <span class="op">*</span> std_y) <span class="op">+</span> mean_y</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>preds_rev_z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<pre><code>array([ 503.19742,  740.29913,  750.162  ,  925.39716,  852.4557 ,
        760.76434,  554.0927 ,  833.5172 ,  560.8332 ,  989.64075,
        911.5566 ,  811.3644 ,  669.76855,  698.5878 ,  662.21594,
        608.6222 ,  713.7396 ,  596.6855 ,  862.1983 ,  837.5951 ,
        643.1972 ,  760.3959 ,  614.1673 ,  646.3362 ,  656.99835,
        595.31805,  676.5636 ,  647.2605 ,  847.57983,  633.68475,
        623.5753 ,  487.5171 ,  601.7172 ,  769.8253 ,  721.7454 ,
        669.007  ,  699.51697,  718.921  ,  823.7829 ,  733.9562 ,
        733.47864,  844.809  ,  756.0645 ,  704.84674,  712.1032 ,
        651.29706,  877.1283 ,  824.4278 ,  707.6642 ,  739.52386,
        920.5541 ,  690.2509 ,  604.60156,  884.58203,  645.2677 ,
        683.05505,  690.4194 ,  645.77167,  778.08655,  490.20398,
        860.4209 ,  840.98065,  824.93317,  859.26215,  651.2747 ,
        672.27826,  747.3292 ,  595.03284,  733.04425, 1048.7585 ,
        713.8005 ,  624.35114,  692.9905 , 1003.65594,  590.2439 ,
        817.8419 ,  878.1723 ,  855.48004,  513.20447,  633.84076,
        726.1297 ,  674.9499 ,  687.39594,  608.2773 ,  764.93384,
        537.4387 ,  967.02576,  644.7894 ,  821.598  ,  605.64825,
        826.8151 ,  714.10974,  798.56586,  607.2015 ,  755.2059 ,
        692.33624,  638.04114,  701.8062 ,  681.00555,  958.86035,
        661.1677 ,  636.11053,  653.6246 ,  650.42755,  913.2119 ,
        619.9395 ,  706.2809 ,  782.9319 ,  977.73804,  693.3305 ,
        596.0039 ,  808.7659 ,  549.474  ,  767.93866,  770.958  ,
        777.8969 ,  616.03217,  605.1793 ,  872.58185,  685.57294,
        627.9364 ,  697.0684 ,  699.9716 ,  717.7886 ,  814.0482 ,
        680.4784 ,  807.4989 ,  834.6159 ,  736.20795,  872.3298 ,
        663.39014,  738.7007 ,  729.6429 ,  776.33246,  589.75854,
        763.2922 ,  716.20917,  681.61395,  766.9679 ], dtype=float32)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Prepare the input for inverse Yeo-Johnson transformation</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame with the same columns as the original y used in fit</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>dummy_y <span class="op">=</span> pd.DataFrame(<span class="dv">0</span>, index<span class="op">=</span><span class="bu">range</span>(<span class="bu">len</span>(preds_rev_z)), columns<span class="op">=</span>yj_transformer_Y.feature_names_in_)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>dummy_y[y_index] <span class="op">=</span> preds_rev_z</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>dummy_y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="80">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ESTIMATE</th>
<th data-quarto-table-cell-role="th">IMPRES</th>
<th data-quarto-table-cell-role="th">C_Bcellsnaive</th>
<th data-quarto-table-cell-role="th">C_TcellsCD4memoryresting</th>
<th data-quarto-table-cell-role="th">C_MacrophagesM2</th>
<th data-quarto-table-cell-role="th">S_Attractors_LYM</th>
<th data-quarto-table-cell-role="th">S_Attractors_IFIT3</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_GIMAP4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_HLA.DPA1</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SLAMF6</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_LILRB4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SIGLEC9</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CYTH4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CD3E</th>
<th data-quarto-table-cell-role="th">S_Lymph_Vessels</th>
<th data-quarto-table-cell-role="th">S_ICR_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_INHIB_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_ACT_SCORE</th>
<th data-quarto-table-cell-role="th">S_Angiogenesis</th>
<th data-quarto-table-cell-role="th">S_APM1</th>
<th data-quarto-table-cell-role="th">S_APM2</th>
<th data-quarto-table-cell-role="th">S_ICS5_score</th>
<th data-quarto-table-cell-role="th">S_LIexpression_score</th>
<th data-quarto-table-cell-role="th">S_Chemokine12_score</th>
<th data-quarto-table-cell-role="th">S_NHI_5gene_score</th>
<th data-quarto-table-cell-role="th">S_CD68</th>
<th data-quarto-table-cell-role="th">S_CD8A</th>
<th data-quarto-table-cell-role="th">S_PD1_data</th>
<th data-quarto-table-cell-role="th">S_PDL1_data</th>
<th data-quarto-table-cell-role="th">S_PD1_PDL1_score</th>
<th data-quarto-table-cell-role="th">S_CTLA4_data</th>
<th data-quarto-table-cell-role="th">S_Bcell_mg_IGJ</th>
<th data-quarto-table-cell-role="th">S_Bcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_STAT1_score</th>
<th data-quarto-table-cell-role="th">S_CSF1_response</th>
<th data-quarto-table-cell-role="th">S_TcClassII_score</th>
<th data-quarto-table-cell-role="th">S_IL12_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL4_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL2_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL13_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IFNG_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TGFB_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TREM1_data</th>
<th data-quarto-table-cell-role="th">S_DAP12_data</th>
<th data-quarto-table-cell-role="th">S_Tcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_IL8_21978456</th>
<th data-quarto-table-cell-role="th">S_IFN_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC1_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC2_21978456</th>
<th data-quarto-table-cell-role="th">S_Bcell_21978456</th>
<th data-quarto-table-cell-role="th">S_Tcell_21978456</th>
<th data-quarto-table-cell-role="th">S_CD103pos_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_CD103neg_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_IgG_19272155</th>
<th data-quarto-table-cell-role="th">S_Interferon_19272155</th>
<th data-quarto-table-cell-role="th">S_LCK_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.I_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.II_19272155</th>
<th data-quarto-table-cell-role="th">S_STAT1_19272155</th>
<th data-quarto-table-cell-role="th">S_Troester_WoundSig_19887484</th>
<th data-quarto-table-cell-role="th">S_MDACC.FNA.1_20805453</th>
<th data-quarto-table-cell-role="th">S_IGG_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Minterferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Immune_cell_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_MCD3_CD8_21214954</th>
<th data-quarto-table-cell-role="th">S_Interferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_B_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_CD8_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_GRANS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_LYMPHS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_T_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_TGFB_PCA_17349583</th>
<th data-quarto-table-cell-role="th">S_Rotterdam_ERneg_PCA_15721472</th>
<th data-quarto-table-cell-role="th">S_HER2_Immune_PCA_18006808</th>
<th data-quarto-table-cell-role="th">S_IR7_score</th>
<th data-quarto-table-cell-role="th">S_Buck14_score</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_score</th>
<th data-quarto-table-cell-role="th">S_Immune_NSCLC_score</th>
<th data-quarto-table-cell-role="th">S_Module3_IFN_score</th>
<th data-quarto-table-cell-role="th">S_Module4_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module5_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module11_Prolif_score</th>
<th data-quarto-table-cell-role="th">S_CD8_CD68_ratio</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_TcClassII_ratio</th>
<th data-quarto-table-cell-role="th">S_CHANG_CORE_SERUM_RESPONSE_UP</th>
<th data-quarto-table-cell-role="th">S_CSR_Activated_15701700</th>
<th data-quarto-table-cell-role="th">S_B_cells</th>
<th data-quarto-table-cell-role="th">S_T_cells</th>
<th data-quarto-table-cell-role="th">S_T_helper</th>
<th data-quarto-table-cell-role="th">S_Tcm</th>
<th data-quarto-table-cell-role="th">S_Tem</th>
<th data-quarto-table-cell-role="th">S_Th1</th>
<th data-quarto-table-cell-role="th">S_Th2</th>
<th data-quarto-table-cell-role="th">S_TFH</th>
<th data-quarto-table-cell-role="th">S_CD8_Tcells</th>
<th data-quarto-table-cell-role="th">S_Th17</th>
<th data-quarto-table-cell-role="th">S_Treg</th>
<th data-quarto-table-cell-role="th">S_Tgd</th>
<th data-quarto-table-cell-role="th">S_Cytotoxic_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cd56dim</th>
<th data-quarto-table-cell-role="th">S_NK_cd56bright</th>
<th data-quarto-table-cell-role="th">S_DC</th>
<th data-quarto-table-cell-role="th">S_iDC</th>
<th data-quarto-table-cell-role="th">S_aDC</th>
<th data-quarto-table-cell-role="th">S_pDC</th>
<th data-quarto-table-cell-role="th">S_Eosinophils</th>
<th data-quarto-table-cell-role="th">S_Macrophages</th>
<th data-quarto-table-cell-role="th">S_Mast</th>
<th data-quarto-table-cell-role="th">S_Neutrophils</th>
<th data-quarto-table-cell-role="th">S_Bindea_full</th>
<th data-quarto-table-cell-role="th">S_Expanded_IFNg</th>
<th data-quarto-table-cell-role="th">S_KEGG_MMR</th>
<th data-quarto-table-cell-role="th">S_KEGG_TGF_Beta</th>
<th data-quarto-table-cell-role="th">S_KEGG_Cytosolic_DNA_Sensing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>503.197418</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>740.299133</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>750.161987</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>925.397156</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>852.455688</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">134</td>
<td>589.758545</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">135</td>
<td>763.292175</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">136</td>
<td>716.209167</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">137</td>
<td>681.613953</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">138</td>
<td>766.967896</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>139 rows × 115 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Apply inverse Yeo-Johnson transformation</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>preds_rev_yj <span class="op">=</span> yj_transformer_Y.inverse_transform(dummy_y)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>preds_rev_yj</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="81">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ESTIMATE</th>
<th data-quarto-table-cell-role="th">IMPRES</th>
<th data-quarto-table-cell-role="th">C_Bcellsnaive</th>
<th data-quarto-table-cell-role="th">C_TcellsCD4memoryresting</th>
<th data-quarto-table-cell-role="th">C_MacrophagesM2</th>
<th data-quarto-table-cell-role="th">S_Attractors_LYM</th>
<th data-quarto-table-cell-role="th">S_Attractors_IFIT3</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_GIMAP4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_HLA.DPA1</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SLAMF6</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_LILRB4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SIGLEC9</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CYTH4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CD3E</th>
<th data-quarto-table-cell-role="th">S_Lymph_Vessels</th>
<th data-quarto-table-cell-role="th">S_ICR_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_INHIB_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_ACT_SCORE</th>
<th data-quarto-table-cell-role="th">S_Angiogenesis</th>
<th data-quarto-table-cell-role="th">S_APM1</th>
<th data-quarto-table-cell-role="th">S_APM2</th>
<th data-quarto-table-cell-role="th">S_ICS5_score</th>
<th data-quarto-table-cell-role="th">S_LIexpression_score</th>
<th data-quarto-table-cell-role="th">S_Chemokine12_score</th>
<th data-quarto-table-cell-role="th">S_NHI_5gene_score</th>
<th data-quarto-table-cell-role="th">S_CD68</th>
<th data-quarto-table-cell-role="th">S_CD8A</th>
<th data-quarto-table-cell-role="th">S_PD1_data</th>
<th data-quarto-table-cell-role="th">S_PDL1_data</th>
<th data-quarto-table-cell-role="th">S_PD1_PDL1_score</th>
<th data-quarto-table-cell-role="th">S_CTLA4_data</th>
<th data-quarto-table-cell-role="th">S_Bcell_mg_IGJ</th>
<th data-quarto-table-cell-role="th">S_Bcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_STAT1_score</th>
<th data-quarto-table-cell-role="th">S_CSF1_response</th>
<th data-quarto-table-cell-role="th">S_TcClassII_score</th>
<th data-quarto-table-cell-role="th">S_IL12_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL4_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL2_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL13_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IFNG_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TGFB_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TREM1_data</th>
<th data-quarto-table-cell-role="th">S_DAP12_data</th>
<th data-quarto-table-cell-role="th">S_Tcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_IL8_21978456</th>
<th data-quarto-table-cell-role="th">S_IFN_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC1_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC2_21978456</th>
<th data-quarto-table-cell-role="th">S_Bcell_21978456</th>
<th data-quarto-table-cell-role="th">S_Tcell_21978456</th>
<th data-quarto-table-cell-role="th">S_CD103pos_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_CD103neg_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_IgG_19272155</th>
<th data-quarto-table-cell-role="th">S_Interferon_19272155</th>
<th data-quarto-table-cell-role="th">S_LCK_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.I_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.II_19272155</th>
<th data-quarto-table-cell-role="th">S_STAT1_19272155</th>
<th data-quarto-table-cell-role="th">S_Troester_WoundSig_19887484</th>
<th data-quarto-table-cell-role="th">S_MDACC.FNA.1_20805453</th>
<th data-quarto-table-cell-role="th">S_IGG_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Minterferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Immune_cell_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_MCD3_CD8_21214954</th>
<th data-quarto-table-cell-role="th">S_Interferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_B_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_CD8_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_GRANS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_LYMPHS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_T_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_TGFB_PCA_17349583</th>
<th data-quarto-table-cell-role="th">S_Rotterdam_ERneg_PCA_15721472</th>
<th data-quarto-table-cell-role="th">S_HER2_Immune_PCA_18006808</th>
<th data-quarto-table-cell-role="th">S_IR7_score</th>
<th data-quarto-table-cell-role="th">S_Buck14_score</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_score</th>
<th data-quarto-table-cell-role="th">S_Immune_NSCLC_score</th>
<th data-quarto-table-cell-role="th">S_Module3_IFN_score</th>
<th data-quarto-table-cell-role="th">S_Module4_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module5_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module11_Prolif_score</th>
<th data-quarto-table-cell-role="th">S_CD8_CD68_ratio</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_TcClassII_ratio</th>
<th data-quarto-table-cell-role="th">S_CHANG_CORE_SERUM_RESPONSE_UP</th>
<th data-quarto-table-cell-role="th">S_CSR_Activated_15701700</th>
<th data-quarto-table-cell-role="th">S_B_cells</th>
<th data-quarto-table-cell-role="th">S_T_cells</th>
<th data-quarto-table-cell-role="th">S_T_helper</th>
<th data-quarto-table-cell-role="th">S_Tcm</th>
<th data-quarto-table-cell-role="th">S_Tem</th>
<th data-quarto-table-cell-role="th">S_Th1</th>
<th data-quarto-table-cell-role="th">S_Th2</th>
<th data-quarto-table-cell-role="th">S_TFH</th>
<th data-quarto-table-cell-role="th">S_CD8_Tcells</th>
<th data-quarto-table-cell-role="th">S_Th17</th>
<th data-quarto-table-cell-role="th">S_Treg</th>
<th data-quarto-table-cell-role="th">S_Tgd</th>
<th data-quarto-table-cell-role="th">S_Cytotoxic_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cd56dim</th>
<th data-quarto-table-cell-role="th">S_NK_cd56bright</th>
<th data-quarto-table-cell-role="th">S_DC</th>
<th data-quarto-table-cell-role="th">S_iDC</th>
<th data-quarto-table-cell-role="th">S_aDC</th>
<th data-quarto-table-cell-role="th">S_pDC</th>
<th data-quarto-table-cell-role="th">S_Eosinophils</th>
<th data-quarto-table-cell-role="th">S_Macrophages</th>
<th data-quarto-table-cell-role="th">S_Mast</th>
<th data-quarto-table-cell-role="th">S_Neutrophils</th>
<th data-quarto-table-cell-role="th">S_Bindea_full</th>
<th data-quarto-table-cell-role="th">S_Expanded_IFNg</th>
<th data-quarto-table-cell-role="th">S_KEGG_MMR</th>
<th data-quarto-table-cell-role="th">S_KEGG_TGF_Beta</th>
<th data-quarto-table-cell-role="th">S_KEGG_Cytosolic_DNA_Sensing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2437.000244</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>4037.304199</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>4107.801758</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>5406.045410</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4855.468750</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">134</td>
<td>2998.989502</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">135</td>
<td>4202.099121</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">136</td>
<td>3866.339111</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">137</td>
<td>3623.925537</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">138</td>
<td>4228.587891</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>139 rows × 115 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Extract the relevant column</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>preds <span class="op">=</span> pd.DataFrame(preds_rev_yj, columns<span class="op">=</span>yj_transformer_Y.feature_names_in_)[y_index].values</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>preds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="82">
<pre><code>array([2437.0002, 4037.3042, 4107.802 , 5406.0454, 4855.4688, 4183.906 ,
       2764.1064, 4714.8384, 2808.1482, 5902.264 , 5300.5054, 4551.591 ,
       3541.7847, 3742.3997, 3489.6458, 3125.0244, 3848.9124, 3045.1282,
       4928.1934, 4745.0366, 3359.1667, 4181.2554, 3162.3057, 3380.6208,
       3453.7334, 3036.0068, 3588.85  , 3386.9443, 4819.1694, 3294.3506,
       3225.796 , 2338.2212, 3078.7476, 4249.206 , 3905.474 , 3536.5193,
       3748.911 , 3885.4973, 4642.937 , 3992.1191, 3988.7222, 4798.57  ,
       4150.13  , 3786.3125, 3837.3745, 3414.5923, 5040.133 , 4647.693 ,
       3806.119 , 4031.7751, 5369.0596, 3684.0972, 3098.0586, 5096.2397,
       3373.3145, 3633.949 , 3685.2732, 3376.76  , 4308.951 , 2355.0786,
       4914.907 , 4770.143 , 4651.42  , 4906.2495, 3414.4392, 3559.1511,
       4087.5244, 3034.1052, 3985.6328, 6367.806 , 3849.3416, 3231.0447,
       3703.2322, 6011.873 , 3002.2168, 4599.1836, 5047.9824, 4878.017 ,
       2500.5415, 3295.4114, 3936.5325, 3577.6597, 3664.1814, 3122.709 ,
       4213.925 , 2656.0027, 5726.413 , 3370.0452, 4626.835 , 3105.0732,
       4665.306 , 3851.523 , 4457.901 , 3115.4895, 4143.9653, 3698.6604,
       3323.997 , 3764.965 , 3619.696 , 5663.2305, 3482.4238, 3310.851 ,
       3430.5586, 3408.6323, 5313.102 , 3201.2239, 3796.3914, 4344.0835,
       5809.5537, 3705.609 , 3040.581 , 4532.5317, 2734.0234, 4235.59  ,
       4257.386 , 4307.577 , 3174.867 , 3101.9302, 5005.982 , 3651.4775,
       3255.3276, 3731.7583, 3752.0981, 3877.4941, 4571.296 , 3616.0317,
       4523.2456, 4722.97  , 4008.1465, 5004.091 , 3497.7397, 4025.9062,
       3961.4614, 4296.249 , 2998.9895, 4202.099 , 3866.339 , 3623.9255,
       4228.588 ], dtype=float32)</code></pre>
</div>
</div>
</section>
<section id="evaluation" class="level4">
<h4 class="anchored" data-anchor-id="evaluation"><strong>Evaluation</strong></h4>
<p>Import Scikit-Learn’s <code>metrics</code> tools to evaluate the machine learning outputs.</p>
<div class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, mean_absolute_error, r2_score</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>rmse <span class="op">=</span> np.sqrt(mean_squared_error(Y_test[y_index], preds))</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"RMSE: </span><span class="sc">{</span>rmse<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>mae <span class="op">=</span> mean_absolute_error(Y_test[y_index], preds)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>r2 <span class="op">=</span> r2_score(Y_test[y_index], preds)</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mean Absolute Error: </span><span class="sc">{</span>mae<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"R-squared Score: </span><span class="sc">{</span>r2<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>RMSE: 1474.3084979951584
Mean Absolute Error: 1138.2018656271355
R-squared Score: -0.19136873756902717</code></pre>
</div>
</div>
<div class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> xgboost <span class="im">import</span> plot_importance</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>plot_importance(model, ax<span class="op">=</span>ax)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="xgboost_files/figure-html/cell-68-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shap</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the SHAP explainer</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>explainer <span class="op">=</span> shap.TreeExplainer(model)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate SHAP values</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>shap_values <span class="op">=</span> explainer.shap_values(X_train_tfz)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary plot</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>shap.summary_plot(shap_values, X_train_tfz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="xgboost_files/figure-html/cell-69-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature importance based on mean absolute SHAP values</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>feature_importance <span class="op">=</span> np.<span class="bu">abs</span>(shap_values).mean(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>feature_importance_df <span class="op">=</span> pd.DataFrame(<span class="bu">list</span>(<span class="bu">zip</span>(X_train_tfz.columns, feature_importance)),</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>                                     columns<span class="op">=</span>[<span class="st">'feature'</span>, <span class="st">'importance'</span>])</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>feature_importance_df <span class="op">=</span> feature_importance_df.sort_values(<span class="st">'importance'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Top 10 features by SHAP importance:"</span>)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(feature_importance_df.head(<span class="dv">10</span>))</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot feature importance</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>feature_importance_df.plot(x<span class="op">=</span><span class="st">'feature'</span>, y<span class="op">=</span><span class="st">'importance'</span>, kind<span class="op">=</span><span class="st">'bar'</span>)</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Feature Importance (Mean Absolute SHAP Values)'</span>)</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Features'</span>)</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Mean |SHAP Value|'</span>)</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a><span class="co"># SHAP dependence plot for the most important feature</span></span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>most_important_feature <span class="op">=</span> feature_importance_df.iloc[<span class="dv">0</span>][<span class="st">'feature'</span>]</span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>shap.dependence_plot(most_important_feature, shap_values, X_train_tfz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Top 10 features by SHAP importance:
                   feature  importance
2               TumorGrade    0.278227
7        SNVindelNeo_Count    0.206780
6              FN/FT_Ratio    0.198583
0                      Age    0.151603
4          FusionNeo_Count    0.147300
3               TumourSize    0.126634
8         SNVindelNeo_IC50    0.110108
5  FusionTransscript_Count    0.107770
1                    Stage    0.026071</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 1000x600 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="xgboost_files/figure-html/cell-70-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="xgboost_files/figure-html/cell-70-output-4.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the SHAP explainer</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>explainer <span class="op">=</span> shap.TreeExplainer(model)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate SHAP values</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>shap_values <span class="op">=</span> explainer(X_train_tfz)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform clustering</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>clust <span class="op">=</span> shap.utils.hclust(X_train_tfz, Y_train_ix)</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the bar plot with clustering</span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>shap.plots.bar(shap_values, clustering<span class="op">=</span>clust, clustering_cutoff<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="xgboost_files/figure-html/cell-71-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create SHAP explainers</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>explainer_original <span class="op">=</span> shap.TreeExplainer(model)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>explainer_transformed <span class="op">=</span> shap.TreeExplainer(model)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate SHAP values</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>shap_values_original <span class="op">=</span> explainer_original(X_train)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>shap_values_transformed <span class="op">=</span> explainer_transformed(X_train_tfz)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to plot and compare SHAP summary plots</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compare_shap_plots(shap_values_orig, shap_values_trans, X_orig, X_trans):</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">60</span>, <span class="dv">30</span>))</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">121</span>)</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>    shap.summary_plot(shap_values_orig, X_orig, plot_type<span class="op">=</span><span class="st">"bar"</span>, show<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">"SHAP Values - Original Features"</span>)</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">122</span>)</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>    shap.summary_plot(shap_values_trans, X_trans, plot_type<span class="op">=</span><span class="st">"bar"</span>, show<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">"SHAP Values - Transformed Features"</span>)</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>    plt.subplots_adjust(bottom<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare SHAP plots</span></span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a>compare_shap_plots(shap_values_original, shap_values_transformed, X_train, X_train_tfz)</span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get feature importance from SHAP values</span></span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_feature_importance(shap_values, feature_names):</span>
<span id="cb77-30"><a href="#cb77-30" aria-hidden="true" tabindex="-1"></a>    feature_importance <span class="op">=</span> np.<span class="bu">abs</span>(shap_values.values).mean(<span class="dv">0</span>)</span>
<span id="cb77-31"><a href="#cb77-31" aria-hidden="true" tabindex="-1"></a>    feature_importance_df <span class="op">=</span> pd.DataFrame(<span class="bu">list</span>(<span class="bu">zip</span>(feature_names, feature_importance)),</span>
<span id="cb77-32"><a href="#cb77-32" aria-hidden="true" tabindex="-1"></a>                                         columns<span class="op">=</span>[<span class="st">'feature'</span>, <span class="st">'importance'</span>])</span>
<span id="cb77-33"><a href="#cb77-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> feature_importance_df.sort_values(<span class="st">'importance'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb77-34"><a href="#cb77-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-35"><a href="#cb77-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Get and compare feature importances</span></span>
<span id="cb77-36"><a href="#cb77-36" aria-hidden="true" tabindex="-1"></a>importance_original <span class="op">=</span> get_feature_importance(shap_values_original, X_train.columns)</span>
<span id="cb77-37"><a href="#cb77-37" aria-hidden="true" tabindex="-1"></a>importance_transformed <span class="op">=</span> get_feature_importance(shap_values_transformed, X_train_tfz.columns)</span>
<span id="cb77-38"><a href="#cb77-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-39"><a href="#cb77-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Top 10 features (Original):"</span>)</span>
<span id="cb77-40"><a href="#cb77-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(importance_original.head(<span class="dv">10</span>))</span>
<span id="cb77-41"><a href="#cb77-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Top 10 features (Transformed):"</span>)</span>
<span id="cb77-42"><a href="#cb77-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(importance_transformed.head(<span class="dv">10</span>))</span>
<span id="cb77-43"><a href="#cb77-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-44"><a href="#cb77-44" aria-hidden="true" tabindex="-1"></a><span class="co"># For specific feature analysis, use dependence plots</span></span>
<span id="cb77-45"><a href="#cb77-45" aria-hidden="true" tabindex="-1"></a>shap.dependence_plot(importance_original.iloc[<span class="dv">2</span>][<span class="st">'feature'</span>], shap_values_original.values, X_train)</span>
<span id="cb77-46"><a href="#cb77-46" aria-hidden="true" tabindex="-1"></a>shap.dependence_plot(importance_transformed.iloc[<span class="dv">2</span>][<span class="st">'feature'</span>], shap_values_transformed.values, X_train_tfz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="xgboost_files/figure-html/cell-72-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Top 10 features (Original):
              feature  importance
3          TumourSize    0.286982
8    SNVindelNeo_IC50    0.234111
4     FusionNeo_Count    0.211817
6         FN/FT_Ratio    0.196752
..                ...         ...
7   SNVindelNeo_Count    0.155644
2          TumorGrade    0.110269
0                 Age    0.099511
1               Stage    0.039045

[9 rows x 2 columns]

Top 10 features (Transformed):
                    feature  importance
2                TumorGrade    0.278227
7         SNVindelNeo_Count    0.206780
6               FN/FT_Ratio    0.198583
0                       Age    0.151603
..                      ...         ...
3                TumourSize    0.126634
8          SNVindelNeo_IC50    0.110108
5   FusionTransscript_Count    0.107770
1                     Stage    0.026071

[9 rows x 2 columns]</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="xgboost_files/figure-html/cell-72-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="xgboost_files/figure-html/cell-72-output-4.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>