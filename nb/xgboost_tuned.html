<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Gradient-Boosting Machine (XGBoost) - With Tuned Hyperparameters</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="xgboost_tuned_files/libs/clipboard/clipboard.min.js"></script>
<script src="xgboost_tuned_files/libs/quarto-html/quarto.js"></script>
<script src="xgboost_tuned_files/libs/quarto-html/popper.min.js"></script>
<script src="xgboost_tuned_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="xgboost_tuned_files/libs/quarto-html/anchor.min.js"></script>
<link href="xgboost_tuned_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="xgboost_tuned_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="xgboost_tuned_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="xgboost_tuned_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="xgboost_tuned_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Gradient-Boosting Machine (XGBoost) - With Tuned Hyperparameters</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="exploring-the-association-between-neoantigen-related-variables-and-immune-scores" class="level3">
<h3 class="anchored" data-anchor-id="exploring-the-association-between-neoantigen-related-variables-and-immune-scores"><em>Exploring the association between neoantigen-related variables and immune scores</em></h3>
<p>This notebook is the continuation of the <code>xgboost.ipynb</code> notebook, which details hyperparameter tuning grid search with cross-validation to model interactions of select X features on a subset of Y labels (based on the PCA work done by Caitlin from GB team).</p>
<section id="package-and-raw-data-loading" class="level4">
<h4 class="anchored" data-anchor-id="package-and-raw-data-loading"><strong>Package and Raw Data Loading</strong></h4>
<p>First, import necessary packages and load in the raw data table into <code>pandas</code> dataFrame.</p>
<div id="cell-3" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xgboost <span class="im">as</span> xgb</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> feature_engine.transformation <span class="im">import</span> YeoJohnsonTransformer</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> warnings <span class="im">import</span> simplefilter, filterwarnings</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>simplefilter(action<span class="op">=</span><span class="st">"ignore"</span>, category<span class="op">=</span>pd.errors.PerformanceWarning)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>filterwarnings(<span class="st">"ignore"</span>, category<span class="op">=</span><span class="pp">UserWarning</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_columns'</span>, <span class="va">None</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_format <span class="op">=</span> <span class="st">'retina'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Load up the cleaned-up dataset wrangled from MHâ€™s latest work.</p>
<div id="cell-5" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read in latest data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># use the 202409_new_excludedIHC_batch-duplicate-removed.tsv</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"../input-data/SA/202409_new_excludedIHC_batch-duplicate-removed.tsv"</span>,sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.shape)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#print row 107 and 226</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>df.iloc[[<span class="dv">107</span>,<span class="dv">226</span>,<span class="dv">555</span>,<span class="dv">872</span>], :<span class="dv">25</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(953, 156)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">Batch</th>
<th data-quarto-table-cell-role="th">PAM50</th>
<th data-quarto-table-cell-role="th">Subtype</th>
<th data-quarto-table-cell-role="th">HR_status</th>
<th data-quarto-table-cell-role="th">HER_status</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">AgeGroup</th>
<th data-quarto-table-cell-role="th">Stage</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionNeo_bestScore</th>
<th data-quarto-table-cell-role="th">FusionTransscript_Count</th>
<th data-quarto-table-cell-role="th">Fusion_T2NeoRate</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50Percentile</th>
<th data-quarto-table-cell-role="th">TotalNeo_Count</th>
<th data-quarto-table-cell-role="th">ESTIMATE</th>
<th data-quarto-table-cell-role="th">IMPRES</th>
<th data-quarto-table-cell-role="th">Bindea_full</th>
<th data-quarto-table-cell-role="th">Expanded_IFNg</th>
<th data-quarto-table-cell-role="th">C_Bcellsnaive</th>
<th data-quarto-table-cell-role="th">C_Bcellsmemory</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">107</td>
<td>SD0299</td>
<td>Batch_1</td>
<td>LumA</td>
<td>HR+/HER2-</td>
<td>HR+</td>
<td>HER2-</td>
<td>60.0</td>
<td>51-60</td>
<td>2.0</td>
<td>2.0</td>
<td>3.0</td>
<td>NaN</td>
<td>NaN</td>
<td>10.0</td>
<td>NaN</td>
<td>153.0</td>
<td>3.9</td>
<td>0.0038</td>
<td>NaN</td>
<td>2706.111665</td>
<td>9.0</td>
<td>-0.2558</td>
<td>-0.7362</td>
<td>0.078713</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">226</td>
<td>SD0787</td>
<td>Batch_1</td>
<td>LumA</td>
<td>HR+/HER2-</td>
<td>HR+</td>
<td>HER2-</td>
<td>66.0</td>
<td>61-70</td>
<td>3.0</td>
<td>2.0</td>
<td>2.5</td>
<td>NaN</td>
<td>NaN</td>
<td>12.0</td>
<td>NaN</td>
<td>141.0</td>
<td>3.8</td>
<td>0.0040</td>
<td>NaN</td>
<td>2809.623846</td>
<td>9.0</td>
<td>-0.2755</td>
<td>-0.8429</td>
<td>0.164741</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">555</td>
<td>B13822</td>
<td>Batch_2</td>
<td>Her2</td>
<td>TNBC</td>
<td>HR-</td>
<td>HER2-</td>
<td>67.0</td>
<td>61-70</td>
<td>1.0</td>
<td>NaN</td>
<td>1.6</td>
<td>NaN</td>
<td>NaN</td>
<td>62.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5273.837913</td>
<td>10.0</td>
<td>0.0110</td>
<td>0.6930</td>
<td>0.118868</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">872</td>
<td>SD2132</td>
<td>Batch_2</td>
<td>Basal</td>
<td>TNBC</td>
<td>HR-</td>
<td>HER2-</td>
<td>56.0</td>
<td>51-60</td>
<td>2.0</td>
<td>2.0</td>
<td>2.6</td>
<td>48.0</td>
<td>10.86</td>
<td>85.0</td>
<td>0.564705882</td>
<td>2179.0</td>
<td>1.8</td>
<td>0.0010</td>
<td>2227.0</td>
<td>3518.159157</td>
<td>10.0</td>
<td>-0.3685</td>
<td>0.1545</td>
<td>0.106324</td>
<td>0.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-6" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># exclude the 29 Cibersort scores, leaving only 3</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(columns<span class="op">=</span>[<span class="st">'Bindea_full'</span>, <span class="st">'Expanded_IFNg'</span>, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">'C_Bcellsmemory'</span>,<span class="st">'C_Plasmacells'</span>,<span class="st">'C_TcellsCD8'</span>,<span class="st">'C_TcellsCD4naive'</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">'C_TcellsCD4memoryactivated'</span>,<span class="st">'C_Tcellsfollicularhelper'</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">'C_Tcellsregulatory(Tregs)'</span>,<span class="st">'C_Tcellsgammadelta'</span>,<span class="st">'C_NKcellsresting'</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">'C_NKcellsactivated'</span>, <span class="st">'C_Monocytes'</span>, <span class="st">'C_MacrophagesM0'</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">'C_MacrophagesM1'</span>,<span class="st">'C_Dendriticcellsresting'</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">'C_Dendriticcellsactivated'</span>, <span class="st">'C_Mastcellsresting'</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">'C_Mastcellsactivated'</span>,<span class="st">'C_Eosinophils'</span>, <span class="st">'C_Neutrophils'</span>, <span class="st">'S_PAM100HRD'</span>])</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.shape)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(953, 134)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">Batch</th>
<th data-quarto-table-cell-role="th">PAM50</th>
<th data-quarto-table-cell-role="th">Subtype</th>
<th data-quarto-table-cell-role="th">HR_status</th>
<th data-quarto-table-cell-role="th">HER_status</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">AgeGroup</th>
<th data-quarto-table-cell-role="th">Stage</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionNeo_bestScore</th>
<th data-quarto-table-cell-role="th">FusionTransscript_Count</th>
<th data-quarto-table-cell-role="th">Fusion_T2NeoRate</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50Percentile</th>
<th data-quarto-table-cell-role="th">TotalNeo_Count</th>
<th data-quarto-table-cell-role="th">ESTIMATE</th>
<th data-quarto-table-cell-role="th">IMPRES</th>
<th data-quarto-table-cell-role="th">C_Bcellsnaive</th>
<th data-quarto-table-cell-role="th">C_TcellsCD4memoryresting</th>
<th data-quarto-table-cell-role="th">C_MacrophagesM2</th>
<th data-quarto-table-cell-role="th">S_Attractors_LYM</th>
<th data-quarto-table-cell-role="th">S_Attractors_IFIT3</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_GIMAP4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_HLA.DPA1</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SLAMF6</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_LILRB4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SIGLEC9</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CYTH4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CD3E</th>
<th data-quarto-table-cell-role="th">S_Lymph_Vessels</th>
<th data-quarto-table-cell-role="th">S_ICR_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_INHIB_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_ACT_SCORE</th>
<th data-quarto-table-cell-role="th">S_Angiogenesis</th>
<th data-quarto-table-cell-role="th">S_APM1</th>
<th data-quarto-table-cell-role="th">S_APM2</th>
<th data-quarto-table-cell-role="th">S_ICS5_score</th>
<th data-quarto-table-cell-role="th">S_LIexpression_score</th>
<th data-quarto-table-cell-role="th">S_Chemokine12_score</th>
<th data-quarto-table-cell-role="th">S_NHI_5gene_score</th>
<th data-quarto-table-cell-role="th">S_CD68</th>
<th data-quarto-table-cell-role="th">S_CD8A</th>
<th data-quarto-table-cell-role="th">S_PD1_data</th>
<th data-quarto-table-cell-role="th">S_PDL1_data</th>
<th data-quarto-table-cell-role="th">S_PD1_PDL1_score</th>
<th data-quarto-table-cell-role="th">S_CTLA4_data</th>
<th data-quarto-table-cell-role="th">S_Bcell_mg_IGJ</th>
<th data-quarto-table-cell-role="th">S_Bcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_STAT1_score</th>
<th data-quarto-table-cell-role="th">S_CSF1_response</th>
<th data-quarto-table-cell-role="th">S_TcClassII_score</th>
<th data-quarto-table-cell-role="th">S_IL12_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL4_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL2_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL13_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IFNG_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TGFB_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TREM1_data</th>
<th data-quarto-table-cell-role="th">S_DAP12_data</th>
<th data-quarto-table-cell-role="th">S_Tcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_IL8_21978456</th>
<th data-quarto-table-cell-role="th">S_IFN_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC1_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC2_21978456</th>
<th data-quarto-table-cell-role="th">S_Bcell_21978456</th>
<th data-quarto-table-cell-role="th">S_Tcell_21978456</th>
<th data-quarto-table-cell-role="th">S_CD103pos_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_CD103neg_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_IgG_19272155</th>
<th data-quarto-table-cell-role="th">S_Interferon_19272155</th>
<th data-quarto-table-cell-role="th">S_LCK_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.I_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.II_19272155</th>
<th data-quarto-table-cell-role="th">S_STAT1_19272155</th>
<th data-quarto-table-cell-role="th">S_Troester_WoundSig_19887484</th>
<th data-quarto-table-cell-role="th">S_MDACC.FNA.1_20805453</th>
<th data-quarto-table-cell-role="th">S_IGG_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Minterferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Immune_cell_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_MCD3_CD8_21214954</th>
<th data-quarto-table-cell-role="th">S_Interferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_B_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_CD8_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_GRANS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_LYMPHS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_T_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_TGFB_PCA_17349583</th>
<th data-quarto-table-cell-role="th">S_Rotterdam_ERneg_PCA_15721472</th>
<th data-quarto-table-cell-role="th">S_HER2_Immune_PCA_18006808</th>
<th data-quarto-table-cell-role="th">S_IR7_score</th>
<th data-quarto-table-cell-role="th">S_Buck14_score</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_score</th>
<th data-quarto-table-cell-role="th">S_Immune_NSCLC_score</th>
<th data-quarto-table-cell-role="th">S_Module3_IFN_score</th>
<th data-quarto-table-cell-role="th">S_Module4_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module5_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module11_Prolif_score</th>
<th data-quarto-table-cell-role="th">S_CD8_CD68_ratio</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_TcClassII_ratio</th>
<th data-quarto-table-cell-role="th">S_CHANG_CORE_SERUM_RESPONSE_UP</th>
<th data-quarto-table-cell-role="th">S_CSR_Activated_15701700</th>
<th data-quarto-table-cell-role="th">S_B_cells</th>
<th data-quarto-table-cell-role="th">S_T_cells</th>
<th data-quarto-table-cell-role="th">S_T_helper</th>
<th data-quarto-table-cell-role="th">S_Tcm</th>
<th data-quarto-table-cell-role="th">S_Tem</th>
<th data-quarto-table-cell-role="th">S_Th1</th>
<th data-quarto-table-cell-role="th">S_Th2</th>
<th data-quarto-table-cell-role="th">S_TFH</th>
<th data-quarto-table-cell-role="th">S_CD8_Tcells</th>
<th data-quarto-table-cell-role="th">S_Th17</th>
<th data-quarto-table-cell-role="th">S_Treg</th>
<th data-quarto-table-cell-role="th">S_Tgd</th>
<th data-quarto-table-cell-role="th">S_Cytotoxic_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cd56dim</th>
<th data-quarto-table-cell-role="th">S_NK_cd56bright</th>
<th data-quarto-table-cell-role="th">S_DC</th>
<th data-quarto-table-cell-role="th">S_iDC</th>
<th data-quarto-table-cell-role="th">S_aDC</th>
<th data-quarto-table-cell-role="th">S_pDC</th>
<th data-quarto-table-cell-role="th">S_Eosinophils</th>
<th data-quarto-table-cell-role="th">S_Macrophages</th>
<th data-quarto-table-cell-role="th">S_Mast</th>
<th data-quarto-table-cell-role="th">S_Neutrophils</th>
<th data-quarto-table-cell-role="th">S_Bindea_full</th>
<th data-quarto-table-cell-role="th">S_Expanded_IFNg</th>
<th data-quarto-table-cell-role="th">S_KEGG_MMR</th>
<th data-quarto-table-cell-role="th">S_KEGG_TGF_Beta</th>
<th data-quarto-table-cell-role="th">S_KEGG_Cytosolic_DNA_Sensing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>SD0012</td>
<td>Batch_1</td>
<td>LumB</td>
<td>HR+/HER2-</td>
<td>HR+</td>
<td>HER2-</td>
<td>50.0</td>
<td>41-50</td>
<td>2.0</td>
<td>2.0</td>
<td>2.3</td>
<td>20.0</td>
<td>5.79</td>
<td>42.0</td>
<td>0.476190476</td>
<td>357.0</td>
<td>1.7</td>
<td>0.0025</td>
<td>377.0</td>
<td>2895.605487</td>
<td>9.0</td>
<td>0.120394</td>
<td>0.117468</td>
<td>0.448450</td>
<td>0.3620</td>
<td>0.4216</td>
<td>0.3034</td>
<td>0.4425</td>
<td>0.2749</td>
<td>0.2983</td>
<td>0.2756</td>
<td>0.3121</td>
<td>0.2765</td>
<td>0.3203</td>
<td>0.2463</td>
<td>0.2341</td>
<td>0.2495</td>
<td>0.3571</td>
<td>0.4591</td>
<td>0.3985</td>
<td>0.2130</td>
<td>0.2223</td>
<td>0.2766</td>
<td>0.3573</td>
<td>0.1561</td>
<td>0.2942</td>
<td>0.1536</td>
<td>0.2530</td>
<td>0.2042</td>
<td>0.2061</td>
<td>0.1942</td>
<td>0.2764</td>
<td>0.3327</td>
<td>0.3795</td>
<td>0.3435</td>
<td>0.2846</td>
<td>0.3797</td>
<td>0.3761</td>
<td>0.3197</td>
<td>0.4008</td>
<td>0.4403</td>
<td>0.2907</td>
<td>0.4011</td>
<td>0.2526</td>
<td>0.2237</td>
<td>0.4256</td>
<td>0.3971</td>
<td>0.4477</td>
<td>0.1852</td>
<td>0.2516</td>
<td>0.2262</td>
<td>0.3854</td>
<td>0.1591</td>
<td>0.4462</td>
<td>0.2912</td>
<td>0.4211</td>
<td>0.4502</td>
<td>0.3610</td>
<td>0.2711</td>
<td>0.3414</td>
<td>0.2183</td>
<td>0.3728</td>
<td>0.3512</td>
<td>0.3529</td>
<td>0.4162</td>
<td>0.3612</td>
<td>0.2215</td>
<td>0.3614</td>
<td>0.4294</td>
<td>0.3451</td>
<td>0.4648</td>
<td>0.2937</td>
<td>0.3338</td>
<td>0.2999</td>
<td>0.2094</td>
<td>0.2743</td>
<td>0.3203</td>
<td>0.4136</td>
<td>0.2546</td>
<td>0.2730</td>
<td>0.3697</td>
<td>0.2268</td>
<td>0.3335</td>
<td>0.3959</td>
<td>0.4066</td>
<td>0.2199</td>
<td>0.2395</td>
<td>0.4132</td>
<td>0.3633</td>
<td>0.3210</td>
<td>0.2599</td>
<td>0.3561</td>
<td>0.3112</td>
<td>0.3645</td>
<td>0.2810</td>
<td>0.2348</td>
<td>0.1945</td>
<td>0.2188</td>
<td>0.3281</td>
<td>0.0602</td>
<td>0.2038</td>
<td>0.2445</td>
<td>0.3220</td>
<td>0.2212</td>
<td>0.2866</td>
<td>0.3030</td>
<td>0.3657</td>
<td>0.2499</td>
<td>0.2531</td>
<td>0.3031</td>
<td>0.3097</td>
<td>0.4053</td>
<td>0.3537</td>
<td>0.2530</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>SD0014</td>
<td>Batch_1</td>
<td>LumA</td>
<td>HR+/HER2-</td>
<td>HR+</td>
<td>HER2-</td>
<td>58.0</td>
<td>51-60</td>
<td>2.0</td>
<td>2.0</td>
<td>2.5</td>
<td>10.0</td>
<td>5.28</td>
<td>17.0</td>
<td>0.588235294</td>
<td>85.0</td>
<td>4.1</td>
<td>0.0039</td>
<td>95.0</td>
<td>4257.831526</td>
<td>11.0</td>
<td>0.165023</td>
<td>0.207531</td>
<td>0.124223</td>
<td>0.4126</td>
<td>0.3815</td>
<td>0.3619</td>
<td>0.4760</td>
<td>0.3343</td>
<td>0.3001</td>
<td>0.2769</td>
<td>0.3761</td>
<td>0.3525</td>
<td>0.3452</td>
<td>0.3051</td>
<td>0.2701</td>
<td>0.3143</td>
<td>0.3803</td>
<td>0.4819</td>
<td>0.4125</td>
<td>0.3002</td>
<td>0.3106</td>
<td>0.3646</td>
<td>0.3753</td>
<td>0.1030</td>
<td>0.3644</td>
<td>0.2726</td>
<td>0.2377</td>
<td>0.2553</td>
<td>0.2513</td>
<td>0.2820</td>
<td>0.3079</td>
<td>0.3515</td>
<td>0.3869</td>
<td>0.3868</td>
<td>0.3133</td>
<td>0.4051</td>
<td>0.4031</td>
<td>0.3308</td>
<td>0.4120</td>
<td>0.4496</td>
<td>0.2012</td>
<td>0.4360</td>
<td>0.3290</td>
<td>0.2562</td>
<td>0.3882</td>
<td>0.4310</td>
<td>0.4682</td>
<td>0.2990</td>
<td>0.3007</td>
<td>0.2859</td>
<td>0.3998</td>
<td>0.2225</td>
<td>0.4068</td>
<td>0.3481</td>
<td>0.4494</td>
<td>0.4710</td>
<td>0.4011</td>
<td>0.2840</td>
<td>0.3779</td>
<td>0.2727</td>
<td>0.3831</td>
<td>0.3864</td>
<td>0.3511</td>
<td>0.3983</td>
<td>0.3676</td>
<td>0.2761</td>
<td>0.3637</td>
<td>0.4268</td>
<td>0.3555</td>
<td>0.4580</td>
<td>0.3266</td>
<td>0.3549</td>
<td>0.3763</td>
<td>0.2157</td>
<td>0.3028</td>
<td>0.3278</td>
<td>0.3896</td>
<td>0.3111</td>
<td>0.3159</td>
<td>0.3126</td>
<td>0.2395</td>
<td>0.3747</td>
<td>0.3838</td>
<td>0.4030</td>
<td>0.2731</td>
<td>0.2909</td>
<td>0.4092</td>
<td>0.3404</td>
<td>0.3530</td>
<td>0.2808</td>
<td>0.3102</td>
<td>0.3229</td>
<td>0.3713</td>
<td>0.2645</td>
<td>0.3182</td>
<td>0.1977</td>
<td>0.2985</td>
<td>0.3502</td>
<td>0.1191</td>
<td>0.3316</td>
<td>0.2976</td>
<td>0.3445</td>
<td>0.2403</td>
<td>0.3450</td>
<td>0.3203</td>
<td>0.3484</td>
<td>0.2768</td>
<td>0.2783</td>
<td>0.3200</td>
<td>0.3668</td>
<td>0.3803</td>
<td>0.3470</td>
<td>0.2606</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>SD0015</td>
<td>Batch_1</td>
<td>LumA</td>
<td>HR+/HER2-</td>
<td>HR+</td>
<td>HER2-</td>
<td>46.0</td>
<td>41-50</td>
<td>1.0</td>
<td>2.0</td>
<td>1.8</td>
<td>4.0</td>
<td>11.48</td>
<td>16.0</td>
<td>0.25</td>
<td>150.0</td>
<td>2.4</td>
<td>0.0042</td>
<td>154.0</td>
<td>3123.055856</td>
<td>8.0</td>
<td>0.162653</td>
<td>0.235337</td>
<td>0.279972</td>
<td>0.3556</td>
<td>0.3782</td>
<td>0.3363</td>
<td>0.4718</td>
<td>0.3015</td>
<td>0.2659</td>
<td>0.2274</td>
<td>0.3180</td>
<td>0.3025</td>
<td>0.3124</td>
<td>0.2622</td>
<td>0.2304</td>
<td>0.2706</td>
<td>0.3761</td>
<td>0.4613</td>
<td>0.3814</td>
<td>0.3055</td>
<td>0.2764</td>
<td>0.3211</td>
<td>0.3784</td>
<td>-0.1955</td>
<td>0.3122</td>
<td>0.1932</td>
<td>0.2485</td>
<td>0.2211</td>
<td>0.2004</td>
<td>0.2478</td>
<td>0.3040</td>
<td>0.3316</td>
<td>0.3646</td>
<td>0.3483</td>
<td>0.3012</td>
<td>0.4038</td>
<td>0.3875</td>
<td>0.3158</td>
<td>0.3986</td>
<td>0.4391</td>
<td>0.1509</td>
<td>0.3958</td>
<td>0.2886</td>
<td>0.2535</td>
<td>0.3764</td>
<td>0.4054</td>
<td>0.4601</td>
<td>0.2509</td>
<td>0.2830</td>
<td>0.2712</td>
<td>0.3801</td>
<td>0.1750</td>
<td>0.3987</td>
<td>0.3063</td>
<td>0.4239</td>
<td>0.4616</td>
<td>0.3587</td>
<td>0.2955</td>
<td>0.3431</td>
<td>0.2278</td>
<td>0.3599</td>
<td>0.3549</td>
<td>0.4011</td>
<td>0.3865</td>
<td>0.3661</td>
<td>0.2671</td>
<td>0.3591</td>
<td>0.4313</td>
<td>0.3489</td>
<td>0.4442</td>
<td>0.2985</td>
<td>0.3383</td>
<td>0.3370</td>
<td>0.2609</td>
<td>0.2706</td>
<td>0.3312</td>
<td>0.3792</td>
<td>0.2851</td>
<td>0.2897</td>
<td>0.2984</td>
<td>0.0936</td>
<td>0.3370</td>
<td>0.3880</td>
<td>0.4038</td>
<td>0.2799</td>
<td>0.2873</td>
<td>0.4159</td>
<td>0.3520</td>
<td>0.3560</td>
<td>0.2600</td>
<td>0.3116</td>
<td>0.3225</td>
<td>0.3762</td>
<td>0.2370</td>
<td>0.2251</td>
<td>0.2021</td>
<td>0.2720</td>
<td>0.3434</td>
<td>0.0626</td>
<td>0.3025</td>
<td>0.2670</td>
<td>0.3212</td>
<td>0.2098</td>
<td>0.2967</td>
<td>0.3236</td>
<td>0.3266</td>
<td>0.2455</td>
<td>0.2522</td>
<td>0.3107</td>
<td>0.3372</td>
<td>0.3793</td>
<td>0.3522</td>
<td>0.2564</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>SD0016</td>
<td>Batch_1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>41.0</td>
<td>41-50</td>
<td>0.0</td>
<td>NaN</td>
<td>11.0</td>
<td>1.0</td>
<td>43.92</td>
<td>15.0</td>
<td>0.066666667</td>
<td>218.0</td>
<td>2.8</td>
<td>0.0027</td>
<td>219.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>SD0017</td>
<td>Batch_1</td>
<td>LumB</td>
<td>HR+/HER2-</td>
<td>HR+</td>
<td>HER2-</td>
<td>54.0</td>
<td>51-60</td>
<td>2.0</td>
<td>2.0</td>
<td>2.5</td>
<td>19.0</td>
<td>15.11</td>
<td>47.0</td>
<td>0.404255319</td>
<td>1369.0</td>
<td>1.7</td>
<td>0.0030</td>
<td>1388.0</td>
<td>5275.497847</td>
<td>11.0</td>
<td>0.155523</td>
<td>0.148387</td>
<td>0.128777</td>
<td>0.4314</td>
<td>0.4482</td>
<td>0.4080</td>
<td>0.4980</td>
<td>0.3912</td>
<td>0.3120</td>
<td>0.2934</td>
<td>0.3864</td>
<td>0.3957</td>
<td>0.3131</td>
<td>0.3589</td>
<td>0.3341</td>
<td>0.3654</td>
<td>0.3842</td>
<td>0.4957</td>
<td>0.4328</td>
<td>0.3533</td>
<td>0.3732</td>
<td>0.4177</td>
<td>0.4350</td>
<td>0.1401</td>
<td>0.4006</td>
<td>0.3023</td>
<td>0.3429</td>
<td>0.3228</td>
<td>0.2922</td>
<td>0.3591</td>
<td>0.3671</td>
<td>0.3926</td>
<td>0.4113</td>
<td>0.4082</td>
<td>0.3325</td>
<td>0.4092</td>
<td>0.4129</td>
<td>0.3338</td>
<td>0.4190</td>
<td>0.4248</td>
<td>0.1319</td>
<td>0.4878</td>
<td>0.3797</td>
<td>0.1889</td>
<td>0.4601</td>
<td>0.4445</td>
<td>0.4859</td>
<td>0.3224</td>
<td>0.3693</td>
<td>0.3003</td>
<td>0.4095</td>
<td>0.2938</td>
<td>0.4707</td>
<td>0.3968</td>
<td>0.4616</td>
<td>0.4893</td>
<td>0.4644</td>
<td>0.2735</td>
<td>0.3955</td>
<td>0.3234</td>
<td>0.4165</td>
<td>0.4337</td>
<td>0.4190</td>
<td>0.4511</td>
<td>0.3758</td>
<td>0.3174</td>
<td>0.3679</td>
<td>0.4314</td>
<td>0.3648</td>
<td>0.4439</td>
<td>0.2886</td>
<td>0.3688</td>
<td>0.4143</td>
<td>0.2489</td>
<td>0.3562</td>
<td>0.3498</td>
<td>0.4563</td>
<td>0.3576</td>
<td>0.3706</td>
<td>0.3377</td>
<td>0.2758</td>
<td>0.4006</td>
<td>0.4000</td>
<td>0.4062</td>
<td>0.3182</td>
<td>0.3460</td>
<td>0.4170</td>
<td>0.3275</td>
<td>0.3432</td>
<td>0.2914</td>
<td>0.3307</td>
<td>0.3525</td>
<td>0.3879</td>
<td>0.2212</td>
<td>0.3330</td>
<td>0.2251</td>
<td>0.3151</td>
<td>0.3495</td>
<td>0.1939</td>
<td>0.2953</td>
<td>0.3010</td>
<td>0.3467</td>
<td>0.2547</td>
<td>0.3313</td>
<td>0.3230</td>
<td>0.3597</td>
<td>0.2726</td>
<td>0.2648</td>
<td>0.3309</td>
<td>0.4165</td>
<td>0.3997</td>
<td>0.3468</td>
<td>0.2682</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="data-preprocessing" class="level4">
<h4 class="anchored" data-anchor-id="data-preprocessing"><strong>Data Preprocessing</strong></h4>
<p>Decide all the clinical variables and neoantigen-related variables to keep in the X matrix (features).</p>
<ol type="1">
<li><p><code>Subtype</code> column has already been encoded categorically by <code>HR_status</code> and <code>HER_status</code> columns so these two columns can be dropped. <strong><em>UPDATE: due to their lesser importance during the default XGBoost modeling, <code>PAM50</code> column was dropped as well.</em></strong></p></li>
<li><p><code>AgeGroup</code> is just a binned information of <code>Age</code> column so it is dropped as it is redundant.</p></li>
<li><p>Drop <code>FusionNeo_bestScore</code>, <code>FusionTransscript_Count</code>, <code>Fusion_T2NeoRate</code> columns as well as the <code>SNVindelNeo_IC50</code> and <code>SNVindelNeo_IC50Percentile</code> columns for now to reduce complexity.</p></li>
<li><p>Drop <code>Batch</code> column.</p></li>
</ol>
<blockquote class="blockquote">
<p><strong>UPDATE 1: Exclude <code>TotalNeo_Count</code>, and include <code>Fusion_T2NeoRate</code> and <code>SNVindelNeo_IC50</code> columns. Also, rename <code>Fusion_T2NeoRate</code> to <code>FN/FT_Ratio</code>.</strong></p>
</blockquote>
<blockquote class="blockquote">
<p><strong>UPDATE 2: put back <code>FusionNeo_bestScore</code> into the X variable set and rename it into <code>FusionNeo_bestIC50</code></strong></p>
</blockquote>
<div id="cell-8" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># let's drop all NaN for now and set col 'ID' as index</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>dfd <span class="op">=</span> df.drop(columns <span class="op">=</span> [<span class="st">'Batch'</span>, <span class="st">'Stage'</span>, <span class="st">'PAM50'</span>, <span class="st">'HR_status'</span>, <span class="st">'HER_status'</span>, <span class="st">'AgeGroup'</span>, <span class="st">'TotalNeo_Count'</span>, <span class="st">'FusionTransscript_Count'</span>, <span class="st">'SNVindelNeo_IC50Percentile'</span>]).dropna().set_index(<span class="st">'ID'</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dfd.shape)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>dfd.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(674, 124)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Subtype</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionNeo_bestScore</th>
<th data-quarto-table-cell-role="th">Fusion_T2NeoRate</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
<th data-quarto-table-cell-role="th">ESTIMATE</th>
<th data-quarto-table-cell-role="th">IMPRES</th>
<th data-quarto-table-cell-role="th">C_Bcellsnaive</th>
<th data-quarto-table-cell-role="th">C_TcellsCD4memoryresting</th>
<th data-quarto-table-cell-role="th">C_MacrophagesM2</th>
<th data-quarto-table-cell-role="th">S_Attractors_LYM</th>
<th data-quarto-table-cell-role="th">S_Attractors_IFIT3</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_GIMAP4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_HLA.DPA1</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SLAMF6</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_LILRB4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SIGLEC9</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CYTH4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CD3E</th>
<th data-quarto-table-cell-role="th">S_Lymph_Vessels</th>
<th data-quarto-table-cell-role="th">S_ICR_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_INHIB_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_ACT_SCORE</th>
<th data-quarto-table-cell-role="th">S_Angiogenesis</th>
<th data-quarto-table-cell-role="th">S_APM1</th>
<th data-quarto-table-cell-role="th">S_APM2</th>
<th data-quarto-table-cell-role="th">S_ICS5_score</th>
<th data-quarto-table-cell-role="th">S_LIexpression_score</th>
<th data-quarto-table-cell-role="th">S_Chemokine12_score</th>
<th data-quarto-table-cell-role="th">S_NHI_5gene_score</th>
<th data-quarto-table-cell-role="th">S_CD68</th>
<th data-quarto-table-cell-role="th">S_CD8A</th>
<th data-quarto-table-cell-role="th">S_PD1_data</th>
<th data-quarto-table-cell-role="th">S_PDL1_data</th>
<th data-quarto-table-cell-role="th">S_PD1_PDL1_score</th>
<th data-quarto-table-cell-role="th">S_CTLA4_data</th>
<th data-quarto-table-cell-role="th">S_Bcell_mg_IGJ</th>
<th data-quarto-table-cell-role="th">S_Bcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_STAT1_score</th>
<th data-quarto-table-cell-role="th">S_CSF1_response</th>
<th data-quarto-table-cell-role="th">S_TcClassII_score</th>
<th data-quarto-table-cell-role="th">S_IL12_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL4_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL2_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL13_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IFNG_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TGFB_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TREM1_data</th>
<th data-quarto-table-cell-role="th">S_DAP12_data</th>
<th data-quarto-table-cell-role="th">S_Tcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_IL8_21978456</th>
<th data-quarto-table-cell-role="th">S_IFN_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC1_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC2_21978456</th>
<th data-quarto-table-cell-role="th">S_Bcell_21978456</th>
<th data-quarto-table-cell-role="th">S_Tcell_21978456</th>
<th data-quarto-table-cell-role="th">S_CD103pos_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_CD103neg_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_IgG_19272155</th>
<th data-quarto-table-cell-role="th">S_Interferon_19272155</th>
<th data-quarto-table-cell-role="th">S_LCK_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.I_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.II_19272155</th>
<th data-quarto-table-cell-role="th">S_STAT1_19272155</th>
<th data-quarto-table-cell-role="th">S_Troester_WoundSig_19887484</th>
<th data-quarto-table-cell-role="th">S_MDACC.FNA.1_20805453</th>
<th data-quarto-table-cell-role="th">S_IGG_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Minterferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Immune_cell_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_MCD3_CD8_21214954</th>
<th data-quarto-table-cell-role="th">S_Interferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_B_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_CD8_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_GRANS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_LYMPHS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_T_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_TGFB_PCA_17349583</th>
<th data-quarto-table-cell-role="th">S_Rotterdam_ERneg_PCA_15721472</th>
<th data-quarto-table-cell-role="th">S_HER2_Immune_PCA_18006808</th>
<th data-quarto-table-cell-role="th">S_IR7_score</th>
<th data-quarto-table-cell-role="th">S_Buck14_score</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_score</th>
<th data-quarto-table-cell-role="th">S_Immune_NSCLC_score</th>
<th data-quarto-table-cell-role="th">S_Module3_IFN_score</th>
<th data-quarto-table-cell-role="th">S_Module4_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module5_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module11_Prolif_score</th>
<th data-quarto-table-cell-role="th">S_CD8_CD68_ratio</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_TcClassII_ratio</th>
<th data-quarto-table-cell-role="th">S_CHANG_CORE_SERUM_RESPONSE_UP</th>
<th data-quarto-table-cell-role="th">S_CSR_Activated_15701700</th>
<th data-quarto-table-cell-role="th">S_B_cells</th>
<th data-quarto-table-cell-role="th">S_T_cells</th>
<th data-quarto-table-cell-role="th">S_T_helper</th>
<th data-quarto-table-cell-role="th">S_Tcm</th>
<th data-quarto-table-cell-role="th">S_Tem</th>
<th data-quarto-table-cell-role="th">S_Th1</th>
<th data-quarto-table-cell-role="th">S_Th2</th>
<th data-quarto-table-cell-role="th">S_TFH</th>
<th data-quarto-table-cell-role="th">S_CD8_Tcells</th>
<th data-quarto-table-cell-role="th">S_Th17</th>
<th data-quarto-table-cell-role="th">S_Treg</th>
<th data-quarto-table-cell-role="th">S_Tgd</th>
<th data-quarto-table-cell-role="th">S_Cytotoxic_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cd56dim</th>
<th data-quarto-table-cell-role="th">S_NK_cd56bright</th>
<th data-quarto-table-cell-role="th">S_DC</th>
<th data-quarto-table-cell-role="th">S_iDC</th>
<th data-quarto-table-cell-role="th">S_aDC</th>
<th data-quarto-table-cell-role="th">S_pDC</th>
<th data-quarto-table-cell-role="th">S_Eosinophils</th>
<th data-quarto-table-cell-role="th">S_Macrophages</th>
<th data-quarto-table-cell-role="th">S_Mast</th>
<th data-quarto-table-cell-role="th">S_Neutrophils</th>
<th data-quarto-table-cell-role="th">S_Bindea_full</th>
<th data-quarto-table-cell-role="th">S_Expanded_IFNg</th>
<th data-quarto-table-cell-role="th">S_KEGG_MMR</th>
<th data-quarto-table-cell-role="th">S_KEGG_TGF_Beta</th>
<th data-quarto-table-cell-role="th">S_KEGG_Cytosolic_DNA_Sensing</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0012</td>
<td>HR+/HER2-</td>
<td>50.0</td>
<td>2.0</td>
<td>2.3</td>
<td>20.0</td>
<td>5.79</td>
<td>0.476190476</td>
<td>357.0</td>
<td>1.7</td>
<td>2895.605487</td>
<td>9.0</td>
<td>0.120394</td>
<td>0.117468</td>
<td>0.448450</td>
<td>0.3620</td>
<td>0.4216</td>
<td>0.3034</td>
<td>0.4425</td>
<td>0.2749</td>
<td>0.2983</td>
<td>0.2756</td>
<td>0.3121</td>
<td>0.2765</td>
<td>0.3203</td>
<td>0.2463</td>
<td>0.2341</td>
<td>0.2495</td>
<td>0.3571</td>
<td>0.4591</td>
<td>0.3985</td>
<td>0.2130</td>
<td>0.2223</td>
<td>0.2766</td>
<td>0.3573</td>
<td>0.1561</td>
<td>0.2942</td>
<td>0.1536</td>
<td>0.2530</td>
<td>0.2042</td>
<td>0.2061</td>
<td>0.1942</td>
<td>0.2764</td>
<td>0.3327</td>
<td>0.3795</td>
<td>0.3435</td>
<td>0.2846</td>
<td>0.3797</td>
<td>0.3761</td>
<td>0.3197</td>
<td>0.4008</td>
<td>0.4403</td>
<td>0.2907</td>
<td>0.4011</td>
<td>0.2526</td>
<td>0.2237</td>
<td>0.4256</td>
<td>0.3971</td>
<td>0.4477</td>
<td>0.1852</td>
<td>0.2516</td>
<td>0.2262</td>
<td>0.3854</td>
<td>0.1591</td>
<td>0.4462</td>
<td>0.2912</td>
<td>0.4211</td>
<td>0.4502</td>
<td>0.3610</td>
<td>0.2711</td>
<td>0.3414</td>
<td>0.2183</td>
<td>0.3728</td>
<td>0.3512</td>
<td>0.3529</td>
<td>0.4162</td>
<td>0.3612</td>
<td>0.2215</td>
<td>0.3614</td>
<td>0.4294</td>
<td>0.3451</td>
<td>0.4648</td>
<td>0.2937</td>
<td>0.3338</td>
<td>0.2999</td>
<td>0.2094</td>
<td>0.2743</td>
<td>0.3203</td>
<td>0.4136</td>
<td>0.2546</td>
<td>0.2730</td>
<td>0.3697</td>
<td>0.2268</td>
<td>0.3335</td>
<td>0.3959</td>
<td>0.4066</td>
<td>0.2199</td>
<td>0.2395</td>
<td>0.4132</td>
<td>0.3633</td>
<td>0.3210</td>
<td>0.2599</td>
<td>0.3561</td>
<td>0.3112</td>
<td>0.3645</td>
<td>0.2810</td>
<td>0.2348</td>
<td>0.1945</td>
<td>0.2188</td>
<td>0.3281</td>
<td>0.0602</td>
<td>0.2038</td>
<td>0.2445</td>
<td>0.3220</td>
<td>0.2212</td>
<td>0.2866</td>
<td>0.3030</td>
<td>0.3657</td>
<td>0.2499</td>
<td>0.2531</td>
<td>0.3031</td>
<td>0.3097</td>
<td>0.4053</td>
<td>0.3537</td>
<td>0.2530</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0014</td>
<td>HR+/HER2-</td>
<td>58.0</td>
<td>2.0</td>
<td>2.5</td>
<td>10.0</td>
<td>5.28</td>
<td>0.588235294</td>
<td>85.0</td>
<td>4.1</td>
<td>4257.831526</td>
<td>11.0</td>
<td>0.165023</td>
<td>0.207531</td>
<td>0.124223</td>
<td>0.4126</td>
<td>0.3815</td>
<td>0.3619</td>
<td>0.4760</td>
<td>0.3343</td>
<td>0.3001</td>
<td>0.2769</td>
<td>0.3761</td>
<td>0.3525</td>
<td>0.3452</td>
<td>0.3051</td>
<td>0.2701</td>
<td>0.3143</td>
<td>0.3803</td>
<td>0.4819</td>
<td>0.4125</td>
<td>0.3002</td>
<td>0.3106</td>
<td>0.3646</td>
<td>0.3753</td>
<td>0.1030</td>
<td>0.3644</td>
<td>0.2726</td>
<td>0.2377</td>
<td>0.2553</td>
<td>0.2513</td>
<td>0.2820</td>
<td>0.3079</td>
<td>0.3515</td>
<td>0.3869</td>
<td>0.3868</td>
<td>0.3133</td>
<td>0.4051</td>
<td>0.4031</td>
<td>0.3308</td>
<td>0.4120</td>
<td>0.4496</td>
<td>0.2012</td>
<td>0.4360</td>
<td>0.3290</td>
<td>0.2562</td>
<td>0.3882</td>
<td>0.4310</td>
<td>0.4682</td>
<td>0.2990</td>
<td>0.3007</td>
<td>0.2859</td>
<td>0.3998</td>
<td>0.2225</td>
<td>0.4068</td>
<td>0.3481</td>
<td>0.4494</td>
<td>0.4710</td>
<td>0.4011</td>
<td>0.2840</td>
<td>0.3779</td>
<td>0.2727</td>
<td>0.3831</td>
<td>0.3864</td>
<td>0.3511</td>
<td>0.3983</td>
<td>0.3676</td>
<td>0.2761</td>
<td>0.3637</td>
<td>0.4268</td>
<td>0.3555</td>
<td>0.4580</td>
<td>0.3266</td>
<td>0.3549</td>
<td>0.3763</td>
<td>0.2157</td>
<td>0.3028</td>
<td>0.3278</td>
<td>0.3896</td>
<td>0.3111</td>
<td>0.3159</td>
<td>0.3126</td>
<td>0.2395</td>
<td>0.3747</td>
<td>0.3838</td>
<td>0.4030</td>
<td>0.2731</td>
<td>0.2909</td>
<td>0.4092</td>
<td>0.3404</td>
<td>0.3530</td>
<td>0.2808</td>
<td>0.3102</td>
<td>0.3229</td>
<td>0.3713</td>
<td>0.2645</td>
<td>0.3182</td>
<td>0.1977</td>
<td>0.2985</td>
<td>0.3502</td>
<td>0.1191</td>
<td>0.3316</td>
<td>0.2976</td>
<td>0.3445</td>
<td>0.2403</td>
<td>0.3450</td>
<td>0.3203</td>
<td>0.3484</td>
<td>0.2768</td>
<td>0.2783</td>
<td>0.3200</td>
<td>0.3668</td>
<td>0.3803</td>
<td>0.3470</td>
<td>0.2606</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0015</td>
<td>HR+/HER2-</td>
<td>46.0</td>
<td>2.0</td>
<td>1.8</td>
<td>4.0</td>
<td>11.48</td>
<td>0.25</td>
<td>150.0</td>
<td>2.4</td>
<td>3123.055856</td>
<td>8.0</td>
<td>0.162653</td>
<td>0.235337</td>
<td>0.279972</td>
<td>0.3556</td>
<td>0.3782</td>
<td>0.3363</td>
<td>0.4718</td>
<td>0.3015</td>
<td>0.2659</td>
<td>0.2274</td>
<td>0.3180</td>
<td>0.3025</td>
<td>0.3124</td>
<td>0.2622</td>
<td>0.2304</td>
<td>0.2706</td>
<td>0.3761</td>
<td>0.4613</td>
<td>0.3814</td>
<td>0.3055</td>
<td>0.2764</td>
<td>0.3211</td>
<td>0.3784</td>
<td>-0.1955</td>
<td>0.3122</td>
<td>0.1932</td>
<td>0.2485</td>
<td>0.2211</td>
<td>0.2004</td>
<td>0.2478</td>
<td>0.3040</td>
<td>0.3316</td>
<td>0.3646</td>
<td>0.3483</td>
<td>0.3012</td>
<td>0.4038</td>
<td>0.3875</td>
<td>0.3158</td>
<td>0.3986</td>
<td>0.4391</td>
<td>0.1509</td>
<td>0.3958</td>
<td>0.2886</td>
<td>0.2535</td>
<td>0.3764</td>
<td>0.4054</td>
<td>0.4601</td>
<td>0.2509</td>
<td>0.2830</td>
<td>0.2712</td>
<td>0.3801</td>
<td>0.1750</td>
<td>0.3987</td>
<td>0.3063</td>
<td>0.4239</td>
<td>0.4616</td>
<td>0.3587</td>
<td>0.2955</td>
<td>0.3431</td>
<td>0.2278</td>
<td>0.3599</td>
<td>0.3549</td>
<td>0.4011</td>
<td>0.3865</td>
<td>0.3661</td>
<td>0.2671</td>
<td>0.3591</td>
<td>0.4313</td>
<td>0.3489</td>
<td>0.4442</td>
<td>0.2985</td>
<td>0.3383</td>
<td>0.3370</td>
<td>0.2609</td>
<td>0.2706</td>
<td>0.3312</td>
<td>0.3792</td>
<td>0.2851</td>
<td>0.2897</td>
<td>0.2984</td>
<td>0.0936</td>
<td>0.3370</td>
<td>0.3880</td>
<td>0.4038</td>
<td>0.2799</td>
<td>0.2873</td>
<td>0.4159</td>
<td>0.3520</td>
<td>0.3560</td>
<td>0.2600</td>
<td>0.3116</td>
<td>0.3225</td>
<td>0.3762</td>
<td>0.2370</td>
<td>0.2251</td>
<td>0.2021</td>
<td>0.2720</td>
<td>0.3434</td>
<td>0.0626</td>
<td>0.3025</td>
<td>0.2670</td>
<td>0.3212</td>
<td>0.2098</td>
<td>0.2967</td>
<td>0.3236</td>
<td>0.3266</td>
<td>0.2455</td>
<td>0.2522</td>
<td>0.3107</td>
<td>0.3372</td>
<td>0.3793</td>
<td>0.3522</td>
<td>0.2564</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0017</td>
<td>HR+/HER2-</td>
<td>54.0</td>
<td>2.0</td>
<td>2.5</td>
<td>19.0</td>
<td>15.11</td>
<td>0.404255319</td>
<td>1369.0</td>
<td>1.7</td>
<td>5275.497847</td>
<td>11.0</td>
<td>0.155523</td>
<td>0.148387</td>
<td>0.128777</td>
<td>0.4314</td>
<td>0.4482</td>
<td>0.4080</td>
<td>0.4980</td>
<td>0.3912</td>
<td>0.3120</td>
<td>0.2934</td>
<td>0.3864</td>
<td>0.3957</td>
<td>0.3131</td>
<td>0.3589</td>
<td>0.3341</td>
<td>0.3654</td>
<td>0.3842</td>
<td>0.4957</td>
<td>0.4328</td>
<td>0.3533</td>
<td>0.3732</td>
<td>0.4177</td>
<td>0.4350</td>
<td>0.1401</td>
<td>0.4006</td>
<td>0.3023</td>
<td>0.3429</td>
<td>0.3228</td>
<td>0.2922</td>
<td>0.3591</td>
<td>0.3671</td>
<td>0.3926</td>
<td>0.4113</td>
<td>0.4082</td>
<td>0.3325</td>
<td>0.4092</td>
<td>0.4129</td>
<td>0.3338</td>
<td>0.4190</td>
<td>0.4248</td>
<td>0.1319</td>
<td>0.4878</td>
<td>0.3797</td>
<td>0.1889</td>
<td>0.4601</td>
<td>0.4445</td>
<td>0.4859</td>
<td>0.3224</td>
<td>0.3693</td>
<td>0.3003</td>
<td>0.4095</td>
<td>0.2938</td>
<td>0.4707</td>
<td>0.3968</td>
<td>0.4616</td>
<td>0.4893</td>
<td>0.4644</td>
<td>0.2735</td>
<td>0.3955</td>
<td>0.3234</td>
<td>0.4165</td>
<td>0.4337</td>
<td>0.4190</td>
<td>0.4511</td>
<td>0.3758</td>
<td>0.3174</td>
<td>0.3679</td>
<td>0.4314</td>
<td>0.3648</td>
<td>0.4439</td>
<td>0.2886</td>
<td>0.3688</td>
<td>0.4143</td>
<td>0.2489</td>
<td>0.3562</td>
<td>0.3498</td>
<td>0.4563</td>
<td>0.3576</td>
<td>0.3706</td>
<td>0.3377</td>
<td>0.2758</td>
<td>0.4006</td>
<td>0.4000</td>
<td>0.4062</td>
<td>0.3182</td>
<td>0.3460</td>
<td>0.4170</td>
<td>0.3275</td>
<td>0.3432</td>
<td>0.2914</td>
<td>0.3307</td>
<td>0.3525</td>
<td>0.3879</td>
<td>0.2212</td>
<td>0.3330</td>
<td>0.2251</td>
<td>0.3151</td>
<td>0.3495</td>
<td>0.1939</td>
<td>0.2953</td>
<td>0.3010</td>
<td>0.3467</td>
<td>0.2547</td>
<td>0.3313</td>
<td>0.3230</td>
<td>0.3597</td>
<td>0.2726</td>
<td>0.2648</td>
<td>0.3309</td>
<td>0.4165</td>
<td>0.3997</td>
<td>0.3468</td>
<td>0.2682</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0018</td>
<td>HR+/HER2+</td>
<td>58.0</td>
<td>3.0</td>
<td>3.0</td>
<td>39.0</td>
<td>3.00</td>
<td>0.30952381</td>
<td>382.0</td>
<td>1.6</td>
<td>3548.348220</td>
<td>11.0</td>
<td>0.129397</td>
<td>0.133531</td>
<td>0.304963</td>
<td>0.3701</td>
<td>0.3859</td>
<td>0.3067</td>
<td>0.4858</td>
<td>0.3141</td>
<td>0.2980</td>
<td>0.2006</td>
<td>0.3222</td>
<td>0.3017</td>
<td>0.3358</td>
<td>0.2870</td>
<td>0.2544</td>
<td>0.2955</td>
<td>0.3292</td>
<td>0.4758</td>
<td>0.4200</td>
<td>0.2892</td>
<td>0.2845</td>
<td>0.3767</td>
<td>0.4084</td>
<td>0.1187</td>
<td>0.2786</td>
<td>0.2363</td>
<td>0.2357</td>
<td>0.2360</td>
<td>0.2310</td>
<td>0.3125</td>
<td>0.3054</td>
<td>0.3430</td>
<td>0.3742</td>
<td>0.3709</td>
<td>0.2860</td>
<td>0.3689</td>
<td>0.3880</td>
<td>0.3172</td>
<td>0.4095</td>
<td>0.4343</td>
<td>0.2824</td>
<td>0.4664</td>
<td>0.2799</td>
<td>0.2613</td>
<td>0.3975</td>
<td>0.4264</td>
<td>0.4805</td>
<td>0.3210</td>
<td>0.2670</td>
<td>0.2429</td>
<td>0.3952</td>
<td>0.2321</td>
<td>0.4166</td>
<td>0.3061</td>
<td>0.4446</td>
<td>0.4658</td>
<td>0.4181</td>
<td>0.2747</td>
<td>0.3910</td>
<td>0.3019</td>
<td>0.3722</td>
<td>0.3716</td>
<td>0.3075</td>
<td>0.3931</td>
<td>0.3605</td>
<td>0.2308</td>
<td>0.3603</td>
<td>0.4258</td>
<td>0.3393</td>
<td>0.4654</td>
<td>0.2920</td>
<td>0.3385</td>
<td>0.3668</td>
<td>0.2237</td>
<td>0.3404</td>
<td>0.3264</td>
<td>0.3909</td>
<td>0.2758</td>
<td>0.3050</td>
<td>0.3770</td>
<td>0.2009</td>
<td>0.3664</td>
<td>0.4026</td>
<td>0.4092</td>
<td>0.2699</td>
<td>0.2530</td>
<td>0.3955</td>
<td>0.3185</td>
<td>0.3066</td>
<td>0.2713</td>
<td>0.3333</td>
<td>0.3041</td>
<td>0.3523</td>
<td>0.2401</td>
<td>0.2709</td>
<td>0.1413</td>
<td>0.2636</td>
<td>0.3061</td>
<td>0.0764</td>
<td>0.2639</td>
<td>0.2623</td>
<td>0.3348</td>
<td>0.2124</td>
<td>0.2731</td>
<td>0.3020</td>
<td>0.3540</td>
<td>0.2233</td>
<td>0.2182</td>
<td>0.2979</td>
<td>0.3530</td>
<td>0.4033</td>
<td>0.3444</td>
<td>0.2496</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-9" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the column `Fusion_T2NeoRate` to `FN/FT_Ratio` and `FusionNeo_bestScore` to `FusionNeo_bestIC50`</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>dfd.rename(columns<span class="op">=</span>{<span class="st">'Fusion_T2NeoRate'</span>: <span class="st">'FN/FT_Ratio'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>dfd.rename(columns<span class="op">=</span>{<span class="st">'FusionNeo_bestScore'</span>: <span class="st">'FusionNeo_bestIC50'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-10" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>dfd.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Subtype</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionNeo_bestIC50</th>
<th data-quarto-table-cell-role="th">FN/FT_Ratio</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
<th data-quarto-table-cell-role="th">ESTIMATE</th>
<th data-quarto-table-cell-role="th">IMPRES</th>
<th data-quarto-table-cell-role="th">C_Bcellsnaive</th>
<th data-quarto-table-cell-role="th">C_TcellsCD4memoryresting</th>
<th data-quarto-table-cell-role="th">C_MacrophagesM2</th>
<th data-quarto-table-cell-role="th">S_Attractors_LYM</th>
<th data-quarto-table-cell-role="th">S_Attractors_IFIT3</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_GIMAP4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_HLA.DPA1</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SLAMF6</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_LILRB4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SIGLEC9</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CYTH4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CD3E</th>
<th data-quarto-table-cell-role="th">S_Lymph_Vessels</th>
<th data-quarto-table-cell-role="th">S_ICR_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_INHIB_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_ACT_SCORE</th>
<th data-quarto-table-cell-role="th">S_Angiogenesis</th>
<th data-quarto-table-cell-role="th">S_APM1</th>
<th data-quarto-table-cell-role="th">S_APM2</th>
<th data-quarto-table-cell-role="th">S_ICS5_score</th>
<th data-quarto-table-cell-role="th">S_LIexpression_score</th>
<th data-quarto-table-cell-role="th">S_Chemokine12_score</th>
<th data-quarto-table-cell-role="th">S_NHI_5gene_score</th>
<th data-quarto-table-cell-role="th">S_CD68</th>
<th data-quarto-table-cell-role="th">S_CD8A</th>
<th data-quarto-table-cell-role="th">S_PD1_data</th>
<th data-quarto-table-cell-role="th">S_PDL1_data</th>
<th data-quarto-table-cell-role="th">S_PD1_PDL1_score</th>
<th data-quarto-table-cell-role="th">S_CTLA4_data</th>
<th data-quarto-table-cell-role="th">S_Bcell_mg_IGJ</th>
<th data-quarto-table-cell-role="th">S_Bcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_STAT1_score</th>
<th data-quarto-table-cell-role="th">S_CSF1_response</th>
<th data-quarto-table-cell-role="th">S_TcClassII_score</th>
<th data-quarto-table-cell-role="th">S_IL12_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL4_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL2_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL13_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IFNG_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TGFB_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TREM1_data</th>
<th data-quarto-table-cell-role="th">S_DAP12_data</th>
<th data-quarto-table-cell-role="th">S_Tcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_IL8_21978456</th>
<th data-quarto-table-cell-role="th">S_IFN_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC1_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC2_21978456</th>
<th data-quarto-table-cell-role="th">S_Bcell_21978456</th>
<th data-quarto-table-cell-role="th">S_Tcell_21978456</th>
<th data-quarto-table-cell-role="th">S_CD103pos_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_CD103neg_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_IgG_19272155</th>
<th data-quarto-table-cell-role="th">S_Interferon_19272155</th>
<th data-quarto-table-cell-role="th">S_LCK_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.I_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.II_19272155</th>
<th data-quarto-table-cell-role="th">S_STAT1_19272155</th>
<th data-quarto-table-cell-role="th">S_Troester_WoundSig_19887484</th>
<th data-quarto-table-cell-role="th">S_MDACC.FNA.1_20805453</th>
<th data-quarto-table-cell-role="th">S_IGG_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Minterferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Immune_cell_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_MCD3_CD8_21214954</th>
<th data-quarto-table-cell-role="th">S_Interferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_B_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_CD8_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_GRANS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_LYMPHS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_T_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_TGFB_PCA_17349583</th>
<th data-quarto-table-cell-role="th">S_Rotterdam_ERneg_PCA_15721472</th>
<th data-quarto-table-cell-role="th">S_HER2_Immune_PCA_18006808</th>
<th data-quarto-table-cell-role="th">S_IR7_score</th>
<th data-quarto-table-cell-role="th">S_Buck14_score</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_score</th>
<th data-quarto-table-cell-role="th">S_Immune_NSCLC_score</th>
<th data-quarto-table-cell-role="th">S_Module3_IFN_score</th>
<th data-quarto-table-cell-role="th">S_Module4_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module5_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module11_Prolif_score</th>
<th data-quarto-table-cell-role="th">S_CD8_CD68_ratio</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_TcClassII_ratio</th>
<th data-quarto-table-cell-role="th">S_CHANG_CORE_SERUM_RESPONSE_UP</th>
<th data-quarto-table-cell-role="th">S_CSR_Activated_15701700</th>
<th data-quarto-table-cell-role="th">S_B_cells</th>
<th data-quarto-table-cell-role="th">S_T_cells</th>
<th data-quarto-table-cell-role="th">S_T_helper</th>
<th data-quarto-table-cell-role="th">S_Tcm</th>
<th data-quarto-table-cell-role="th">S_Tem</th>
<th data-quarto-table-cell-role="th">S_Th1</th>
<th data-quarto-table-cell-role="th">S_Th2</th>
<th data-quarto-table-cell-role="th">S_TFH</th>
<th data-quarto-table-cell-role="th">S_CD8_Tcells</th>
<th data-quarto-table-cell-role="th">S_Th17</th>
<th data-quarto-table-cell-role="th">S_Treg</th>
<th data-quarto-table-cell-role="th">S_Tgd</th>
<th data-quarto-table-cell-role="th">S_Cytotoxic_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cd56dim</th>
<th data-quarto-table-cell-role="th">S_NK_cd56bright</th>
<th data-quarto-table-cell-role="th">S_DC</th>
<th data-quarto-table-cell-role="th">S_iDC</th>
<th data-quarto-table-cell-role="th">S_aDC</th>
<th data-quarto-table-cell-role="th">S_pDC</th>
<th data-quarto-table-cell-role="th">S_Eosinophils</th>
<th data-quarto-table-cell-role="th">S_Macrophages</th>
<th data-quarto-table-cell-role="th">S_Mast</th>
<th data-quarto-table-cell-role="th">S_Neutrophils</th>
<th data-quarto-table-cell-role="th">S_Bindea_full</th>
<th data-quarto-table-cell-role="th">S_Expanded_IFNg</th>
<th data-quarto-table-cell-role="th">S_KEGG_MMR</th>
<th data-quarto-table-cell-role="th">S_KEGG_TGF_Beta</th>
<th data-quarto-table-cell-role="th">S_KEGG_Cytosolic_DNA_Sensing</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0012</td>
<td>HR+/HER2-</td>
<td>50.0</td>
<td>2.0</td>
<td>2.3</td>
<td>20.0</td>
<td>5.79</td>
<td>0.476190476</td>
<td>357.0</td>
<td>1.7</td>
<td>2895.605487</td>
<td>9.0</td>
<td>0.120394</td>
<td>0.117468</td>
<td>0.448450</td>
<td>0.3620</td>
<td>0.4216</td>
<td>0.3034</td>
<td>0.4425</td>
<td>0.2749</td>
<td>0.2983</td>
<td>0.2756</td>
<td>0.3121</td>
<td>0.2765</td>
<td>0.3203</td>
<td>0.2463</td>
<td>0.2341</td>
<td>0.2495</td>
<td>0.3571</td>
<td>0.4591</td>
<td>0.3985</td>
<td>0.2130</td>
<td>0.2223</td>
<td>0.2766</td>
<td>0.3573</td>
<td>0.1561</td>
<td>0.2942</td>
<td>0.1536</td>
<td>0.2530</td>
<td>0.2042</td>
<td>0.2061</td>
<td>0.1942</td>
<td>0.2764</td>
<td>0.3327</td>
<td>0.3795</td>
<td>0.3435</td>
<td>0.2846</td>
<td>0.3797</td>
<td>0.3761</td>
<td>0.3197</td>
<td>0.4008</td>
<td>0.4403</td>
<td>0.2907</td>
<td>0.4011</td>
<td>0.2526</td>
<td>0.2237</td>
<td>0.4256</td>
<td>0.3971</td>
<td>0.4477</td>
<td>0.1852</td>
<td>0.2516</td>
<td>0.2262</td>
<td>0.3854</td>
<td>0.1591</td>
<td>0.4462</td>
<td>0.2912</td>
<td>0.4211</td>
<td>0.4502</td>
<td>0.3610</td>
<td>0.2711</td>
<td>0.3414</td>
<td>0.2183</td>
<td>0.3728</td>
<td>0.3512</td>
<td>0.3529</td>
<td>0.4162</td>
<td>0.3612</td>
<td>0.2215</td>
<td>0.3614</td>
<td>0.4294</td>
<td>0.3451</td>
<td>0.4648</td>
<td>0.2937</td>
<td>0.3338</td>
<td>0.2999</td>
<td>0.2094</td>
<td>0.2743</td>
<td>0.3203</td>
<td>0.4136</td>
<td>0.2546</td>
<td>0.2730</td>
<td>0.3697</td>
<td>0.2268</td>
<td>0.3335</td>
<td>0.3959</td>
<td>0.4066</td>
<td>0.2199</td>
<td>0.2395</td>
<td>0.4132</td>
<td>0.3633</td>
<td>0.3210</td>
<td>0.2599</td>
<td>0.3561</td>
<td>0.3112</td>
<td>0.3645</td>
<td>0.2810</td>
<td>0.2348</td>
<td>0.1945</td>
<td>0.2188</td>
<td>0.3281</td>
<td>0.0602</td>
<td>0.2038</td>
<td>0.2445</td>
<td>0.3220</td>
<td>0.2212</td>
<td>0.2866</td>
<td>0.3030</td>
<td>0.3657</td>
<td>0.2499</td>
<td>0.2531</td>
<td>0.3031</td>
<td>0.3097</td>
<td>0.4053</td>
<td>0.3537</td>
<td>0.2530</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0014</td>
<td>HR+/HER2-</td>
<td>58.0</td>
<td>2.0</td>
<td>2.5</td>
<td>10.0</td>
<td>5.28</td>
<td>0.588235294</td>
<td>85.0</td>
<td>4.1</td>
<td>4257.831526</td>
<td>11.0</td>
<td>0.165023</td>
<td>0.207531</td>
<td>0.124223</td>
<td>0.4126</td>
<td>0.3815</td>
<td>0.3619</td>
<td>0.4760</td>
<td>0.3343</td>
<td>0.3001</td>
<td>0.2769</td>
<td>0.3761</td>
<td>0.3525</td>
<td>0.3452</td>
<td>0.3051</td>
<td>0.2701</td>
<td>0.3143</td>
<td>0.3803</td>
<td>0.4819</td>
<td>0.4125</td>
<td>0.3002</td>
<td>0.3106</td>
<td>0.3646</td>
<td>0.3753</td>
<td>0.1030</td>
<td>0.3644</td>
<td>0.2726</td>
<td>0.2377</td>
<td>0.2553</td>
<td>0.2513</td>
<td>0.2820</td>
<td>0.3079</td>
<td>0.3515</td>
<td>0.3869</td>
<td>0.3868</td>
<td>0.3133</td>
<td>0.4051</td>
<td>0.4031</td>
<td>0.3308</td>
<td>0.4120</td>
<td>0.4496</td>
<td>0.2012</td>
<td>0.4360</td>
<td>0.3290</td>
<td>0.2562</td>
<td>0.3882</td>
<td>0.4310</td>
<td>0.4682</td>
<td>0.2990</td>
<td>0.3007</td>
<td>0.2859</td>
<td>0.3998</td>
<td>0.2225</td>
<td>0.4068</td>
<td>0.3481</td>
<td>0.4494</td>
<td>0.4710</td>
<td>0.4011</td>
<td>0.2840</td>
<td>0.3779</td>
<td>0.2727</td>
<td>0.3831</td>
<td>0.3864</td>
<td>0.3511</td>
<td>0.3983</td>
<td>0.3676</td>
<td>0.2761</td>
<td>0.3637</td>
<td>0.4268</td>
<td>0.3555</td>
<td>0.4580</td>
<td>0.3266</td>
<td>0.3549</td>
<td>0.3763</td>
<td>0.2157</td>
<td>0.3028</td>
<td>0.3278</td>
<td>0.3896</td>
<td>0.3111</td>
<td>0.3159</td>
<td>0.3126</td>
<td>0.2395</td>
<td>0.3747</td>
<td>0.3838</td>
<td>0.4030</td>
<td>0.2731</td>
<td>0.2909</td>
<td>0.4092</td>
<td>0.3404</td>
<td>0.3530</td>
<td>0.2808</td>
<td>0.3102</td>
<td>0.3229</td>
<td>0.3713</td>
<td>0.2645</td>
<td>0.3182</td>
<td>0.1977</td>
<td>0.2985</td>
<td>0.3502</td>
<td>0.1191</td>
<td>0.3316</td>
<td>0.2976</td>
<td>0.3445</td>
<td>0.2403</td>
<td>0.3450</td>
<td>0.3203</td>
<td>0.3484</td>
<td>0.2768</td>
<td>0.2783</td>
<td>0.3200</td>
<td>0.3668</td>
<td>0.3803</td>
<td>0.3470</td>
<td>0.2606</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0015</td>
<td>HR+/HER2-</td>
<td>46.0</td>
<td>2.0</td>
<td>1.8</td>
<td>4.0</td>
<td>11.48</td>
<td>0.25</td>
<td>150.0</td>
<td>2.4</td>
<td>3123.055856</td>
<td>8.0</td>
<td>0.162653</td>
<td>0.235337</td>
<td>0.279972</td>
<td>0.3556</td>
<td>0.3782</td>
<td>0.3363</td>
<td>0.4718</td>
<td>0.3015</td>
<td>0.2659</td>
<td>0.2274</td>
<td>0.3180</td>
<td>0.3025</td>
<td>0.3124</td>
<td>0.2622</td>
<td>0.2304</td>
<td>0.2706</td>
<td>0.3761</td>
<td>0.4613</td>
<td>0.3814</td>
<td>0.3055</td>
<td>0.2764</td>
<td>0.3211</td>
<td>0.3784</td>
<td>-0.1955</td>
<td>0.3122</td>
<td>0.1932</td>
<td>0.2485</td>
<td>0.2211</td>
<td>0.2004</td>
<td>0.2478</td>
<td>0.3040</td>
<td>0.3316</td>
<td>0.3646</td>
<td>0.3483</td>
<td>0.3012</td>
<td>0.4038</td>
<td>0.3875</td>
<td>0.3158</td>
<td>0.3986</td>
<td>0.4391</td>
<td>0.1509</td>
<td>0.3958</td>
<td>0.2886</td>
<td>0.2535</td>
<td>0.3764</td>
<td>0.4054</td>
<td>0.4601</td>
<td>0.2509</td>
<td>0.2830</td>
<td>0.2712</td>
<td>0.3801</td>
<td>0.1750</td>
<td>0.3987</td>
<td>0.3063</td>
<td>0.4239</td>
<td>0.4616</td>
<td>0.3587</td>
<td>0.2955</td>
<td>0.3431</td>
<td>0.2278</td>
<td>0.3599</td>
<td>0.3549</td>
<td>0.4011</td>
<td>0.3865</td>
<td>0.3661</td>
<td>0.2671</td>
<td>0.3591</td>
<td>0.4313</td>
<td>0.3489</td>
<td>0.4442</td>
<td>0.2985</td>
<td>0.3383</td>
<td>0.3370</td>
<td>0.2609</td>
<td>0.2706</td>
<td>0.3312</td>
<td>0.3792</td>
<td>0.2851</td>
<td>0.2897</td>
<td>0.2984</td>
<td>0.0936</td>
<td>0.3370</td>
<td>0.3880</td>
<td>0.4038</td>
<td>0.2799</td>
<td>0.2873</td>
<td>0.4159</td>
<td>0.3520</td>
<td>0.3560</td>
<td>0.2600</td>
<td>0.3116</td>
<td>0.3225</td>
<td>0.3762</td>
<td>0.2370</td>
<td>0.2251</td>
<td>0.2021</td>
<td>0.2720</td>
<td>0.3434</td>
<td>0.0626</td>
<td>0.3025</td>
<td>0.2670</td>
<td>0.3212</td>
<td>0.2098</td>
<td>0.2967</td>
<td>0.3236</td>
<td>0.3266</td>
<td>0.2455</td>
<td>0.2522</td>
<td>0.3107</td>
<td>0.3372</td>
<td>0.3793</td>
<td>0.3522</td>
<td>0.2564</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0017</td>
<td>HR+/HER2-</td>
<td>54.0</td>
<td>2.0</td>
<td>2.5</td>
<td>19.0</td>
<td>15.11</td>
<td>0.404255319</td>
<td>1369.0</td>
<td>1.7</td>
<td>5275.497847</td>
<td>11.0</td>
<td>0.155523</td>
<td>0.148387</td>
<td>0.128777</td>
<td>0.4314</td>
<td>0.4482</td>
<td>0.4080</td>
<td>0.4980</td>
<td>0.3912</td>
<td>0.3120</td>
<td>0.2934</td>
<td>0.3864</td>
<td>0.3957</td>
<td>0.3131</td>
<td>0.3589</td>
<td>0.3341</td>
<td>0.3654</td>
<td>0.3842</td>
<td>0.4957</td>
<td>0.4328</td>
<td>0.3533</td>
<td>0.3732</td>
<td>0.4177</td>
<td>0.4350</td>
<td>0.1401</td>
<td>0.4006</td>
<td>0.3023</td>
<td>0.3429</td>
<td>0.3228</td>
<td>0.2922</td>
<td>0.3591</td>
<td>0.3671</td>
<td>0.3926</td>
<td>0.4113</td>
<td>0.4082</td>
<td>0.3325</td>
<td>0.4092</td>
<td>0.4129</td>
<td>0.3338</td>
<td>0.4190</td>
<td>0.4248</td>
<td>0.1319</td>
<td>0.4878</td>
<td>0.3797</td>
<td>0.1889</td>
<td>0.4601</td>
<td>0.4445</td>
<td>0.4859</td>
<td>0.3224</td>
<td>0.3693</td>
<td>0.3003</td>
<td>0.4095</td>
<td>0.2938</td>
<td>0.4707</td>
<td>0.3968</td>
<td>0.4616</td>
<td>0.4893</td>
<td>0.4644</td>
<td>0.2735</td>
<td>0.3955</td>
<td>0.3234</td>
<td>0.4165</td>
<td>0.4337</td>
<td>0.4190</td>
<td>0.4511</td>
<td>0.3758</td>
<td>0.3174</td>
<td>0.3679</td>
<td>0.4314</td>
<td>0.3648</td>
<td>0.4439</td>
<td>0.2886</td>
<td>0.3688</td>
<td>0.4143</td>
<td>0.2489</td>
<td>0.3562</td>
<td>0.3498</td>
<td>0.4563</td>
<td>0.3576</td>
<td>0.3706</td>
<td>0.3377</td>
<td>0.2758</td>
<td>0.4006</td>
<td>0.4000</td>
<td>0.4062</td>
<td>0.3182</td>
<td>0.3460</td>
<td>0.4170</td>
<td>0.3275</td>
<td>0.3432</td>
<td>0.2914</td>
<td>0.3307</td>
<td>0.3525</td>
<td>0.3879</td>
<td>0.2212</td>
<td>0.3330</td>
<td>0.2251</td>
<td>0.3151</td>
<td>0.3495</td>
<td>0.1939</td>
<td>0.2953</td>
<td>0.3010</td>
<td>0.3467</td>
<td>0.2547</td>
<td>0.3313</td>
<td>0.3230</td>
<td>0.3597</td>
<td>0.2726</td>
<td>0.2648</td>
<td>0.3309</td>
<td>0.4165</td>
<td>0.3997</td>
<td>0.3468</td>
<td>0.2682</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0018</td>
<td>HR+/HER2+</td>
<td>58.0</td>
<td>3.0</td>
<td>3.0</td>
<td>39.0</td>
<td>3.00</td>
<td>0.30952381</td>
<td>382.0</td>
<td>1.6</td>
<td>3548.348220</td>
<td>11.0</td>
<td>0.129397</td>
<td>0.133531</td>
<td>0.304963</td>
<td>0.3701</td>
<td>0.3859</td>
<td>0.3067</td>
<td>0.4858</td>
<td>0.3141</td>
<td>0.2980</td>
<td>0.2006</td>
<td>0.3222</td>
<td>0.3017</td>
<td>0.3358</td>
<td>0.2870</td>
<td>0.2544</td>
<td>0.2955</td>
<td>0.3292</td>
<td>0.4758</td>
<td>0.4200</td>
<td>0.2892</td>
<td>0.2845</td>
<td>0.3767</td>
<td>0.4084</td>
<td>0.1187</td>
<td>0.2786</td>
<td>0.2363</td>
<td>0.2357</td>
<td>0.2360</td>
<td>0.2310</td>
<td>0.3125</td>
<td>0.3054</td>
<td>0.3430</td>
<td>0.3742</td>
<td>0.3709</td>
<td>0.2860</td>
<td>0.3689</td>
<td>0.3880</td>
<td>0.3172</td>
<td>0.4095</td>
<td>0.4343</td>
<td>0.2824</td>
<td>0.4664</td>
<td>0.2799</td>
<td>0.2613</td>
<td>0.3975</td>
<td>0.4264</td>
<td>0.4805</td>
<td>0.3210</td>
<td>0.2670</td>
<td>0.2429</td>
<td>0.3952</td>
<td>0.2321</td>
<td>0.4166</td>
<td>0.3061</td>
<td>0.4446</td>
<td>0.4658</td>
<td>0.4181</td>
<td>0.2747</td>
<td>0.3910</td>
<td>0.3019</td>
<td>0.3722</td>
<td>0.3716</td>
<td>0.3075</td>
<td>0.3931</td>
<td>0.3605</td>
<td>0.2308</td>
<td>0.3603</td>
<td>0.4258</td>
<td>0.3393</td>
<td>0.4654</td>
<td>0.2920</td>
<td>0.3385</td>
<td>0.3668</td>
<td>0.2237</td>
<td>0.3404</td>
<td>0.3264</td>
<td>0.3909</td>
<td>0.2758</td>
<td>0.3050</td>
<td>0.3770</td>
<td>0.2009</td>
<td>0.3664</td>
<td>0.4026</td>
<td>0.4092</td>
<td>0.2699</td>
<td>0.2530</td>
<td>0.3955</td>
<td>0.3185</td>
<td>0.3066</td>
<td>0.2713</td>
<td>0.3333</td>
<td>0.3041</td>
<td>0.3523</td>
<td>0.2401</td>
<td>0.2709</td>
<td>0.1413</td>
<td>0.2636</td>
<td>0.3061</td>
<td>0.0764</td>
<td>0.2639</td>
<td>0.2623</td>
<td>0.3348</td>
<td>0.2124</td>
<td>0.2731</td>
<td>0.3020</td>
<td>0.3540</td>
<td>0.2233</td>
<td>0.2182</td>
<td>0.2979</td>
<td>0.3530</td>
<td>0.4033</td>
<td>0.3444</td>
<td>0.2496</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><strong>Sanity Check:</strong> Check to make sure there is no duplicated index rows in the dataset.</p>
<div id="cell-12" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dfd.index[dfd.index.duplicated()].unique())</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>rows_dupe <span class="op">=</span> <span class="bu">list</span>(dfd.index[dfd.index.duplicated()].unique())</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>rows_dupe</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index([], dtype='object', name='ID')</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>[]</code></pre>
</div>
</div>
<p>Now we can encode categorical variables and integer variables accordingly so they are more amenable to machine learning algorithms.</p>
<p>Check data types of the resulting cleaned up dataFrame.</p>
<div id="cell-14" class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check original df's dtypes</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_rows'</span>, <span class="va">None</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># dfd.dtypes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We need to encode the <code>object</code> columns of <code>Subtype</code> and <code>FN/FT_Ratio</code> into appropriate types. Change <code>Age</code>, <code>TumorGrade</code>, and <code>IMPRES</code> into <code>int64</code> as well as all <code>*_Count</code> columns because they are discrete variables. Change the <code>FN/FT_Ratio</code> into <code>float64</code>.</p>
<div id="cell-16" class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>dfd[<span class="st">'Subtype'</span>] <span class="op">=</span> dfd[<span class="st">'Subtype'</span>].astype(<span class="st">'category'</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>dfd[<span class="st">'Age'</span>] <span class="op">=</span> dfd[<span class="st">'Age'</span>].astype(<span class="st">'int64'</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>dfd[<span class="st">'TumorGrade'</span>] <span class="op">=</span> dfd[<span class="st">'TumorGrade'</span>].astype(<span class="st">'int64'</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>dfd[<span class="st">'IMPRES'</span>] <span class="op">=</span> dfd[<span class="st">'IMPRES'</span>].astype(<span class="st">'int64'</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>dfd[<span class="st">'FusionNeo_Count'</span>] <span class="op">=</span> dfd[<span class="st">'FusionNeo_Count'</span>].astype(<span class="st">'int64'</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>dfd[<span class="st">'SNVindelNeo_Count'</span>] <span class="op">=</span> dfd[<span class="st">'SNVindelNeo_Count'</span>].astype(<span class="st">'int64'</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>dfd[<span class="st">'FN/FT_Ratio'</span>] <span class="op">=</span> dfd[<span class="st">'FN/FT_Ratio'</span>].astype(<span class="st">'float64'</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print(dfd.dtypes)</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_rows'</span>, <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can use Feature_Engineâ€™s <code>OneHotEncoder()</code> to create a <code>k</code> dummy variable set for <code>Subtype</code>.</p>
<p><strong>NOTE</strong>: The encoded columns will be appended at the end of the dataFrame.</p>
<div id="cell-18" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> feature_engine.encoding <span class="im">import</span> OneHotEncoder</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>encoder <span class="op">=</span> OneHotEncoder(</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    variables<span class="op">=</span>[<span class="st">'Subtype'</span>],</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    drop_last<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>encoder.fit(dfd)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>dfd_ <span class="op">=</span> encoder.transform(dfd)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>dfd_.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionNeo_bestIC50</th>
<th data-quarto-table-cell-role="th">FN/FT_Ratio</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
<th data-quarto-table-cell-role="th">ESTIMATE</th>
<th data-quarto-table-cell-role="th">IMPRES</th>
<th data-quarto-table-cell-role="th">C_Bcellsnaive</th>
<th data-quarto-table-cell-role="th">C_TcellsCD4memoryresting</th>
<th data-quarto-table-cell-role="th">C_MacrophagesM2</th>
<th data-quarto-table-cell-role="th">S_Attractors_LYM</th>
<th data-quarto-table-cell-role="th">S_Attractors_IFIT3</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_GIMAP4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_HLA.DPA1</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SLAMF6</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_LILRB4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SIGLEC9</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CYTH4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CD3E</th>
<th data-quarto-table-cell-role="th">S_Lymph_Vessels</th>
<th data-quarto-table-cell-role="th">S_ICR_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_INHIB_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_ACT_SCORE</th>
<th data-quarto-table-cell-role="th">S_Angiogenesis</th>
<th data-quarto-table-cell-role="th">S_APM1</th>
<th data-quarto-table-cell-role="th">S_APM2</th>
<th data-quarto-table-cell-role="th">S_ICS5_score</th>
<th data-quarto-table-cell-role="th">S_LIexpression_score</th>
<th data-quarto-table-cell-role="th">S_Chemokine12_score</th>
<th data-quarto-table-cell-role="th">S_NHI_5gene_score</th>
<th data-quarto-table-cell-role="th">S_CD68</th>
<th data-quarto-table-cell-role="th">S_CD8A</th>
<th data-quarto-table-cell-role="th">S_PD1_data</th>
<th data-quarto-table-cell-role="th">S_PDL1_data</th>
<th data-quarto-table-cell-role="th">S_PD1_PDL1_score</th>
<th data-quarto-table-cell-role="th">S_CTLA4_data</th>
<th data-quarto-table-cell-role="th">S_Bcell_mg_IGJ</th>
<th data-quarto-table-cell-role="th">S_Bcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_STAT1_score</th>
<th data-quarto-table-cell-role="th">S_CSF1_response</th>
<th data-quarto-table-cell-role="th">S_TcClassII_score</th>
<th data-quarto-table-cell-role="th">S_IL12_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL4_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL2_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL13_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IFNG_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TGFB_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TREM1_data</th>
<th data-quarto-table-cell-role="th">S_DAP12_data</th>
<th data-quarto-table-cell-role="th">S_Tcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_IL8_21978456</th>
<th data-quarto-table-cell-role="th">S_IFN_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC1_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC2_21978456</th>
<th data-quarto-table-cell-role="th">S_Bcell_21978456</th>
<th data-quarto-table-cell-role="th">S_Tcell_21978456</th>
<th data-quarto-table-cell-role="th">S_CD103pos_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_CD103neg_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_IgG_19272155</th>
<th data-quarto-table-cell-role="th">S_Interferon_19272155</th>
<th data-quarto-table-cell-role="th">S_LCK_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.I_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.II_19272155</th>
<th data-quarto-table-cell-role="th">S_STAT1_19272155</th>
<th data-quarto-table-cell-role="th">S_Troester_WoundSig_19887484</th>
<th data-quarto-table-cell-role="th">S_MDACC.FNA.1_20805453</th>
<th data-quarto-table-cell-role="th">S_IGG_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Minterferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Immune_cell_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_MCD3_CD8_21214954</th>
<th data-quarto-table-cell-role="th">S_Interferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_B_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_CD8_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_GRANS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_LYMPHS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_T_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_TGFB_PCA_17349583</th>
<th data-quarto-table-cell-role="th">S_Rotterdam_ERneg_PCA_15721472</th>
<th data-quarto-table-cell-role="th">S_HER2_Immune_PCA_18006808</th>
<th data-quarto-table-cell-role="th">S_IR7_score</th>
<th data-quarto-table-cell-role="th">S_Buck14_score</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_score</th>
<th data-quarto-table-cell-role="th">S_Immune_NSCLC_score</th>
<th data-quarto-table-cell-role="th">S_Module3_IFN_score</th>
<th data-quarto-table-cell-role="th">S_Module4_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module5_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module11_Prolif_score</th>
<th data-quarto-table-cell-role="th">S_CD8_CD68_ratio</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_TcClassII_ratio</th>
<th data-quarto-table-cell-role="th">S_CHANG_CORE_SERUM_RESPONSE_UP</th>
<th data-quarto-table-cell-role="th">S_CSR_Activated_15701700</th>
<th data-quarto-table-cell-role="th">S_B_cells</th>
<th data-quarto-table-cell-role="th">S_T_cells</th>
<th data-quarto-table-cell-role="th">S_T_helper</th>
<th data-quarto-table-cell-role="th">S_Tcm</th>
<th data-quarto-table-cell-role="th">S_Tem</th>
<th data-quarto-table-cell-role="th">S_Th1</th>
<th data-quarto-table-cell-role="th">S_Th2</th>
<th data-quarto-table-cell-role="th">S_TFH</th>
<th data-quarto-table-cell-role="th">S_CD8_Tcells</th>
<th data-quarto-table-cell-role="th">S_Th17</th>
<th data-quarto-table-cell-role="th">S_Treg</th>
<th data-quarto-table-cell-role="th">S_Tgd</th>
<th data-quarto-table-cell-role="th">S_Cytotoxic_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cd56dim</th>
<th data-quarto-table-cell-role="th">S_NK_cd56bright</th>
<th data-quarto-table-cell-role="th">S_DC</th>
<th data-quarto-table-cell-role="th">S_iDC</th>
<th data-quarto-table-cell-role="th">S_aDC</th>
<th data-quarto-table-cell-role="th">S_pDC</th>
<th data-quarto-table-cell-role="th">S_Eosinophils</th>
<th data-quarto-table-cell-role="th">S_Macrophages</th>
<th data-quarto-table-cell-role="th">S_Mast</th>
<th data-quarto-table-cell-role="th">S_Neutrophils</th>
<th data-quarto-table-cell-role="th">S_Bindea_full</th>
<th data-quarto-table-cell-role="th">S_Expanded_IFNg</th>
<th data-quarto-table-cell-role="th">S_KEGG_MMR</th>
<th data-quarto-table-cell-role="th">S_KEGG_TGF_Beta</th>
<th data-quarto-table-cell-role="th">S_KEGG_Cytosolic_DNA_Sensing</th>
<th data-quarto-table-cell-role="th">Subtype_HR+/HER2-</th>
<th data-quarto-table-cell-role="th">Subtype_HR+/HER2+</th>
<th data-quarto-table-cell-role="th">Subtype_TNBC</th>
<th data-quarto-table-cell-role="th">Subtype_HR-/HER2+</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0012</td>
<td>50</td>
<td>2</td>
<td>2.3</td>
<td>20</td>
<td>5.79</td>
<td>0.476190</td>
<td>357</td>
<td>1.7</td>
<td>2895.605487</td>
<td>9</td>
<td>0.120394</td>
<td>0.117468</td>
<td>0.448450</td>
<td>0.3620</td>
<td>0.4216</td>
<td>0.3034</td>
<td>0.4425</td>
<td>0.2749</td>
<td>0.2983</td>
<td>0.2756</td>
<td>0.3121</td>
<td>0.2765</td>
<td>0.3203</td>
<td>0.2463</td>
<td>0.2341</td>
<td>0.2495</td>
<td>0.3571</td>
<td>0.4591</td>
<td>0.3985</td>
<td>0.2130</td>
<td>0.2223</td>
<td>0.2766</td>
<td>0.3573</td>
<td>0.1561</td>
<td>0.2942</td>
<td>0.1536</td>
<td>0.2530</td>
<td>0.2042</td>
<td>0.2061</td>
<td>0.1942</td>
<td>0.2764</td>
<td>0.3327</td>
<td>0.3795</td>
<td>0.3435</td>
<td>0.2846</td>
<td>0.3797</td>
<td>0.3761</td>
<td>0.3197</td>
<td>0.4008</td>
<td>0.4403</td>
<td>0.2907</td>
<td>0.4011</td>
<td>0.2526</td>
<td>0.2237</td>
<td>0.4256</td>
<td>0.3971</td>
<td>0.4477</td>
<td>0.1852</td>
<td>0.2516</td>
<td>0.2262</td>
<td>0.3854</td>
<td>0.1591</td>
<td>0.4462</td>
<td>0.2912</td>
<td>0.4211</td>
<td>0.4502</td>
<td>0.3610</td>
<td>0.2711</td>
<td>0.3414</td>
<td>0.2183</td>
<td>0.3728</td>
<td>0.3512</td>
<td>0.3529</td>
<td>0.4162</td>
<td>0.3612</td>
<td>0.2215</td>
<td>0.3614</td>
<td>0.4294</td>
<td>0.3451</td>
<td>0.4648</td>
<td>0.2937</td>
<td>0.3338</td>
<td>0.2999</td>
<td>0.2094</td>
<td>0.2743</td>
<td>0.3203</td>
<td>0.4136</td>
<td>0.2546</td>
<td>0.2730</td>
<td>0.3697</td>
<td>0.2268</td>
<td>0.3335</td>
<td>0.3959</td>
<td>0.4066</td>
<td>0.2199</td>
<td>0.2395</td>
<td>0.4132</td>
<td>0.3633</td>
<td>0.3210</td>
<td>0.2599</td>
<td>0.3561</td>
<td>0.3112</td>
<td>0.3645</td>
<td>0.2810</td>
<td>0.2348</td>
<td>0.1945</td>
<td>0.2188</td>
<td>0.3281</td>
<td>0.0602</td>
<td>0.2038</td>
<td>0.2445</td>
<td>0.3220</td>
<td>0.2212</td>
<td>0.2866</td>
<td>0.3030</td>
<td>0.3657</td>
<td>0.2499</td>
<td>0.2531</td>
<td>0.3031</td>
<td>0.3097</td>
<td>0.4053</td>
<td>0.3537</td>
<td>0.2530</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0014</td>
<td>58</td>
<td>2</td>
<td>2.5</td>
<td>10</td>
<td>5.28</td>
<td>0.588235</td>
<td>85</td>
<td>4.1</td>
<td>4257.831526</td>
<td>11</td>
<td>0.165023</td>
<td>0.207531</td>
<td>0.124223</td>
<td>0.4126</td>
<td>0.3815</td>
<td>0.3619</td>
<td>0.4760</td>
<td>0.3343</td>
<td>0.3001</td>
<td>0.2769</td>
<td>0.3761</td>
<td>0.3525</td>
<td>0.3452</td>
<td>0.3051</td>
<td>0.2701</td>
<td>0.3143</td>
<td>0.3803</td>
<td>0.4819</td>
<td>0.4125</td>
<td>0.3002</td>
<td>0.3106</td>
<td>0.3646</td>
<td>0.3753</td>
<td>0.1030</td>
<td>0.3644</td>
<td>0.2726</td>
<td>0.2377</td>
<td>0.2553</td>
<td>0.2513</td>
<td>0.2820</td>
<td>0.3079</td>
<td>0.3515</td>
<td>0.3869</td>
<td>0.3868</td>
<td>0.3133</td>
<td>0.4051</td>
<td>0.4031</td>
<td>0.3308</td>
<td>0.4120</td>
<td>0.4496</td>
<td>0.2012</td>
<td>0.4360</td>
<td>0.3290</td>
<td>0.2562</td>
<td>0.3882</td>
<td>0.4310</td>
<td>0.4682</td>
<td>0.2990</td>
<td>0.3007</td>
<td>0.2859</td>
<td>0.3998</td>
<td>0.2225</td>
<td>0.4068</td>
<td>0.3481</td>
<td>0.4494</td>
<td>0.4710</td>
<td>0.4011</td>
<td>0.2840</td>
<td>0.3779</td>
<td>0.2727</td>
<td>0.3831</td>
<td>0.3864</td>
<td>0.3511</td>
<td>0.3983</td>
<td>0.3676</td>
<td>0.2761</td>
<td>0.3637</td>
<td>0.4268</td>
<td>0.3555</td>
<td>0.4580</td>
<td>0.3266</td>
<td>0.3549</td>
<td>0.3763</td>
<td>0.2157</td>
<td>0.3028</td>
<td>0.3278</td>
<td>0.3896</td>
<td>0.3111</td>
<td>0.3159</td>
<td>0.3126</td>
<td>0.2395</td>
<td>0.3747</td>
<td>0.3838</td>
<td>0.4030</td>
<td>0.2731</td>
<td>0.2909</td>
<td>0.4092</td>
<td>0.3404</td>
<td>0.3530</td>
<td>0.2808</td>
<td>0.3102</td>
<td>0.3229</td>
<td>0.3713</td>
<td>0.2645</td>
<td>0.3182</td>
<td>0.1977</td>
<td>0.2985</td>
<td>0.3502</td>
<td>0.1191</td>
<td>0.3316</td>
<td>0.2976</td>
<td>0.3445</td>
<td>0.2403</td>
<td>0.3450</td>
<td>0.3203</td>
<td>0.3484</td>
<td>0.2768</td>
<td>0.2783</td>
<td>0.3200</td>
<td>0.3668</td>
<td>0.3803</td>
<td>0.3470</td>
<td>0.2606</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0015</td>
<td>46</td>
<td>2</td>
<td>1.8</td>
<td>4</td>
<td>11.48</td>
<td>0.250000</td>
<td>150</td>
<td>2.4</td>
<td>3123.055856</td>
<td>8</td>
<td>0.162653</td>
<td>0.235337</td>
<td>0.279972</td>
<td>0.3556</td>
<td>0.3782</td>
<td>0.3363</td>
<td>0.4718</td>
<td>0.3015</td>
<td>0.2659</td>
<td>0.2274</td>
<td>0.3180</td>
<td>0.3025</td>
<td>0.3124</td>
<td>0.2622</td>
<td>0.2304</td>
<td>0.2706</td>
<td>0.3761</td>
<td>0.4613</td>
<td>0.3814</td>
<td>0.3055</td>
<td>0.2764</td>
<td>0.3211</td>
<td>0.3784</td>
<td>-0.1955</td>
<td>0.3122</td>
<td>0.1932</td>
<td>0.2485</td>
<td>0.2211</td>
<td>0.2004</td>
<td>0.2478</td>
<td>0.3040</td>
<td>0.3316</td>
<td>0.3646</td>
<td>0.3483</td>
<td>0.3012</td>
<td>0.4038</td>
<td>0.3875</td>
<td>0.3158</td>
<td>0.3986</td>
<td>0.4391</td>
<td>0.1509</td>
<td>0.3958</td>
<td>0.2886</td>
<td>0.2535</td>
<td>0.3764</td>
<td>0.4054</td>
<td>0.4601</td>
<td>0.2509</td>
<td>0.2830</td>
<td>0.2712</td>
<td>0.3801</td>
<td>0.1750</td>
<td>0.3987</td>
<td>0.3063</td>
<td>0.4239</td>
<td>0.4616</td>
<td>0.3587</td>
<td>0.2955</td>
<td>0.3431</td>
<td>0.2278</td>
<td>0.3599</td>
<td>0.3549</td>
<td>0.4011</td>
<td>0.3865</td>
<td>0.3661</td>
<td>0.2671</td>
<td>0.3591</td>
<td>0.4313</td>
<td>0.3489</td>
<td>0.4442</td>
<td>0.2985</td>
<td>0.3383</td>
<td>0.3370</td>
<td>0.2609</td>
<td>0.2706</td>
<td>0.3312</td>
<td>0.3792</td>
<td>0.2851</td>
<td>0.2897</td>
<td>0.2984</td>
<td>0.0936</td>
<td>0.3370</td>
<td>0.3880</td>
<td>0.4038</td>
<td>0.2799</td>
<td>0.2873</td>
<td>0.4159</td>
<td>0.3520</td>
<td>0.3560</td>
<td>0.2600</td>
<td>0.3116</td>
<td>0.3225</td>
<td>0.3762</td>
<td>0.2370</td>
<td>0.2251</td>
<td>0.2021</td>
<td>0.2720</td>
<td>0.3434</td>
<td>0.0626</td>
<td>0.3025</td>
<td>0.2670</td>
<td>0.3212</td>
<td>0.2098</td>
<td>0.2967</td>
<td>0.3236</td>
<td>0.3266</td>
<td>0.2455</td>
<td>0.2522</td>
<td>0.3107</td>
<td>0.3372</td>
<td>0.3793</td>
<td>0.3522</td>
<td>0.2564</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0017</td>
<td>54</td>
<td>2</td>
<td>2.5</td>
<td>19</td>
<td>15.11</td>
<td>0.404255</td>
<td>1369</td>
<td>1.7</td>
<td>5275.497847</td>
<td>11</td>
<td>0.155523</td>
<td>0.148387</td>
<td>0.128777</td>
<td>0.4314</td>
<td>0.4482</td>
<td>0.4080</td>
<td>0.4980</td>
<td>0.3912</td>
<td>0.3120</td>
<td>0.2934</td>
<td>0.3864</td>
<td>0.3957</td>
<td>0.3131</td>
<td>0.3589</td>
<td>0.3341</td>
<td>0.3654</td>
<td>0.3842</td>
<td>0.4957</td>
<td>0.4328</td>
<td>0.3533</td>
<td>0.3732</td>
<td>0.4177</td>
<td>0.4350</td>
<td>0.1401</td>
<td>0.4006</td>
<td>0.3023</td>
<td>0.3429</td>
<td>0.3228</td>
<td>0.2922</td>
<td>0.3591</td>
<td>0.3671</td>
<td>0.3926</td>
<td>0.4113</td>
<td>0.4082</td>
<td>0.3325</td>
<td>0.4092</td>
<td>0.4129</td>
<td>0.3338</td>
<td>0.4190</td>
<td>0.4248</td>
<td>0.1319</td>
<td>0.4878</td>
<td>0.3797</td>
<td>0.1889</td>
<td>0.4601</td>
<td>0.4445</td>
<td>0.4859</td>
<td>0.3224</td>
<td>0.3693</td>
<td>0.3003</td>
<td>0.4095</td>
<td>0.2938</td>
<td>0.4707</td>
<td>0.3968</td>
<td>0.4616</td>
<td>0.4893</td>
<td>0.4644</td>
<td>0.2735</td>
<td>0.3955</td>
<td>0.3234</td>
<td>0.4165</td>
<td>0.4337</td>
<td>0.4190</td>
<td>0.4511</td>
<td>0.3758</td>
<td>0.3174</td>
<td>0.3679</td>
<td>0.4314</td>
<td>0.3648</td>
<td>0.4439</td>
<td>0.2886</td>
<td>0.3688</td>
<td>0.4143</td>
<td>0.2489</td>
<td>0.3562</td>
<td>0.3498</td>
<td>0.4563</td>
<td>0.3576</td>
<td>0.3706</td>
<td>0.3377</td>
<td>0.2758</td>
<td>0.4006</td>
<td>0.4000</td>
<td>0.4062</td>
<td>0.3182</td>
<td>0.3460</td>
<td>0.4170</td>
<td>0.3275</td>
<td>0.3432</td>
<td>0.2914</td>
<td>0.3307</td>
<td>0.3525</td>
<td>0.3879</td>
<td>0.2212</td>
<td>0.3330</td>
<td>0.2251</td>
<td>0.3151</td>
<td>0.3495</td>
<td>0.1939</td>
<td>0.2953</td>
<td>0.3010</td>
<td>0.3467</td>
<td>0.2547</td>
<td>0.3313</td>
<td>0.3230</td>
<td>0.3597</td>
<td>0.2726</td>
<td>0.2648</td>
<td>0.3309</td>
<td>0.4165</td>
<td>0.3997</td>
<td>0.3468</td>
<td>0.2682</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0018</td>
<td>58</td>
<td>3</td>
<td>3.0</td>
<td>39</td>
<td>3.00</td>
<td>0.309524</td>
<td>382</td>
<td>1.6</td>
<td>3548.348220</td>
<td>11</td>
<td>0.129397</td>
<td>0.133531</td>
<td>0.304963</td>
<td>0.3701</td>
<td>0.3859</td>
<td>0.3067</td>
<td>0.4858</td>
<td>0.3141</td>
<td>0.2980</td>
<td>0.2006</td>
<td>0.3222</td>
<td>0.3017</td>
<td>0.3358</td>
<td>0.2870</td>
<td>0.2544</td>
<td>0.2955</td>
<td>0.3292</td>
<td>0.4758</td>
<td>0.4200</td>
<td>0.2892</td>
<td>0.2845</td>
<td>0.3767</td>
<td>0.4084</td>
<td>0.1187</td>
<td>0.2786</td>
<td>0.2363</td>
<td>0.2357</td>
<td>0.2360</td>
<td>0.2310</td>
<td>0.3125</td>
<td>0.3054</td>
<td>0.3430</td>
<td>0.3742</td>
<td>0.3709</td>
<td>0.2860</td>
<td>0.3689</td>
<td>0.3880</td>
<td>0.3172</td>
<td>0.4095</td>
<td>0.4343</td>
<td>0.2824</td>
<td>0.4664</td>
<td>0.2799</td>
<td>0.2613</td>
<td>0.3975</td>
<td>0.4264</td>
<td>0.4805</td>
<td>0.3210</td>
<td>0.2670</td>
<td>0.2429</td>
<td>0.3952</td>
<td>0.2321</td>
<td>0.4166</td>
<td>0.3061</td>
<td>0.4446</td>
<td>0.4658</td>
<td>0.4181</td>
<td>0.2747</td>
<td>0.3910</td>
<td>0.3019</td>
<td>0.3722</td>
<td>0.3716</td>
<td>0.3075</td>
<td>0.3931</td>
<td>0.3605</td>
<td>0.2308</td>
<td>0.3603</td>
<td>0.4258</td>
<td>0.3393</td>
<td>0.4654</td>
<td>0.2920</td>
<td>0.3385</td>
<td>0.3668</td>
<td>0.2237</td>
<td>0.3404</td>
<td>0.3264</td>
<td>0.3909</td>
<td>0.2758</td>
<td>0.3050</td>
<td>0.3770</td>
<td>0.2009</td>
<td>0.3664</td>
<td>0.4026</td>
<td>0.4092</td>
<td>0.2699</td>
<td>0.2530</td>
<td>0.3955</td>
<td>0.3185</td>
<td>0.3066</td>
<td>0.2713</td>
<td>0.3333</td>
<td>0.3041</td>
<td>0.3523</td>
<td>0.2401</td>
<td>0.2709</td>
<td>0.1413</td>
<td>0.2636</td>
<td>0.3061</td>
<td>0.0764</td>
<td>0.2639</td>
<td>0.2623</td>
<td>0.3348</td>
<td>0.2124</td>
<td>0.2731</td>
<td>0.3020</td>
<td>0.3540</td>
<td>0.2233</td>
<td>0.2182</td>
<td>0.2979</td>
<td>0.3530</td>
<td>0.4033</td>
<td>0.3444</td>
<td>0.2496</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-19" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the encoded columns to shift</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>enc_cols <span class="op">=</span> [<span class="st">'Subtype_HR+/HER2-'</span>, <span class="st">'Subtype_HR+/HER2+'</span>, <span class="st">'Subtype_TNBC'</span>, <span class="st">'Subtype_HR-/HER2+'</span>]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop the specified columns and store them</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>encoded_df <span class="op">=</span> dfd_[enc_cols]</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>dfenc <span class="op">=</span> dfd.drop(columns<span class="op">=</span>[<span class="st">'Subtype'</span>])</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the index where you want to reinsert the columns</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>insert_index <span class="op">=</span> <span class="dv">0</span>  <span class="co"># This will insert at the first column</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Reinsert the columns</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, col <span class="kw">in</span> <span class="bu">enumerate</span>(encoded_df.columns):</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    dfenc.insert(insert_index <span class="op">+</span> i, col, encoded_df[col])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Below is the categorically-encoded dataframe.</p>
<div id="cell-21" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dfenc.shape)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>dfenc.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(674, 127)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Subtype_HR+/HER2-</th>
<th data-quarto-table-cell-role="th">Subtype_HR+/HER2+</th>
<th data-quarto-table-cell-role="th">Subtype_TNBC</th>
<th data-quarto-table-cell-role="th">Subtype_HR-/HER2+</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionNeo_bestIC50</th>
<th data-quarto-table-cell-role="th">FN/FT_Ratio</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
<th data-quarto-table-cell-role="th">ESTIMATE</th>
<th data-quarto-table-cell-role="th">IMPRES</th>
<th data-quarto-table-cell-role="th">C_Bcellsnaive</th>
<th data-quarto-table-cell-role="th">C_TcellsCD4memoryresting</th>
<th data-quarto-table-cell-role="th">C_MacrophagesM2</th>
<th data-quarto-table-cell-role="th">S_Attractors_LYM</th>
<th data-quarto-table-cell-role="th">S_Attractors_IFIT3</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_GIMAP4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_HLA.DPA1</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SLAMF6</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_LILRB4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SIGLEC9</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CYTH4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CD3E</th>
<th data-quarto-table-cell-role="th">S_Lymph_Vessels</th>
<th data-quarto-table-cell-role="th">S_ICR_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_INHIB_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_ACT_SCORE</th>
<th data-quarto-table-cell-role="th">S_Angiogenesis</th>
<th data-quarto-table-cell-role="th">S_APM1</th>
<th data-quarto-table-cell-role="th">S_APM2</th>
<th data-quarto-table-cell-role="th">S_ICS5_score</th>
<th data-quarto-table-cell-role="th">S_LIexpression_score</th>
<th data-quarto-table-cell-role="th">S_Chemokine12_score</th>
<th data-quarto-table-cell-role="th">S_NHI_5gene_score</th>
<th data-quarto-table-cell-role="th">S_CD68</th>
<th data-quarto-table-cell-role="th">S_CD8A</th>
<th data-quarto-table-cell-role="th">S_PD1_data</th>
<th data-quarto-table-cell-role="th">S_PDL1_data</th>
<th data-quarto-table-cell-role="th">S_PD1_PDL1_score</th>
<th data-quarto-table-cell-role="th">S_CTLA4_data</th>
<th data-quarto-table-cell-role="th">S_Bcell_mg_IGJ</th>
<th data-quarto-table-cell-role="th">S_Bcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_STAT1_score</th>
<th data-quarto-table-cell-role="th">S_CSF1_response</th>
<th data-quarto-table-cell-role="th">S_TcClassII_score</th>
<th data-quarto-table-cell-role="th">S_IL12_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL4_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL2_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL13_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IFNG_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TGFB_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TREM1_data</th>
<th data-quarto-table-cell-role="th">S_DAP12_data</th>
<th data-quarto-table-cell-role="th">S_Tcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_IL8_21978456</th>
<th data-quarto-table-cell-role="th">S_IFN_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC1_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC2_21978456</th>
<th data-quarto-table-cell-role="th">S_Bcell_21978456</th>
<th data-quarto-table-cell-role="th">S_Tcell_21978456</th>
<th data-quarto-table-cell-role="th">S_CD103pos_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_CD103neg_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_IgG_19272155</th>
<th data-quarto-table-cell-role="th">S_Interferon_19272155</th>
<th data-quarto-table-cell-role="th">S_LCK_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.I_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.II_19272155</th>
<th data-quarto-table-cell-role="th">S_STAT1_19272155</th>
<th data-quarto-table-cell-role="th">S_Troester_WoundSig_19887484</th>
<th data-quarto-table-cell-role="th">S_MDACC.FNA.1_20805453</th>
<th data-quarto-table-cell-role="th">S_IGG_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Minterferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Immune_cell_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_MCD3_CD8_21214954</th>
<th data-quarto-table-cell-role="th">S_Interferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_B_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_CD8_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_GRANS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_LYMPHS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_T_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_TGFB_PCA_17349583</th>
<th data-quarto-table-cell-role="th">S_Rotterdam_ERneg_PCA_15721472</th>
<th data-quarto-table-cell-role="th">S_HER2_Immune_PCA_18006808</th>
<th data-quarto-table-cell-role="th">S_IR7_score</th>
<th data-quarto-table-cell-role="th">S_Buck14_score</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_score</th>
<th data-quarto-table-cell-role="th">S_Immune_NSCLC_score</th>
<th data-quarto-table-cell-role="th">S_Module3_IFN_score</th>
<th data-quarto-table-cell-role="th">S_Module4_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module5_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module11_Prolif_score</th>
<th data-quarto-table-cell-role="th">S_CD8_CD68_ratio</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_TcClassII_ratio</th>
<th data-quarto-table-cell-role="th">S_CHANG_CORE_SERUM_RESPONSE_UP</th>
<th data-quarto-table-cell-role="th">S_CSR_Activated_15701700</th>
<th data-quarto-table-cell-role="th">S_B_cells</th>
<th data-quarto-table-cell-role="th">S_T_cells</th>
<th data-quarto-table-cell-role="th">S_T_helper</th>
<th data-quarto-table-cell-role="th">S_Tcm</th>
<th data-quarto-table-cell-role="th">S_Tem</th>
<th data-quarto-table-cell-role="th">S_Th1</th>
<th data-quarto-table-cell-role="th">S_Th2</th>
<th data-quarto-table-cell-role="th">S_TFH</th>
<th data-quarto-table-cell-role="th">S_CD8_Tcells</th>
<th data-quarto-table-cell-role="th">S_Th17</th>
<th data-quarto-table-cell-role="th">S_Treg</th>
<th data-quarto-table-cell-role="th">S_Tgd</th>
<th data-quarto-table-cell-role="th">S_Cytotoxic_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cd56dim</th>
<th data-quarto-table-cell-role="th">S_NK_cd56bright</th>
<th data-quarto-table-cell-role="th">S_DC</th>
<th data-quarto-table-cell-role="th">S_iDC</th>
<th data-quarto-table-cell-role="th">S_aDC</th>
<th data-quarto-table-cell-role="th">S_pDC</th>
<th data-quarto-table-cell-role="th">S_Eosinophils</th>
<th data-quarto-table-cell-role="th">S_Macrophages</th>
<th data-quarto-table-cell-role="th">S_Mast</th>
<th data-quarto-table-cell-role="th">S_Neutrophils</th>
<th data-quarto-table-cell-role="th">S_Bindea_full</th>
<th data-quarto-table-cell-role="th">S_Expanded_IFNg</th>
<th data-quarto-table-cell-role="th">S_KEGG_MMR</th>
<th data-quarto-table-cell-role="th">S_KEGG_TGF_Beta</th>
<th data-quarto-table-cell-role="th">S_KEGG_Cytosolic_DNA_Sensing</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0012</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>50</td>
<td>2</td>
<td>2.3</td>
<td>20</td>
<td>5.79</td>
<td>0.476190</td>
<td>357</td>
<td>1.7</td>
<td>2895.605487</td>
<td>9</td>
<td>0.120394</td>
<td>0.117468</td>
<td>0.448450</td>
<td>0.3620</td>
<td>0.4216</td>
<td>0.3034</td>
<td>0.4425</td>
<td>0.2749</td>
<td>0.2983</td>
<td>0.2756</td>
<td>0.3121</td>
<td>0.2765</td>
<td>0.3203</td>
<td>0.2463</td>
<td>0.2341</td>
<td>0.2495</td>
<td>0.3571</td>
<td>0.4591</td>
<td>0.3985</td>
<td>0.2130</td>
<td>0.2223</td>
<td>0.2766</td>
<td>0.3573</td>
<td>0.1561</td>
<td>0.2942</td>
<td>0.1536</td>
<td>0.2530</td>
<td>0.2042</td>
<td>0.2061</td>
<td>0.1942</td>
<td>0.2764</td>
<td>0.3327</td>
<td>0.3795</td>
<td>0.3435</td>
<td>0.2846</td>
<td>0.3797</td>
<td>0.3761</td>
<td>0.3197</td>
<td>0.4008</td>
<td>0.4403</td>
<td>0.2907</td>
<td>0.4011</td>
<td>0.2526</td>
<td>0.2237</td>
<td>0.4256</td>
<td>0.3971</td>
<td>0.4477</td>
<td>0.1852</td>
<td>0.2516</td>
<td>0.2262</td>
<td>0.3854</td>
<td>0.1591</td>
<td>0.4462</td>
<td>0.2912</td>
<td>0.4211</td>
<td>0.4502</td>
<td>0.3610</td>
<td>0.2711</td>
<td>0.3414</td>
<td>0.2183</td>
<td>0.3728</td>
<td>0.3512</td>
<td>0.3529</td>
<td>0.4162</td>
<td>0.3612</td>
<td>0.2215</td>
<td>0.3614</td>
<td>0.4294</td>
<td>0.3451</td>
<td>0.4648</td>
<td>0.2937</td>
<td>0.3338</td>
<td>0.2999</td>
<td>0.2094</td>
<td>0.2743</td>
<td>0.3203</td>
<td>0.4136</td>
<td>0.2546</td>
<td>0.2730</td>
<td>0.3697</td>
<td>0.2268</td>
<td>0.3335</td>
<td>0.3959</td>
<td>0.4066</td>
<td>0.2199</td>
<td>0.2395</td>
<td>0.4132</td>
<td>0.3633</td>
<td>0.3210</td>
<td>0.2599</td>
<td>0.3561</td>
<td>0.3112</td>
<td>0.3645</td>
<td>0.2810</td>
<td>0.2348</td>
<td>0.1945</td>
<td>0.2188</td>
<td>0.3281</td>
<td>0.0602</td>
<td>0.2038</td>
<td>0.2445</td>
<td>0.3220</td>
<td>0.2212</td>
<td>0.2866</td>
<td>0.3030</td>
<td>0.3657</td>
<td>0.2499</td>
<td>0.2531</td>
<td>0.3031</td>
<td>0.3097</td>
<td>0.4053</td>
<td>0.3537</td>
<td>0.2530</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0014</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>58</td>
<td>2</td>
<td>2.5</td>
<td>10</td>
<td>5.28</td>
<td>0.588235</td>
<td>85</td>
<td>4.1</td>
<td>4257.831526</td>
<td>11</td>
<td>0.165023</td>
<td>0.207531</td>
<td>0.124223</td>
<td>0.4126</td>
<td>0.3815</td>
<td>0.3619</td>
<td>0.4760</td>
<td>0.3343</td>
<td>0.3001</td>
<td>0.2769</td>
<td>0.3761</td>
<td>0.3525</td>
<td>0.3452</td>
<td>0.3051</td>
<td>0.2701</td>
<td>0.3143</td>
<td>0.3803</td>
<td>0.4819</td>
<td>0.4125</td>
<td>0.3002</td>
<td>0.3106</td>
<td>0.3646</td>
<td>0.3753</td>
<td>0.1030</td>
<td>0.3644</td>
<td>0.2726</td>
<td>0.2377</td>
<td>0.2553</td>
<td>0.2513</td>
<td>0.2820</td>
<td>0.3079</td>
<td>0.3515</td>
<td>0.3869</td>
<td>0.3868</td>
<td>0.3133</td>
<td>0.4051</td>
<td>0.4031</td>
<td>0.3308</td>
<td>0.4120</td>
<td>0.4496</td>
<td>0.2012</td>
<td>0.4360</td>
<td>0.3290</td>
<td>0.2562</td>
<td>0.3882</td>
<td>0.4310</td>
<td>0.4682</td>
<td>0.2990</td>
<td>0.3007</td>
<td>0.2859</td>
<td>0.3998</td>
<td>0.2225</td>
<td>0.4068</td>
<td>0.3481</td>
<td>0.4494</td>
<td>0.4710</td>
<td>0.4011</td>
<td>0.2840</td>
<td>0.3779</td>
<td>0.2727</td>
<td>0.3831</td>
<td>0.3864</td>
<td>0.3511</td>
<td>0.3983</td>
<td>0.3676</td>
<td>0.2761</td>
<td>0.3637</td>
<td>0.4268</td>
<td>0.3555</td>
<td>0.4580</td>
<td>0.3266</td>
<td>0.3549</td>
<td>0.3763</td>
<td>0.2157</td>
<td>0.3028</td>
<td>0.3278</td>
<td>0.3896</td>
<td>0.3111</td>
<td>0.3159</td>
<td>0.3126</td>
<td>0.2395</td>
<td>0.3747</td>
<td>0.3838</td>
<td>0.4030</td>
<td>0.2731</td>
<td>0.2909</td>
<td>0.4092</td>
<td>0.3404</td>
<td>0.3530</td>
<td>0.2808</td>
<td>0.3102</td>
<td>0.3229</td>
<td>0.3713</td>
<td>0.2645</td>
<td>0.3182</td>
<td>0.1977</td>
<td>0.2985</td>
<td>0.3502</td>
<td>0.1191</td>
<td>0.3316</td>
<td>0.2976</td>
<td>0.3445</td>
<td>0.2403</td>
<td>0.3450</td>
<td>0.3203</td>
<td>0.3484</td>
<td>0.2768</td>
<td>0.2783</td>
<td>0.3200</td>
<td>0.3668</td>
<td>0.3803</td>
<td>0.3470</td>
<td>0.2606</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0015</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>46</td>
<td>2</td>
<td>1.8</td>
<td>4</td>
<td>11.48</td>
<td>0.250000</td>
<td>150</td>
<td>2.4</td>
<td>3123.055856</td>
<td>8</td>
<td>0.162653</td>
<td>0.235337</td>
<td>0.279972</td>
<td>0.3556</td>
<td>0.3782</td>
<td>0.3363</td>
<td>0.4718</td>
<td>0.3015</td>
<td>0.2659</td>
<td>0.2274</td>
<td>0.3180</td>
<td>0.3025</td>
<td>0.3124</td>
<td>0.2622</td>
<td>0.2304</td>
<td>0.2706</td>
<td>0.3761</td>
<td>0.4613</td>
<td>0.3814</td>
<td>0.3055</td>
<td>0.2764</td>
<td>0.3211</td>
<td>0.3784</td>
<td>-0.1955</td>
<td>0.3122</td>
<td>0.1932</td>
<td>0.2485</td>
<td>0.2211</td>
<td>0.2004</td>
<td>0.2478</td>
<td>0.3040</td>
<td>0.3316</td>
<td>0.3646</td>
<td>0.3483</td>
<td>0.3012</td>
<td>0.4038</td>
<td>0.3875</td>
<td>0.3158</td>
<td>0.3986</td>
<td>0.4391</td>
<td>0.1509</td>
<td>0.3958</td>
<td>0.2886</td>
<td>0.2535</td>
<td>0.3764</td>
<td>0.4054</td>
<td>0.4601</td>
<td>0.2509</td>
<td>0.2830</td>
<td>0.2712</td>
<td>0.3801</td>
<td>0.1750</td>
<td>0.3987</td>
<td>0.3063</td>
<td>0.4239</td>
<td>0.4616</td>
<td>0.3587</td>
<td>0.2955</td>
<td>0.3431</td>
<td>0.2278</td>
<td>0.3599</td>
<td>0.3549</td>
<td>0.4011</td>
<td>0.3865</td>
<td>0.3661</td>
<td>0.2671</td>
<td>0.3591</td>
<td>0.4313</td>
<td>0.3489</td>
<td>0.4442</td>
<td>0.2985</td>
<td>0.3383</td>
<td>0.3370</td>
<td>0.2609</td>
<td>0.2706</td>
<td>0.3312</td>
<td>0.3792</td>
<td>0.2851</td>
<td>0.2897</td>
<td>0.2984</td>
<td>0.0936</td>
<td>0.3370</td>
<td>0.3880</td>
<td>0.4038</td>
<td>0.2799</td>
<td>0.2873</td>
<td>0.4159</td>
<td>0.3520</td>
<td>0.3560</td>
<td>0.2600</td>
<td>0.3116</td>
<td>0.3225</td>
<td>0.3762</td>
<td>0.2370</td>
<td>0.2251</td>
<td>0.2021</td>
<td>0.2720</td>
<td>0.3434</td>
<td>0.0626</td>
<td>0.3025</td>
<td>0.2670</td>
<td>0.3212</td>
<td>0.2098</td>
<td>0.2967</td>
<td>0.3236</td>
<td>0.3266</td>
<td>0.2455</td>
<td>0.2522</td>
<td>0.3107</td>
<td>0.3372</td>
<td>0.3793</td>
<td>0.3522</td>
<td>0.2564</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0017</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>54</td>
<td>2</td>
<td>2.5</td>
<td>19</td>
<td>15.11</td>
<td>0.404255</td>
<td>1369</td>
<td>1.7</td>
<td>5275.497847</td>
<td>11</td>
<td>0.155523</td>
<td>0.148387</td>
<td>0.128777</td>
<td>0.4314</td>
<td>0.4482</td>
<td>0.4080</td>
<td>0.4980</td>
<td>0.3912</td>
<td>0.3120</td>
<td>0.2934</td>
<td>0.3864</td>
<td>0.3957</td>
<td>0.3131</td>
<td>0.3589</td>
<td>0.3341</td>
<td>0.3654</td>
<td>0.3842</td>
<td>0.4957</td>
<td>0.4328</td>
<td>0.3533</td>
<td>0.3732</td>
<td>0.4177</td>
<td>0.4350</td>
<td>0.1401</td>
<td>0.4006</td>
<td>0.3023</td>
<td>0.3429</td>
<td>0.3228</td>
<td>0.2922</td>
<td>0.3591</td>
<td>0.3671</td>
<td>0.3926</td>
<td>0.4113</td>
<td>0.4082</td>
<td>0.3325</td>
<td>0.4092</td>
<td>0.4129</td>
<td>0.3338</td>
<td>0.4190</td>
<td>0.4248</td>
<td>0.1319</td>
<td>0.4878</td>
<td>0.3797</td>
<td>0.1889</td>
<td>0.4601</td>
<td>0.4445</td>
<td>0.4859</td>
<td>0.3224</td>
<td>0.3693</td>
<td>0.3003</td>
<td>0.4095</td>
<td>0.2938</td>
<td>0.4707</td>
<td>0.3968</td>
<td>0.4616</td>
<td>0.4893</td>
<td>0.4644</td>
<td>0.2735</td>
<td>0.3955</td>
<td>0.3234</td>
<td>0.4165</td>
<td>0.4337</td>
<td>0.4190</td>
<td>0.4511</td>
<td>0.3758</td>
<td>0.3174</td>
<td>0.3679</td>
<td>0.4314</td>
<td>0.3648</td>
<td>0.4439</td>
<td>0.2886</td>
<td>0.3688</td>
<td>0.4143</td>
<td>0.2489</td>
<td>0.3562</td>
<td>0.3498</td>
<td>0.4563</td>
<td>0.3576</td>
<td>0.3706</td>
<td>0.3377</td>
<td>0.2758</td>
<td>0.4006</td>
<td>0.4000</td>
<td>0.4062</td>
<td>0.3182</td>
<td>0.3460</td>
<td>0.4170</td>
<td>0.3275</td>
<td>0.3432</td>
<td>0.2914</td>
<td>0.3307</td>
<td>0.3525</td>
<td>0.3879</td>
<td>0.2212</td>
<td>0.3330</td>
<td>0.2251</td>
<td>0.3151</td>
<td>0.3495</td>
<td>0.1939</td>
<td>0.2953</td>
<td>0.3010</td>
<td>0.3467</td>
<td>0.2547</td>
<td>0.3313</td>
<td>0.3230</td>
<td>0.3597</td>
<td>0.2726</td>
<td>0.2648</td>
<td>0.3309</td>
<td>0.4165</td>
<td>0.3997</td>
<td>0.3468</td>
<td>0.2682</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0018</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>58</td>
<td>3</td>
<td>3.0</td>
<td>39</td>
<td>3.00</td>
<td>0.309524</td>
<td>382</td>
<td>1.6</td>
<td>3548.348220</td>
<td>11</td>
<td>0.129397</td>
<td>0.133531</td>
<td>0.304963</td>
<td>0.3701</td>
<td>0.3859</td>
<td>0.3067</td>
<td>0.4858</td>
<td>0.3141</td>
<td>0.2980</td>
<td>0.2006</td>
<td>0.3222</td>
<td>0.3017</td>
<td>0.3358</td>
<td>0.2870</td>
<td>0.2544</td>
<td>0.2955</td>
<td>0.3292</td>
<td>0.4758</td>
<td>0.4200</td>
<td>0.2892</td>
<td>0.2845</td>
<td>0.3767</td>
<td>0.4084</td>
<td>0.1187</td>
<td>0.2786</td>
<td>0.2363</td>
<td>0.2357</td>
<td>0.2360</td>
<td>0.2310</td>
<td>0.3125</td>
<td>0.3054</td>
<td>0.3430</td>
<td>0.3742</td>
<td>0.3709</td>
<td>0.2860</td>
<td>0.3689</td>
<td>0.3880</td>
<td>0.3172</td>
<td>0.4095</td>
<td>0.4343</td>
<td>0.2824</td>
<td>0.4664</td>
<td>0.2799</td>
<td>0.2613</td>
<td>0.3975</td>
<td>0.4264</td>
<td>0.4805</td>
<td>0.3210</td>
<td>0.2670</td>
<td>0.2429</td>
<td>0.3952</td>
<td>0.2321</td>
<td>0.4166</td>
<td>0.3061</td>
<td>0.4446</td>
<td>0.4658</td>
<td>0.4181</td>
<td>0.2747</td>
<td>0.3910</td>
<td>0.3019</td>
<td>0.3722</td>
<td>0.3716</td>
<td>0.3075</td>
<td>0.3931</td>
<td>0.3605</td>
<td>0.2308</td>
<td>0.3603</td>
<td>0.4258</td>
<td>0.3393</td>
<td>0.4654</td>
<td>0.2920</td>
<td>0.3385</td>
<td>0.3668</td>
<td>0.2237</td>
<td>0.3404</td>
<td>0.3264</td>
<td>0.3909</td>
<td>0.2758</td>
<td>0.3050</td>
<td>0.3770</td>
<td>0.2009</td>
<td>0.3664</td>
<td>0.4026</td>
<td>0.4092</td>
<td>0.2699</td>
<td>0.2530</td>
<td>0.3955</td>
<td>0.3185</td>
<td>0.3066</td>
<td>0.2713</td>
<td>0.3333</td>
<td>0.3041</td>
<td>0.3523</td>
<td>0.2401</td>
<td>0.2709</td>
<td>0.1413</td>
<td>0.2636</td>
<td>0.3061</td>
<td>0.0764</td>
<td>0.2639</td>
<td>0.2623</td>
<td>0.3348</td>
<td>0.2124</td>
<td>0.2731</td>
<td>0.3020</td>
<td>0.3540</td>
<td>0.2233</td>
<td>0.2182</td>
<td>0.2979</td>
<td>0.3530</td>
<td>0.4033</td>
<td>0.3444</td>
<td>0.2496</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>And below is the original, unencoded dataframe.</p>
<div id="cell-23" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dfd.shape)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>dfd.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(674, 124)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Subtype</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionNeo_bestIC50</th>
<th data-quarto-table-cell-role="th">FN/FT_Ratio</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
<th data-quarto-table-cell-role="th">ESTIMATE</th>
<th data-quarto-table-cell-role="th">IMPRES</th>
<th data-quarto-table-cell-role="th">C_Bcellsnaive</th>
<th data-quarto-table-cell-role="th">C_TcellsCD4memoryresting</th>
<th data-quarto-table-cell-role="th">C_MacrophagesM2</th>
<th data-quarto-table-cell-role="th">S_Attractors_LYM</th>
<th data-quarto-table-cell-role="th">S_Attractors_IFIT3</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_GIMAP4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_HLA.DPA1</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SLAMF6</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_LILRB4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SIGLEC9</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CYTH4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CD3E</th>
<th data-quarto-table-cell-role="th">S_Lymph_Vessels</th>
<th data-quarto-table-cell-role="th">S_ICR_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_INHIB_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_ACT_SCORE</th>
<th data-quarto-table-cell-role="th">S_Angiogenesis</th>
<th data-quarto-table-cell-role="th">S_APM1</th>
<th data-quarto-table-cell-role="th">S_APM2</th>
<th data-quarto-table-cell-role="th">S_ICS5_score</th>
<th data-quarto-table-cell-role="th">S_LIexpression_score</th>
<th data-quarto-table-cell-role="th">S_Chemokine12_score</th>
<th data-quarto-table-cell-role="th">S_NHI_5gene_score</th>
<th data-quarto-table-cell-role="th">S_CD68</th>
<th data-quarto-table-cell-role="th">S_CD8A</th>
<th data-quarto-table-cell-role="th">S_PD1_data</th>
<th data-quarto-table-cell-role="th">S_PDL1_data</th>
<th data-quarto-table-cell-role="th">S_PD1_PDL1_score</th>
<th data-quarto-table-cell-role="th">S_CTLA4_data</th>
<th data-quarto-table-cell-role="th">S_Bcell_mg_IGJ</th>
<th data-quarto-table-cell-role="th">S_Bcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_STAT1_score</th>
<th data-quarto-table-cell-role="th">S_CSF1_response</th>
<th data-quarto-table-cell-role="th">S_TcClassII_score</th>
<th data-quarto-table-cell-role="th">S_IL12_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL4_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL2_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL13_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IFNG_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TGFB_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TREM1_data</th>
<th data-quarto-table-cell-role="th">S_DAP12_data</th>
<th data-quarto-table-cell-role="th">S_Tcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_IL8_21978456</th>
<th data-quarto-table-cell-role="th">S_IFN_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC1_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC2_21978456</th>
<th data-quarto-table-cell-role="th">S_Bcell_21978456</th>
<th data-quarto-table-cell-role="th">S_Tcell_21978456</th>
<th data-quarto-table-cell-role="th">S_CD103pos_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_CD103neg_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_IgG_19272155</th>
<th data-quarto-table-cell-role="th">S_Interferon_19272155</th>
<th data-quarto-table-cell-role="th">S_LCK_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.I_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.II_19272155</th>
<th data-quarto-table-cell-role="th">S_STAT1_19272155</th>
<th data-quarto-table-cell-role="th">S_Troester_WoundSig_19887484</th>
<th data-quarto-table-cell-role="th">S_MDACC.FNA.1_20805453</th>
<th data-quarto-table-cell-role="th">S_IGG_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Minterferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Immune_cell_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_MCD3_CD8_21214954</th>
<th data-quarto-table-cell-role="th">S_Interferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_B_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_CD8_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_GRANS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_LYMPHS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_T_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_TGFB_PCA_17349583</th>
<th data-quarto-table-cell-role="th">S_Rotterdam_ERneg_PCA_15721472</th>
<th data-quarto-table-cell-role="th">S_HER2_Immune_PCA_18006808</th>
<th data-quarto-table-cell-role="th">S_IR7_score</th>
<th data-quarto-table-cell-role="th">S_Buck14_score</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_score</th>
<th data-quarto-table-cell-role="th">S_Immune_NSCLC_score</th>
<th data-quarto-table-cell-role="th">S_Module3_IFN_score</th>
<th data-quarto-table-cell-role="th">S_Module4_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module5_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module11_Prolif_score</th>
<th data-quarto-table-cell-role="th">S_CD8_CD68_ratio</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_TcClassII_ratio</th>
<th data-quarto-table-cell-role="th">S_CHANG_CORE_SERUM_RESPONSE_UP</th>
<th data-quarto-table-cell-role="th">S_CSR_Activated_15701700</th>
<th data-quarto-table-cell-role="th">S_B_cells</th>
<th data-quarto-table-cell-role="th">S_T_cells</th>
<th data-quarto-table-cell-role="th">S_T_helper</th>
<th data-quarto-table-cell-role="th">S_Tcm</th>
<th data-quarto-table-cell-role="th">S_Tem</th>
<th data-quarto-table-cell-role="th">S_Th1</th>
<th data-quarto-table-cell-role="th">S_Th2</th>
<th data-quarto-table-cell-role="th">S_TFH</th>
<th data-quarto-table-cell-role="th">S_CD8_Tcells</th>
<th data-quarto-table-cell-role="th">S_Th17</th>
<th data-quarto-table-cell-role="th">S_Treg</th>
<th data-quarto-table-cell-role="th">S_Tgd</th>
<th data-quarto-table-cell-role="th">S_Cytotoxic_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cd56dim</th>
<th data-quarto-table-cell-role="th">S_NK_cd56bright</th>
<th data-quarto-table-cell-role="th">S_DC</th>
<th data-quarto-table-cell-role="th">S_iDC</th>
<th data-quarto-table-cell-role="th">S_aDC</th>
<th data-quarto-table-cell-role="th">S_pDC</th>
<th data-quarto-table-cell-role="th">S_Eosinophils</th>
<th data-quarto-table-cell-role="th">S_Macrophages</th>
<th data-quarto-table-cell-role="th">S_Mast</th>
<th data-quarto-table-cell-role="th">S_Neutrophils</th>
<th data-quarto-table-cell-role="th">S_Bindea_full</th>
<th data-quarto-table-cell-role="th">S_Expanded_IFNg</th>
<th data-quarto-table-cell-role="th">S_KEGG_MMR</th>
<th data-quarto-table-cell-role="th">S_KEGG_TGF_Beta</th>
<th data-quarto-table-cell-role="th">S_KEGG_Cytosolic_DNA_Sensing</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0012</td>
<td>HR+/HER2-</td>
<td>50</td>
<td>2</td>
<td>2.3</td>
<td>20</td>
<td>5.79</td>
<td>0.476190</td>
<td>357</td>
<td>1.7</td>
<td>2895.605487</td>
<td>9</td>
<td>0.120394</td>
<td>0.117468</td>
<td>0.448450</td>
<td>0.3620</td>
<td>0.4216</td>
<td>0.3034</td>
<td>0.4425</td>
<td>0.2749</td>
<td>0.2983</td>
<td>0.2756</td>
<td>0.3121</td>
<td>0.2765</td>
<td>0.3203</td>
<td>0.2463</td>
<td>0.2341</td>
<td>0.2495</td>
<td>0.3571</td>
<td>0.4591</td>
<td>0.3985</td>
<td>0.2130</td>
<td>0.2223</td>
<td>0.2766</td>
<td>0.3573</td>
<td>0.1561</td>
<td>0.2942</td>
<td>0.1536</td>
<td>0.2530</td>
<td>0.2042</td>
<td>0.2061</td>
<td>0.1942</td>
<td>0.2764</td>
<td>0.3327</td>
<td>0.3795</td>
<td>0.3435</td>
<td>0.2846</td>
<td>0.3797</td>
<td>0.3761</td>
<td>0.3197</td>
<td>0.4008</td>
<td>0.4403</td>
<td>0.2907</td>
<td>0.4011</td>
<td>0.2526</td>
<td>0.2237</td>
<td>0.4256</td>
<td>0.3971</td>
<td>0.4477</td>
<td>0.1852</td>
<td>0.2516</td>
<td>0.2262</td>
<td>0.3854</td>
<td>0.1591</td>
<td>0.4462</td>
<td>0.2912</td>
<td>0.4211</td>
<td>0.4502</td>
<td>0.3610</td>
<td>0.2711</td>
<td>0.3414</td>
<td>0.2183</td>
<td>0.3728</td>
<td>0.3512</td>
<td>0.3529</td>
<td>0.4162</td>
<td>0.3612</td>
<td>0.2215</td>
<td>0.3614</td>
<td>0.4294</td>
<td>0.3451</td>
<td>0.4648</td>
<td>0.2937</td>
<td>0.3338</td>
<td>0.2999</td>
<td>0.2094</td>
<td>0.2743</td>
<td>0.3203</td>
<td>0.4136</td>
<td>0.2546</td>
<td>0.2730</td>
<td>0.3697</td>
<td>0.2268</td>
<td>0.3335</td>
<td>0.3959</td>
<td>0.4066</td>
<td>0.2199</td>
<td>0.2395</td>
<td>0.4132</td>
<td>0.3633</td>
<td>0.3210</td>
<td>0.2599</td>
<td>0.3561</td>
<td>0.3112</td>
<td>0.3645</td>
<td>0.2810</td>
<td>0.2348</td>
<td>0.1945</td>
<td>0.2188</td>
<td>0.3281</td>
<td>0.0602</td>
<td>0.2038</td>
<td>0.2445</td>
<td>0.3220</td>
<td>0.2212</td>
<td>0.2866</td>
<td>0.3030</td>
<td>0.3657</td>
<td>0.2499</td>
<td>0.2531</td>
<td>0.3031</td>
<td>0.3097</td>
<td>0.4053</td>
<td>0.3537</td>
<td>0.2530</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0014</td>
<td>HR+/HER2-</td>
<td>58</td>
<td>2</td>
<td>2.5</td>
<td>10</td>
<td>5.28</td>
<td>0.588235</td>
<td>85</td>
<td>4.1</td>
<td>4257.831526</td>
<td>11</td>
<td>0.165023</td>
<td>0.207531</td>
<td>0.124223</td>
<td>0.4126</td>
<td>0.3815</td>
<td>0.3619</td>
<td>0.4760</td>
<td>0.3343</td>
<td>0.3001</td>
<td>0.2769</td>
<td>0.3761</td>
<td>0.3525</td>
<td>0.3452</td>
<td>0.3051</td>
<td>0.2701</td>
<td>0.3143</td>
<td>0.3803</td>
<td>0.4819</td>
<td>0.4125</td>
<td>0.3002</td>
<td>0.3106</td>
<td>0.3646</td>
<td>0.3753</td>
<td>0.1030</td>
<td>0.3644</td>
<td>0.2726</td>
<td>0.2377</td>
<td>0.2553</td>
<td>0.2513</td>
<td>0.2820</td>
<td>0.3079</td>
<td>0.3515</td>
<td>0.3869</td>
<td>0.3868</td>
<td>0.3133</td>
<td>0.4051</td>
<td>0.4031</td>
<td>0.3308</td>
<td>0.4120</td>
<td>0.4496</td>
<td>0.2012</td>
<td>0.4360</td>
<td>0.3290</td>
<td>0.2562</td>
<td>0.3882</td>
<td>0.4310</td>
<td>0.4682</td>
<td>0.2990</td>
<td>0.3007</td>
<td>0.2859</td>
<td>0.3998</td>
<td>0.2225</td>
<td>0.4068</td>
<td>0.3481</td>
<td>0.4494</td>
<td>0.4710</td>
<td>0.4011</td>
<td>0.2840</td>
<td>0.3779</td>
<td>0.2727</td>
<td>0.3831</td>
<td>0.3864</td>
<td>0.3511</td>
<td>0.3983</td>
<td>0.3676</td>
<td>0.2761</td>
<td>0.3637</td>
<td>0.4268</td>
<td>0.3555</td>
<td>0.4580</td>
<td>0.3266</td>
<td>0.3549</td>
<td>0.3763</td>
<td>0.2157</td>
<td>0.3028</td>
<td>0.3278</td>
<td>0.3896</td>
<td>0.3111</td>
<td>0.3159</td>
<td>0.3126</td>
<td>0.2395</td>
<td>0.3747</td>
<td>0.3838</td>
<td>0.4030</td>
<td>0.2731</td>
<td>0.2909</td>
<td>0.4092</td>
<td>0.3404</td>
<td>0.3530</td>
<td>0.2808</td>
<td>0.3102</td>
<td>0.3229</td>
<td>0.3713</td>
<td>0.2645</td>
<td>0.3182</td>
<td>0.1977</td>
<td>0.2985</td>
<td>0.3502</td>
<td>0.1191</td>
<td>0.3316</td>
<td>0.2976</td>
<td>0.3445</td>
<td>0.2403</td>
<td>0.3450</td>
<td>0.3203</td>
<td>0.3484</td>
<td>0.2768</td>
<td>0.2783</td>
<td>0.3200</td>
<td>0.3668</td>
<td>0.3803</td>
<td>0.3470</td>
<td>0.2606</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0015</td>
<td>HR+/HER2-</td>
<td>46</td>
<td>2</td>
<td>1.8</td>
<td>4</td>
<td>11.48</td>
<td>0.250000</td>
<td>150</td>
<td>2.4</td>
<td>3123.055856</td>
<td>8</td>
<td>0.162653</td>
<td>0.235337</td>
<td>0.279972</td>
<td>0.3556</td>
<td>0.3782</td>
<td>0.3363</td>
<td>0.4718</td>
<td>0.3015</td>
<td>0.2659</td>
<td>0.2274</td>
<td>0.3180</td>
<td>0.3025</td>
<td>0.3124</td>
<td>0.2622</td>
<td>0.2304</td>
<td>0.2706</td>
<td>0.3761</td>
<td>0.4613</td>
<td>0.3814</td>
<td>0.3055</td>
<td>0.2764</td>
<td>0.3211</td>
<td>0.3784</td>
<td>-0.1955</td>
<td>0.3122</td>
<td>0.1932</td>
<td>0.2485</td>
<td>0.2211</td>
<td>0.2004</td>
<td>0.2478</td>
<td>0.3040</td>
<td>0.3316</td>
<td>0.3646</td>
<td>0.3483</td>
<td>0.3012</td>
<td>0.4038</td>
<td>0.3875</td>
<td>0.3158</td>
<td>0.3986</td>
<td>0.4391</td>
<td>0.1509</td>
<td>0.3958</td>
<td>0.2886</td>
<td>0.2535</td>
<td>0.3764</td>
<td>0.4054</td>
<td>0.4601</td>
<td>0.2509</td>
<td>0.2830</td>
<td>0.2712</td>
<td>0.3801</td>
<td>0.1750</td>
<td>0.3987</td>
<td>0.3063</td>
<td>0.4239</td>
<td>0.4616</td>
<td>0.3587</td>
<td>0.2955</td>
<td>0.3431</td>
<td>0.2278</td>
<td>0.3599</td>
<td>0.3549</td>
<td>0.4011</td>
<td>0.3865</td>
<td>0.3661</td>
<td>0.2671</td>
<td>0.3591</td>
<td>0.4313</td>
<td>0.3489</td>
<td>0.4442</td>
<td>0.2985</td>
<td>0.3383</td>
<td>0.3370</td>
<td>0.2609</td>
<td>0.2706</td>
<td>0.3312</td>
<td>0.3792</td>
<td>0.2851</td>
<td>0.2897</td>
<td>0.2984</td>
<td>0.0936</td>
<td>0.3370</td>
<td>0.3880</td>
<td>0.4038</td>
<td>0.2799</td>
<td>0.2873</td>
<td>0.4159</td>
<td>0.3520</td>
<td>0.3560</td>
<td>0.2600</td>
<td>0.3116</td>
<td>0.3225</td>
<td>0.3762</td>
<td>0.2370</td>
<td>0.2251</td>
<td>0.2021</td>
<td>0.2720</td>
<td>0.3434</td>
<td>0.0626</td>
<td>0.3025</td>
<td>0.2670</td>
<td>0.3212</td>
<td>0.2098</td>
<td>0.2967</td>
<td>0.3236</td>
<td>0.3266</td>
<td>0.2455</td>
<td>0.2522</td>
<td>0.3107</td>
<td>0.3372</td>
<td>0.3793</td>
<td>0.3522</td>
<td>0.2564</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0017</td>
<td>HR+/HER2-</td>
<td>54</td>
<td>2</td>
<td>2.5</td>
<td>19</td>
<td>15.11</td>
<td>0.404255</td>
<td>1369</td>
<td>1.7</td>
<td>5275.497847</td>
<td>11</td>
<td>0.155523</td>
<td>0.148387</td>
<td>0.128777</td>
<td>0.4314</td>
<td>0.4482</td>
<td>0.4080</td>
<td>0.4980</td>
<td>0.3912</td>
<td>0.3120</td>
<td>0.2934</td>
<td>0.3864</td>
<td>0.3957</td>
<td>0.3131</td>
<td>0.3589</td>
<td>0.3341</td>
<td>0.3654</td>
<td>0.3842</td>
<td>0.4957</td>
<td>0.4328</td>
<td>0.3533</td>
<td>0.3732</td>
<td>0.4177</td>
<td>0.4350</td>
<td>0.1401</td>
<td>0.4006</td>
<td>0.3023</td>
<td>0.3429</td>
<td>0.3228</td>
<td>0.2922</td>
<td>0.3591</td>
<td>0.3671</td>
<td>0.3926</td>
<td>0.4113</td>
<td>0.4082</td>
<td>0.3325</td>
<td>0.4092</td>
<td>0.4129</td>
<td>0.3338</td>
<td>0.4190</td>
<td>0.4248</td>
<td>0.1319</td>
<td>0.4878</td>
<td>0.3797</td>
<td>0.1889</td>
<td>0.4601</td>
<td>0.4445</td>
<td>0.4859</td>
<td>0.3224</td>
<td>0.3693</td>
<td>0.3003</td>
<td>0.4095</td>
<td>0.2938</td>
<td>0.4707</td>
<td>0.3968</td>
<td>0.4616</td>
<td>0.4893</td>
<td>0.4644</td>
<td>0.2735</td>
<td>0.3955</td>
<td>0.3234</td>
<td>0.4165</td>
<td>0.4337</td>
<td>0.4190</td>
<td>0.4511</td>
<td>0.3758</td>
<td>0.3174</td>
<td>0.3679</td>
<td>0.4314</td>
<td>0.3648</td>
<td>0.4439</td>
<td>0.2886</td>
<td>0.3688</td>
<td>0.4143</td>
<td>0.2489</td>
<td>0.3562</td>
<td>0.3498</td>
<td>0.4563</td>
<td>0.3576</td>
<td>0.3706</td>
<td>0.3377</td>
<td>0.2758</td>
<td>0.4006</td>
<td>0.4000</td>
<td>0.4062</td>
<td>0.3182</td>
<td>0.3460</td>
<td>0.4170</td>
<td>0.3275</td>
<td>0.3432</td>
<td>0.2914</td>
<td>0.3307</td>
<td>0.3525</td>
<td>0.3879</td>
<td>0.2212</td>
<td>0.3330</td>
<td>0.2251</td>
<td>0.3151</td>
<td>0.3495</td>
<td>0.1939</td>
<td>0.2953</td>
<td>0.3010</td>
<td>0.3467</td>
<td>0.2547</td>
<td>0.3313</td>
<td>0.3230</td>
<td>0.3597</td>
<td>0.2726</td>
<td>0.2648</td>
<td>0.3309</td>
<td>0.4165</td>
<td>0.3997</td>
<td>0.3468</td>
<td>0.2682</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0018</td>
<td>HR+/HER2+</td>
<td>58</td>
<td>3</td>
<td>3.0</td>
<td>39</td>
<td>3.00</td>
<td>0.309524</td>
<td>382</td>
<td>1.6</td>
<td>3548.348220</td>
<td>11</td>
<td>0.129397</td>
<td>0.133531</td>
<td>0.304963</td>
<td>0.3701</td>
<td>0.3859</td>
<td>0.3067</td>
<td>0.4858</td>
<td>0.3141</td>
<td>0.2980</td>
<td>0.2006</td>
<td>0.3222</td>
<td>0.3017</td>
<td>0.3358</td>
<td>0.2870</td>
<td>0.2544</td>
<td>0.2955</td>
<td>0.3292</td>
<td>0.4758</td>
<td>0.4200</td>
<td>0.2892</td>
<td>0.2845</td>
<td>0.3767</td>
<td>0.4084</td>
<td>0.1187</td>
<td>0.2786</td>
<td>0.2363</td>
<td>0.2357</td>
<td>0.2360</td>
<td>0.2310</td>
<td>0.3125</td>
<td>0.3054</td>
<td>0.3430</td>
<td>0.3742</td>
<td>0.3709</td>
<td>0.2860</td>
<td>0.3689</td>
<td>0.3880</td>
<td>0.3172</td>
<td>0.4095</td>
<td>0.4343</td>
<td>0.2824</td>
<td>0.4664</td>
<td>0.2799</td>
<td>0.2613</td>
<td>0.3975</td>
<td>0.4264</td>
<td>0.4805</td>
<td>0.3210</td>
<td>0.2670</td>
<td>0.2429</td>
<td>0.3952</td>
<td>0.2321</td>
<td>0.4166</td>
<td>0.3061</td>
<td>0.4446</td>
<td>0.4658</td>
<td>0.4181</td>
<td>0.2747</td>
<td>0.3910</td>
<td>0.3019</td>
<td>0.3722</td>
<td>0.3716</td>
<td>0.3075</td>
<td>0.3931</td>
<td>0.3605</td>
<td>0.2308</td>
<td>0.3603</td>
<td>0.4258</td>
<td>0.3393</td>
<td>0.4654</td>
<td>0.2920</td>
<td>0.3385</td>
<td>0.3668</td>
<td>0.2237</td>
<td>0.3404</td>
<td>0.3264</td>
<td>0.3909</td>
<td>0.2758</td>
<td>0.3050</td>
<td>0.3770</td>
<td>0.2009</td>
<td>0.3664</td>
<td>0.4026</td>
<td>0.4092</td>
<td>0.2699</td>
<td>0.2530</td>
<td>0.3955</td>
<td>0.3185</td>
<td>0.3066</td>
<td>0.2713</td>
<td>0.3333</td>
<td>0.3041</td>
<td>0.3523</td>
<td>0.2401</td>
<td>0.2709</td>
<td>0.1413</td>
<td>0.2636</td>
<td>0.3061</td>
<td>0.0764</td>
<td>0.2639</td>
<td>0.2623</td>
<td>0.3348</td>
<td>0.2124</td>
<td>0.2731</td>
<td>0.3020</td>
<td>0.3540</td>
<td>0.2233</td>
<td>0.2182</td>
<td>0.2979</td>
<td>0.3530</td>
<td>0.4033</td>
<td>0.3444</td>
<td>0.2496</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="subsetting-y-labels-for-xgboost" class="level4">
<h4 class="anchored" data-anchor-id="subsetting-y-labels-for-xgboost"><strong>Subsetting Y Labels for XGBoost</strong></h4>
<p>In the previous exploration, many of the immune scores (Y targets/labels) might not really show much relationship with fusion neoantigen variables so they may not be as informative. We decided to use Caitlinâ€™s finding and subset the Y labels into several clinically meaningful groups.</p>
<div id="cell-25" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use the unencoded categorical dataframe (dfd) and drop the Subtype categorical column</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>df_dcat <span class="op">=</span> dfd.drop(columns<span class="op">=</span>[<span class="st">'Subtype'</span>])</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_dcat.shape)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>df_dcat.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(674, 123)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionNeo_bestIC50</th>
<th data-quarto-table-cell-role="th">FN/FT_Ratio</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
<th data-quarto-table-cell-role="th">ESTIMATE</th>
<th data-quarto-table-cell-role="th">IMPRES</th>
<th data-quarto-table-cell-role="th">C_Bcellsnaive</th>
<th data-quarto-table-cell-role="th">C_TcellsCD4memoryresting</th>
<th data-quarto-table-cell-role="th">C_MacrophagesM2</th>
<th data-quarto-table-cell-role="th">S_Attractors_LYM</th>
<th data-quarto-table-cell-role="th">S_Attractors_IFIT3</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_GIMAP4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_HLA.DPA1</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SLAMF6</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_LILRB4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SIGLEC9</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CYTH4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CD3E</th>
<th data-quarto-table-cell-role="th">S_Lymph_Vessels</th>
<th data-quarto-table-cell-role="th">S_ICR_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_INHIB_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_ACT_SCORE</th>
<th data-quarto-table-cell-role="th">S_Angiogenesis</th>
<th data-quarto-table-cell-role="th">S_APM1</th>
<th data-quarto-table-cell-role="th">S_APM2</th>
<th data-quarto-table-cell-role="th">S_ICS5_score</th>
<th data-quarto-table-cell-role="th">S_LIexpression_score</th>
<th data-quarto-table-cell-role="th">S_Chemokine12_score</th>
<th data-quarto-table-cell-role="th">S_NHI_5gene_score</th>
<th data-quarto-table-cell-role="th">S_CD68</th>
<th data-quarto-table-cell-role="th">S_CD8A</th>
<th data-quarto-table-cell-role="th">S_PD1_data</th>
<th data-quarto-table-cell-role="th">S_PDL1_data</th>
<th data-quarto-table-cell-role="th">S_PD1_PDL1_score</th>
<th data-quarto-table-cell-role="th">S_CTLA4_data</th>
<th data-quarto-table-cell-role="th">S_Bcell_mg_IGJ</th>
<th data-quarto-table-cell-role="th">S_Bcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_STAT1_score</th>
<th data-quarto-table-cell-role="th">S_CSF1_response</th>
<th data-quarto-table-cell-role="th">S_TcClassII_score</th>
<th data-quarto-table-cell-role="th">S_IL12_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL4_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL2_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL13_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IFNG_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TGFB_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TREM1_data</th>
<th data-quarto-table-cell-role="th">S_DAP12_data</th>
<th data-quarto-table-cell-role="th">S_Tcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_IL8_21978456</th>
<th data-quarto-table-cell-role="th">S_IFN_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC1_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC2_21978456</th>
<th data-quarto-table-cell-role="th">S_Bcell_21978456</th>
<th data-quarto-table-cell-role="th">S_Tcell_21978456</th>
<th data-quarto-table-cell-role="th">S_CD103pos_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_CD103neg_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_IgG_19272155</th>
<th data-quarto-table-cell-role="th">S_Interferon_19272155</th>
<th data-quarto-table-cell-role="th">S_LCK_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.I_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.II_19272155</th>
<th data-quarto-table-cell-role="th">S_STAT1_19272155</th>
<th data-quarto-table-cell-role="th">S_Troester_WoundSig_19887484</th>
<th data-quarto-table-cell-role="th">S_MDACC.FNA.1_20805453</th>
<th data-quarto-table-cell-role="th">S_IGG_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Minterferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Immune_cell_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_MCD3_CD8_21214954</th>
<th data-quarto-table-cell-role="th">S_Interferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_B_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_CD8_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_GRANS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_LYMPHS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_T_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_TGFB_PCA_17349583</th>
<th data-quarto-table-cell-role="th">S_Rotterdam_ERneg_PCA_15721472</th>
<th data-quarto-table-cell-role="th">S_HER2_Immune_PCA_18006808</th>
<th data-quarto-table-cell-role="th">S_IR7_score</th>
<th data-quarto-table-cell-role="th">S_Buck14_score</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_score</th>
<th data-quarto-table-cell-role="th">S_Immune_NSCLC_score</th>
<th data-quarto-table-cell-role="th">S_Module3_IFN_score</th>
<th data-quarto-table-cell-role="th">S_Module4_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module5_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module11_Prolif_score</th>
<th data-quarto-table-cell-role="th">S_CD8_CD68_ratio</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_TcClassII_ratio</th>
<th data-quarto-table-cell-role="th">S_CHANG_CORE_SERUM_RESPONSE_UP</th>
<th data-quarto-table-cell-role="th">S_CSR_Activated_15701700</th>
<th data-quarto-table-cell-role="th">S_B_cells</th>
<th data-quarto-table-cell-role="th">S_T_cells</th>
<th data-quarto-table-cell-role="th">S_T_helper</th>
<th data-quarto-table-cell-role="th">S_Tcm</th>
<th data-quarto-table-cell-role="th">S_Tem</th>
<th data-quarto-table-cell-role="th">S_Th1</th>
<th data-quarto-table-cell-role="th">S_Th2</th>
<th data-quarto-table-cell-role="th">S_TFH</th>
<th data-quarto-table-cell-role="th">S_CD8_Tcells</th>
<th data-quarto-table-cell-role="th">S_Th17</th>
<th data-quarto-table-cell-role="th">S_Treg</th>
<th data-quarto-table-cell-role="th">S_Tgd</th>
<th data-quarto-table-cell-role="th">S_Cytotoxic_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cd56dim</th>
<th data-quarto-table-cell-role="th">S_NK_cd56bright</th>
<th data-quarto-table-cell-role="th">S_DC</th>
<th data-quarto-table-cell-role="th">S_iDC</th>
<th data-quarto-table-cell-role="th">S_aDC</th>
<th data-quarto-table-cell-role="th">S_pDC</th>
<th data-quarto-table-cell-role="th">S_Eosinophils</th>
<th data-quarto-table-cell-role="th">S_Macrophages</th>
<th data-quarto-table-cell-role="th">S_Mast</th>
<th data-quarto-table-cell-role="th">S_Neutrophils</th>
<th data-quarto-table-cell-role="th">S_Bindea_full</th>
<th data-quarto-table-cell-role="th">S_Expanded_IFNg</th>
<th data-quarto-table-cell-role="th">S_KEGG_MMR</th>
<th data-quarto-table-cell-role="th">S_KEGG_TGF_Beta</th>
<th data-quarto-table-cell-role="th">S_KEGG_Cytosolic_DNA_Sensing</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0012</td>
<td>50</td>
<td>2</td>
<td>2.3</td>
<td>20</td>
<td>5.79</td>
<td>0.476190</td>
<td>357</td>
<td>1.7</td>
<td>2895.605487</td>
<td>9</td>
<td>0.120394</td>
<td>0.117468</td>
<td>0.448450</td>
<td>0.3620</td>
<td>0.4216</td>
<td>0.3034</td>
<td>0.4425</td>
<td>0.2749</td>
<td>0.2983</td>
<td>0.2756</td>
<td>0.3121</td>
<td>0.2765</td>
<td>0.3203</td>
<td>0.2463</td>
<td>0.2341</td>
<td>0.2495</td>
<td>0.3571</td>
<td>0.4591</td>
<td>0.3985</td>
<td>0.2130</td>
<td>0.2223</td>
<td>0.2766</td>
<td>0.3573</td>
<td>0.1561</td>
<td>0.2942</td>
<td>0.1536</td>
<td>0.2530</td>
<td>0.2042</td>
<td>0.2061</td>
<td>0.1942</td>
<td>0.2764</td>
<td>0.3327</td>
<td>0.3795</td>
<td>0.3435</td>
<td>0.2846</td>
<td>0.3797</td>
<td>0.3761</td>
<td>0.3197</td>
<td>0.4008</td>
<td>0.4403</td>
<td>0.2907</td>
<td>0.4011</td>
<td>0.2526</td>
<td>0.2237</td>
<td>0.4256</td>
<td>0.3971</td>
<td>0.4477</td>
<td>0.1852</td>
<td>0.2516</td>
<td>0.2262</td>
<td>0.3854</td>
<td>0.1591</td>
<td>0.4462</td>
<td>0.2912</td>
<td>0.4211</td>
<td>0.4502</td>
<td>0.3610</td>
<td>0.2711</td>
<td>0.3414</td>
<td>0.2183</td>
<td>0.3728</td>
<td>0.3512</td>
<td>0.3529</td>
<td>0.4162</td>
<td>0.3612</td>
<td>0.2215</td>
<td>0.3614</td>
<td>0.4294</td>
<td>0.3451</td>
<td>0.4648</td>
<td>0.2937</td>
<td>0.3338</td>
<td>0.2999</td>
<td>0.2094</td>
<td>0.2743</td>
<td>0.3203</td>
<td>0.4136</td>
<td>0.2546</td>
<td>0.2730</td>
<td>0.3697</td>
<td>0.2268</td>
<td>0.3335</td>
<td>0.3959</td>
<td>0.4066</td>
<td>0.2199</td>
<td>0.2395</td>
<td>0.4132</td>
<td>0.3633</td>
<td>0.3210</td>
<td>0.2599</td>
<td>0.3561</td>
<td>0.3112</td>
<td>0.3645</td>
<td>0.2810</td>
<td>0.2348</td>
<td>0.1945</td>
<td>0.2188</td>
<td>0.3281</td>
<td>0.0602</td>
<td>0.2038</td>
<td>0.2445</td>
<td>0.3220</td>
<td>0.2212</td>
<td>0.2866</td>
<td>0.3030</td>
<td>0.3657</td>
<td>0.2499</td>
<td>0.2531</td>
<td>0.3031</td>
<td>0.3097</td>
<td>0.4053</td>
<td>0.3537</td>
<td>0.2530</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0014</td>
<td>58</td>
<td>2</td>
<td>2.5</td>
<td>10</td>
<td>5.28</td>
<td>0.588235</td>
<td>85</td>
<td>4.1</td>
<td>4257.831526</td>
<td>11</td>
<td>0.165023</td>
<td>0.207531</td>
<td>0.124223</td>
<td>0.4126</td>
<td>0.3815</td>
<td>0.3619</td>
<td>0.4760</td>
<td>0.3343</td>
<td>0.3001</td>
<td>0.2769</td>
<td>0.3761</td>
<td>0.3525</td>
<td>0.3452</td>
<td>0.3051</td>
<td>0.2701</td>
<td>0.3143</td>
<td>0.3803</td>
<td>0.4819</td>
<td>0.4125</td>
<td>0.3002</td>
<td>0.3106</td>
<td>0.3646</td>
<td>0.3753</td>
<td>0.1030</td>
<td>0.3644</td>
<td>0.2726</td>
<td>0.2377</td>
<td>0.2553</td>
<td>0.2513</td>
<td>0.2820</td>
<td>0.3079</td>
<td>0.3515</td>
<td>0.3869</td>
<td>0.3868</td>
<td>0.3133</td>
<td>0.4051</td>
<td>0.4031</td>
<td>0.3308</td>
<td>0.4120</td>
<td>0.4496</td>
<td>0.2012</td>
<td>0.4360</td>
<td>0.3290</td>
<td>0.2562</td>
<td>0.3882</td>
<td>0.4310</td>
<td>0.4682</td>
<td>0.2990</td>
<td>0.3007</td>
<td>0.2859</td>
<td>0.3998</td>
<td>0.2225</td>
<td>0.4068</td>
<td>0.3481</td>
<td>0.4494</td>
<td>0.4710</td>
<td>0.4011</td>
<td>0.2840</td>
<td>0.3779</td>
<td>0.2727</td>
<td>0.3831</td>
<td>0.3864</td>
<td>0.3511</td>
<td>0.3983</td>
<td>0.3676</td>
<td>0.2761</td>
<td>0.3637</td>
<td>0.4268</td>
<td>0.3555</td>
<td>0.4580</td>
<td>0.3266</td>
<td>0.3549</td>
<td>0.3763</td>
<td>0.2157</td>
<td>0.3028</td>
<td>0.3278</td>
<td>0.3896</td>
<td>0.3111</td>
<td>0.3159</td>
<td>0.3126</td>
<td>0.2395</td>
<td>0.3747</td>
<td>0.3838</td>
<td>0.4030</td>
<td>0.2731</td>
<td>0.2909</td>
<td>0.4092</td>
<td>0.3404</td>
<td>0.3530</td>
<td>0.2808</td>
<td>0.3102</td>
<td>0.3229</td>
<td>0.3713</td>
<td>0.2645</td>
<td>0.3182</td>
<td>0.1977</td>
<td>0.2985</td>
<td>0.3502</td>
<td>0.1191</td>
<td>0.3316</td>
<td>0.2976</td>
<td>0.3445</td>
<td>0.2403</td>
<td>0.3450</td>
<td>0.3203</td>
<td>0.3484</td>
<td>0.2768</td>
<td>0.2783</td>
<td>0.3200</td>
<td>0.3668</td>
<td>0.3803</td>
<td>0.3470</td>
<td>0.2606</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0015</td>
<td>46</td>
<td>2</td>
<td>1.8</td>
<td>4</td>
<td>11.48</td>
<td>0.250000</td>
<td>150</td>
<td>2.4</td>
<td>3123.055856</td>
<td>8</td>
<td>0.162653</td>
<td>0.235337</td>
<td>0.279972</td>
<td>0.3556</td>
<td>0.3782</td>
<td>0.3363</td>
<td>0.4718</td>
<td>0.3015</td>
<td>0.2659</td>
<td>0.2274</td>
<td>0.3180</td>
<td>0.3025</td>
<td>0.3124</td>
<td>0.2622</td>
<td>0.2304</td>
<td>0.2706</td>
<td>0.3761</td>
<td>0.4613</td>
<td>0.3814</td>
<td>0.3055</td>
<td>0.2764</td>
<td>0.3211</td>
<td>0.3784</td>
<td>-0.1955</td>
<td>0.3122</td>
<td>0.1932</td>
<td>0.2485</td>
<td>0.2211</td>
<td>0.2004</td>
<td>0.2478</td>
<td>0.3040</td>
<td>0.3316</td>
<td>0.3646</td>
<td>0.3483</td>
<td>0.3012</td>
<td>0.4038</td>
<td>0.3875</td>
<td>0.3158</td>
<td>0.3986</td>
<td>0.4391</td>
<td>0.1509</td>
<td>0.3958</td>
<td>0.2886</td>
<td>0.2535</td>
<td>0.3764</td>
<td>0.4054</td>
<td>0.4601</td>
<td>0.2509</td>
<td>0.2830</td>
<td>0.2712</td>
<td>0.3801</td>
<td>0.1750</td>
<td>0.3987</td>
<td>0.3063</td>
<td>0.4239</td>
<td>0.4616</td>
<td>0.3587</td>
<td>0.2955</td>
<td>0.3431</td>
<td>0.2278</td>
<td>0.3599</td>
<td>0.3549</td>
<td>0.4011</td>
<td>0.3865</td>
<td>0.3661</td>
<td>0.2671</td>
<td>0.3591</td>
<td>0.4313</td>
<td>0.3489</td>
<td>0.4442</td>
<td>0.2985</td>
<td>0.3383</td>
<td>0.3370</td>
<td>0.2609</td>
<td>0.2706</td>
<td>0.3312</td>
<td>0.3792</td>
<td>0.2851</td>
<td>0.2897</td>
<td>0.2984</td>
<td>0.0936</td>
<td>0.3370</td>
<td>0.3880</td>
<td>0.4038</td>
<td>0.2799</td>
<td>0.2873</td>
<td>0.4159</td>
<td>0.3520</td>
<td>0.3560</td>
<td>0.2600</td>
<td>0.3116</td>
<td>0.3225</td>
<td>0.3762</td>
<td>0.2370</td>
<td>0.2251</td>
<td>0.2021</td>
<td>0.2720</td>
<td>0.3434</td>
<td>0.0626</td>
<td>0.3025</td>
<td>0.2670</td>
<td>0.3212</td>
<td>0.2098</td>
<td>0.2967</td>
<td>0.3236</td>
<td>0.3266</td>
<td>0.2455</td>
<td>0.2522</td>
<td>0.3107</td>
<td>0.3372</td>
<td>0.3793</td>
<td>0.3522</td>
<td>0.2564</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0017</td>
<td>54</td>
<td>2</td>
<td>2.5</td>
<td>19</td>
<td>15.11</td>
<td>0.404255</td>
<td>1369</td>
<td>1.7</td>
<td>5275.497847</td>
<td>11</td>
<td>0.155523</td>
<td>0.148387</td>
<td>0.128777</td>
<td>0.4314</td>
<td>0.4482</td>
<td>0.4080</td>
<td>0.4980</td>
<td>0.3912</td>
<td>0.3120</td>
<td>0.2934</td>
<td>0.3864</td>
<td>0.3957</td>
<td>0.3131</td>
<td>0.3589</td>
<td>0.3341</td>
<td>0.3654</td>
<td>0.3842</td>
<td>0.4957</td>
<td>0.4328</td>
<td>0.3533</td>
<td>0.3732</td>
<td>0.4177</td>
<td>0.4350</td>
<td>0.1401</td>
<td>0.4006</td>
<td>0.3023</td>
<td>0.3429</td>
<td>0.3228</td>
<td>0.2922</td>
<td>0.3591</td>
<td>0.3671</td>
<td>0.3926</td>
<td>0.4113</td>
<td>0.4082</td>
<td>0.3325</td>
<td>0.4092</td>
<td>0.4129</td>
<td>0.3338</td>
<td>0.4190</td>
<td>0.4248</td>
<td>0.1319</td>
<td>0.4878</td>
<td>0.3797</td>
<td>0.1889</td>
<td>0.4601</td>
<td>0.4445</td>
<td>0.4859</td>
<td>0.3224</td>
<td>0.3693</td>
<td>0.3003</td>
<td>0.4095</td>
<td>0.2938</td>
<td>0.4707</td>
<td>0.3968</td>
<td>0.4616</td>
<td>0.4893</td>
<td>0.4644</td>
<td>0.2735</td>
<td>0.3955</td>
<td>0.3234</td>
<td>0.4165</td>
<td>0.4337</td>
<td>0.4190</td>
<td>0.4511</td>
<td>0.3758</td>
<td>0.3174</td>
<td>0.3679</td>
<td>0.4314</td>
<td>0.3648</td>
<td>0.4439</td>
<td>0.2886</td>
<td>0.3688</td>
<td>0.4143</td>
<td>0.2489</td>
<td>0.3562</td>
<td>0.3498</td>
<td>0.4563</td>
<td>0.3576</td>
<td>0.3706</td>
<td>0.3377</td>
<td>0.2758</td>
<td>0.4006</td>
<td>0.4000</td>
<td>0.4062</td>
<td>0.3182</td>
<td>0.3460</td>
<td>0.4170</td>
<td>0.3275</td>
<td>0.3432</td>
<td>0.2914</td>
<td>0.3307</td>
<td>0.3525</td>
<td>0.3879</td>
<td>0.2212</td>
<td>0.3330</td>
<td>0.2251</td>
<td>0.3151</td>
<td>0.3495</td>
<td>0.1939</td>
<td>0.2953</td>
<td>0.3010</td>
<td>0.3467</td>
<td>0.2547</td>
<td>0.3313</td>
<td>0.3230</td>
<td>0.3597</td>
<td>0.2726</td>
<td>0.2648</td>
<td>0.3309</td>
<td>0.4165</td>
<td>0.3997</td>
<td>0.3468</td>
<td>0.2682</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0018</td>
<td>58</td>
<td>3</td>
<td>3.0</td>
<td>39</td>
<td>3.00</td>
<td>0.309524</td>
<td>382</td>
<td>1.6</td>
<td>3548.348220</td>
<td>11</td>
<td>0.129397</td>
<td>0.133531</td>
<td>0.304963</td>
<td>0.3701</td>
<td>0.3859</td>
<td>0.3067</td>
<td>0.4858</td>
<td>0.3141</td>
<td>0.2980</td>
<td>0.2006</td>
<td>0.3222</td>
<td>0.3017</td>
<td>0.3358</td>
<td>0.2870</td>
<td>0.2544</td>
<td>0.2955</td>
<td>0.3292</td>
<td>0.4758</td>
<td>0.4200</td>
<td>0.2892</td>
<td>0.2845</td>
<td>0.3767</td>
<td>0.4084</td>
<td>0.1187</td>
<td>0.2786</td>
<td>0.2363</td>
<td>0.2357</td>
<td>0.2360</td>
<td>0.2310</td>
<td>0.3125</td>
<td>0.3054</td>
<td>0.3430</td>
<td>0.3742</td>
<td>0.3709</td>
<td>0.2860</td>
<td>0.3689</td>
<td>0.3880</td>
<td>0.3172</td>
<td>0.4095</td>
<td>0.4343</td>
<td>0.2824</td>
<td>0.4664</td>
<td>0.2799</td>
<td>0.2613</td>
<td>0.3975</td>
<td>0.4264</td>
<td>0.4805</td>
<td>0.3210</td>
<td>0.2670</td>
<td>0.2429</td>
<td>0.3952</td>
<td>0.2321</td>
<td>0.4166</td>
<td>0.3061</td>
<td>0.4446</td>
<td>0.4658</td>
<td>0.4181</td>
<td>0.2747</td>
<td>0.3910</td>
<td>0.3019</td>
<td>0.3722</td>
<td>0.3716</td>
<td>0.3075</td>
<td>0.3931</td>
<td>0.3605</td>
<td>0.2308</td>
<td>0.3603</td>
<td>0.4258</td>
<td>0.3393</td>
<td>0.4654</td>
<td>0.2920</td>
<td>0.3385</td>
<td>0.3668</td>
<td>0.2237</td>
<td>0.3404</td>
<td>0.3264</td>
<td>0.3909</td>
<td>0.2758</td>
<td>0.3050</td>
<td>0.3770</td>
<td>0.2009</td>
<td>0.3664</td>
<td>0.4026</td>
<td>0.4092</td>
<td>0.2699</td>
<td>0.2530</td>
<td>0.3955</td>
<td>0.3185</td>
<td>0.3066</td>
<td>0.2713</td>
<td>0.3333</td>
<td>0.3041</td>
<td>0.3523</td>
<td>0.2401</td>
<td>0.2709</td>
<td>0.1413</td>
<td>0.2636</td>
<td>0.3061</td>
<td>0.0764</td>
<td>0.2639</td>
<td>0.2623</td>
<td>0.3348</td>
<td>0.2124</td>
<td>0.2731</td>
<td>0.3020</td>
<td>0.3540</td>
<td>0.2233</td>
<td>0.2182</td>
<td>0.2979</td>
<td>0.3530</td>
<td>0.4033</td>
<td>0.3444</td>
<td>0.2496</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>First list all the clinical variables that would be the X feature set.</p>
<div id="cell-27" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>X_features <span class="op">=</span> [<span class="st">'Subtype_HR+/HER2-'</span>, <span class="st">'Subtype_HR+/HER2+'</span>, <span class="st">'Subtype_TNBC'</span>, <span class="st">'Subtype_HR-/HER2+'</span>, <span class="st">'Age'</span>, <span class="st">'TumorGrade'</span>, <span class="st">'TumourSize'</span>, <span class="st">'FusionNeo_Count'</span>, <span class="st">'FusionNeo_bestIC50'</span>, <span class="st">'FN/FT_Ratio'</span>, <span class="st">'SNVindelNeo_Count'</span>, <span class="st">'SNVindelNeo_IC50'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-28" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>X_features_nocat <span class="op">=</span> [<span class="st">'Age'</span>, <span class="st">'TumorGrade'</span>, <span class="st">'TumourSize'</span>, <span class="st">'FusionNeo_Count'</span>, <span class="st">'FusionNeo_bestIC50'</span>, <span class="st">'FN/FT_Ratio'</span>, <span class="st">'SNVindelNeo_Count'</span>, <span class="st">'SNVindelNeo_IC50'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-29" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get the Y variable set</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>Y_labels_all <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> dfd.drop(columns<span class="op">=</span>[<span class="st">'Subtype'</span>]).columns <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> X_features]</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Y_labels_all[:<span class="dv">5</span>])</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(Y_labels_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['ESTIMATE', 'IMPRES', 'C_Bcellsnaive', 'C_TcellsCD4memoryresting', 'C_MacrophagesM2']</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>115</code></pre>
</div>
</div>
<div id="cell-30" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load up the tsv containing the groupings of the different immune scores</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>df_imscores <span class="op">=</span> pd.read_csv(<span class="st">'../input-data/SA/immune_score_groupings.tsv'</span>, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>df_imscores.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">HR&gt;1</th>
<th data-quarto-table-cell-role="th">HR&gt;1_worst_10_prog</th>
<th data-quarto-table-cell-role="th">HR&lt;1</th>
<th data-quarto-table-cell-role="th">HR&lt;1_best_10_prog</th>
<th data-quarto-table-cell-role="th">cytokine_chemokine_activator</th>
<th data-quarto-table-cell-role="th">activator_T</th>
<th data-quarto-table-cell-role="th">suppressor_T</th>
<th data-quarto-table-cell-role="th">B_cell_all</th>
<th data-quarto-table-cell-role="th">innate_cell_all</th>
<th data-quarto-table-cell-role="th">general</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>S_TREM1_data</td>
<td>S_TGFB_score_21050467</td>
<td>S_Buck14_score</td>
<td>S_Buck14_score</td>
<td>S_Expanded_IFNg</td>
<td>S_T_cells</td>
<td>S_Treg</td>
<td>S_CSR_Activated_15701700</td>
<td>S_pDC</td>
<td>S_Buck14_score</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>S_CHANG_CORE_SERUM_RESPONSE_UP</td>
<td>S_TGFB_PCA_17349583</td>
<td>S_Bcell_receptors_score</td>
<td>S_Bcell_receptors_score</td>
<td>S_IL2_score_21050467</td>
<td>S_Tcell_receptors_score</td>
<td>S_TGFB_score_21050467</td>
<td>S_Bcell_receptors_score</td>
<td>NaN</td>
<td>S_Rotterdam_ERneg_PCA_15721472</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>S_IL8_21978456</td>
<td>S_Lymph_Vessels</td>
<td>S_TFH</td>
<td>S_TFH</td>
<td>S_IL12_score_21050467</td>
<td>S_Tcell_21978456</td>
<td>S_CTLA4_data</td>
<td>S_B_cell_PCA_16704732</td>
<td>NaN</td>
<td>S_KEGG_Cytosolic_DNA_Sensing</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>S_Rotterdam_ERneg_PCA_15721472</td>
<td>S_CD103pos_mean_25446897</td>
<td>S_CD103pos_mean_25446897</td>
<td>S_IFNG_score_21050467</td>
<td>S_CD8_Tcells</td>
<td>S_PD1_data</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>S_IFNG_score_21050467</td>
<td>S_T_helper</td>
<td>S_T_helper</td>
<td>S_IR7_score</td>
<td>S_CD8A</td>
<td>S_PDL1_data</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-32" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># now convert each column into a Series and drop NA</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dictionary to store the Series</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>imscore_series_dict <span class="op">=</span> {}</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate through each column in the DataFrame</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column <span class="kw">in</span> df_imscores.columns:</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert the column to a Series, drop NaN values, and store in the dictionary</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    imscore_series_dict[column] <span class="op">=</span> df_imscores[column].dropna().tolist()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="spearman-correlation-heatmap" class="level4">
<h4 class="anchored" data-anchor-id="spearman-correlation-heatmap"><strong>Spearman Correlation Heatmap</strong></h4>
<p>Before moving on with XGBoost, we can plot a Spearman correlation matrix between the clinical variables (X features) and the different groupings of immune score variables (Y labels).</p>
<p>First, draw a matrix on the full cleaned up dataframe.</p>
<div id="cell-36" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># replot heatmap on transformed data</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>corr_df <span class="op">=</span> df_dcat.corr(method<span class="op">=</span><span class="st">'spearman'</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>corr_df <span class="op">=</span> corr_df.<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a mask for the upper triangle</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> np.triu(np.ones_like(corr_df, dtype<span class="op">=</span><span class="bu">bool</span>))</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">46</span>, <span class="dv">36</span>))</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the correlation matrix and represent it as a heatmap.</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>hm <span class="op">=</span> sns.heatmap(corr_df, annot <span class="op">=</span> <span class="va">False</span>, cmap <span class="op">=</span> <span class="st">'RdBu_r'</span>, square <span class="op">=</span> <span class="va">True</span>, linewidths<span class="op">=</span><span class="fl">0.5</span>, center<span class="op">=</span><span class="dv">0</span>, mask<span class="op">=</span>mask, cbar_kws<span class="op">=</span>{<span class="st">"shrink"</span>: <span class="fl">.5</span>})</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get current labels</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>ylabels <span class="op">=</span> hm.get_yticklabels()</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>xlabels <span class="op">=</span> hm.get_xticklabels()</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Hide the first y-axis label and the last x-axis label</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>ylabels[<span class="dv">0</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>xlabels[<span class="op">-</span><span class="dv">1</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Rotate and align the tick labels</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>plt.setp(xlabels, rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Define columns to highlight and their colors</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>highlight_cols <span class="op">=</span> {</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"FN/FT_Ratio"</span>: <span class="st">"crimson"</span>,</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"FusionNeo_Count"</span>: <span class="st">"olive"</span>,</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SNVindelNeo_Count"</span>: <span class="st">"darkviolet"</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Change color of specific x-axis and y-axis labels</span></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> label <span class="kw">in</span> xlabels:</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> label.get_text() <span class="kw">in</span> highlight_cols:</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>        label.set_color(highlight_cols[label.get_text()])</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>        label.set_fontweight(<span class="st">'bold'</span>)</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> label <span class="kw">in</span> ylabels:</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> label.get_text() <span class="kw">in</span> highlight_cols:</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>        label.set_color(highlight_cols[label.get_text()])</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>        label.set_fontweight(<span class="st">'bold'</span>)</span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Removes all ticks</span></span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>hm.tick_params(left<span class="op">=</span><span class="va">False</span>, bottom<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>hm.set_title(<span class="st">'Dataframe Correlation Heatmap'</span>, fontsize<span class="op">=</span><span class="dv">30</span>, x<span class="op">=</span><span class="fl">0.45</span>)</span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="xgboost_tuned_files/figure-html/cell-22-output-1.png" width="3368" height="3047" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now, draw the same on the subset Y labels grouped as <code>activator_T</code>.</p>
<div id="cell-38" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the list from the dict</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>activator_t <span class="op">=</span> imscore_series_dict[<span class="st">'activator_T'</span>]</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>suppressor_t <span class="op">=</span> imscore_series_dict[<span class="st">'suppressor_T'</span>]</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>best_prog <span class="op">=</span> imscore_series_dict[<span class="st">'HR&lt;1_best_10_prog'</span>]</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>worst_prog <span class="op">=</span> imscore_series_dict[<span class="st">'HR&gt;1_worst_10_prog'</span>]</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># combine these with the X feature set (unique only using set())</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>merged_cols <span class="op">=</span> X_features_nocat <span class="op">+</span> activator_t <span class="op">+</span> suppressor_t <span class="op">+</span> best_prog <span class="op">+</span> worst_prog</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>merged_cols <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(merged_cols))</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total number of elements in merged_cols (unsorted): </span><span class="sc">{</span><span class="bu">len</span>(merged_cols)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co"># there are repeated immune scores (at least in between two groups, can be more than two groups) so get a list of them first</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> combinations</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co"># list of all the sets</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>all_sets <span class="op">=</span> [<span class="bu">set</span>(activator_t), <span class="bu">set</span>(suppressor_t), <span class="bu">set</span>(best_prog), <span class="bu">set</span>(worst_prog)]</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Get all possible combinations of 2 sets</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>set_combo <span class="op">=</span> combinations(all_sets, <span class="dv">2</span>)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the union of all set combinations</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>union_of_combo <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>.union(<span class="op">*</span>[<span class="bu">set</span>.intersection(c1, c2) <span class="cf">for</span> c1, c2 <span class="kw">in</span> set_combo]))</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Elements that overlap between at least two sets: </span><span class="sc">{</span>union_of_combo<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a><span class="co"># rearrange the list element order based on another list</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>merged_cols <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> X_features_nocat] <span class="op">+</span> union_of_combo <span class="op">+</span> [x <span class="cf">for</span> x <span class="kw">in</span> activator_t <span class="cf">if</span> x <span class="kw">not</span> <span class="kw">in</span> union_of_combo] <span class="op">+</span> [x <span class="cf">for</span> x <span class="kw">in</span> suppressor_t <span class="cf">if</span> x <span class="kw">not</span> <span class="kw">in</span> union_of_combo] <span class="op">+</span> [x <span class="cf">for</span> x <span class="kw">in</span> best_prog <span class="cf">if</span> x <span class="kw">not</span> <span class="kw">in</span> union_of_combo] <span class="op">+</span> [x <span class="cf">for</span> x <span class="kw">in</span> worst_prog <span class="cf">if</span> x <span class="kw">not</span> <span class="kw">in</span> union_of_combo]</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total number of elements in merged_cols (sorted by original X feature order and groups): </span><span class="sc">{</span><span class="bu">len</span>(merged_cols)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total number of elements in merged_cols (unsorted): 53
Elements that overlap between at least two sets: ['S_TFH', 'S_T_helper', 'S_TGFB_score_21050467', 'S_TGFB_PCA_17349583']
Total number of elements in merged_cols (sorted by original X feature order and groups): 53</code></pre>
</div>
</div>
<div id="cell-39" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># now subset the dcat data</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>df_dcat_ss <span class="op">=</span> df_dcat[merged_cols]</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>df_dcat_ss.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionNeo_bestIC50</th>
<th data-quarto-table-cell-role="th">FN/FT_Ratio</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
<th data-quarto-table-cell-role="th">S_TFH</th>
<th data-quarto-table-cell-role="th">S_T_helper</th>
<th data-quarto-table-cell-role="th">S_TGFB_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TGFB_PCA_17349583</th>
<th data-quarto-table-cell-role="th">S_T_cells</th>
<th data-quarto-table-cell-role="th">S_Tcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_Tcell_21978456</th>
<th data-quarto-table-cell-role="th">S_CD8_Tcells</th>
<th data-quarto-table-cell-role="th">S_CD8A</th>
<th data-quarto-table-cell-role="th">S_Th17</th>
<th data-quarto-table-cell-role="th">S_Tcm</th>
<th data-quarto-table-cell-role="th">S_Tem</th>
<th data-quarto-table-cell-role="th">S_Th1</th>
<th data-quarto-table-cell-role="th">S_Cytotoxic_cells</th>
<th data-quarto-table-cell-role="th">C_TcellsCD4memoryresting</th>
<th data-quarto-table-cell-role="th">S_T_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CD3E</th>
<th data-quarto-table-cell-role="th">S_Tgd</th>
<th data-quarto-table-cell-role="th">S_CD8_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_Module4_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module5_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_CD8_CD68_ratio</th>
<th data-quarto-table-cell-role="th">S_ICR_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_ACT_SCORE</th>
<th data-quarto-table-cell-role="th">S_GRANS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_Treg</th>
<th data-quarto-table-cell-role="th">S_CTLA4_data</th>
<th data-quarto-table-cell-role="th">S_PD1_data</th>
<th data-quarto-table-cell-role="th">S_PDL1_data</th>
<th data-quarto-table-cell-role="th">S_PD1_PDL1_score</th>
<th data-quarto-table-cell-role="th">S_IL4_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL13_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TcClassII_score</th>
<th data-quarto-table-cell-role="th">S_KEGG_TGF_Beta</th>
<th data-quarto-table-cell-role="th">S_ICR_INHIB_SCORE</th>
<th data-quarto-table-cell-role="th">S_Buck14_score</th>
<th data-quarto-table-cell-role="th">S_Bcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_CD103pos_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SLAMF6</th>
<th data-quarto-table-cell-role="th">S_ICS5_score</th>
<th data-quarto-table-cell-role="th">S_Lymph_Vessels</th>
<th data-quarto-table-cell-role="th">S_Rotterdam_ERneg_PCA_15721472</th>
<th data-quarto-table-cell-role="th">S_IFNG_score_21050467</th>
<th data-quarto-table-cell-role="th">S_Module11_Prolif_score</th>
<th data-quarto-table-cell-role="th">S_TREM1_data</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0012</td>
<td>50</td>
<td>2</td>
<td>2.3</td>
<td>20</td>
<td>5.79</td>
<td>0.476190</td>
<td>357</td>
<td>1.7</td>
<td>0.3112</td>
<td>0.4132</td>
<td>0.4403</td>
<td>0.4648</td>
<td>0.2395</td>
<td>0.2526</td>
<td>0.2516</td>
<td>0.3645</td>
<td>0.2942</td>
<td>0.2810</td>
<td>0.3633</td>
<td>0.3210</td>
<td>0.2599</td>
<td>0.2188</td>
<td>0.117468</td>
<td>0.3451</td>
<td>0.2765</td>
<td>0.1945</td>
<td>0.2215</td>
<td>0.2546</td>
<td>0.2730</td>
<td>0.2268</td>
<td>0.2463</td>
<td>0.2495</td>
<td>0.3614</td>
<td>0.2348</td>
<td>0.2061</td>
<td>0.1536</td>
<td>0.2530</td>
<td>0.2042</td>
<td>0.3797</td>
<td>0.3197</td>
<td>0.3435</td>
<td>0.3537</td>
<td>0.2341</td>
<td>0.2094</td>
<td>0.2764</td>
<td>0.2262</td>
<td>0.2749</td>
<td>0.2130</td>
<td>0.3203</td>
<td>0.2937</td>
<td>0.4008</td>
<td>0.3697</td>
<td>0.2907</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0014</td>
<td>58</td>
<td>2</td>
<td>2.5</td>
<td>10</td>
<td>5.28</td>
<td>0.588235</td>
<td>85</td>
<td>4.1</td>
<td>0.3229</td>
<td>0.4092</td>
<td>0.4496</td>
<td>0.4580</td>
<td>0.2909</td>
<td>0.3290</td>
<td>0.3007</td>
<td>0.3713</td>
<td>0.3644</td>
<td>0.2645</td>
<td>0.3404</td>
<td>0.3530</td>
<td>0.2808</td>
<td>0.2985</td>
<td>0.207531</td>
<td>0.3555</td>
<td>0.3525</td>
<td>0.1977</td>
<td>0.2761</td>
<td>0.3111</td>
<td>0.3159</td>
<td>0.2395</td>
<td>0.3051</td>
<td>0.3143</td>
<td>0.3637</td>
<td>0.3182</td>
<td>0.2513</td>
<td>0.2726</td>
<td>0.2377</td>
<td>0.2553</td>
<td>0.4051</td>
<td>0.3308</td>
<td>0.3868</td>
<td>0.3470</td>
<td>0.2701</td>
<td>0.2157</td>
<td>0.3079</td>
<td>0.2859</td>
<td>0.3343</td>
<td>0.3002</td>
<td>0.3452</td>
<td>0.3266</td>
<td>0.4120</td>
<td>0.3126</td>
<td>0.2012</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0015</td>
<td>46</td>
<td>2</td>
<td>1.8</td>
<td>4</td>
<td>11.48</td>
<td>0.250000</td>
<td>150</td>
<td>2.4</td>
<td>0.3225</td>
<td>0.4159</td>
<td>0.4391</td>
<td>0.4442</td>
<td>0.2873</td>
<td>0.2886</td>
<td>0.2830</td>
<td>0.3762</td>
<td>0.3122</td>
<td>0.2370</td>
<td>0.3520</td>
<td>0.3560</td>
<td>0.2600</td>
<td>0.2720</td>
<td>0.235337</td>
<td>0.3489</td>
<td>0.3025</td>
<td>0.2021</td>
<td>0.2671</td>
<td>0.2851</td>
<td>0.2897</td>
<td>0.0936</td>
<td>0.2622</td>
<td>0.2706</td>
<td>0.3591</td>
<td>0.2251</td>
<td>0.2004</td>
<td>0.1932</td>
<td>0.2485</td>
<td>0.2211</td>
<td>0.4038</td>
<td>0.3158</td>
<td>0.3483</td>
<td>0.3522</td>
<td>0.2304</td>
<td>0.2609</td>
<td>0.3040</td>
<td>0.2712</td>
<td>0.3015</td>
<td>0.3055</td>
<td>0.3124</td>
<td>0.2985</td>
<td>0.3986</td>
<td>0.2984</td>
<td>0.1509</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0017</td>
<td>54</td>
<td>2</td>
<td>2.5</td>
<td>19</td>
<td>15.11</td>
<td>0.404255</td>
<td>1369</td>
<td>1.7</td>
<td>0.3525</td>
<td>0.4170</td>
<td>0.4248</td>
<td>0.4439</td>
<td>0.3460</td>
<td>0.3797</td>
<td>0.3693</td>
<td>0.3879</td>
<td>0.4006</td>
<td>0.2212</td>
<td>0.3275</td>
<td>0.3432</td>
<td>0.2914</td>
<td>0.3151</td>
<td>0.148387</td>
<td>0.3648</td>
<td>0.3957</td>
<td>0.2251</td>
<td>0.3174</td>
<td>0.3576</td>
<td>0.3706</td>
<td>0.2758</td>
<td>0.3589</td>
<td>0.3654</td>
<td>0.3679</td>
<td>0.3330</td>
<td>0.2922</td>
<td>0.3023</td>
<td>0.3429</td>
<td>0.3228</td>
<td>0.4092</td>
<td>0.3338</td>
<td>0.4082</td>
<td>0.3468</td>
<td>0.3341</td>
<td>0.2489</td>
<td>0.3671</td>
<td>0.3003</td>
<td>0.3912</td>
<td>0.3533</td>
<td>0.3131</td>
<td>0.2886</td>
<td>0.4190</td>
<td>0.3377</td>
<td>0.1319</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0018</td>
<td>58</td>
<td>3</td>
<td>3.0</td>
<td>39</td>
<td>3.00</td>
<td>0.309524</td>
<td>382</td>
<td>1.6</td>
<td>0.3041</td>
<td>0.3955</td>
<td>0.4343</td>
<td>0.4654</td>
<td>0.2530</td>
<td>0.2799</td>
<td>0.2670</td>
<td>0.3523</td>
<td>0.2786</td>
<td>0.2401</td>
<td>0.3185</td>
<td>0.3066</td>
<td>0.2713</td>
<td>0.2636</td>
<td>0.133531</td>
<td>0.3393</td>
<td>0.3017</td>
<td>0.1413</td>
<td>0.2308</td>
<td>0.2758</td>
<td>0.3050</td>
<td>0.2009</td>
<td>0.2870</td>
<td>0.2955</td>
<td>0.3603</td>
<td>0.2709</td>
<td>0.2310</td>
<td>0.2363</td>
<td>0.2357</td>
<td>0.2360</td>
<td>0.3689</td>
<td>0.3172</td>
<td>0.3709</td>
<td>0.3444</td>
<td>0.2544</td>
<td>0.2237</td>
<td>0.3054</td>
<td>0.2429</td>
<td>0.3141</td>
<td>0.2892</td>
<td>0.3358</td>
<td>0.2920</td>
<td>0.4095</td>
<td>0.3770</td>
<td>0.2824</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-40" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># replot heatmap on transformed data</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>corr_df <span class="op">=</span> df_dcat_ss.corr(method<span class="op">=</span><span class="st">'spearman'</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>corr_df <span class="op">=</span> corr_df.<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a mask for the upper triangle</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> np.triu(np.ones_like(corr_df, dtype<span class="op">=</span><span class="bu">bool</span>))</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">46</span>, <span class="dv">36</span>))</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the correlation matrix and represent it as a heatmap.</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>hm <span class="op">=</span> sns.heatmap(corr_df, annot <span class="op">=</span> <span class="va">False</span>, cmap <span class="op">=</span> <span class="st">'RdBu_r'</span>, square <span class="op">=</span> <span class="va">True</span>, linewidths<span class="op">=</span><span class="fl">0.5</span>, center<span class="op">=</span><span class="dv">0</span>, mask<span class="op">=</span>mask, cbar_kws<span class="op">=</span>{<span class="st">"shrink"</span>: <span class="fl">.5</span>})</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get current labels</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>ylabels <span class="op">=</span> hm.get_yticklabels()</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>xlabels <span class="op">=</span> hm.get_xticklabels()</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Hide the first y-axis label and the last x-axis label</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>ylabels[<span class="dv">0</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>xlabels[<span class="op">-</span><span class="dv">1</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Rotate and align the tick labels</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>plt.setp(xlabels, rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Define columns to highlight and their colors</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>highlight_cols <span class="op">=</span> {</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"FN/FT_Ratio"</span>: <span class="st">"crimson"</span>,</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"FusionNeo_Count"</span>: <span class="st">"olive"</span>,</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SNVindelNeo_Count"</span>: <span class="st">"darkviolet"</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Change color of specific x-axis and y-axis labels</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> label <span class="kw">in</span> xlabels:</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> label.get_text() <span class="kw">in</span> highlight_cols:</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>        label.set_color(highlight_cols[label.get_text()])</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>        label.set_fontweight(<span class="st">'bold'</span>)</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> label <span class="kw">in</span> ylabels:</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> label.get_text() <span class="kw">in</span> highlight_cols:</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>        label.set_color(highlight_cols[label.get_text()])</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>        label.set_fontweight(<span class="st">'bold'</span>)</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Removes all ticks</span></span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>hm.tick_params(left<span class="op">=</span><span class="va">False</span>, bottom<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>hm.set_title(<span class="st">'Dataframe Correlation Heatmap'</span>, fontsize<span class="op">=</span><span class="dv">30</span>, x<span class="op">=</span><span class="fl">0.45</span>)</span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="xgboost_tuned_files/figure-html/cell-25-output-1.png" width="3345" height="3030" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="split-dataset-with-train_test_split" class="level4">
<h4 class="anchored" data-anchor-id="split-dataset-with-train_test_split"><strong>Split Dataset with <code>train_test_split</code></strong></h4>
<p>Split the dataset before modeling to avoid information leakage, then preprocess the data through the set up Pipeline before XGBoost.</p>
<div id="cell-42" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subset X features; use the list generated before</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> dfenc[X_features]</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Subtype_HR+/HER2-</th>
<th data-quarto-table-cell-role="th">Subtype_HR+/HER2+</th>
<th data-quarto-table-cell-role="th">Subtype_TNBC</th>
<th data-quarto-table-cell-role="th">Subtype_HR-/HER2+</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionNeo_bestIC50</th>
<th data-quarto-table-cell-role="th">FN/FT_Ratio</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0012</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>50</td>
<td>2</td>
<td>2.3</td>
<td>20</td>
<td>5.79</td>
<td>0.476190</td>
<td>357</td>
<td>1.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0014</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>58</td>
<td>2</td>
<td>2.5</td>
<td>10</td>
<td>5.28</td>
<td>0.588235</td>
<td>85</td>
<td>4.1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0015</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>46</td>
<td>2</td>
<td>1.8</td>
<td>4</td>
<td>11.48</td>
<td>0.250000</td>
<td>150</td>
<td>2.4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0017</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>54</td>
<td>2</td>
<td>2.5</td>
<td>19</td>
<td>15.11</td>
<td>0.404255</td>
<td>1369</td>
<td>1.7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD2406</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>72</td>
<td>2</td>
<td>3.0</td>
<td>13</td>
<td>9.51</td>
<td>0.393939</td>
<td>512</td>
<td>1.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD2409</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>50</td>
<td>2</td>
<td>2.0</td>
<td>4</td>
<td>11.17</td>
<td>1.333333</td>
<td>26</td>
<td>2.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD2412</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>49</td>
<td>2</td>
<td>3.5</td>
<td>12</td>
<td>43.78</td>
<td>0.230769</td>
<td>80</td>
<td>5.1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD2418</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>74</td>
<td>2</td>
<td>2.2</td>
<td>17</td>
<td>17.87</td>
<td>0.772727</td>
<td>264</td>
<td>2.7</td>
</tr>
</tbody>
</table>

<p>674 rows Ã— 12 columns</p>
</div>
</div>
</div>
<p>Now grab the Y targets (do this as a whole, but we will train on each column individually later).</p>
<div id="cell-44" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get the Y variable set</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> dfenc[Y_labels_all]</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>Y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ESTIMATE</th>
<th data-quarto-table-cell-role="th">IMPRES</th>
<th data-quarto-table-cell-role="th">C_Bcellsnaive</th>
<th data-quarto-table-cell-role="th">C_TcellsCD4memoryresting</th>
<th data-quarto-table-cell-role="th">C_MacrophagesM2</th>
<th data-quarto-table-cell-role="th">S_Attractors_LYM</th>
<th data-quarto-table-cell-role="th">S_Attractors_IFIT3</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_GIMAP4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_HLA.DPA1</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SLAMF6</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_LILRB4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SIGLEC9</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CYTH4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CD3E</th>
<th data-quarto-table-cell-role="th">S_Lymph_Vessels</th>
<th data-quarto-table-cell-role="th">S_ICR_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_INHIB_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_ACT_SCORE</th>
<th data-quarto-table-cell-role="th">S_Angiogenesis</th>
<th data-quarto-table-cell-role="th">S_APM1</th>
<th data-quarto-table-cell-role="th">S_APM2</th>
<th data-quarto-table-cell-role="th">S_ICS5_score</th>
<th data-quarto-table-cell-role="th">S_LIexpression_score</th>
<th data-quarto-table-cell-role="th">S_Chemokine12_score</th>
<th data-quarto-table-cell-role="th">S_NHI_5gene_score</th>
<th data-quarto-table-cell-role="th">S_CD68</th>
<th data-quarto-table-cell-role="th">S_CD8A</th>
<th data-quarto-table-cell-role="th">S_PD1_data</th>
<th data-quarto-table-cell-role="th">S_PDL1_data</th>
<th data-quarto-table-cell-role="th">S_PD1_PDL1_score</th>
<th data-quarto-table-cell-role="th">S_CTLA4_data</th>
<th data-quarto-table-cell-role="th">S_Bcell_mg_IGJ</th>
<th data-quarto-table-cell-role="th">S_Bcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_STAT1_score</th>
<th data-quarto-table-cell-role="th">S_CSF1_response</th>
<th data-quarto-table-cell-role="th">S_TcClassII_score</th>
<th data-quarto-table-cell-role="th">S_IL12_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL4_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL2_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL13_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IFNG_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TGFB_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TREM1_data</th>
<th data-quarto-table-cell-role="th">S_DAP12_data</th>
<th data-quarto-table-cell-role="th">S_Tcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_IL8_21978456</th>
<th data-quarto-table-cell-role="th">S_IFN_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC1_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC2_21978456</th>
<th data-quarto-table-cell-role="th">S_Bcell_21978456</th>
<th data-quarto-table-cell-role="th">S_Tcell_21978456</th>
<th data-quarto-table-cell-role="th">S_CD103pos_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_CD103neg_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_IgG_19272155</th>
<th data-quarto-table-cell-role="th">S_Interferon_19272155</th>
<th data-quarto-table-cell-role="th">S_LCK_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.I_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.II_19272155</th>
<th data-quarto-table-cell-role="th">S_STAT1_19272155</th>
<th data-quarto-table-cell-role="th">S_Troester_WoundSig_19887484</th>
<th data-quarto-table-cell-role="th">S_MDACC.FNA.1_20805453</th>
<th data-quarto-table-cell-role="th">S_IGG_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Minterferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Immune_cell_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_MCD3_CD8_21214954</th>
<th data-quarto-table-cell-role="th">S_Interferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_B_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_CD8_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_GRANS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_LYMPHS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_T_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_TGFB_PCA_17349583</th>
<th data-quarto-table-cell-role="th">S_Rotterdam_ERneg_PCA_15721472</th>
<th data-quarto-table-cell-role="th">S_HER2_Immune_PCA_18006808</th>
<th data-quarto-table-cell-role="th">S_IR7_score</th>
<th data-quarto-table-cell-role="th">S_Buck14_score</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_score</th>
<th data-quarto-table-cell-role="th">S_Immune_NSCLC_score</th>
<th data-quarto-table-cell-role="th">S_Module3_IFN_score</th>
<th data-quarto-table-cell-role="th">S_Module4_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module5_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module11_Prolif_score</th>
<th data-quarto-table-cell-role="th">S_CD8_CD68_ratio</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_TcClassII_ratio</th>
<th data-quarto-table-cell-role="th">S_CHANG_CORE_SERUM_RESPONSE_UP</th>
<th data-quarto-table-cell-role="th">S_CSR_Activated_15701700</th>
<th data-quarto-table-cell-role="th">S_B_cells</th>
<th data-quarto-table-cell-role="th">S_T_cells</th>
<th data-quarto-table-cell-role="th">S_T_helper</th>
<th data-quarto-table-cell-role="th">S_Tcm</th>
<th data-quarto-table-cell-role="th">S_Tem</th>
<th data-quarto-table-cell-role="th">S_Th1</th>
<th data-quarto-table-cell-role="th">S_Th2</th>
<th data-quarto-table-cell-role="th">S_TFH</th>
<th data-quarto-table-cell-role="th">S_CD8_Tcells</th>
<th data-quarto-table-cell-role="th">S_Th17</th>
<th data-quarto-table-cell-role="th">S_Treg</th>
<th data-quarto-table-cell-role="th">S_Tgd</th>
<th data-quarto-table-cell-role="th">S_Cytotoxic_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cd56dim</th>
<th data-quarto-table-cell-role="th">S_NK_cd56bright</th>
<th data-quarto-table-cell-role="th">S_DC</th>
<th data-quarto-table-cell-role="th">S_iDC</th>
<th data-quarto-table-cell-role="th">S_aDC</th>
<th data-quarto-table-cell-role="th">S_pDC</th>
<th data-quarto-table-cell-role="th">S_Eosinophils</th>
<th data-quarto-table-cell-role="th">S_Macrophages</th>
<th data-quarto-table-cell-role="th">S_Mast</th>
<th data-quarto-table-cell-role="th">S_Neutrophils</th>
<th data-quarto-table-cell-role="th">S_Bindea_full</th>
<th data-quarto-table-cell-role="th">S_Expanded_IFNg</th>
<th data-quarto-table-cell-role="th">S_KEGG_MMR</th>
<th data-quarto-table-cell-role="th">S_KEGG_TGF_Beta</th>
<th data-quarto-table-cell-role="th">S_KEGG_Cytosolic_DNA_Sensing</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0012</td>
<td>2895.605487</td>
<td>9</td>
<td>0.120394</td>
<td>0.117468</td>
<td>0.448450</td>
<td>0.3620</td>
<td>0.4216</td>
<td>0.3034</td>
<td>0.4425</td>
<td>0.2749</td>
<td>0.2983</td>
<td>0.2756</td>
<td>0.3121</td>
<td>0.2765</td>
<td>0.3203</td>
<td>0.2463</td>
<td>0.2341</td>
<td>0.2495</td>
<td>0.3571</td>
<td>0.4591</td>
<td>0.3985</td>
<td>0.2130</td>
<td>0.2223</td>
<td>0.2766</td>
<td>0.3573</td>
<td>0.1561</td>
<td>0.2942</td>
<td>0.1536</td>
<td>0.2530</td>
<td>0.2042</td>
<td>0.2061</td>
<td>0.1942</td>
<td>0.2764</td>
<td>0.3327</td>
<td>0.3795</td>
<td>0.3435</td>
<td>0.2846</td>
<td>0.3797</td>
<td>0.3761</td>
<td>0.3197</td>
<td>0.4008</td>
<td>0.4403</td>
<td>0.2907</td>
<td>0.4011</td>
<td>0.2526</td>
<td>0.2237</td>
<td>0.4256</td>
<td>0.3971</td>
<td>0.4477</td>
<td>0.1852</td>
<td>0.2516</td>
<td>0.2262</td>
<td>0.3854</td>
<td>0.1591</td>
<td>0.4462</td>
<td>0.2912</td>
<td>0.4211</td>
<td>0.4502</td>
<td>0.3610</td>
<td>0.2711</td>
<td>0.3414</td>
<td>0.2183</td>
<td>0.3728</td>
<td>0.3512</td>
<td>0.3529</td>
<td>0.4162</td>
<td>0.3612</td>
<td>0.2215</td>
<td>0.3614</td>
<td>0.4294</td>
<td>0.3451</td>
<td>0.4648</td>
<td>0.2937</td>
<td>0.3338</td>
<td>0.2999</td>
<td>0.2094</td>
<td>0.2743</td>
<td>0.3203</td>
<td>0.4136</td>
<td>0.2546</td>
<td>0.2730</td>
<td>0.3697</td>
<td>0.2268</td>
<td>0.3335</td>
<td>0.3959</td>
<td>0.4066</td>
<td>0.2199</td>
<td>0.2395</td>
<td>0.4132</td>
<td>0.3633</td>
<td>0.3210</td>
<td>0.2599</td>
<td>0.3561</td>
<td>0.3112</td>
<td>0.3645</td>
<td>0.2810</td>
<td>0.2348</td>
<td>0.1945</td>
<td>0.2188</td>
<td>0.3281</td>
<td>0.0602</td>
<td>0.2038</td>
<td>0.2445</td>
<td>0.3220</td>
<td>0.2212</td>
<td>0.2866</td>
<td>0.3030</td>
<td>0.3657</td>
<td>0.2499</td>
<td>0.2531</td>
<td>0.3031</td>
<td>0.3097</td>
<td>0.4053</td>
<td>0.3537</td>
<td>0.2530</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0014</td>
<td>4257.831526</td>
<td>11</td>
<td>0.165023</td>
<td>0.207531</td>
<td>0.124223</td>
<td>0.4126</td>
<td>0.3815</td>
<td>0.3619</td>
<td>0.4760</td>
<td>0.3343</td>
<td>0.3001</td>
<td>0.2769</td>
<td>0.3761</td>
<td>0.3525</td>
<td>0.3452</td>
<td>0.3051</td>
<td>0.2701</td>
<td>0.3143</td>
<td>0.3803</td>
<td>0.4819</td>
<td>0.4125</td>
<td>0.3002</td>
<td>0.3106</td>
<td>0.3646</td>
<td>0.3753</td>
<td>0.1030</td>
<td>0.3644</td>
<td>0.2726</td>
<td>0.2377</td>
<td>0.2553</td>
<td>0.2513</td>
<td>0.2820</td>
<td>0.3079</td>
<td>0.3515</td>
<td>0.3869</td>
<td>0.3868</td>
<td>0.3133</td>
<td>0.4051</td>
<td>0.4031</td>
<td>0.3308</td>
<td>0.4120</td>
<td>0.4496</td>
<td>0.2012</td>
<td>0.4360</td>
<td>0.3290</td>
<td>0.2562</td>
<td>0.3882</td>
<td>0.4310</td>
<td>0.4682</td>
<td>0.2990</td>
<td>0.3007</td>
<td>0.2859</td>
<td>0.3998</td>
<td>0.2225</td>
<td>0.4068</td>
<td>0.3481</td>
<td>0.4494</td>
<td>0.4710</td>
<td>0.4011</td>
<td>0.2840</td>
<td>0.3779</td>
<td>0.2727</td>
<td>0.3831</td>
<td>0.3864</td>
<td>0.3511</td>
<td>0.3983</td>
<td>0.3676</td>
<td>0.2761</td>
<td>0.3637</td>
<td>0.4268</td>
<td>0.3555</td>
<td>0.4580</td>
<td>0.3266</td>
<td>0.3549</td>
<td>0.3763</td>
<td>0.2157</td>
<td>0.3028</td>
<td>0.3278</td>
<td>0.3896</td>
<td>0.3111</td>
<td>0.3159</td>
<td>0.3126</td>
<td>0.2395</td>
<td>0.3747</td>
<td>0.3838</td>
<td>0.4030</td>
<td>0.2731</td>
<td>0.2909</td>
<td>0.4092</td>
<td>0.3404</td>
<td>0.3530</td>
<td>0.2808</td>
<td>0.3102</td>
<td>0.3229</td>
<td>0.3713</td>
<td>0.2645</td>
<td>0.3182</td>
<td>0.1977</td>
<td>0.2985</td>
<td>0.3502</td>
<td>0.1191</td>
<td>0.3316</td>
<td>0.2976</td>
<td>0.3445</td>
<td>0.2403</td>
<td>0.3450</td>
<td>0.3203</td>
<td>0.3484</td>
<td>0.2768</td>
<td>0.2783</td>
<td>0.3200</td>
<td>0.3668</td>
<td>0.3803</td>
<td>0.3470</td>
<td>0.2606</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0015</td>
<td>3123.055856</td>
<td>8</td>
<td>0.162653</td>
<td>0.235337</td>
<td>0.279972</td>
<td>0.3556</td>
<td>0.3782</td>
<td>0.3363</td>
<td>0.4718</td>
<td>0.3015</td>
<td>0.2659</td>
<td>0.2274</td>
<td>0.3180</td>
<td>0.3025</td>
<td>0.3124</td>
<td>0.2622</td>
<td>0.2304</td>
<td>0.2706</td>
<td>0.3761</td>
<td>0.4613</td>
<td>0.3814</td>
<td>0.3055</td>
<td>0.2764</td>
<td>0.3211</td>
<td>0.3784</td>
<td>-0.1955</td>
<td>0.3122</td>
<td>0.1932</td>
<td>0.2485</td>
<td>0.2211</td>
<td>0.2004</td>
<td>0.2478</td>
<td>0.3040</td>
<td>0.3316</td>
<td>0.3646</td>
<td>0.3483</td>
<td>0.3012</td>
<td>0.4038</td>
<td>0.3875</td>
<td>0.3158</td>
<td>0.3986</td>
<td>0.4391</td>
<td>0.1509</td>
<td>0.3958</td>
<td>0.2886</td>
<td>0.2535</td>
<td>0.3764</td>
<td>0.4054</td>
<td>0.4601</td>
<td>0.2509</td>
<td>0.2830</td>
<td>0.2712</td>
<td>0.3801</td>
<td>0.1750</td>
<td>0.3987</td>
<td>0.3063</td>
<td>0.4239</td>
<td>0.4616</td>
<td>0.3587</td>
<td>0.2955</td>
<td>0.3431</td>
<td>0.2278</td>
<td>0.3599</td>
<td>0.3549</td>
<td>0.4011</td>
<td>0.3865</td>
<td>0.3661</td>
<td>0.2671</td>
<td>0.3591</td>
<td>0.4313</td>
<td>0.3489</td>
<td>0.4442</td>
<td>0.2985</td>
<td>0.3383</td>
<td>0.3370</td>
<td>0.2609</td>
<td>0.2706</td>
<td>0.3312</td>
<td>0.3792</td>
<td>0.2851</td>
<td>0.2897</td>
<td>0.2984</td>
<td>0.0936</td>
<td>0.3370</td>
<td>0.3880</td>
<td>0.4038</td>
<td>0.2799</td>
<td>0.2873</td>
<td>0.4159</td>
<td>0.3520</td>
<td>0.3560</td>
<td>0.2600</td>
<td>0.3116</td>
<td>0.3225</td>
<td>0.3762</td>
<td>0.2370</td>
<td>0.2251</td>
<td>0.2021</td>
<td>0.2720</td>
<td>0.3434</td>
<td>0.0626</td>
<td>0.3025</td>
<td>0.2670</td>
<td>0.3212</td>
<td>0.2098</td>
<td>0.2967</td>
<td>0.3236</td>
<td>0.3266</td>
<td>0.2455</td>
<td>0.2522</td>
<td>0.3107</td>
<td>0.3372</td>
<td>0.3793</td>
<td>0.3522</td>
<td>0.2564</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0017</td>
<td>5275.497847</td>
<td>11</td>
<td>0.155523</td>
<td>0.148387</td>
<td>0.128777</td>
<td>0.4314</td>
<td>0.4482</td>
<td>0.4080</td>
<td>0.4980</td>
<td>0.3912</td>
<td>0.3120</td>
<td>0.2934</td>
<td>0.3864</td>
<td>0.3957</td>
<td>0.3131</td>
<td>0.3589</td>
<td>0.3341</td>
<td>0.3654</td>
<td>0.3842</td>
<td>0.4957</td>
<td>0.4328</td>
<td>0.3533</td>
<td>0.3732</td>
<td>0.4177</td>
<td>0.4350</td>
<td>0.1401</td>
<td>0.4006</td>
<td>0.3023</td>
<td>0.3429</td>
<td>0.3228</td>
<td>0.2922</td>
<td>0.3591</td>
<td>0.3671</td>
<td>0.3926</td>
<td>0.4113</td>
<td>0.4082</td>
<td>0.3325</td>
<td>0.4092</td>
<td>0.4129</td>
<td>0.3338</td>
<td>0.4190</td>
<td>0.4248</td>
<td>0.1319</td>
<td>0.4878</td>
<td>0.3797</td>
<td>0.1889</td>
<td>0.4601</td>
<td>0.4445</td>
<td>0.4859</td>
<td>0.3224</td>
<td>0.3693</td>
<td>0.3003</td>
<td>0.4095</td>
<td>0.2938</td>
<td>0.4707</td>
<td>0.3968</td>
<td>0.4616</td>
<td>0.4893</td>
<td>0.4644</td>
<td>0.2735</td>
<td>0.3955</td>
<td>0.3234</td>
<td>0.4165</td>
<td>0.4337</td>
<td>0.4190</td>
<td>0.4511</td>
<td>0.3758</td>
<td>0.3174</td>
<td>0.3679</td>
<td>0.4314</td>
<td>0.3648</td>
<td>0.4439</td>
<td>0.2886</td>
<td>0.3688</td>
<td>0.4143</td>
<td>0.2489</td>
<td>0.3562</td>
<td>0.3498</td>
<td>0.4563</td>
<td>0.3576</td>
<td>0.3706</td>
<td>0.3377</td>
<td>0.2758</td>
<td>0.4006</td>
<td>0.4000</td>
<td>0.4062</td>
<td>0.3182</td>
<td>0.3460</td>
<td>0.4170</td>
<td>0.3275</td>
<td>0.3432</td>
<td>0.2914</td>
<td>0.3307</td>
<td>0.3525</td>
<td>0.3879</td>
<td>0.2212</td>
<td>0.3330</td>
<td>0.2251</td>
<td>0.3151</td>
<td>0.3495</td>
<td>0.1939</td>
<td>0.2953</td>
<td>0.3010</td>
<td>0.3467</td>
<td>0.2547</td>
<td>0.3313</td>
<td>0.3230</td>
<td>0.3597</td>
<td>0.2726</td>
<td>0.2648</td>
<td>0.3309</td>
<td>0.4165</td>
<td>0.3997</td>
<td>0.3468</td>
<td>0.2682</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD2406</td>
<td>2758.511524</td>
<td>9</td>
<td>0.040575</td>
<td>0.157374</td>
<td>0.372476</td>
<td>0.3538</td>
<td>0.3675</td>
<td>0.3196</td>
<td>0.4475</td>
<td>0.2878</td>
<td>0.2987</td>
<td>0.2249</td>
<td>0.2977</td>
<td>0.2772</td>
<td>0.3157</td>
<td>0.2587</td>
<td>0.2404</td>
<td>0.2636</td>
<td>0.3613</td>
<td>0.4659</td>
<td>0.3922</td>
<td>0.1966</td>
<td>0.2316</td>
<td>0.2923</td>
<td>0.2813</td>
<td>0.1748</td>
<td>0.2810</td>
<td>0.2205</td>
<td>0.2491</td>
<td>0.2348</td>
<td>0.2304</td>
<td>0.0588</td>
<td>0.2951</td>
<td>0.3204</td>
<td>0.3760</td>
<td>0.3382</td>
<td>0.2889</td>
<td>0.3728</td>
<td>0.3790</td>
<td>0.3174</td>
<td>0.3849</td>
<td>0.4309</td>
<td>0.3109</td>
<td>0.4362</td>
<td>0.2583</td>
<td>0.2269</td>
<td>0.3813</td>
<td>0.4082</td>
<td>0.4513</td>
<td>0.0401</td>
<td>0.2631</td>
<td>0.2357</td>
<td>0.3879</td>
<td>0.0211</td>
<td>0.3995</td>
<td>0.2916</td>
<td>0.4247</td>
<td>0.4515</td>
<td>0.3606</td>
<td>0.2608</td>
<td>0.3098</td>
<td>0.1564</td>
<td>0.3513</td>
<td>0.3567</td>
<td>0.3750</td>
<td>0.3842</td>
<td>0.3501</td>
<td>0.2271</td>
<td>0.3615</td>
<td>0.4321</td>
<td>0.3351</td>
<td>0.4546</td>
<td>0.2928</td>
<td>0.3272</td>
<td>0.2899</td>
<td>0.1731</td>
<td>0.2730</td>
<td>0.3076</td>
<td>0.3788</td>
<td>0.2516</td>
<td>0.2696</td>
<td>0.3959</td>
<td>0.2289</td>
<td>0.3288</td>
<td>0.4173</td>
<td>0.4145</td>
<td>0.1935</td>
<td>0.2306</td>
<td>0.4093</td>
<td>0.3427</td>
<td>0.2848</td>
<td>0.2491</td>
<td>0.3534</td>
<td>0.2957</td>
<td>0.3566</td>
<td>0.1893</td>
<td>0.2477</td>
<td>-0.0057</td>
<td>0.2601</td>
<td>0.3146</td>
<td>0.0602</td>
<td>0.2081</td>
<td>0.2756</td>
<td>0.3329</td>
<td>0.1981</td>
<td>0.3020</td>
<td>0.3171</td>
<td>0.3629</td>
<td>0.2257</td>
<td>0.2302</td>
<td>0.2934</td>
<td>0.3086</td>
<td>0.4236</td>
<td>0.3489</td>
<td>0.2568</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD2409</td>
<td>5379.451341</td>
<td>11</td>
<td>0.098933</td>
<td>0.065574</td>
<td>0.336374</td>
<td>0.4315</td>
<td>0.4001</td>
<td>0.4281</td>
<td>0.4980</td>
<td>0.3670</td>
<td>0.3599</td>
<td>0.3109</td>
<td>0.3885</td>
<td>0.3636</td>
<td>0.4058</td>
<td>0.3074</td>
<td>0.2588</td>
<td>0.3201</td>
<td>0.4278</td>
<td>0.4789</td>
<td>0.4486</td>
<td>0.2958</td>
<td>0.3271</td>
<td>0.3578</td>
<td>0.4093</td>
<td>0.2096</td>
<td>0.3742</td>
<td>0.2676</td>
<td>0.2780</td>
<td>0.2728</td>
<td>0.2282</td>
<td>0.3606</td>
<td>0.3481</td>
<td>0.3615</td>
<td>0.4254</td>
<td>0.3986</td>
<td>0.3114</td>
<td>0.4257</td>
<td>0.4138</td>
<td>0.3804</td>
<td>0.4204</td>
<td>0.4438</td>
<td>0.2689</td>
<td>0.5003</td>
<td>0.3371</td>
<td>0.3379</td>
<td>0.4041</td>
<td>0.4373</td>
<td>0.4943</td>
<td>0.3594</td>
<td>0.3169</td>
<td>0.3037</td>
<td>0.4367</td>
<td>0.2960</td>
<td>0.4184</td>
<td>0.3754</td>
<td>0.4485</td>
<td>0.4846</td>
<td>0.3863</td>
<td>0.3134</td>
<td>0.4283</td>
<td>0.3230</td>
<td>0.3787</td>
<td>0.4163</td>
<td>0.4373</td>
<td>0.4103</td>
<td>0.3737</td>
<td>0.2959</td>
<td>0.3780</td>
<td>0.4324</td>
<td>0.3626</td>
<td>0.4790</td>
<td>0.3242</td>
<td>0.3694</td>
<td>0.4018</td>
<td>0.1984</td>
<td>0.2949</td>
<td>0.3494</td>
<td>0.3979</td>
<td>0.3243</td>
<td>0.3352</td>
<td>0.2980</td>
<td>0.2940</td>
<td>0.3837</td>
<td>0.3991</td>
<td>0.4168</td>
<td>0.2902</td>
<td>0.3016</td>
<td>0.4070</td>
<td>0.3236</td>
<td>0.3370</td>
<td>0.2773</td>
<td>0.3046</td>
<td>0.3263</td>
<td>0.3789</td>
<td>0.2107</td>
<td>0.2569</td>
<td>0.2197</td>
<td>0.3364</td>
<td>0.3517</td>
<td>0.1525</td>
<td>0.3144</td>
<td>0.3632</td>
<td>0.3714</td>
<td>0.2620</td>
<td>0.4239</td>
<td>0.3225</td>
<td>0.3916</td>
<td>0.3130</td>
<td>0.3030</td>
<td>0.3316</td>
<td>0.3701</td>
<td>0.3928</td>
<td>0.3509</td>
<td>0.2660</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD2412</td>
<td>4225.584090</td>
<td>10</td>
<td>0.173398</td>
<td>0.207518</td>
<td>0.206046</td>
<td>0.4012</td>
<td>0.4299</td>
<td>0.3902</td>
<td>0.4827</td>
<td>0.3308</td>
<td>0.2883</td>
<td>0.2645</td>
<td>0.3532</td>
<td>0.3307</td>
<td>0.3501</td>
<td>0.2914</td>
<td>0.2594</td>
<td>0.2998</td>
<td>0.4215</td>
<td>0.4689</td>
<td>0.4101</td>
<td>0.2921</td>
<td>0.2960</td>
<td>0.3519</td>
<td>0.4009</td>
<td>0.1197</td>
<td>0.3624</td>
<td>0.2331</td>
<td>0.2785</td>
<td>0.2560</td>
<td>0.2199</td>
<td>0.2859</td>
<td>0.3213</td>
<td>0.3555</td>
<td>0.3963</td>
<td>0.3732</td>
<td>0.3114</td>
<td>0.4212</td>
<td>0.4116</td>
<td>0.3613</td>
<td>0.4112</td>
<td>0.4515</td>
<td>0.1930</td>
<td>0.4146</td>
<td>0.3027</td>
<td>0.2417</td>
<td>0.4171</td>
<td>0.4003</td>
<td>0.4708</td>
<td>0.3035</td>
<td>0.3050</td>
<td>0.3060</td>
<td>0.4193</td>
<td>0.2516</td>
<td>0.4358</td>
<td>0.3525</td>
<td>0.4096</td>
<td>0.4776</td>
<td>0.4012</td>
<td>0.3032</td>
<td>0.3910</td>
<td>0.2762</td>
<td>0.3900</td>
<td>0.3891</td>
<td>0.4143</td>
<td>0.4119</td>
<td>0.3790</td>
<td>0.2756</td>
<td>0.3649</td>
<td>0.4301</td>
<td>0.3595</td>
<td>0.4676</td>
<td>0.3259</td>
<td>0.3577</td>
<td>0.3666</td>
<td>0.2383</td>
<td>0.3118</td>
<td>0.3334</td>
<td>0.4189</td>
<td>0.3155</td>
<td>0.3162</td>
<td>0.3044</td>
<td>0.2460</td>
<td>0.3643</td>
<td>0.3864</td>
<td>0.4062</td>
<td>0.2942</td>
<td>0.3026</td>
<td>0.4215</td>
<td>0.3600</td>
<td>0.3633</td>
<td>0.2781</td>
<td>0.3185</td>
<td>0.3387</td>
<td>0.3711</td>
<td>0.2080</td>
<td>0.2333</td>
<td>0.1697</td>
<td>0.2862</td>
<td>0.3441</td>
<td>0.1187</td>
<td>0.2648</td>
<td>0.3162</td>
<td>0.3431</td>
<td>0.2301</td>
<td>0.3355</td>
<td>0.3413</td>
<td>0.3496</td>
<td>0.2730</td>
<td>0.2748</td>
<td>0.3238</td>
<td>0.3560</td>
<td>0.3815</td>
<td>0.3596</td>
<td>0.2491</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD2418</td>
<td>4774.602798</td>
<td>9</td>
<td>0.117058</td>
<td>0.243782</td>
<td>0.277604</td>
<td>0.4254</td>
<td>0.4221</td>
<td>0.3631</td>
<td>0.4951</td>
<td>0.3487</td>
<td>0.3314</td>
<td>0.3077</td>
<td>0.3607</td>
<td>0.3500</td>
<td>0.3505</td>
<td>0.3235</td>
<td>0.2908</td>
<td>0.3320</td>
<td>0.3746</td>
<td>0.4853</td>
<td>0.4419</td>
<td>0.2960</td>
<td>0.3042</td>
<td>0.3473</td>
<td>0.4130</td>
<td>0.1257</td>
<td>0.3791</td>
<td>0.2575</td>
<td>0.2910</td>
<td>0.2744</td>
<td>0.2594</td>
<td>0.3583</td>
<td>0.3261</td>
<td>0.3722</td>
<td>0.4154</td>
<td>0.3925</td>
<td>0.3258</td>
<td>0.4092</td>
<td>0.4006</td>
<td>0.3251</td>
<td>0.4131</td>
<td>0.4466</td>
<td>0.2654</td>
<td>0.4736</td>
<td>0.3285</td>
<td>0.1966</td>
<td>0.4315</td>
<td>0.4426</td>
<td>0.4951</td>
<td>0.3212</td>
<td>0.3321</td>
<td>0.2835</td>
<td>0.4145</td>
<td>0.2408</td>
<td>0.4493</td>
<td>0.3538</td>
<td>0.4528</td>
<td>0.4865</td>
<td>0.4305</td>
<td>0.2833</td>
<td>0.4032</td>
<td>0.3058</td>
<td>0.3931</td>
<td>0.4101</td>
<td>0.3594</td>
<td>0.4195</td>
<td>0.3746</td>
<td>0.2839</td>
<td>0.3682</td>
<td>0.4237</td>
<td>0.3598</td>
<td>0.4645</td>
<td>0.3018</td>
<td>0.3602</td>
<td>0.3782</td>
<td>0.2253</td>
<td>0.3274</td>
<td>0.3475</td>
<td>0.4265</td>
<td>0.3162</td>
<td>0.3365</td>
<td>0.3433</td>
<td>0.2577</td>
<td>0.3831</td>
<td>0.3977</td>
<td>0.4108</td>
<td>0.2873</td>
<td>0.3153</td>
<td>0.4120</td>
<td>0.3498</td>
<td>0.3359</td>
<td>0.2841</td>
<td>0.3405</td>
<td>0.3247</td>
<td>0.3672</td>
<td>0.2736</td>
<td>0.3118</td>
<td>0.1389</td>
<td>0.2862</td>
<td>0.3378</td>
<td>0.0954</td>
<td>0.1935</td>
<td>0.2901</td>
<td>0.3575</td>
<td>0.2500</td>
<td>0.3003</td>
<td>0.3100</td>
<td>0.3676</td>
<td>0.2489</td>
<td>0.2636</td>
<td>0.3191</td>
<td>0.3735</td>
<td>0.4077</td>
<td>0.3418</td>
<td>0.2582</td>
</tr>
</tbody>
</table>

<p>674 rows Ã— 115 columns</p>
</div>
</div>
</div>
<p>Now we perform train test split on the X and Y variables.</p>
<div id="cell-46" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform train-test split</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>X_train, X_test, Y_train, Y_test <span class="op">=</span> train_test_split(X, Y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As we donâ€™t want to transform all the X columns (because some of them are discrete numerical data and some of them are one-hot encoded categorical variables), we need to specify the columns to transform.</p>
</section>
<section id="create-a-data-transformation-pipeline-from-feature_engine-package" class="level4">
<h4 class="anchored" data-anchor-id="create-a-data-transformation-pipeline-from-feature_engine-package"><strong>Create a Data Transformation Pipeline from <code>feature_engine</code> Package</strong></h4>
<p>First, the pipeline will apply the Yeo-Johnson transformation on the split datasets on select X features and all Y labels, and scale them using <code>StandardScaler</code> (but wrapped within <code>feature_engine</code>â€™s wrapper) on select X features and all Y labels.</p>
<p>This pipeline would enable easy inverse transform steps for both X and Y datasets later.</p>
<div id="cell-54" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>X_vars_to_transform <span class="op">=</span> [<span class="st">'TumourSize'</span>, <span class="st">'FusionNeo_Count'</span>, <span class="st">'FusionNeo_bestIC50'</span>, <span class="st">'FN/FT_Ratio'</span>, <span class="st">'SNVindelNeo_Count'</span>, <span class="st">'SNVindelNeo_IC50'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Do for X datasets.</p>
<div id="cell-56" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> feature_engine.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> feature_engine.transformation <span class="im">import</span> YeoJohnsonTransformer</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> feature_engine.wrappers <span class="im">import</span> SklearnTransformerWrapper</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co"># select variables to scale</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>scale_cols_X <span class="op">=</span> X_train.columns.tolist()</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>scale_cols_X <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> scale_cols_X <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> [<span class="st">'Age'</span>, <span class="st">'TumorGrade'</span>, <span class="st">'Subtype_HR+/HER2-'</span>, <span class="st">'Subtype_HR+/HER2+'</span>, <span class="st">'Subtype_TNBC'</span>, <span class="st">'Subtype_HR-/HER2+'</span>]]</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the pipeline</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>preprocess_pipeline_X <span class="op">=</span> Pipeline([</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'yeo_johnson'</span>, YeoJohnsonTransformer(variables<span class="op">=</span>X_vars_to_transform)),</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'scaler'</span>, SklearnTransformerWrapper(transformer <span class="op">=</span> StandardScaler(), variables <span class="op">=</span> scale_cols_X))</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the pipeline to the training data</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>preprocess_pipeline_X.fit(X_train)</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform the training data</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>X_train_yjs <span class="op">=</span> preprocess_pipeline_X.transform(X_train)</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform the test data</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>X_test_yjs <span class="op">=</span> preprocess_pipeline_X.transform(X_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-57" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>X_train</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Subtype_HR+/HER2-</th>
<th data-quarto-table-cell-role="th">Subtype_HR+/HER2+</th>
<th data-quarto-table-cell-role="th">Subtype_TNBC</th>
<th data-quarto-table-cell-role="th">Subtype_HR-/HER2+</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionNeo_bestIC50</th>
<th data-quarto-table-cell-role="th">FN/FT_Ratio</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0907</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>64</td>
<td>2</td>
<td>2.5</td>
<td>47</td>
<td>4.86</td>
<td>0.580247</td>
<td>177</td>
<td>3.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0850</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>50</td>
<td>3</td>
<td>2.0</td>
<td>20</td>
<td>9.90</td>
<td>0.392157</td>
<td>362</td>
<td>1.7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0050</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>45</td>
<td>3</td>
<td>4.0</td>
<td>37</td>
<td>6.92</td>
<td>0.536232</td>
<td>317</td>
<td>1.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD1753</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>73</td>
<td>2</td>
<td>3.0</td>
<td>1</td>
<td>454.07</td>
<td>0.166667</td>
<td>63</td>
<td>2.7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0339</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>66</td>
<td>3</td>
<td>3.5</td>
<td>117</td>
<td>5.52</td>
<td>0.587940</td>
<td>284</td>
<td>1.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0994</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>64</td>
<td>3</td>
<td>3.5</td>
<td>6</td>
<td>9.41</td>
<td>0.171429</td>
<td>138</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD1532</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>67</td>
<td>2</td>
<td>2.5</td>
<td>55</td>
<td>2.43</td>
<td>0.591398</td>
<td>543</td>
<td>2.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0326</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>43</td>
<td>2</td>
<td>5.0</td>
<td>74</td>
<td>5.20</td>
<td>0.755102</td>
<td>196</td>
<td>2.8</td>
</tr>
</tbody>
</table>

<p>539 rows Ã— 12 columns</p>
</div>
</div>
</div>
<div id="cell-58" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>X_train_yjs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Subtype_HR+/HER2-</th>
<th data-quarto-table-cell-role="th">Subtype_HR+/HER2+</th>
<th data-quarto-table-cell-role="th">Subtype_TNBC</th>
<th data-quarto-table-cell-role="th">Subtype_HR-/HER2+</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">TumorGrade</th>
<th data-quarto-table-cell-role="th">TumourSize</th>
<th data-quarto-table-cell-role="th">FusionNeo_Count</th>
<th data-quarto-table-cell-role="th">FusionNeo_bestIC50</th>
<th data-quarto-table-cell-role="th">FN/FT_Ratio</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_Count</th>
<th data-quarto-table-cell-role="th">SNVindelNeo_IC50</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0907</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>64</td>
<td>2</td>
<td>-0.198167</td>
<td>1.084700</td>
<td>-0.561304</td>
<td>0.536308</td>
<td>-0.569045</td>
<td>1.016003</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0850</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>50</td>
<td>3</td>
<td>-0.674861</td>
<td>0.115984</td>
<td>0.408689</td>
<td>-0.373761</td>
<td>0.088991</td>
<td>-0.672361</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0050</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>45</td>
<td>3</td>
<td>0.755274</td>
<td>0.801083</td>
<td>-0.045619</td>
<td>0.339224</td>
<td>-0.030124</td>
<td>-0.887022</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD1753</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>73</td>
<td>2</td>
<td>0.181899</td>
<td>-2.165375</td>
<td>2.337760</td>
<td>-1.760274</td>
<td>-1.588698</td>
<td>0.657471</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0339</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>66</td>
<td>3</td>
<td>0.493716</td>
<td>2.254499</td>
<td>-0.367907</td>
<td>0.569864</td>
<td>-0.129784</td>
<td>-1.691642</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0994</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>64</td>
<td>3</td>
<td>0.493716</td>
<td>-1.030586</td>
<td>0.348478</td>
<td>-1.726679</td>
<td>-0.807226</td>
<td>-0.143442</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD1532</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>67</td>
<td>2</td>
<td>-0.198167</td>
<td>1.276271</td>
<td>-1.741884</td>
<td>0.584865</td>
<td>0.444600</td>
<td>0.135236</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0326</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>43</td>
<td>2</td>
<td>1.172027</td>
<td>1.649245</td>
<td>-0.457567</td>
<td>1.240736</td>
<td>-0.472856</td>
<td>0.739698</td>
</tr>
</tbody>
</table>

<p>539 rows Ã— 12 columns</p>
</div>
</div>
</div>
<div id="cell-59" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select variables to scale</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>scale_cols_Y <span class="op">=</span> Y_train.columns.tolist()</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the pipeline</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>preprocess_pipeline_Y <span class="op">=</span> Pipeline([</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'yeo_johnson'</span>, YeoJohnsonTransformer()),</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'scaler'</span>, SklearnTransformerWrapper(transformer <span class="op">=</span> StandardScaler(), variables <span class="op">=</span> scale_cols_Y))</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the pipeline to the training data</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>preprocess_pipeline_Y.fit(Y_train)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform the training data</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>Y_train_yjs <span class="op">=</span> preprocess_pipeline_Y.transform(Y_train)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform the test data</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>Y_test_yjs <span class="op">=</span> preprocess_pipeline_Y.transform(Y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-60" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>Y_train</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ESTIMATE</th>
<th data-quarto-table-cell-role="th">IMPRES</th>
<th data-quarto-table-cell-role="th">C_Bcellsnaive</th>
<th data-quarto-table-cell-role="th">C_TcellsCD4memoryresting</th>
<th data-quarto-table-cell-role="th">C_MacrophagesM2</th>
<th data-quarto-table-cell-role="th">S_Attractors_LYM</th>
<th data-quarto-table-cell-role="th">S_Attractors_IFIT3</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_GIMAP4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_HLA.DPA1</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SLAMF6</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_LILRB4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SIGLEC9</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CYTH4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CD3E</th>
<th data-quarto-table-cell-role="th">S_Lymph_Vessels</th>
<th data-quarto-table-cell-role="th">S_ICR_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_INHIB_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_ACT_SCORE</th>
<th data-quarto-table-cell-role="th">S_Angiogenesis</th>
<th data-quarto-table-cell-role="th">S_APM1</th>
<th data-quarto-table-cell-role="th">S_APM2</th>
<th data-quarto-table-cell-role="th">S_ICS5_score</th>
<th data-quarto-table-cell-role="th">S_LIexpression_score</th>
<th data-quarto-table-cell-role="th">S_Chemokine12_score</th>
<th data-quarto-table-cell-role="th">S_NHI_5gene_score</th>
<th data-quarto-table-cell-role="th">S_CD68</th>
<th data-quarto-table-cell-role="th">S_CD8A</th>
<th data-quarto-table-cell-role="th">S_PD1_data</th>
<th data-quarto-table-cell-role="th">S_PDL1_data</th>
<th data-quarto-table-cell-role="th">S_PD1_PDL1_score</th>
<th data-quarto-table-cell-role="th">S_CTLA4_data</th>
<th data-quarto-table-cell-role="th">S_Bcell_mg_IGJ</th>
<th data-quarto-table-cell-role="th">S_Bcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_STAT1_score</th>
<th data-quarto-table-cell-role="th">S_CSF1_response</th>
<th data-quarto-table-cell-role="th">S_TcClassII_score</th>
<th data-quarto-table-cell-role="th">S_IL12_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL4_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL2_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL13_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IFNG_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TGFB_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TREM1_data</th>
<th data-quarto-table-cell-role="th">S_DAP12_data</th>
<th data-quarto-table-cell-role="th">S_Tcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_IL8_21978456</th>
<th data-quarto-table-cell-role="th">S_IFN_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC1_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC2_21978456</th>
<th data-quarto-table-cell-role="th">S_Bcell_21978456</th>
<th data-quarto-table-cell-role="th">S_Tcell_21978456</th>
<th data-quarto-table-cell-role="th">S_CD103pos_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_CD103neg_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_IgG_19272155</th>
<th data-quarto-table-cell-role="th">S_Interferon_19272155</th>
<th data-quarto-table-cell-role="th">S_LCK_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.I_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.II_19272155</th>
<th data-quarto-table-cell-role="th">S_STAT1_19272155</th>
<th data-quarto-table-cell-role="th">S_Troester_WoundSig_19887484</th>
<th data-quarto-table-cell-role="th">S_MDACC.FNA.1_20805453</th>
<th data-quarto-table-cell-role="th">S_IGG_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Minterferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Immune_cell_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_MCD3_CD8_21214954</th>
<th data-quarto-table-cell-role="th">S_Interferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_B_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_CD8_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_GRANS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_LYMPHS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_T_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_TGFB_PCA_17349583</th>
<th data-quarto-table-cell-role="th">S_Rotterdam_ERneg_PCA_15721472</th>
<th data-quarto-table-cell-role="th">S_HER2_Immune_PCA_18006808</th>
<th data-quarto-table-cell-role="th">S_IR7_score</th>
<th data-quarto-table-cell-role="th">S_Buck14_score</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_score</th>
<th data-quarto-table-cell-role="th">S_Immune_NSCLC_score</th>
<th data-quarto-table-cell-role="th">S_Module3_IFN_score</th>
<th data-quarto-table-cell-role="th">S_Module4_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module5_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module11_Prolif_score</th>
<th data-quarto-table-cell-role="th">S_CD8_CD68_ratio</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_TcClassII_ratio</th>
<th data-quarto-table-cell-role="th">S_CHANG_CORE_SERUM_RESPONSE_UP</th>
<th data-quarto-table-cell-role="th">S_CSR_Activated_15701700</th>
<th data-quarto-table-cell-role="th">S_B_cells</th>
<th data-quarto-table-cell-role="th">S_T_cells</th>
<th data-quarto-table-cell-role="th">S_T_helper</th>
<th data-quarto-table-cell-role="th">S_Tcm</th>
<th data-quarto-table-cell-role="th">S_Tem</th>
<th data-quarto-table-cell-role="th">S_Th1</th>
<th data-quarto-table-cell-role="th">S_Th2</th>
<th data-quarto-table-cell-role="th">S_TFH</th>
<th data-quarto-table-cell-role="th">S_CD8_Tcells</th>
<th data-quarto-table-cell-role="th">S_Th17</th>
<th data-quarto-table-cell-role="th">S_Treg</th>
<th data-quarto-table-cell-role="th">S_Tgd</th>
<th data-quarto-table-cell-role="th">S_Cytotoxic_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cd56dim</th>
<th data-quarto-table-cell-role="th">S_NK_cd56bright</th>
<th data-quarto-table-cell-role="th">S_DC</th>
<th data-quarto-table-cell-role="th">S_iDC</th>
<th data-quarto-table-cell-role="th">S_aDC</th>
<th data-quarto-table-cell-role="th">S_pDC</th>
<th data-quarto-table-cell-role="th">S_Eosinophils</th>
<th data-quarto-table-cell-role="th">S_Macrophages</th>
<th data-quarto-table-cell-role="th">S_Mast</th>
<th data-quarto-table-cell-role="th">S_Neutrophils</th>
<th data-quarto-table-cell-role="th">S_Bindea_full</th>
<th data-quarto-table-cell-role="th">S_Expanded_IFNg</th>
<th data-quarto-table-cell-role="th">S_KEGG_MMR</th>
<th data-quarto-table-cell-role="th">S_KEGG_TGF_Beta</th>
<th data-quarto-table-cell-role="th">S_KEGG_Cytosolic_DNA_Sensing</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0907</td>
<td>5087.085018</td>
<td>12</td>
<td>0.118125</td>
<td>0.256480</td>
<td>0.165096</td>
<td>0.4142</td>
<td>0.4760</td>
<td>0.3919</td>
<td>0.4921</td>
<td>0.3844</td>
<td>0.3343</td>
<td>0.3073</td>
<td>0.3640</td>
<td>0.3604</td>
<td>0.3475</td>
<td>0.3574</td>
<td>0.3291</td>
<td>0.3648</td>
<td>0.3590</td>
<td>0.4875</td>
<td>0.4452</td>
<td>0.3611</td>
<td>0.3395</td>
<td>0.4598</td>
<td>0.4458</td>
<td>0.1021</td>
<td>0.3835</td>
<td>0.2815</td>
<td>0.3298</td>
<td>0.3058</td>
<td>0.2838</td>
<td>0.3775</td>
<td>0.3519</td>
<td>0.3987</td>
<td>0.4151</td>
<td>0.4071</td>
<td>0.3404</td>
<td>0.3838</td>
<td>0.4119</td>
<td>0.3754</td>
<td>0.4066</td>
<td>0.4280</td>
<td>0.2817</td>
<td>0.4651</td>
<td>0.3490</td>
<td>0.2439</td>
<td>0.4762</td>
<td>0.4304</td>
<td>0.4948</td>
<td>0.3513</td>
<td>0.3549</td>
<td>0.2850</td>
<td>0.3981</td>
<td>0.2854</td>
<td>0.4880</td>
<td>0.3775</td>
<td>0.4485</td>
<td>0.4918</td>
<td>0.4791</td>
<td>0.2630</td>
<td>0.4153</td>
<td>0.3499</td>
<td>0.4350</td>
<td>0.4301</td>
<td>0.2917</td>
<td>0.4557</td>
<td>0.3866</td>
<td>0.2994</td>
<td>0.3660</td>
<td>0.4321</td>
<td>0.3605</td>
<td>0.4424</td>
<td>0.2864</td>
<td>0.3656</td>
<td>0.3989</td>
<td>0.2009</td>
<td>0.4268</td>
<td>0.3502</td>
<td>0.4724</td>
<td>0.3500</td>
<td>0.3830</td>
<td>0.3950</td>
<td>0.2495</td>
<td>0.4101</td>
<td>0.4071</td>
<td>0.4079</td>
<td>0.3258</td>
<td>0.3354</td>
<td>0.4259</td>
<td>0.3548</td>
<td>0.3213</td>
<td>0.2933</td>
<td>0.3484</td>
<td>0.3260</td>
<td>0.3699</td>
<td>0.2996</td>
<td>0.2953</td>
<td>0.2180</td>
<td>0.3140</td>
<td>0.3230</td>
<td>0.2266</td>
<td>0.2121</td>
<td>0.3060</td>
<td>0.3194</td>
<td>0.2668</td>
<td>0.3132</td>
<td>0.2935</td>
<td>0.3684</td>
<td>0.2259</td>
<td>0.2696</td>
<td>0.3235</td>
<td>0.4169</td>
<td>0.4112</td>
<td>0.3337</td>
<td>0.2683</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0850</td>
<td>3163.224848</td>
<td>8</td>
<td>0.103919</td>
<td>0.070753</td>
<td>0.272750</td>
<td>0.3671</td>
<td>0.4333</td>
<td>0.3166</td>
<td>0.4604</td>
<td>0.2911</td>
<td>0.3122</td>
<td>0.2923</td>
<td>0.3237</td>
<td>0.2783</td>
<td>0.3638</td>
<td>0.2715</td>
<td>0.2473</td>
<td>0.2778</td>
<td>0.3736</td>
<td>0.4796</td>
<td>0.4076</td>
<td>0.2594</td>
<td>0.2585</td>
<td>0.3186</td>
<td>0.3881</td>
<td>0.1263</td>
<td>0.2680</td>
<td>0.2008</td>
<td>0.2537</td>
<td>0.2275</td>
<td>0.2207</td>
<td>0.2605</td>
<td>0.2971</td>
<td>0.3442</td>
<td>0.3749</td>
<td>0.3534</td>
<td>0.2832</td>
<td>0.3780</td>
<td>0.3914</td>
<td>0.3175</td>
<td>0.4106</td>
<td>0.4416</td>
<td>0.2741</td>
<td>0.4535</td>
<td>0.2492</td>
<td>0.2219</td>
<td>0.4382</td>
<td>0.4149</td>
<td>0.4703</td>
<td>0.2862</td>
<td>0.2611</td>
<td>0.2523</td>
<td>0.3920</td>
<td>0.2026</td>
<td>0.4519</td>
<td>0.2968</td>
<td>0.4346</td>
<td>0.4557</td>
<td>0.3906</td>
<td>0.2755</td>
<td>0.3700</td>
<td>0.2613</td>
<td>0.3745</td>
<td>0.3611</td>
<td>0.3533</td>
<td>0.4229</td>
<td>0.3573</td>
<td>0.2310</td>
<td>0.3660</td>
<td>0.4276</td>
<td>0.3390</td>
<td>0.4695</td>
<td>0.3083</td>
<td>0.3412</td>
<td>0.3574</td>
<td>0.2084</td>
<td>0.2990</td>
<td>0.3441</td>
<td>0.4180</td>
<td>0.2639</td>
<td>0.2924</td>
<td>0.3733</td>
<td>0.1990</td>
<td>0.3454</td>
<td>0.4057</td>
<td>0.4087</td>
<td>0.2290</td>
<td>0.2362</td>
<td>0.3941</td>
<td>0.3289</td>
<td>0.3481</td>
<td>0.2934</td>
<td>0.3342</td>
<td>0.3221</td>
<td>0.3567</td>
<td>0.2165</td>
<td>0.2536</td>
<td>0.2100</td>
<td>0.2410</td>
<td>0.3423</td>
<td>0.0885</td>
<td>0.2069</td>
<td>0.2714</td>
<td>0.3312</td>
<td>0.2219</td>
<td>0.3227</td>
<td>0.3014</td>
<td>0.3508</td>
<td>0.2695</td>
<td>0.2609</td>
<td>0.3048</td>
<td>0.3224</td>
<td>0.4007</td>
<td>0.3404</td>
<td>0.2573</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0050</td>
<td>4215.075265</td>
<td>9</td>
<td>0.124727</td>
<td>0.201551</td>
<td>0.296744</td>
<td>0.3905</td>
<td>0.4879</td>
<td>0.3591</td>
<td>0.4701</td>
<td>0.3449</td>
<td>0.3283</td>
<td>0.2246</td>
<td>0.3498</td>
<td>0.3356</td>
<td>0.3269</td>
<td>0.3364</td>
<td>0.3310</td>
<td>0.3378</td>
<td>0.3513</td>
<td>0.4981</td>
<td>0.4267</td>
<td>0.3270</td>
<td>0.2981</td>
<td>0.4290</td>
<td>0.4172</td>
<td>-0.1712</td>
<td>0.3271</td>
<td>0.2721</td>
<td>0.3271</td>
<td>0.2999</td>
<td>0.2867</td>
<td>0.3088</td>
<td>0.3227</td>
<td>0.3884</td>
<td>0.4028</td>
<td>0.3846</td>
<td>0.3260</td>
<td>0.3925</td>
<td>0.4006</td>
<td>0.3335</td>
<td>0.4168</td>
<td>0.4337</td>
<td>0.3052</td>
<td>0.4617</td>
<td>0.3203</td>
<td>0.2089</td>
<td>0.4941</td>
<td>0.4479</td>
<td>0.4777</td>
<td>0.2674</td>
<td>0.3050</td>
<td>0.2727</td>
<td>0.3997</td>
<td>0.1861</td>
<td>0.4985</td>
<td>0.3413</td>
<td>0.4610</td>
<td>0.4785</td>
<td>0.4794</td>
<td>0.2856</td>
<td>0.3782</td>
<td>0.2497</td>
<td>0.4370</td>
<td>0.4109</td>
<td>0.3223</td>
<td>0.4682</td>
<td>0.3692</td>
<td>0.2568</td>
<td>0.3648</td>
<td>0.4227</td>
<td>0.3468</td>
<td>0.4497</td>
<td>0.2927</td>
<td>0.3565</td>
<td>0.3932</td>
<td>0.2280</td>
<td>0.4155</td>
<td>0.3415</td>
<td>0.4863</td>
<td>0.3128</td>
<td>0.3548</td>
<td>0.4031</td>
<td>0.1102</td>
<td>0.3893</td>
<td>0.4148</td>
<td>0.4132</td>
<td>0.2842</td>
<td>0.2749</td>
<td>0.4193</td>
<td>0.3463</td>
<td>0.3110</td>
<td>0.2986</td>
<td>0.3478</td>
<td>0.3255</td>
<td>0.3629</td>
<td>0.2038</td>
<td>0.3165</td>
<td>0.1426</td>
<td>0.2898</td>
<td>0.3142</td>
<td>0.1299</td>
<td>0.2367</td>
<td>0.3064</td>
<td>0.3396</td>
<td>0.2617</td>
<td>0.2911</td>
<td>0.3182</td>
<td>0.3526</td>
<td>0.2542</td>
<td>0.2410</td>
<td>0.3146</td>
<td>0.3852</td>
<td>0.4243</td>
<td>0.3416</td>
<td>0.2702</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD1753</td>
<td>4645.649655</td>
<td>10</td>
<td>0.123528</td>
<td>0.112046</td>
<td>0.272824</td>
<td>0.4174</td>
<td>0.4454</td>
<td>0.3754</td>
<td>0.4963</td>
<td>0.3702</td>
<td>0.3120</td>
<td>0.2184</td>
<td>0.3490</td>
<td>0.3659</td>
<td>0.3927</td>
<td>0.3366</td>
<td>0.2887</td>
<td>0.3491</td>
<td>0.3748</td>
<td>0.4899</td>
<td>0.4309</td>
<td>0.3297</td>
<td>0.3365</td>
<td>0.3980</td>
<td>0.4228</td>
<td>0.1469</td>
<td>0.4043</td>
<td>0.2438</td>
<td>0.2735</td>
<td>0.2587</td>
<td>0.2668</td>
<td>0.3973</td>
<td>0.3455</td>
<td>0.3809</td>
<td>0.4060</td>
<td>0.3987</td>
<td>0.3184</td>
<td>0.4083</td>
<td>0.4057</td>
<td>0.3328</td>
<td>0.4175</td>
<td>0.4294</td>
<td>0.2308</td>
<td>0.4787</td>
<td>0.3455</td>
<td>0.1707</td>
<td>0.4448</td>
<td>0.4515</td>
<td>0.4815</td>
<td>0.3527</td>
<td>0.3357</td>
<td>0.2884</td>
<td>0.3895</td>
<td>0.2902</td>
<td>0.4652</td>
<td>0.3632</td>
<td>0.4632</td>
<td>0.4834</td>
<td>0.4412</td>
<td>0.2474</td>
<td>0.4086</td>
<td>0.3571</td>
<td>0.3993</td>
<td>0.4142</td>
<td>0.3348</td>
<td>0.4330</td>
<td>0.3729</td>
<td>0.2966</td>
<td>0.3622</td>
<td>0.4357</td>
<td>0.3506</td>
<td>0.4700</td>
<td>0.2512</td>
<td>0.3594</td>
<td>0.4072</td>
<td>0.2535</td>
<td>0.3456</td>
<td>0.3402</td>
<td>0.4374</td>
<td>0.3270</td>
<td>0.3524</td>
<td>0.3313</td>
<td>0.2809</td>
<td>0.3909</td>
<td>0.4078</td>
<td>0.4102</td>
<td>0.2960</td>
<td>0.3250</td>
<td>0.4096</td>
<td>0.3440</td>
<td>0.3631</td>
<td>0.2961</td>
<td>0.3360</td>
<td>0.3353</td>
<td>0.3780</td>
<td>0.2891</td>
<td>0.2834</td>
<td>0.1902</td>
<td>0.3156</td>
<td>0.3422</td>
<td>0.1230</td>
<td>0.3050</td>
<td>0.2807</td>
<td>0.3395</td>
<td>0.2918</td>
<td>0.3611</td>
<td>0.3389</td>
<td>0.3681</td>
<td>0.2093</td>
<td>0.2677</td>
<td>0.3252</td>
<td>0.3924</td>
<td>0.4058</td>
<td>0.3196</td>
<td>0.2845</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0339</td>
<td>3824.371566</td>
<td>9</td>
<td>0.190386</td>
<td>0.215981</td>
<td>0.236491</td>
<td>0.3952</td>
<td>0.4374</td>
<td>0.3314</td>
<td>0.4801</td>
<td>0.3356</td>
<td>0.3242</td>
<td>0.3001</td>
<td>0.3494</td>
<td>0.3100</td>
<td>0.3335</td>
<td>0.2860</td>
<td>0.2751</td>
<td>0.2888</td>
<td>0.3667</td>
<td>0.4757</td>
<td>0.4245</td>
<td>0.2495</td>
<td>0.3041</td>
<td>0.3617</td>
<td>0.4303</td>
<td>0.1886</td>
<td>0.2919</td>
<td>0.2509</td>
<td>0.2625</td>
<td>0.2567</td>
<td>0.2511</td>
<td>0.3410</td>
<td>0.3256</td>
<td>0.3509</td>
<td>0.3907</td>
<td>0.3739</td>
<td>0.3131</td>
<td>0.4049</td>
<td>0.3978</td>
<td>0.3614</td>
<td>0.4081</td>
<td>0.4485</td>
<td>0.3125</td>
<td>0.4306</td>
<td>0.2832</td>
<td>0.2291</td>
<td>0.4344</td>
<td>0.4187</td>
<td>0.4830</td>
<td>0.3511</td>
<td>0.2994</td>
<td>0.2643</td>
<td>0.4018</td>
<td>0.2689</td>
<td>0.4500</td>
<td>0.3345</td>
<td>0.4385</td>
<td>0.4705</td>
<td>0.4028</td>
<td>0.2860</td>
<td>0.3915</td>
<td>0.3063</td>
<td>0.3880</td>
<td>0.3810</td>
<td>0.3392</td>
<td>0.4108</td>
<td>0.3766</td>
<td>0.2518</td>
<td>0.3661</td>
<td>0.4216</td>
<td>0.3501</td>
<td>0.4543</td>
<td>0.2984</td>
<td>0.3506</td>
<td>0.3525</td>
<td>0.2217</td>
<td>0.3289</td>
<td>0.3288</td>
<td>0.4223</td>
<td>0.3023</td>
<td>0.3173</td>
<td>0.3729</td>
<td>0.2411</td>
<td>0.3673</td>
<td>0.3995</td>
<td>0.4088</td>
<td>0.3036</td>
<td>0.2848</td>
<td>0.4062</td>
<td>0.3439</td>
<td>0.3157</td>
<td>0.2858</td>
<td>0.3285</td>
<td>0.3337</td>
<td>0.3641</td>
<td>0.2376</td>
<td>0.3066</td>
<td>0.2080</td>
<td>0.2768</td>
<td>0.3191</td>
<td>0.0836</td>
<td>0.2138</td>
<td>0.2837</td>
<td>0.3197</td>
<td>0.2475</td>
<td>0.2891</td>
<td>0.3139</td>
<td>0.3610</td>
<td>0.2470</td>
<td>0.2767</td>
<td>0.3142</td>
<td>0.3473</td>
<td>0.3956</td>
<td>0.3450</td>
<td>0.2618</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0994</td>
<td>3025.810269</td>
<td>10</td>
<td>0.221418</td>
<td>0.190491</td>
<td>0.133918</td>
<td>0.3594</td>
<td>0.4172</td>
<td>0.3695</td>
<td>0.4517</td>
<td>0.3016</td>
<td>0.2467</td>
<td>0.1818</td>
<td>0.3078</td>
<td>0.3052</td>
<td>0.3066</td>
<td>0.2606</td>
<td>0.2297</td>
<td>0.2688</td>
<td>0.3971</td>
<td>0.4742</td>
<td>0.4057</td>
<td>0.2776</td>
<td>0.2654</td>
<td>0.2972</td>
<td>0.3955</td>
<td>0.1140</td>
<td>0.3271</td>
<td>0.2050</td>
<td>0.2900</td>
<td>0.2481</td>
<td>0.1704</td>
<td>0.2785</td>
<td>0.2999</td>
<td>0.3353</td>
<td>0.3639</td>
<td>0.3548</td>
<td>0.3060</td>
<td>0.3893</td>
<td>0.3951</td>
<td>0.3555</td>
<td>0.4000</td>
<td>0.4328</td>
<td>0.1893</td>
<td>0.3587</td>
<td>0.2866</td>
<td>0.2438</td>
<td>0.4084</td>
<td>0.4135</td>
<td>0.4622</td>
<td>0.2757</td>
<td>0.2764</td>
<td>0.2881</td>
<td>0.3689</td>
<td>0.2173</td>
<td>0.4351</td>
<td>0.3179</td>
<td>0.4268</td>
<td>0.4562</td>
<td>0.3547</td>
<td>0.3003</td>
<td>0.3723</td>
<td>0.2680</td>
<td>0.3735</td>
<td>0.3580</td>
<td>0.3882</td>
<td>0.4106</td>
<td>0.3662</td>
<td>0.2680</td>
<td>0.3655</td>
<td>0.4286</td>
<td>0.3487</td>
<td>0.4308</td>
<td>0.3150</td>
<td>0.3403</td>
<td>0.3428</td>
<td>0.2465</td>
<td>0.2542</td>
<td>0.3260</td>
<td>0.4102</td>
<td>0.2871</td>
<td>0.2873</td>
<td>0.2872</td>
<td>0.2244</td>
<td>0.3402</td>
<td>0.3853</td>
<td>0.4041</td>
<td>0.2841</td>
<td>0.2795</td>
<td>0.4224</td>
<td>0.3604</td>
<td>0.3353</td>
<td>0.2750</td>
<td>0.2944</td>
<td>0.3342</td>
<td>0.3744</td>
<td>0.2342</td>
<td>0.2186</td>
<td>0.1878</td>
<td>0.2768</td>
<td>0.3357</td>
<td>0.0917</td>
<td>0.3059</td>
<td>0.2637</td>
<td>0.3344</td>
<td>0.2479</td>
<td>0.3287</td>
<td>0.3317</td>
<td>0.3533</td>
<td>0.2703</td>
<td>0.2543</td>
<td>0.3166</td>
<td>0.3296</td>
<td>0.3809</td>
<td>0.3532</td>
<td>0.2593</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD1532</td>
<td>3222.601924</td>
<td>9</td>
<td>0.117293</td>
<td>0.137847</td>
<td>0.372146</td>
<td>0.3728</td>
<td>0.4332</td>
<td>0.3212</td>
<td>0.4701</td>
<td>0.2874</td>
<td>0.3143</td>
<td>0.2936</td>
<td>0.3350</td>
<td>0.2820</td>
<td>0.3251</td>
<td>0.2526</td>
<td>0.2554</td>
<td>0.2518</td>
<td>0.3732</td>
<td>0.4732</td>
<td>0.4197</td>
<td>0.2162</td>
<td>0.2608</td>
<td>0.3098</td>
<td>0.3726</td>
<td>0.1205</td>
<td>0.2865</td>
<td>0.2141</td>
<td>0.2732</td>
<td>0.2439</td>
<td>0.2102</td>
<td>0.2133</td>
<td>0.2970</td>
<td>0.3421</td>
<td>0.3781</td>
<td>0.3518</td>
<td>0.2613</td>
<td>0.3763</td>
<td>0.3917</td>
<td>0.3250</td>
<td>0.4062</td>
<td>0.4402</td>
<td>0.3121</td>
<td>0.4315</td>
<td>0.2532</td>
<td>0.1893</td>
<td>0.4385</td>
<td>0.4089</td>
<td>0.4717</td>
<td>0.2487</td>
<td>0.2814</td>
<td>0.2500</td>
<td>0.4026</td>
<td>0.1560</td>
<td>0.4626</td>
<td>0.3121</td>
<td>0.4271</td>
<td>0.4607</td>
<td>0.3788</td>
<td>0.2778</td>
<td>0.3601</td>
<td>0.2371</td>
<td>0.3815</td>
<td>0.3613</td>
<td>0.3379</td>
<td>0.4245</td>
<td>0.3630</td>
<td>0.2053</td>
<td>0.3605</td>
<td>0.4228</td>
<td>0.3402</td>
<td>0.4572</td>
<td>0.3181</td>
<td>0.3388</td>
<td>0.3067</td>
<td>0.2083</td>
<td>0.2843</td>
<td>0.3251</td>
<td>0.4311</td>
<td>0.2714</td>
<td>0.2837</td>
<td>0.3859</td>
<td>0.2059</td>
<td>0.3419</td>
<td>0.4033</td>
<td>0.4085</td>
<td>0.2553</td>
<td>0.2623</td>
<td>0.4048</td>
<td>0.3581</td>
<td>0.3216</td>
<td>0.2628</td>
<td>0.3337</td>
<td>0.3030</td>
<td>0.3599</td>
<td>0.2001</td>
<td>0.2820</td>
<td>0.1818</td>
<td>0.2677</td>
<td>0.3296</td>
<td>0.0734</td>
<td>0.2862</td>
<td>0.2621</td>
<td>0.3272</td>
<td>0.2389</td>
<td>0.2852</td>
<td>0.3013</td>
<td>0.3397</td>
<td>0.2542</td>
<td>0.2261</td>
<td>0.3038</td>
<td>0.3255</td>
<td>0.4107</td>
<td>0.3401</td>
<td>0.2589</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0326</td>
<td>2667.878507</td>
<td>10</td>
<td>0.168493</td>
<td>0.120741</td>
<td>0.193144</td>
<td>0.3449</td>
<td>0.3354</td>
<td>0.3304</td>
<td>0.4458</td>
<td>0.2978</td>
<td>0.2734</td>
<td>0.2281</td>
<td>0.2982</td>
<td>0.2932</td>
<td>0.3320</td>
<td>0.2496</td>
<td>0.2249</td>
<td>0.2561</td>
<td>0.3712</td>
<td>0.4573</td>
<td>0.3885</td>
<td>0.2429</td>
<td>0.2968</td>
<td>0.2972</td>
<td>0.3369</td>
<td>0.1187</td>
<td>0.2827</td>
<td>0.2481</td>
<td>0.2054</td>
<td>0.2269</td>
<td>0.2223</td>
<td>0.3101</td>
<td>0.3066</td>
<td>0.3059</td>
<td>0.3417</td>
<td>0.3474</td>
<td>0.2785</td>
<td>0.3847</td>
<td>0.3800</td>
<td>0.3356</td>
<td>0.3858</td>
<td>0.4267</td>
<td>0.2303</td>
<td>0.4440</td>
<td>0.2777</td>
<td>0.2008</td>
<td>0.3503</td>
<td>0.3930</td>
<td>0.4557</td>
<td>0.3223</td>
<td>0.2376</td>
<td>0.2470</td>
<td>0.3669</td>
<td>0.2371</td>
<td>0.3689</td>
<td>0.2830</td>
<td>0.4107</td>
<td>0.4300</td>
<td>0.3101</td>
<td>0.2521</td>
<td>0.3751</td>
<td>0.2812</td>
<td>0.3351</td>
<td>0.3397</td>
<td>0.3573</td>
<td>0.3671</td>
<td>0.3490</td>
<td>0.2059</td>
<td>0.3500</td>
<td>0.4188</td>
<td>0.3382</td>
<td>0.4526</td>
<td>0.3231</td>
<td>0.3263</td>
<td>0.3589</td>
<td>0.1785</td>
<td>0.2284</td>
<td>0.3198</td>
<td>0.3378</td>
<td>0.2611</td>
<td>0.2733</td>
<td>0.3768</td>
<td>0.2031</td>
<td>0.3303</td>
<td>0.4043</td>
<td>0.4045</td>
<td>0.2746</td>
<td>0.2445</td>
<td>0.3875</td>
<td>0.3130</td>
<td>0.3030</td>
<td>0.2497</td>
<td>0.3106</td>
<td>0.3175</td>
<td>0.3574</td>
<td>0.1636</td>
<td>0.2803</td>
<td>0.2190</td>
<td>0.2326</td>
<td>0.3157</td>
<td>0.1429</td>
<td>0.2878</td>
<td>0.2636</td>
<td>0.3340</td>
<td>0.1949</td>
<td>0.3498</td>
<td>0.2939</td>
<td>0.3387</td>
<td>0.2436</td>
<td>0.2235</td>
<td>0.2962</td>
<td>0.3116</td>
<td>0.4101</td>
<td>0.3249</td>
<td>0.2502</td>
</tr>
</tbody>
</table>

<p>539 rows Ã— 115 columns</p>
</div>
</div>
</div>
<div id="cell-61" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>Y_train_yjs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ESTIMATE</th>
<th data-quarto-table-cell-role="th">IMPRES</th>
<th data-quarto-table-cell-role="th">C_Bcellsnaive</th>
<th data-quarto-table-cell-role="th">C_TcellsCD4memoryresting</th>
<th data-quarto-table-cell-role="th">C_MacrophagesM2</th>
<th data-quarto-table-cell-role="th">S_Attractors_LYM</th>
<th data-quarto-table-cell-role="th">S_Attractors_IFIT3</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_GIMAP4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_HLA.DPA1</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SLAMF6</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_LILRB4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_SIGLEC9</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CYTH4</th>
<th data-quarto-table-cell-role="th">S_Attractors_G_CD3E</th>
<th data-quarto-table-cell-role="th">S_Lymph_Vessels</th>
<th data-quarto-table-cell-role="th">S_ICR_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_INHIB_SCORE</th>
<th data-quarto-table-cell-role="th">S_ICR_ACT_SCORE</th>
<th data-quarto-table-cell-role="th">S_Angiogenesis</th>
<th data-quarto-table-cell-role="th">S_APM1</th>
<th data-quarto-table-cell-role="th">S_APM2</th>
<th data-quarto-table-cell-role="th">S_ICS5_score</th>
<th data-quarto-table-cell-role="th">S_LIexpression_score</th>
<th data-quarto-table-cell-role="th">S_Chemokine12_score</th>
<th data-quarto-table-cell-role="th">S_NHI_5gene_score</th>
<th data-quarto-table-cell-role="th">S_CD68</th>
<th data-quarto-table-cell-role="th">S_CD8A</th>
<th data-quarto-table-cell-role="th">S_PD1_data</th>
<th data-quarto-table-cell-role="th">S_PDL1_data</th>
<th data-quarto-table-cell-role="th">S_PD1_PDL1_score</th>
<th data-quarto-table-cell-role="th">S_CTLA4_data</th>
<th data-quarto-table-cell-role="th">S_Bcell_mg_IGJ</th>
<th data-quarto-table-cell-role="th">S_Bcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_STAT1_score</th>
<th data-quarto-table-cell-role="th">S_CSF1_response</th>
<th data-quarto-table-cell-role="th">S_TcClassII_score</th>
<th data-quarto-table-cell-role="th">S_IL12_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL4_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL2_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IL13_score_21050467</th>
<th data-quarto-table-cell-role="th">S_IFNG_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TGFB_score_21050467</th>
<th data-quarto-table-cell-role="th">S_TREM1_data</th>
<th data-quarto-table-cell-role="th">S_DAP12_data</th>
<th data-quarto-table-cell-role="th">S_Tcell_receptors_score</th>
<th data-quarto-table-cell-role="th">S_IL8_21978456</th>
<th data-quarto-table-cell-role="th">S_IFN_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC1_21978456</th>
<th data-quarto-table-cell-role="th">S_MHC2_21978456</th>
<th data-quarto-table-cell-role="th">S_Bcell_21978456</th>
<th data-quarto-table-cell-role="th">S_Tcell_21978456</th>
<th data-quarto-table-cell-role="th">S_CD103pos_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_CD103neg_mean_25446897</th>
<th data-quarto-table-cell-role="th">S_IgG_19272155</th>
<th data-quarto-table-cell-role="th">S_Interferon_19272155</th>
<th data-quarto-table-cell-role="th">S_LCK_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.I_19272155</th>
<th data-quarto-table-cell-role="th">S_MHC.II_19272155</th>
<th data-quarto-table-cell-role="th">S_STAT1_19272155</th>
<th data-quarto-table-cell-role="th">S_Troester_WoundSig_19887484</th>
<th data-quarto-table-cell-role="th">S_MDACC.FNA.1_20805453</th>
<th data-quarto-table-cell-role="th">S_IGG_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Minterferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_Immune_cell_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_MCD3_CD8_21214954</th>
<th data-quarto-table-cell-role="th">S_Interferon_Cluster_21214954</th>
<th data-quarto-table-cell-role="th">S_B_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_CD8_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_GRANS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_LYMPHS_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_T_cell_PCA_16704732</th>
<th data-quarto-table-cell-role="th">S_TGFB_PCA_17349583</th>
<th data-quarto-table-cell-role="th">S_Rotterdam_ERneg_PCA_15721472</th>
<th data-quarto-table-cell-role="th">S_HER2_Immune_PCA_18006808</th>
<th data-quarto-table-cell-role="th">S_IR7_score</th>
<th data-quarto-table-cell-role="th">S_Buck14_score</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_score</th>
<th data-quarto-table-cell-role="th">S_Immune_NSCLC_score</th>
<th data-quarto-table-cell-role="th">S_Module3_IFN_score</th>
<th data-quarto-table-cell-role="th">S_Module4_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module5_TcellBcell_score</th>
<th data-quarto-table-cell-role="th">S_Module11_Prolif_score</th>
<th data-quarto-table-cell-role="th">S_CD8_CD68_ratio</th>
<th data-quarto-table-cell-role="th">S_TAMsurr_TcClassII_ratio</th>
<th data-quarto-table-cell-role="th">S_CHANG_CORE_SERUM_RESPONSE_UP</th>
<th data-quarto-table-cell-role="th">S_CSR_Activated_15701700</th>
<th data-quarto-table-cell-role="th">S_B_cells</th>
<th data-quarto-table-cell-role="th">S_T_cells</th>
<th data-quarto-table-cell-role="th">S_T_helper</th>
<th data-quarto-table-cell-role="th">S_Tcm</th>
<th data-quarto-table-cell-role="th">S_Tem</th>
<th data-quarto-table-cell-role="th">S_Th1</th>
<th data-quarto-table-cell-role="th">S_Th2</th>
<th data-quarto-table-cell-role="th">S_TFH</th>
<th data-quarto-table-cell-role="th">S_CD8_Tcells</th>
<th data-quarto-table-cell-role="th">S_Th17</th>
<th data-quarto-table-cell-role="th">S_Treg</th>
<th data-quarto-table-cell-role="th">S_Tgd</th>
<th data-quarto-table-cell-role="th">S_Cytotoxic_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cells</th>
<th data-quarto-table-cell-role="th">S_NK_cd56dim</th>
<th data-quarto-table-cell-role="th">S_NK_cd56bright</th>
<th data-quarto-table-cell-role="th">S_DC</th>
<th data-quarto-table-cell-role="th">S_iDC</th>
<th data-quarto-table-cell-role="th">S_aDC</th>
<th data-quarto-table-cell-role="th">S_pDC</th>
<th data-quarto-table-cell-role="th">S_Eosinophils</th>
<th data-quarto-table-cell-role="th">S_Macrophages</th>
<th data-quarto-table-cell-role="th">S_Mast</th>
<th data-quarto-table-cell-role="th">S_Neutrophils</th>
<th data-quarto-table-cell-role="th">S_Bindea_full</th>
<th data-quarto-table-cell-role="th">S_Expanded_IFNg</th>
<th data-quarto-table-cell-role="th">S_KEGG_MMR</th>
<th data-quarto-table-cell-role="th">S_KEGG_TGF_Beta</th>
<th data-quarto-table-cell-role="th">S_KEGG_Cytosolic_DNA_Sensing</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0907</td>
<td>0.753066</td>
<td>1.514484</td>
<td>-0.045258</td>
<td>0.959818</td>
<td>-0.713344</td>
<td>0.459337</td>
<td>1.038872</td>
<td>0.842711</td>
<td>0.825167</td>
<td>0.999946</td>
<td>0.724495</td>
<td>1.050226</td>
<td>0.477299</td>
<td>0.602946</td>
<td>0.325040</td>
<td>1.065981</td>
<td>0.949352</td>
<td>1.083313</td>
<td>-0.332047</td>
<td>0.351981</td>
<td>0.897073</td>
<td>1.466805</td>
<td>0.773623</td>
<td>1.803650</td>
<td>1.549387</td>
<td>-0.097266</td>
<td>0.808090</td>
<td>0.710334</td>
<td>1.129332</td>
<td>0.928866</td>
<td>0.546182</td>
<td>1.450494</td>
<td>0.850099</td>
<td>1.174804</td>
<td>0.662127</td>
<td>0.883736</td>
<td>0.984890</td>
<td>-0.746990</td>
<td>0.683374</td>
<td>1.536088</td>
<td>-0.211533</td>
<td>-0.893670</td>
<td>0.373311</td>
<td>0.339693</td>
<td>0.752130</td>
<td>0.229598</td>
<td>1.006135</td>
<td>0.301938</td>
<td>1.063589</td>
<td>1.114826</td>
<td>0.924152</td>
<td>0.239968</td>
<td>0.045753</td>
<td>0.964303</td>
<td>1.084179</td>
<td>0.827576</td>
<td>0.352970</td>
<td>1.032982</td>
<td>1.368719</td>
<td>-1.070372</td>
<td>1.276313</td>
<td>1.256404</td>
<td>1.361660</td>
<td>0.981635</td>
<td>-1.371372</td>
<td>0.982702</td>
<td>1.139751</td>
<td>0.896875</td>
<td>0.011102</td>
<td>1.024029</td>
<td>0.655166</td>
<td>-0.904604</td>
<td>-1.270687</td>
<td>0.745460</td>
<td>0.846367</td>
<td>-0.947415</td>
<td>1.440494</td>
<td>1.381826</td>
<td>1.143537</td>
<td>0.976229</td>
<td>1.239406</td>
<td>1.081167</td>
<td>0.453270</td>
<td>1.075105</td>
<td>0.628504</td>
<td>-0.397480</td>
<td>1.290332</td>
<td>0.915388</td>
<td>1.295808</td>
<td>0.899454</td>
<td>-0.440373</td>
<td>0.559149</td>
<td>1.198547</td>
<td>0.081255</td>
<td>0.464821</td>
<td>1.984671</td>
<td>0.373423</td>
<td>0.792385</td>
<td>0.786709</td>
<td>-0.703001</td>
<td>1.427062</td>
<td>-1.283891</td>
<td>0.717029</td>
<td>-0.666544</td>
<td>0.355999</td>
<td>0.097946</td>
<td>-0.935651</td>
<td>0.434291</td>
<td>-0.603836</td>
<td>0.211490</td>
<td>0.609168</td>
<td>1.132090</td>
<td>0.890796</td>
<td>-0.931970</td>
<td>0.724425</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0850</td>
<td>-0.660339</td>
<td>-1.470436</td>
<td>-0.333979</td>
<td>-1.501553</td>
<td>0.544263</td>
<td>-0.650621</td>
<td>0.010017</td>
<td>-1.043829</td>
<td>-0.792892</td>
<td>-0.838946</td>
<td>0.112225</td>
<td>0.653619</td>
<td>-0.513889</td>
<td>-0.899392</td>
<td>0.858210</td>
<td>-0.571976</td>
<td>-0.706443</td>
<td>-0.539488</td>
<td>0.230797</td>
<td>-0.310009</td>
<td>-0.458893</td>
<td>-0.609364</td>
<td>-0.711718</td>
<td>-0.678009</td>
<td>-0.543871</td>
<td>0.258481</td>
<td>-1.276340</td>
<td>-0.667932</td>
<td>-0.781583</td>
<td>-0.714944</td>
<td>-0.595754</td>
<td>-0.556532</td>
<td>-0.623915</td>
<td>-0.467324</td>
<td>-0.671557</td>
<td>-0.653666</td>
<td>-0.786271</td>
<td>-1.082307</td>
<td>-0.510541</td>
<td>-0.868167</td>
<td>0.122176</td>
<td>0.308264</td>
<td>0.241104</td>
<td>-0.010374</td>
<td>-0.946679</td>
<td>-0.126521</td>
<td>0.053515</td>
<td>-0.671062</td>
<td>-0.371548</td>
<td>-0.255033</td>
<td>-0.869727</td>
<td>-0.645202</td>
<td>-0.217989</td>
<td>-0.476013</td>
<td>0.026336</td>
<td>-0.846743</td>
<td>-0.499823</td>
<td>-0.840844</td>
<td>-0.570060</td>
<td>-0.382352</td>
<td>-0.505000</td>
<td>-0.320540</td>
<td>-0.616260</td>
<td>-0.796834</td>
<td>0.159822</td>
<td>-0.043327</td>
<td>-0.896988</td>
<td>-0.814646</td>
<td>0.011102</td>
<td>0.044669</td>
<td>-0.850828</td>
<td>1.060004</td>
<td>-0.273452</td>
<td>-0.512182</td>
<td>-0.311896</td>
<td>-0.658827</td>
<td>-0.558924</td>
<td>0.840364</td>
<td>-0.272669</td>
<td>-0.813033</td>
<td>-0.684463</td>
<td>0.342481</td>
<td>-0.420741</td>
<td>-0.663808</td>
<td>0.478659</td>
<td>-0.249667</td>
<td>-1.079150</td>
<td>-1.061881</td>
<td>-1.621686</td>
<td>-0.968690</td>
<td>0.968315</td>
<td>0.564161</td>
<td>0.123726</td>
<td>-0.177499</td>
<td>-0.870525</td>
<td>0.035828</td>
<td>-0.744533</td>
<td>0.536959</td>
<td>-1.224039</td>
<td>0.992509</td>
<td>-0.934640</td>
<td>-1.398401</td>
<td>-0.285707</td>
<td>-0.057849</td>
<td>-0.794684</td>
<td>0.417581</td>
<td>-0.485233</td>
<td>-0.352286</td>
<td>0.837084</td>
<td>-0.103910</td>
<td>-0.600742</td>
<td>-0.848515</td>
<td>0.012444</td>
<td>-0.422912</td>
<td>-0.208649</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0050</td>
<td>0.128267</td>
<td>-0.806877</td>
<td>0.085367</td>
<td>0.254630</td>
<td>0.772145</td>
<td>-0.097496</td>
<td>1.356389</td>
<td>0.084011</td>
<td>-0.404252</td>
<td>0.245544</td>
<td>0.558999</td>
<td>-0.939302</td>
<td>0.151016</td>
<td>0.146118</td>
<td>-0.298805</td>
<td>0.657347</td>
<td>0.985770</td>
<td>0.562002</td>
<td>-0.630028</td>
<td>1.307626</td>
<td>0.187148</td>
<td>0.663766</td>
<td>0.022853</td>
<td>1.215292</td>
<td>0.416798</td>
<td>-1.870590</td>
<td>-0.091806</td>
<td>0.526217</td>
<td>1.074250</td>
<td>0.793028</td>
<td>0.605899</td>
<td>0.178423</td>
<td>0.092957</td>
<td>0.871654</td>
<td>0.248413</td>
<td>0.226704</td>
<td>0.528084</td>
<td>-0.242313</td>
<td>0.038515</td>
<td>-0.222434</td>
<td>0.647953</td>
<td>-0.437878</td>
<td>0.775137</td>
<td>0.233356</td>
<td>0.253178</td>
<td>-0.335278</td>
<td>1.505594</td>
<td>1.519372</td>
<td>-0.002807</td>
<td>-0.568142</td>
<td>-0.015785</td>
<td>-0.106907</td>
<td>0.116341</td>
<td>-0.716043</td>
<td>1.439222</td>
<td>0.103563</td>
<td>1.230007</td>
<td>0.208438</td>
<td>1.375773</td>
<td>0.221876</td>
<td>-0.220021</td>
<td>-0.528818</td>
<td>1.428990</td>
<td>0.502710</td>
<td>-0.589364</td>
<td>1.390041</td>
<td>-0.068198</td>
<td>-0.154015</td>
<td>-0.142338</td>
<td>-0.960371</td>
<td>-0.291116</td>
<td>-0.457783</td>
<td>-1.004006</td>
<td>0.284266</td>
<td>0.664754</td>
<td>0.172181</td>
<td>1.274063</td>
<td>0.618862</td>
<td>1.538734</td>
<td>0.222935</td>
<td>0.657946</td>
<td>1.369219</td>
<td>-1.686828</td>
<td>0.510507</td>
<td>1.436264</td>
<td>0.638265</td>
<td>0.150251</td>
<td>-0.275325</td>
<td>0.631393</td>
<td>0.178159</td>
<td>-0.991546</td>
<td>0.829305</td>
<td>1.149543</td>
<td>0.047590</td>
<td>-0.236382</td>
<td>-0.384711</td>
<td>0.910267</td>
<td>-0.961700</td>
<td>0.128431</td>
<td>-1.265512</td>
<td>-0.097238</td>
<td>-0.717152</td>
<td>0.729117</td>
<td>0.404458</td>
<td>0.236186</td>
<td>-0.781450</td>
<td>0.530650</td>
<td>-0.275460</td>
<td>0.295799</td>
<td>-0.813583</td>
<td>0.017291</td>
<td>0.509344</td>
<td>1.942205</td>
<td>-0.326288</td>
<td>0.870767</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD1753</td>
<td>0.439617</td>
<td>-0.087541</td>
<td>0.061809</td>
<td>-0.934635</td>
<td>0.544991</td>
<td>0.534264</td>
<td>0.284781</td>
<td>0.472198</td>
<td>1.129295</td>
<td>0.732621</td>
<td>0.106650</td>
<td>-1.070026</td>
<td>0.131927</td>
<td>0.704607</td>
<td>1.896092</td>
<td>0.661213</td>
<td>0.153679</td>
<td>0.778225</td>
<td>0.276933</td>
<td>0.561421</td>
<td>0.340711</td>
<td>0.723075</td>
<td>0.719790</td>
<td>0.650195</td>
<td>0.622897</td>
<td>0.604352</td>
<td>1.094074</td>
<td>0.011128</td>
<td>-0.204486</td>
<td>-0.100113</td>
<td>0.209535</td>
<td>1.872560</td>
<td>0.689360</td>
<td>0.648849</td>
<td>0.355565</td>
<td>0.636255</td>
<td>0.289967</td>
<td>0.679432</td>
<td>0.333490</td>
<td>-0.250981</td>
<td>0.707972</td>
<td>-0.787533</td>
<td>-0.534166</td>
<td>0.798174</td>
<td>0.690834</td>
<td>-0.941429</td>
<td>0.209004</td>
<td>1.786533</td>
<td>0.206639</td>
<td>1.149836</td>
<td>0.566223</td>
<td>0.338932</td>
<td>-0.323658</td>
<td>1.061029</td>
<td>0.388494</td>
<td>0.546558</td>
<td>1.396169</td>
<td>0.491226</td>
<td>0.504212</td>
<td>-1.843744</td>
<td>0.979097</td>
<td>1.383511</td>
<td>0.180799</td>
<td>0.585869</td>
<td>-0.282251</td>
<td>0.266093</td>
<td>0.189050</td>
<td>0.829267</td>
<td>-0.462839</td>
<td>1.848424</td>
<td>-0.024021</td>
<td>1.105001</td>
<td>-2.504635</td>
<td>0.432235</td>
<td>1.125173</td>
<td>1.439084</td>
<td>0.201135</td>
<td>0.510133</td>
<td>0.209274</td>
<td>0.513898</td>
<td>0.607760</td>
<td>-0.957778</td>
<td>1.059471</td>
<td>0.553752</td>
<td>0.703079</td>
<td>0.035457</td>
<td>0.453505</td>
<td>0.713942</td>
<td>-0.287138</td>
<td>0.002902</td>
<td>1.741192</td>
<td>0.700718</td>
<td>0.250555</td>
<td>0.734719</td>
<td>1.257201</td>
<td>1.799032</td>
<td>0.063012</td>
<td>-0.014108</td>
<td>0.829951</td>
<td>0.981735</td>
<td>-0.227864</td>
<td>1.088890</td>
<td>-0.024413</td>
<td>0.398807</td>
<td>0.907459</td>
<td>1.432816</td>
<td>1.897647</td>
<td>0.420205</td>
<td>-1.075103</td>
<td>0.142341</td>
<td>0.725648</td>
<td>0.654246</td>
<td>0.443134</td>
<td>-1.851005</td>
<td>1.850392</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD0339</td>
<td>-0.159626</td>
<td>-0.806877</td>
<td>1.273682</td>
<td>0.441613</td>
<td>0.167007</td>
<td>0.013199</td>
<td>0.101691</td>
<td>-0.630842</td>
<td>0.086686</td>
<td>0.062920</td>
<td>0.445598</td>
<td>0.857774</td>
<td>0.141481</td>
<td>-0.322724</td>
<td>-0.104798</td>
<td>-0.301732</td>
<td>-0.123688</td>
<td>-0.343370</td>
<td>-0.034855</td>
<td>-0.621832</td>
<td>0.108422</td>
<td>-0.764882</td>
<td>0.132727</td>
<td>0.022100</td>
<td>0.910530</td>
<td>1.444531</td>
<td>-0.763075</td>
<td>0.134996</td>
<td>-0.517134</td>
<td>-0.141074</td>
<td>-0.081757</td>
<td>0.739184</td>
<td>0.170941</td>
<td>-0.260271</td>
<td>-0.153709</td>
<td>-0.079214</td>
<td>0.125125</td>
<td>0.480516</td>
<td>-0.126250</td>
<td>0.937550</td>
<td>-0.086894</td>
<td>1.087817</td>
<td>0.897866</td>
<td>-0.604148</td>
<td>-0.379371</td>
<td>-0.010365</td>
<td>-0.034193</td>
<td>-0.441188</td>
<td>0.293353</td>
<td>1.109846</td>
<td>-0.123271</td>
<td>-0.334024</td>
<td>0.209890</td>
<td>0.643510</td>
<td>-0.022956</td>
<td>-0.037202</td>
<td>-0.272660</td>
<td>-0.206279</td>
<td>-0.319210</td>
<td>0.246740</td>
<td>0.275804</td>
<td>0.483403</td>
<td>-0.184733</td>
<td>-0.267279</td>
<td>-0.175781</td>
<td>-0.406506</td>
<td>0.446089</td>
<td>-0.280577</td>
<td>0.024050</td>
<td>-1.177559</td>
<td>-0.058960</td>
<td>-0.147494</td>
<td>-0.749059</td>
<td>-0.019690</td>
<td>-0.425797</td>
<td>-0.107584</td>
<td>-0.066914</td>
<td>-0.388101</td>
<td>-0.167985</td>
<td>0.004996</td>
<td>-0.139234</td>
<td>0.329306</td>
<td>0.299475</td>
<td>-0.080935</td>
<td>-0.196253</td>
<td>-0.230985</td>
<td>0.657047</td>
<td>-0.077308</td>
<td>-0.593488</td>
<td>-0.004538</td>
<td>-0.739354</td>
<td>0.192383</td>
<td>-0.261106</td>
<td>0.618525</td>
<td>-0.115074</td>
<td>0.650205</td>
<td>0.662096</td>
<td>0.476210</td>
<td>-0.228535</td>
<td>-0.965978</td>
<td>-1.042820</td>
<td>-1.246061</td>
<td>0.061150</td>
<td>-0.651636</td>
<td>-0.111470</td>
<td>-0.871664</td>
<td>0.262910</td>
<td>0.093830</td>
<td>0.054798</td>
<td>0.471212</td>
<td>-0.008616</td>
<td>-0.289097</td>
<td>-0.426090</td>
<td>-0.043044</td>
<td>0.191538</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0994</td>
<td>-0.766849</td>
<td>-0.087541</td>
<td>1.772691</td>
<td>0.110449</td>
<td>-1.166711</td>
<td>-0.833371</td>
<td>-0.336227</td>
<td>0.334315</td>
<td>-1.080786</td>
<td>-0.621851</td>
<td>-1.747424</td>
<td>-1.793863</td>
<td>-0.965158</td>
<td>-0.410320</td>
<td>-0.862466</td>
<td>-0.773449</td>
<td>-1.086811</td>
<td>-0.698022</td>
<td>1.130904</td>
<td>-0.739210</td>
<td>-0.518702</td>
<td>-0.304132</td>
<td>-0.582529</td>
<td>-1.007745</td>
<td>-0.316236</td>
<td>0.071215</td>
<td>-0.091806</td>
<td>-0.606726</td>
<td>0.229930</td>
<td>-0.314758</td>
<td>-1.315730</td>
<td>-0.296733</td>
<td>-0.542939</td>
<td>-0.744697</td>
<td>-1.027261</td>
<td>-0.614919</td>
<td>-0.094144</td>
<td>-0.428178</td>
<td>-0.287057</td>
<td>0.688619</td>
<td>-0.752853</td>
<td>-0.514130</td>
<td>-1.314592</td>
<td>-1.835585</td>
<td>-0.321988</td>
<td>0.227971</td>
<td>-0.600061</td>
<td>-0.754377</td>
<td>-0.722162</td>
<td>-0.433941</td>
<td>-0.569129</td>
<td>0.330145</td>
<td>-1.143072</td>
<td>-0.249821</td>
<td>-0.389497</td>
<td>-0.387463</td>
<td>-0.927710</td>
<td>-0.821896</td>
<td>-1.278939</td>
<td>1.185022</td>
<td>-0.426603</td>
<td>-0.200437</td>
<td>-0.648002</td>
<td>-0.880601</td>
<td>0.955484</td>
<td>-0.412441</td>
<td>-0.276931</td>
<td>0.126981</td>
<td>-0.053263</td>
<td>0.257531</td>
<td>-0.157118</td>
<td>-1.512796</td>
<td>0.073560</td>
<td>-0.559874</td>
<td>-0.638818</td>
<td>1.068710</td>
<td>-1.326849</td>
<td>-0.594219</td>
<td>-0.459509</td>
<td>-0.314802</td>
<td>-0.797763</td>
<td>-2.153815</td>
<td>0.003850</td>
<td>-0.801341</td>
<td>-1.814248</td>
<td>-1.061096</td>
<td>0.147746</td>
<td>-0.183159</td>
<td>0.939373</td>
<td>1.444917</td>
<td>0.300029</td>
<td>-0.305196</td>
<td>-2.102077</td>
<td>0.654664</td>
<td>0.907514</td>
<td>0.557731</td>
<td>-1.752000</td>
<td>-0.073748</td>
<td>-0.228535</td>
<td>0.329845</td>
<td>-0.865091</td>
<td>1.115126</td>
<td>-0.497576</td>
<td>0.115343</td>
<td>-0.101385</td>
<td>0.603775</td>
<td>1.407155</td>
<td>-0.245366</td>
<td>0.866513</td>
<td>-0.341089</td>
<td>0.147710</td>
<td>-0.683765</td>
<td>-1.735581</td>
<td>0.701282</td>
<td>-0.027480</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SD1532</td>
<td>-0.614595</td>
<td>-0.806877</td>
<td>-0.061883</td>
<td>-0.586434</td>
<td>1.392824</td>
<td>-0.515576</td>
<td>0.007800</td>
<td>-0.913020</td>
<td>-0.404252</td>
<td>-0.916099</td>
<td>0.170724</td>
<td>0.687335</td>
<td>-0.215058</td>
<td>-0.832308</td>
<td>-0.350781</td>
<td>-0.920401</td>
<td>-0.534407</td>
<td>-0.992772</td>
<td>0.215414</td>
<td>-0.816687</td>
<td>-0.059352</td>
<td>-1.237752</td>
<td>-0.668598</td>
<td>-0.815016</td>
<td>-0.986851</td>
<td>0.168462</td>
<td>-0.874709</td>
<td>-0.470431</td>
<td>-0.212760</td>
<td>-0.398149</td>
<td>-0.758872</td>
<td>-1.164718</td>
<td>-0.626819</td>
<td>-0.532531</td>
<td>-0.567337</td>
<td>-0.697861</td>
<td>-1.433952</td>
<td>-1.180417</td>
<td>-0.492285</td>
<td>-0.567236</td>
<td>-0.244669</td>
<td>0.165380</td>
<td>0.891166</td>
<td>-0.583035</td>
<td>-0.880554</td>
<td>-0.647649</td>
<td>0.060496</td>
<td>-1.023007</td>
<td>-0.305530</td>
<td>-0.848493</td>
<td>-0.471595</td>
<td>-0.703106</td>
<td>0.245799</td>
<td>-1.118249</td>
<td>0.315285</td>
<td>-0.512113</td>
<td>-0.911881</td>
<td>-0.643939</td>
<td>-0.807846</td>
<td>-0.248677</td>
<td>-0.829247</td>
<td>-0.755546</td>
<td>-0.393207</td>
<td>-0.791441</td>
<td>-0.207151</td>
<td>0.005308</td>
<td>-0.499732</td>
<td>-1.491962</td>
<td>-0.663850</td>
<td>-0.940476</td>
<td>-0.763700</td>
<td>0.060450</td>
<td>0.241367</td>
<td>-0.639572</td>
<td>-1.302380</td>
<td>-0.662778</td>
<td>-0.806723</td>
<td>-0.659310</td>
<td>0.050033</td>
<td>-0.650604</td>
<td>-0.878080</td>
<td>0.765617</td>
<td>-0.308322</td>
<td>-0.756415</td>
<td>0.219607</td>
<td>-0.286894</td>
<td>-0.530433</td>
<td>-0.529206</td>
<td>-0.717354</td>
<td>1.213622</td>
<td>-0.424402</td>
<td>-0.826348</td>
<td>0.088955</td>
<td>-1.324966</td>
<td>-0.541671</td>
<td>-0.515199</td>
<td>0.026052</td>
<td>-0.216651</td>
<td>-0.479831</td>
<td>-0.202527</td>
<td>-1.274737</td>
<td>0.555840</td>
<td>-0.541098</td>
<td>-0.269394</td>
<td>-0.332569</td>
<td>-1.053215</td>
<td>-0.491042</td>
<td>-0.808688</td>
<td>0.295799</td>
<td>-1.334289</td>
<td>-0.661884</td>
<td>-0.777277</td>
<td>0.849702</td>
<td>-0.446802</td>
<td>-0.063284</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SD0326</td>
<td>-1.048839</td>
<td>-0.087541</td>
<td>0.898629</td>
<td>-0.816795</td>
<td>-0.343374</td>
<td>-1.178520</td>
<td>-1.791409</td>
<td>-0.658036</td>
<td>-1.248311</td>
<td>-0.700105</td>
<td>-0.981021</td>
<td>-0.864434</td>
<td>-1.256373</td>
<td>-0.628880</td>
<td>-0.149368</td>
<td>-0.975308</td>
<td>-1.192141</td>
<td>-0.918797</td>
<td>0.138467</td>
<td>-1.968794</td>
<td>-1.026183</td>
<td>-0.864626</td>
<td>-0.001002</td>
<td>-1.007745</td>
<td>-1.851323</td>
<td>0.141152</td>
<td>-0.954747</td>
<td>0.085729</td>
<td>-2.496774</td>
<td>-0.726271</td>
<td>-0.570268</td>
<td>0.199918</td>
<td>-0.351784</td>
<td>-1.680402</td>
<td>-1.733135</td>
<td>-0.818921</td>
<td>-0.926680</td>
<td>-0.694876</td>
<td>-1.222491</td>
<td>-0.136632</td>
<td>-1.879047</td>
<td>-0.989020</td>
<td>-0.543344</td>
<td>-0.271486</td>
<td>-0.471947</td>
<td>-0.464717</td>
<td>-1.668348</td>
<td>-1.893482</td>
<td>-0.968295</td>
<td>0.445057</td>
<td>-1.337856</td>
<td>-0.777807</td>
<td>-1.217938</td>
<td>0.074112</td>
<td>-1.650138</td>
<td>-1.156006</td>
<td>-1.708852</td>
<td>-1.626050</td>
<td>-2.100546</td>
<td>-1.620196</td>
<td>-0.329557</td>
<td>0.035765</td>
<td>-1.843656</td>
<td>-1.382305</td>
<td>0.253508</td>
<td>-1.651661</td>
<td>-1.476348</td>
<td>-1.475923</td>
<td>-1.768617</td>
<td>-1.716929</td>
<td>-0.909122</td>
<td>-0.264894</td>
<td>0.522087</td>
<td>-1.314161</td>
<td>-0.276151</td>
<td>-1.722043</td>
<td>-1.786909</td>
<td>-1.031457</td>
<td>-2.016148</td>
<td>-0.874013</td>
<td>-1.111702</td>
<td>0.458435</td>
<td>-0.354201</td>
<td>-1.062260</td>
<td>0.327881</td>
<td>-0.994138</td>
<td>-0.085385</td>
<td>-0.891480</td>
<td>-2.143713</td>
<td>-1.719134</td>
<td>-1.423484</td>
<td>-1.340872</td>
<td>-1.317857</td>
<td>-0.471626</td>
<td>-0.798303</td>
<td>-2.027405</td>
<td>-0.018956</td>
<td>0.825759</td>
<td>-1.460339</td>
<td>-1.177280</td>
<td>0.139945</td>
<td>0.600105</td>
<td>-0.500301</td>
<td>0.093499</td>
<td>-1.603613</td>
<td>1.174238</td>
<td>-0.913251</td>
<td>-0.848372</td>
<td>-0.056063</td>
<td>-1.424219</td>
<td>-1.115278</td>
<td>-1.100356</td>
<td>0.800294</td>
<td>-1.528037</td>
<td>-0.897235</td>
</tr>
</tbody>
</table>

<p>539 rows Ã— 115 columns</p>
</div>
</div>
</div>
</section>
<section id="xgboost-learning" class="level4">
<h4 class="anchored" data-anchor-id="xgboost-learning"><strong>XGBoost Learning</strong></h4>
<p>Time to test XGBoost. Select <code>S_Buck14_score</code> column as the first target/label (<code>y</code>) variable first.</p>
<div id="cell-63" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> xgboost <span class="im">import</span> XGBRegressor</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> xgboost <span class="im">import</span> plot_importance</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>y_target <span class="op">=</span> <span class="st">'S_Buck14_score'</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>y_train_tg <span class="op">=</span> Y_train_yjs[y_target]</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>y_test_tg <span class="op">=</span> Y_test_yjs[y_target]</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>model_xgb <span class="op">=</span> XGBRegressor(n_estimators<span class="op">=</span><span class="dv">150</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co"># fit</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>model_xgb.fit(X_train_yjs, y_train_tg)</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co"># predict</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>y_train_transformed_pred <span class="op">=</span> model_xgb.predict(X_train_yjs)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>y_test_transformed_pred <span class="op">=</span> model_xgb.predict(X_test_yjs)</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame with the same columns as the original y used in fit</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>y_train_dummy_df <span class="op">=</span> pd.DataFrame(<span class="dv">0</span>, index<span class="op">=</span>X_train_yjs.index, columns<span class="op">=</span>Y_train_yjs.columns)</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>y_train_dummy_df[y_target] <span class="op">=</span> y_train_transformed_pred</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>y_test_dummy_df <span class="op">=</span> pd.DataFrame(<span class="dv">0</span>, index<span class="op">=</span>X_test_yjs.index, columns<span class="op">=</span>Y_test_yjs.columns)</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>y_test_dummy_df[y_target] <span class="op">=</span> y_test_transformed_pred</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="co"># apply inverse transform</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>y_train_dummy_df_inv <span class="op">=</span> preprocess_pipeline_Y.inverse_transform(y_train_dummy_df)</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>y_test_dummy_df_inv <span class="op">=</span> preprocess_pipeline_Y.inverse_transform(y_test_dummy_df)</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the relevant target column</span></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>y_train_pred <span class="op">=</span> y_train_dummy_df_inv[y_target].to_numpy()</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>y_test_pred <span class="op">=</span> y_test_dummy_df_inv[y_target].to_numpy()</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, mean_absolute_error, r2_score</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate metrics</span></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>train_r2 <span class="op">=</span> r2_score(Y_train[y_target], y_train_pred)</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>test_r2 <span class="op">=</span> r2_score(Y_test[y_target], y_test_pred)</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>train_rmse <span class="op">=</span> np.sqrt(mean_squared_error(Y_train[y_target], y_train_pred))</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>test_rmse <span class="op">=</span> np.sqrt(mean_squared_error(Y_test[y_target], y_test_pred))</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>train_mae <span class="op">=</span> mean_absolute_error(Y_train[y_target], y_train_pred)</span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>test_mae <span class="op">=</span> mean_absolute_error(Y_test[y_target], y_test_pred)</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Model Performance:"</span>)</span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'Metric'</span><span class="sc">:&lt;10}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Train'</span><span class="sc">:&lt;10}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Test'</span><span class="sc">:&lt;10}</span><span class="ss">"</span>)</span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">30</span>)</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'R2'</span><span class="sc">:&lt;10}</span><span class="ss"> </span><span class="sc">{</span>train_r2<span class="sc">:&lt;10.4f}</span><span class="ss"> </span><span class="sc">{</span>test_r2<span class="sc">:&lt;10.4f}</span><span class="ss">"</span>)</span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'RMSE'</span><span class="sc">:&lt;10}</span><span class="ss"> </span><span class="sc">{</span>train_rmse<span class="sc">:&lt;10.4f}</span><span class="ss"> </span><span class="sc">{</span>test_rmse<span class="sc">:&lt;10.4f}</span><span class="ss">"</span>)</span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'MAE'</span><span class="sc">:&lt;10}</span><span class="ss"> </span><span class="sc">{</span>train_mae<span class="sc">:&lt;10.4f}</span><span class="ss"> </span><span class="sc">{</span>test_mae<span class="sc">:&lt;10.4f}</span><span class="ss">"</span>)</span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot actual vs predicted</span></span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>))</span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a>ax1.scatter(Y_train[y_target], y_train_pred, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a>ax1.plot([Y_train[y_target].<span class="bu">min</span>(), Y_train[y_target].<span class="bu">max</span>()], [Y_train[y_target].<span class="bu">min</span>(), Y_train[y_target].<span class="bu">max</span>()], <span class="st">'r--'</span>, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Actual'</span>)</span>
<span id="cb45-60"><a href="#cb45-60" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Predicted'</span>)</span>
<span id="cb45-61"><a href="#cb45-61" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Train Set'</span>)</span>
<span id="cb45-62"><a href="#cb45-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-63"><a href="#cb45-63" aria-hidden="true" tabindex="-1"></a>ax2.scatter(Y_test[y_target], y_test_pred, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb45-64"><a href="#cb45-64" aria-hidden="true" tabindex="-1"></a>ax2.plot([Y_test[y_target].<span class="bu">min</span>(), Y_test[y_target].<span class="bu">max</span>()], [Y_test[y_target].<span class="bu">min</span>(), Y_test[y_target].<span class="bu">max</span>()], <span class="st">'r--'</span>, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb45-65"><a href="#cb45-65" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Actual'</span>)</span>
<span id="cb45-66"><a href="#cb45-66" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Predicted'</span>)</span>
<span id="cb45-67"><a href="#cb45-67" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Test Set'</span>)</span>
<span id="cb45-68"><a href="#cb45-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-69"><a href="#cb45-69" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb45-70"><a href="#cb45-70" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb45-71"><a href="#cb45-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-72"><a href="#cb45-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature importance</span></span>
<span id="cb45-73"><a href="#cb45-73" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">16</span>), dpi<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb45-74"><a href="#cb45-74" aria-hidden="true" tabindex="-1"></a>plot_importance(model_xgb, ax<span class="op">=</span>ax)</span>
<span id="cb45-75"><a href="#cb45-75" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb45-76"><a href="#cb45-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-77"><a href="#cb45-77" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shap</span>
<span id="cb45-78"><a href="#cb45-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the SHAP explainer</span></span>
<span id="cb45-79"><a href="#cb45-79" aria-hidden="true" tabindex="-1"></a>explainer <span class="op">=</span> shap.TreeExplainer(model_xgb)</span>
<span id="cb45-80"><a href="#cb45-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-81"><a href="#cb45-81" aria-hidden="true" tabindex="-1"></a><span class="co"># run explanation object on X_test dataset because we don't want to learn what the model learned from the X_train data, but to see features that would influence predictions on new data</span></span>
<span id="cb45-82"><a href="#cb45-82" aria-hidden="true" tabindex="-1"></a>shap_values <span class="op">=</span> explainer(X_test_yjs)</span>
<span id="cb45-83"><a href="#cb45-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-84"><a href="#cb45-84" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">16</span>)) </span>
<span id="cb45-85"><a href="#cb45-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary plot</span></span>
<span id="cb45-86"><a href="#cb45-86" aria-hidden="true" tabindex="-1"></a>shap.summary_plot(shap_values, show<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb45-87"><a href="#cb45-87" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb45-88"><a href="#cb45-88" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb45-89"><a href="#cb45-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-90"><a href="#cb45-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform clustering</span></span>
<span id="cb45-91"><a href="#cb45-91" aria-hidden="true" tabindex="-1"></a>clust <span class="op">=</span> shap.utils.hclust(X_test_yjs, y_test_tg)</span>
<span id="cb45-92"><a href="#cb45-92" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the bar plot with clustering</span></span>
<span id="cb45-93"><a href="#cb45-93" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">16</span>)) </span>
<span id="cb45-94"><a href="#cb45-94" aria-hidden="true" tabindex="-1"></a>shap.plots.bar(shap_values, clustering<span class="op">=</span>clust, clustering_cutoff<span class="op">=</span><span class="dv">1</span>, show<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb45-95"><a href="#cb45-95" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb45-96"><a href="#cb45-96" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model Performance:
Metric     Train      Test      
------------------------------
R2         1.0000     -0.2018   
RMSE       0.0001     0.0270    
MAE        0.0001     0.0211    </code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="xgboost_tuned_files/figure-html/cell-41-output-2.png" width="1189" height="491" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="xgboost_tuned_files/figure-html/cell-41-output-3.png" width="4781" height="3945" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="xgboost_tuned_files/figure-html/cell-41-output-4.png" width="772" height="618" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="xgboost_tuned_files/figure-html/cell-41-output-5.png" width="757" height="639" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="iterative-learning-over-all-y-labels" class="level4">
<h4 class="anchored" data-anchor-id="iterative-learning-over-all-y-labels"><strong>Iterative Learning over all Y labels</strong></h4>
<p>The learning using XGBoost above was done on just one Y label, which is the <code>ESTIMATE</code> column. Letâ€™s put these into a set of functions so we can run this process iteratively on all Y columns we have set up.</p>
<div id="cell-65" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># copy the steps above as a function</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shap</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> xgboost <span class="im">import</span> XGBRegressor</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> learning_curve</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_absolute_error, mean_squared_error, r2_score</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> YTargetMetrics:</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, target_name, train_r2, test_r2, train_rmse, test_rmse, train_mae, test_mae):</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.target_name <span class="op">=</span> target_name</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.train_r2 <span class="op">=</span> train_r2</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.test_r2 <span class="op">=</span> test_r2</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.train_rmse <span class="op">=</span> train_rmse</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.test_rmse <span class="op">=</span> test_rmse</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.train_mae <span class="op">=</span> train_mae</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.test_mae <span class="op">=</span> test_mae</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__str__</span>(<span class="va">self</span>):</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f"""Model Performance for </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>target_name<span class="sc">}</span><span class="ss">:</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span><span class="st">'Metric'</span><span class="sc">:&lt;10}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Train'</span><span class="sc">:&lt;10}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Test'</span><span class="sc">:&lt;10}</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span><span class="st">'-'</span> <span class="op">*</span> <span class="dv">30</span><span class="sc">}</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span><span class="st">'R2'</span><span class="sc">:&lt;10}</span><span class="ss"> </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>train_r2<span class="sc">:&lt;10.4f}</span><span class="ss"> </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>test_r2<span class="sc">:&lt;10.4f}</span></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span><span class="st">'RMSE'</span><span class="sc">:&lt;10}</span><span class="ss"> </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>train_rmse<span class="sc">:&lt;10.4f}</span><span class="ss"> </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>test_rmse<span class="sc">:&lt;10.4f}</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span><span class="st">'MAE'</span><span class="sc">:&lt;10}</span><span class="ss"> </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>train_mae<span class="sc">:&lt;10.4f}</span><span class="ss"> </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>test_mae<span class="sc">:&lt;10.4f}</span><span class="ss">"""</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> to_dict(<span class="va">self</span>):</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">'target_name'</span>: <span class="va">self</span>.target_name,</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">'train_r2'</span>: <span class="va">self</span>.train_r2,</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">'test_r2'</span>: <span class="va">self</span>.test_r2,</span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">'train_rmse'</span>: <span class="va">self</span>.train_rmse,</span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">'test_rmse'</span>: <span class="va">self</span>.test_rmse,</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">'train_mae'</span>: <span class="va">self</span>.train_mae,</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">'test_mae'</span>: <span class="va">self</span>.test_mae</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_learning_curves(estimator, X, y, target, cv<span class="op">=</span><span class="dv">5</span>, train_sizes<span class="op">=</span>np.linspace(<span class="fl">.1</span>, <span class="fl">1.0</span>, <span class="dv">5</span>)):</span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>    train_sizes, train_scores, test_scores <span class="op">=</span> learning_curve(</span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>        estimator, X, y, cv<span class="op">=</span>cv, n_jobs<span class="op">=-</span><span class="dv">1</span>, train_sizes<span class="op">=</span>train_sizes,</span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>        scoring<span class="op">=</span><span class="st">'neg_mean_squared_error'</span>)</span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a>    train_scores_mean <span class="op">=</span> <span class="op">-</span>train_scores.mean(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a>    train_scores_std <span class="op">=</span> train_scores.std(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a>    test_scores_mean <span class="op">=</span> <span class="op">-</span>test_scores.mean(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>    test_scores_std <span class="op">=</span> test_scores.std(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">"Learning Curves"</span>)</span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">"Training examples"</span>)</span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">"Mean Squared Error"</span>)</span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a>    plt.fill_between(train_sizes, train_scores_mean <span class="op">-</span> train_scores_std,</span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a>                     train_scores_mean <span class="op">+</span> train_scores_std, alpha<span class="op">=</span><span class="fl">0.1</span>, color<span class="op">=</span><span class="st">"r"</span>)</span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a>    plt.fill_between(train_sizes, test_scores_mean <span class="op">-</span> test_scores_std,</span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a>                     test_scores_mean <span class="op">+</span> test_scores_std, alpha<span class="op">=</span><span class="fl">0.1</span>, color<span class="op">=</span><span class="st">"g"</span>)</span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a>    plt.plot(train_sizes, train_scores_mean, <span class="st">'o-'</span>, color<span class="op">=</span><span class="st">"r"</span>, label<span class="op">=</span><span class="st">"Training score"</span>)</span>
<span id="cb47-56"><a href="#cb47-56" aria-hidden="true" tabindex="-1"></a>    plt.plot(train_sizes, test_scores_mean, <span class="st">'o-'</span>, color<span class="op">=</span><span class="st">"g"</span>, label<span class="op">=</span><span class="st">"Cross-validation score"</span>)</span>
<span id="cb47-57"><a href="#cb47-57" aria-hidden="true" tabindex="-1"></a>    plt.legend(loc<span class="op">=</span><span class="st">"best"</span>)</span>
<span id="cb47-58"><a href="#cb47-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-59"><a href="#cb47-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create 'plots' directory if it doesn't exist</span></span>
<span id="cb47-60"><a href="#cb47-60" aria-hidden="true" tabindex="-1"></a>    os.makedirs(<span class="ss">f'plots/</span><span class="sc">{</span>target<span class="sc">}</span><span class="ss">'</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb47-61"><a href="#cb47-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-62"><a href="#cb47-62" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Save the plot</span></span>
<span id="cb47-63"><a href="#cb47-63" aria-hidden="true" tabindex="-1"></a>    plt.savefig(<span class="ss">f'plots/</span><span class="sc">{</span>target<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>target<span class="sc">}</span><span class="ss">-xgb-def-model-learning-curve.png'</span>)</span>
<span id="cb47-64"><a href="#cb47-64" aria-hidden="true" tabindex="-1"></a>    plt.close()</span>
<span id="cb47-65"><a href="#cb47-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-66"><a href="#cb47-66" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_xgboost_model(y_target, Y_train, Y_test, X_train_transformed, X_test_transformed, Y_train_transformed, Y_test_transformed, preprocess_pipeline_Y):</span>
<span id="cb47-67"><a href="#cb47-67" aria-hidden="true" tabindex="-1"></a>    <span class="co"># assign untransformed, raw target data</span></span>
<span id="cb47-68"><a href="#cb47-68" aria-hidden="true" tabindex="-1"></a>    raw_y_train <span class="op">=</span> Y_train[y_target]</span>
<span id="cb47-69"><a href="#cb47-69" aria-hidden="true" tabindex="-1"></a>    raw_y_test <span class="op">=</span> Y_test[y_target]</span>
<span id="cb47-70"><a href="#cb47-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-71"><a href="#cb47-71" aria-hidden="true" tabindex="-1"></a>    model_instance <span class="op">=</span> XGBRegressor(n_estimators<span class="op">=</span><span class="dv">150</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb47-72"><a href="#cb47-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-73"><a href="#cb47-73" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fit</span></span>
<span id="cb47-74"><a href="#cb47-74" aria-hidden="true" tabindex="-1"></a>    model_instance.fit(X_train_transformed, Y_train_transformed[y_target])</span>
<span id="cb47-75"><a href="#cb47-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-76"><a href="#cb47-76" aria-hidden="true" tabindex="-1"></a>    <span class="co"># predict</span></span>
<span id="cb47-77"><a href="#cb47-77" aria-hidden="true" tabindex="-1"></a>    y_train_pred_transformed <span class="op">=</span> model_instance.predict(X_train_transformed)</span>
<span id="cb47-78"><a href="#cb47-78" aria-hidden="true" tabindex="-1"></a>    y_test_pred_transformed <span class="op">=</span> model_instance.predict(X_test_transformed)</span>
<span id="cb47-79"><a href="#cb47-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-80"><a href="#cb47-80" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a DataFrame with the same columns as the original y used in fit</span></span>
<span id="cb47-81"><a href="#cb47-81" aria-hidden="true" tabindex="-1"></a>    dummy_train_y <span class="op">=</span> pd.DataFrame(<span class="dv">0</span>, index<span class="op">=</span>X_train_transformed.index, columns<span class="op">=</span>Y_train_transformed.columns)</span>
<span id="cb47-82"><a href="#cb47-82" aria-hidden="true" tabindex="-1"></a>    dummy_train_y[y_target] <span class="op">=</span> y_train_pred_transformed</span>
<span id="cb47-83"><a href="#cb47-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-84"><a href="#cb47-84" aria-hidden="true" tabindex="-1"></a>    dummy_test_y <span class="op">=</span> pd.DataFrame(<span class="dv">0</span>, index<span class="op">=</span>X_test_transformed.index, columns<span class="op">=</span>Y_test_transformed.columns)</span>
<span id="cb47-85"><a href="#cb47-85" aria-hidden="true" tabindex="-1"></a>    dummy_test_y[y_target] <span class="op">=</span> y_test_pred_transformed</span>
<span id="cb47-86"><a href="#cb47-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-87"><a href="#cb47-87" aria-hidden="true" tabindex="-1"></a>    <span class="co"># apply inverse transform</span></span>
<span id="cb47-88"><a href="#cb47-88" aria-hidden="true" tabindex="-1"></a>    dummy_train_y_inv <span class="op">=</span> preprocess_pipeline_Y.inverse_transform(dummy_train_y)</span>
<span id="cb47-89"><a href="#cb47-89" aria-hidden="true" tabindex="-1"></a>    dummy_test_y_inv <span class="op">=</span> preprocess_pipeline_Y.inverse_transform(dummy_test_y)</span>
<span id="cb47-90"><a href="#cb47-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-91"><a href="#cb47-91" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the relevant target column</span></span>
<span id="cb47-92"><a href="#cb47-92" aria-hidden="true" tabindex="-1"></a>    y_train_pred <span class="op">=</span> dummy_train_y_inv[y_target].to_numpy()</span>
<span id="cb47-93"><a href="#cb47-93" aria-hidden="true" tabindex="-1"></a>    y_test_pred <span class="op">=</span> dummy_test_y_inv[y_target].to_numpy()</span>
<span id="cb47-94"><a href="#cb47-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-95"><a href="#cb47-95" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Evaluate model</span></span>
<span id="cb47-96"><a href="#cb47-96" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate metrics</span></span>
<span id="cb47-97"><a href="#cb47-97" aria-hidden="true" tabindex="-1"></a>    train_r2 <span class="op">=</span> r2_score(raw_y_train, y_train_pred)</span>
<span id="cb47-98"><a href="#cb47-98" aria-hidden="true" tabindex="-1"></a>    test_r2 <span class="op">=</span> r2_score(raw_y_test, y_test_pred)</span>
<span id="cb47-99"><a href="#cb47-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-100"><a href="#cb47-100" aria-hidden="true" tabindex="-1"></a>    train_rmse <span class="op">=</span> np.sqrt(mean_squared_error(raw_y_train, y_train_pred))</span>
<span id="cb47-101"><a href="#cb47-101" aria-hidden="true" tabindex="-1"></a>    test_rmse <span class="op">=</span> np.sqrt(mean_squared_error(raw_y_test, y_test_pred))</span>
<span id="cb47-102"><a href="#cb47-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-103"><a href="#cb47-103" aria-hidden="true" tabindex="-1"></a>    train_mae <span class="op">=</span> mean_absolute_error(raw_y_train, y_train_pred)</span>
<span id="cb47-104"><a href="#cb47-104" aria-hidden="true" tabindex="-1"></a>    test_mae <span class="op">=</span> mean_absolute_error(raw_y_test, y_test_pred)</span>
<span id="cb47-105"><a href="#cb47-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-106"><a href="#cb47-106" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot learning curves</span></span>
<span id="cb47-107"><a href="#cb47-107" aria-hidden="true" tabindex="-1"></a>    plot_learning_curves(model_instance, X_train_transformed, Y_train_transformed[y_target], y_target)</span>
<span id="cb47-108"><a href="#cb47-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-109"><a href="#cb47-109" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print results</span></span>
<span id="cb47-110"><a href="#cb47-110" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print("Model Performance:")</span></span>
<span id="cb47-111"><a href="#cb47-111" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(f"{'Metric':&lt;10} {'Train':&lt;10} {'Test':&lt;10}")</span></span>
<span id="cb47-112"><a href="#cb47-112" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print("-" * 30)</span></span>
<span id="cb47-113"><a href="#cb47-113" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(f"{'R2':&lt;10} {train_r2:&lt;10.4f} {test_r2:&lt;10.4f}")</span></span>
<span id="cb47-114"><a href="#cb47-114" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(f"{'RMSE':&lt;10} {train_rmse:&lt;10.4f} {test_rmse:&lt;10.4f}")</span></span>
<span id="cb47-115"><a href="#cb47-115" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(f"{'MAE':&lt;10} {train_mae:&lt;10.4f} {test_mae:&lt;10.4f}")</span></span>
<span id="cb47-116"><a href="#cb47-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-117"><a href="#cb47-117" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot actual vs predicted</span></span>
<span id="cb47-118"><a href="#cb47-118" aria-hidden="true" tabindex="-1"></a>    _, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb47-119"><a href="#cb47-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-120"><a href="#cb47-120" aria-hidden="true" tabindex="-1"></a>    ax1.scatter(raw_y_train, y_train_pred, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb47-121"><a href="#cb47-121" aria-hidden="true" tabindex="-1"></a>    ax1.plot([raw_y_train.<span class="bu">min</span>(), raw_y_train.<span class="bu">max</span>()], [raw_y_train.<span class="bu">min</span>(), raw_y_train.<span class="bu">max</span>()], <span class="st">'r--'</span>, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb47-122"><a href="#cb47-122" aria-hidden="true" tabindex="-1"></a>    ax1.set_xlabel(<span class="st">'Actual'</span>)</span>
<span id="cb47-123"><a href="#cb47-123" aria-hidden="true" tabindex="-1"></a>    ax1.set_ylabel(<span class="st">'Predicted'</span>)</span>
<span id="cb47-124"><a href="#cb47-124" aria-hidden="true" tabindex="-1"></a>    ax1.set_title(<span class="st">'Training Set'</span>)</span>
<span id="cb47-125"><a href="#cb47-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-126"><a href="#cb47-126" aria-hidden="true" tabindex="-1"></a>    ax2.scatter(raw_y_test, y_test_pred, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb47-127"><a href="#cb47-127" aria-hidden="true" tabindex="-1"></a>    ax2.plot([raw_y_test.<span class="bu">min</span>(), raw_y_test.<span class="bu">max</span>()], [raw_y_test.<span class="bu">min</span>(), raw_y_test.<span class="bu">max</span>()], <span class="st">'r--'</span>, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb47-128"><a href="#cb47-128" aria-hidden="true" tabindex="-1"></a>    ax2.set_xlabel(<span class="st">'Actual'</span>)</span>
<span id="cb47-129"><a href="#cb47-129" aria-hidden="true" tabindex="-1"></a>    ax2.set_ylabel(<span class="st">'Predicted'</span>)</span>
<span id="cb47-130"><a href="#cb47-130" aria-hidden="true" tabindex="-1"></a>    ax2.set_title(<span class="st">'Testing Set'</span>)</span>
<span id="cb47-131"><a href="#cb47-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-132"><a href="#cb47-132" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb47-133"><a href="#cb47-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-134"><a href="#cb47-134" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create 'plots' directory if it doesn't exist</span></span>
<span id="cb47-135"><a href="#cb47-135" aria-hidden="true" tabindex="-1"></a>    os.makedirs(<span class="ss">f'plots/</span><span class="sc">{</span>y_target<span class="sc">}</span><span class="ss">'</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb47-136"><a href="#cb47-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-137"><a href="#cb47-137" aria-hidden="true" tabindex="-1"></a>    plt.savefig(<span class="ss">f'plots/</span><span class="sc">{</span>y_target<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>y_target<span class="sc">}</span><span class="ss">-xgb-def-model-performance-comparison.png'</span>)</span>
<span id="cb47-138"><a href="#cb47-138" aria-hidden="true" tabindex="-1"></a>    plt.close()</span>
<span id="cb47-139"><a href="#cb47-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-140"><a href="#cb47-140" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Feature importance</span></span>
<span id="cb47-141"><a href="#cb47-141" aria-hidden="true" tabindex="-1"></a>    _, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">16</span>), dpi<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb47-142"><a href="#cb47-142" aria-hidden="true" tabindex="-1"></a>    plot_importance(model_instance, ax<span class="op">=</span>ax)</span>
<span id="cb47-143"><a href="#cb47-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-144"><a href="#cb47-144" aria-hidden="true" tabindex="-1"></a>    plt.savefig(<span class="ss">f"plots/</span><span class="sc">{</span>y_target<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>y_target<span class="sc">}</span><span class="ss">-xgb-def-model-test-set-feature-importance.png"</span>)</span>
<span id="cb47-145"><a href="#cb47-145" aria-hidden="true" tabindex="-1"></a>    plt.close()</span>
<span id="cb47-146"><a href="#cb47-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-147"><a href="#cb47-147" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the SHAP explainer</span></span>
<span id="cb47-148"><a href="#cb47-148" aria-hidden="true" tabindex="-1"></a>    explainer <span class="op">=</span> shap.TreeExplainer(model_instance)</span>
<span id="cb47-149"><a href="#cb47-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-150"><a href="#cb47-150" aria-hidden="true" tabindex="-1"></a>    <span class="co"># run explanation object on X_test dataset because we don't want to learn what the model learned from the X_train data, but to see features that would influence predictions on new data</span></span>
<span id="cb47-151"><a href="#cb47-151" aria-hidden="true" tabindex="-1"></a>    shap_values <span class="op">=</span> explainer(X_test_transformed)</span>
<span id="cb47-152"><a href="#cb47-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-153"><a href="#cb47-153" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">16</span>), dpi<span class="op">=</span><span class="dv">300</span>) </span>
<span id="cb47-154"><a href="#cb47-154" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Summary plot</span></span>
<span id="cb47-155"><a href="#cb47-155" aria-hidden="true" tabindex="-1"></a>    shap.summary_plot(shap_values, show<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb47-156"><a href="#cb47-156" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb47-157"><a href="#cb47-157" aria-hidden="true" tabindex="-1"></a>    plt.savefig(<span class="ss">f"plots/</span><span class="sc">{</span>y_target<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>y_target<span class="sc">}</span><span class="ss">-xgb-def-model-test-set-SHAP-beeswarm.png"</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span>
<span id="cb47-158"><a href="#cb47-158" aria-hidden="true" tabindex="-1"></a>    plt.close()</span>
<span id="cb47-159"><a href="#cb47-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-160"><a href="#cb47-160" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform clustering</span></span>
<span id="cb47-161"><a href="#cb47-161" aria-hidden="true" tabindex="-1"></a>    clust <span class="op">=</span> shap.utils.hclust(X_test_transformed, Y_test_transformed[y_target])</span>
<span id="cb47-162"><a href="#cb47-162" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the bar plot with clustering</span></span>
<span id="cb47-163"><a href="#cb47-163" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">16</span>)) </span>
<span id="cb47-164"><a href="#cb47-164" aria-hidden="true" tabindex="-1"></a>    shap.plots.bar(shap_values, clustering<span class="op">=</span>clust, clustering_cutoff<span class="op">=</span><span class="dv">1</span>, show<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb47-165"><a href="#cb47-165" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb47-166"><a href="#cb47-166" aria-hidden="true" tabindex="-1"></a>    plt.savefig(<span class="ss">f"plots/</span><span class="sc">{</span>y_target<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>y_target<span class="sc">}</span><span class="ss">-xgb-def-model-test-set-SHAP-summary.png"</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span>
<span id="cb47-167"><a href="#cb47-167" aria-hidden="true" tabindex="-1"></a>    plt.close()</span>
<span id="cb47-168"><a href="#cb47-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-169"><a href="#cb47-169" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Model training and evaluation for </span><span class="sc">{</span>y_target<span class="sc">}</span><span class="ss"> completed."</span>)</span>
<span id="cb47-170"><a href="#cb47-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-171"><a href="#cb47-171" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Instead of returning a tuple, return a YTargetMetrics object</span></span>
<span id="cb47-172"><a href="#cb47-172" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> YTargetMetrics(y_target, train_r2, test_r2, train_rmse, test_rmse, train_mae, test_mae)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="grid-search-using-gridsearchcv-for-hyperparameter-tuning" class="level4">
<h4 class="anchored" data-anchor-id="grid-search-using-gridsearchcv-for-hyperparameter-tuning"><strong>Grid Search: Using <code>GridSearchCV</code> for Hyperparameter Tuning</strong></h4>
<div id="cell-67" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> xgboost <span class="im">import</span> XGBRegressor</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> YTargetMetrics:</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, target_name, test_mae, test_rmse, test_r2):</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.target_name <span class="op">=</span> target_name</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.test_mae <span class="op">=</span> test_mae</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.test_rmse <span class="op">=</span> test_rmse</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.test_r2 <span class="op">=</span> test_r2</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__str__</span>(<span class="va">self</span>):</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f"""Model Performance for </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>target_name<span class="sc">}</span><span class="ss">:</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span><span class="st">'Metric'</span><span class="sc">:&lt;10}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Test'</span><span class="sc">:&lt;10}</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span><span class="st">'-'</span> <span class="op">*</span> <span class="dv">20</span><span class="sc">}</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span><span class="st">'MAE'</span><span class="sc">:&lt;10}</span><span class="ss"> </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>test_mae<span class="sc">:&lt;10.4f}</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span><span class="st">'RMSE'</span><span class="sc">:&lt;10}</span><span class="ss"> </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>test_rmse<span class="sc">:&lt;10.4f}</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span><span class="st">'R2'</span><span class="sc">:&lt;10}</span><span class="ss"> </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>test_r2<span class="sc">:&lt;10.4f}</span><span class="ss">"""</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> to_dict(<span class="va">self</span>):</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">'target_name'</span>: <span class="va">self</span>.target_name,</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">'test_mae'</span>: <span class="va">self</span>.test_mae,</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">'test_rmse'</span>: <span class="va">self</span>.test_rmse,</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">'test_r2'</span>: <span class="va">self</span>.test_r2</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_grid_search_cv(model_instance, target, search_space, X_train_transformed, Y_train_transformed, output_path):</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># assign y target column</span></span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>    y_train_target <span class="op">=</span> Y_train_transformed[target]</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set up grid search</span></span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>    grid_search <span class="op">=</span> GridSearchCV(</span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>    estimator<span class="op">=</span>model_instance,</span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>    param_grid<span class="op">=</span>search_space,</span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>    cv<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>    refit<span class="op">=</span><span class="st">'r2'</span>,</span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>    scoring<span class="op">=</span>[<span class="st">'r2'</span>, <span class="st">'neg_root_mean_squared_error'</span>],</span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>    n_jobs<span class="op">=-</span><span class="dv">1</span>,  <span class="co"># Use all available cores</span></span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>    verbose<span class="op">=</span><span class="dv">1</span></span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Running grid search on </span><span class="sc">{</span>target<span class="sc">}</span><span class="ss"> column..."</span>)</span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit grid search</span></span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a>    grid_search.fit(X_train_transformed, y_train_target)</span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get best parameters and model</span></span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a>    best_params <span class="op">=</span> grid_search.best_params_</span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a>    best_model <span class="op">=</span> grid_search.best_estimator_</span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a>    best_metric <span class="op">=</span> grid_search.best_score_</span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Best parameters:"</span>, best_params)</span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Best score:"</span>, best_metric)</span>
<span id="cb48-54"><a href="#cb48-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># get CV results into a csv file</span></span>
<span id="cb48-56"><a href="#cb48-56" aria-hidden="true" tabindex="-1"></a>    cv_results <span class="op">=</span> pd.DataFrame(grid_search.cv_results_)</span>
<span id="cb48-57"><a href="#cb48-57" aria-hidden="true" tabindex="-1"></a>    cv_results <span class="op">=</span> cv_results.sort_values(by<span class="op">=</span><span class="st">'rank_test_r2'</span>)</span>
<span id="cb48-58"><a href="#cb48-58" aria-hidden="true" tabindex="-1"></a>    cv_results.to_csv(<span class="ss">f'</span><span class="sc">{</span>output_path<span class="sc">}</span><span class="ss">/grid_search_results_</span><span class="sc">{</span>target<span class="sc">}</span><span class="ss">_score-</span><span class="sc">{</span>best_metric<span class="sc">}</span><span class="ss">.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb48-59"><a href="#cb48-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_model, best_params, best_metric</span>
<span id="cb48-60"><a href="#cb48-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-61"><a href="#cb48-61" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> predict_with_best_xgboost_model(best_model, target, X_test_transformed, Y_test_transformed, Y_test, preprocess_pipeline_Y):</span>
<span id="cb48-62"><a href="#cb48-62" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make predictions on the test set using the best model</span></span>
<span id="cb48-63"><a href="#cb48-63" aria-hidden="true" tabindex="-1"></a>    y_pred_transformed <span class="op">=</span> best_model.predict(X_test_transformed)</span>
<span id="cb48-64"><a href="#cb48-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-65"><a href="#cb48-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a DataFrame with the same columns as the original y used in preprocess_pipeline to reverse transformation</span></span>
<span id="cb48-66"><a href="#cb48-66" aria-hidden="true" tabindex="-1"></a>    dummy_df <span class="op">=</span> pd.DataFrame(<span class="dv">0</span>, index<span class="op">=</span>X_test_transformed.index, columns<span class="op">=</span>Y_test_transformed.columns)</span>
<span id="cb48-67"><a href="#cb48-67" aria-hidden="true" tabindex="-1"></a>    dummy_df[target] <span class="op">=</span> y_pred_transformed</span>
<span id="cb48-68"><a href="#cb48-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-69"><a href="#cb48-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># apply inverse transform</span></span>
<span id="cb48-70"><a href="#cb48-70" aria-hidden="true" tabindex="-1"></a>    dummy_df_inv <span class="op">=</span> preprocess_pipeline_Y.inverse_transform(dummy_df)</span>
<span id="cb48-71"><a href="#cb48-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-72"><a href="#cb48-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the relevant target column</span></span>
<span id="cb48-73"><a href="#cb48-73" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> dummy_df_inv[target].to_numpy()</span>
<span id="cb48-74"><a href="#cb48-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-75"><a href="#cb48-75" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Evaluate</span></span>
<span id="cb48-76"><a href="#cb48-76" aria-hidden="true" tabindex="-1"></a>    y_test <span class="op">=</span> Y_test[target]</span>
<span id="cb48-77"><a href="#cb48-77" aria-hidden="true" tabindex="-1"></a>    test_mae <span class="op">=</span> mean_absolute_error(y_test, y_pred)</span>
<span id="cb48-78"><a href="#cb48-78" aria-hidden="true" tabindex="-1"></a>    test_rmse <span class="op">=</span> np.sqrt(mean_squared_error(y_test, y_pred))</span>
<span id="cb48-79"><a href="#cb48-79" aria-hidden="true" tabindex="-1"></a>    test_r2 <span class="op">=</span> r2_score(y_test, y_pred)</span>
<span id="cb48-80"><a href="#cb48-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-81"><a href="#cb48-81" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Mean Absolute Error (MAE) [Testing]: </span><span class="sc">{</span>test_mae<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb48-82"><a href="#cb48-82" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Root Mean Squared Error (RMSE) [Testing]: </span><span class="sc">{</span>test_rmse<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb48-83"><a href="#cb48-83" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Coefficient of Determination (R2) [Testing]: </span><span class="sc">{</span>test_r2<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb48-84"><a href="#cb48-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-85"><a href="#cb48-85" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Instead of returning a tuple, return a YTargetMetrics object</span></span>
<span id="cb48-86"><a href="#cb48-86" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> YTargetMetrics(target, test_mae, test_rmse, test_r2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-68" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate base model</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>model_xgb <span class="op">=</span> XGBRegressor(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define search space</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>search_space <span class="op">=</span> {</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_estimators'</span>: [<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">400</span>],</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_depth'</span>: [<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>],</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'learning_rate'</span>: [<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="dv">1</span>],</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'subsample'</span>: [<span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">1.0</span>],</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'gamma'</span>: [<span class="fl">0.01</span>, <span class="fl">0.1</span>]</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="co"># set output folder</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>output_loc <span class="op">=</span> <span class="st">'../nb/out_files'</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize an empty dict</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>tuned_results <span class="op">=</span> {}</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> target <span class="kw">in</span> Y_labels_all:</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>    best_model, best_params, best_metric <span class="op">=</span> run_grid_search_cv(model_xgb, target, search_space, X_train_yjs, Y_train_yjs, output_loc)</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>    tuned_metrics <span class="op">=</span> predict_with_best_xgboost_model(best_model, target, X_test_yjs, Y_test_yjs, Y_test, preprocess_pipeline_Y)</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store the metric result in the dictionary</span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>    tuned_results[target] <span class="op">=</span> tuned_metrics</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running grid search on ESTIMATE column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.155118346758868
Mean Absolute Error (MAE) [Testing]: 952.47
Root Mean Squared Error (RMSE) [Testing]: 1176.54
Coefficient of Determination (R2) [Testing]: 0.17
Running grid search on IMPRES column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 6, 'n_estimators': 100, 'subsample': 0.5}
Best score: 0.02365982741447383
Mean Absolute Error (MAE) [Testing]: 1.05
Root Mean Squared Error (RMSE) [Testing]: 1.31
Coefficient of Determination (R2) [Testing]: 0.03
Running grid search on C_Bcellsnaive column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.5}
Best score: 0.05135495163777317
Mean Absolute Error (MAE) [Testing]: 0.04
Root Mean Squared Error (RMSE) [Testing]: 0.05
Coefficient of Determination (R2) [Testing]: 0.08
Running grid search on C_TcellsCD4memoryresting column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100, 'subsample': 0.5}
Best score: -0.028307017274827716
Mean Absolute Error (MAE) [Testing]: 0.07
Root Mean Squared Error (RMSE) [Testing]: 0.08
Coefficient of Determination (R2) [Testing]: 0.00
Running grid search on C_MacrophagesM2 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 9, 'n_estimators': 100, 'subsample': 0.5}
Best score: 0.029962885460540156
Mean Absolute Error (MAE) [Testing]: 0.08
Root Mean Squared Error (RMSE) [Testing]: 0.10
Coefficient of Determination (R2) [Testing]: 0.02
Running grid search on S_Attractors_LYM column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.8}
Best score: 0.1519325801004562
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.04
Coefficient of Determination (R2) [Testing]: 0.12
Running grid search on S_Attractors_IFIT3 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100, 'subsample': 0.5}
Best score: -0.01740592098092939
Mean Absolute Error (MAE) [Testing]: 0.04
Root Mean Squared Error (RMSE) [Testing]: 0.05
Coefficient of Determination (R2) [Testing]: 0.01
Running grid search on S_Attractors_G_GIMAP4 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.8}
Best score: 0.10172485511123637
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.04
Coefficient of Determination (R2) [Testing]: 0.11
Running grid search on S_Attractors_G_HLA.DPA1 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 1.0}
Best score: 0.13334587343594612
Mean Absolute Error (MAE) [Testing]: 0.02
Root Mean Squared Error (RMSE) [Testing]: 0.03
Coefficient of Determination (R2) [Testing]: -0.02
Running grid search on S_Attractors_G_SLAMF6 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.19095641111048084
Mean Absolute Error (MAE) [Testing]: 0.04
Root Mean Squared Error (RMSE) [Testing]: 0.05
Coefficient of Determination (R2) [Testing]: 0.17
Running grid search on S_Attractors_G_LILRB4 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.8}
Best score: 0.14469212473633178
Mean Absolute Error (MAE) [Testing]: 0.02
Root Mean Squared Error (RMSE) [Testing]: 0.03
Coefficient of Determination (R2) [Testing]: 0.09
Running grid search on S_Attractors_G_SIGLEC9 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100, 'subsample': 0.5}
Best score: -0.02085049620339232
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.04
Coefficient of Determination (R2) [Testing]: 0.00
Running grid search on S_Attractors_G_CYTH4 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.16852131461885284
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.04
Coefficient of Determination (R2) [Testing]: 0.18
Running grid search on S_Attractors_G_CD3E column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.1360970322747118
Mean Absolute Error (MAE) [Testing]: 0.04
Root Mean Squared Error (RMSE) [Testing]: 0.05
Coefficient of Determination (R2) [Testing]: 0.13
Running grid search on S_Lymph_Vessels column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 6, 'n_estimators': 100, 'subsample': 0.5}
Best score: 0.03201288157917721
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.03
Coefficient of Determination (R2) [Testing]: -0.02
Running grid search on S_ICR_SCORE column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.8}
Best score: 0.15934291353526212
Mean Absolute Error (MAE) [Testing]: 0.04
Root Mean Squared Error (RMSE) [Testing]: 0.05
Coefficient of Determination (R2) [Testing]: 0.13
Running grid search on S_ICR_INHIB_SCORE column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.5}
Best score: 0.1627773250826052
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.04
Coefficient of Determination (R2) [Testing]: 0.18
Running grid search on S_ICR_ACT_SCORE column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.8}
Best score: 0.1530260099969623
Mean Absolute Error (MAE) [Testing]: 0.04
Root Mean Squared Error (RMSE) [Testing]: 0.05
Coefficient of Determination (R2) [Testing]: 0.12
Running grid search on S_Angiogenesis column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.8}
Best score: 0.06861915844628179
Mean Absolute Error (MAE) [Testing]: 0.02
Root Mean Squared Error (RMSE) [Testing]: 0.03
Coefficient of Determination (R2) [Testing]: 0.03
Running grid search on S_APM1 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.5}
Best score: 0.09787115491563478
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.01
Coefficient of Determination (R2) [Testing]: 0.12
Running grid search on S_APM2 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.5}
Best score: 0.07828700996075295
Mean Absolute Error (MAE) [Testing]: 0.02
Root Mean Squared Error (RMSE) [Testing]: 0.03
Coefficient of Determination (R2) [Testing]: 0.06
Running grid search on S_ICS5_score column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.1663422797208908
Mean Absolute Error (MAE) [Testing]: 0.04
Root Mean Squared Error (RMSE) [Testing]: 0.06
Coefficient of Determination (R2) [Testing]: 0.07
Running grid search on S_LIexpression_score column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.19099609728572745
Mean Absolute Error (MAE) [Testing]: 0.04
Root Mean Squared Error (RMSE) [Testing]: 0.05
Coefficient of Determination (R2) [Testing]: 0.16
Running grid search on S_Chemokine12_score column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.8}
Best score: 0.1804485480291262
Mean Absolute Error (MAE) [Testing]: 0.04
Root Mean Squared Error (RMSE) [Testing]: 0.05
Coefficient of Determination (R2) [Testing]: 0.13
Running grid search on S_NHI_5gene_score column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.1345919647519557
Mean Absolute Error (MAE) [Testing]: 0.02
Root Mean Squared Error (RMSE) [Testing]: 0.03
Coefficient of Determination (R2) [Testing]: 0.08
Running grid search on S_CD68 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 9, 'n_estimators': 100, 'subsample': 0.5}
Best score: 0.03917842665714646
Mean Absolute Error (MAE) [Testing]: 0.08
Root Mean Squared Error (RMSE) [Testing]: 0.13
Coefficient of Determination (R2) [Testing]: -0.14
Running grid search on S_CD8A column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.09649175911751913
Mean Absolute Error (MAE) [Testing]: 0.04
Root Mean Squared Error (RMSE) [Testing]: 0.06
Coefficient of Determination (R2) [Testing]: 0.11
Running grid search on S_PD1_data column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.8}
Best score: 0.1388274399040847
Mean Absolute Error (MAE) [Testing]: 0.05
Root Mean Squared Error (RMSE) [Testing]: 0.09
Coefficient of Determination (R2) [Testing]: -0.01
Running grid search on S_PDL1_data column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.8}
Best score: 0.09523166841467698
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.04
Coefficient of Determination (R2) [Testing]: 0.08
Running grid search on S_PD1_PDL1_score column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.8}
Best score: 0.1223460942580558
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.05
Coefficient of Determination (R2) [Testing]: 0.04
Running grid search on S_CTLA4_data column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.8}
Best score: 0.14432249434540673
Mean Absolute Error (MAE) [Testing]: 0.04
Root Mean Squared Error (RMSE) [Testing]: 0.06
Coefficient of Determination (R2) [Testing]: 0.07
Running grid search on S_Bcell_mg_IGJ column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.15437226542586852
Mean Absolute Error (MAE) [Testing]: 0.05
Root Mean Squared Error (RMSE) [Testing]: 0.07
Coefficient of Determination (R2) [Testing]: -0.00
Running grid search on S_Bcell_receptors_score column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.8}
Best score: 0.20872363643597835
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.03
Coefficient of Determination (R2) [Testing]: 0.17
Running grid search on S_STAT1_score column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.10808145140828648
Mean Absolute Error (MAE) [Testing]: 0.02
Root Mean Squared Error (RMSE) [Testing]: 0.03
Coefficient of Determination (R2) [Testing]: 0.13
Running grid search on S_CSF1_response column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.8}
Best score: 0.17036253048148878
Mean Absolute Error (MAE) [Testing]: 0.02
Root Mean Squared Error (RMSE) [Testing]: 0.03
Coefficient of Determination (R2) [Testing]: 0.12
Running grid search on S_TcClassII_score column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.8}
Best score: 0.1353092427600878
Mean Absolute Error (MAE) [Testing]: 0.02
Root Mean Squared Error (RMSE) [Testing]: 0.03
Coefficient of Determination (R2) [Testing]: 0.13
Running grid search on S_IL12_score_21050467 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.1685925936656082
Mean Absolute Error (MAE) [Testing]: 0.02
Root Mean Squared Error (RMSE) [Testing]: 0.03
Coefficient of Determination (R2) [Testing]: 0.16
Running grid search on S_IL4_score_21050467 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 6, 'n_estimators': 200, 'subsample': 0.5}
Best score: 0.058610473096243496
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.02
Coefficient of Determination (R2) [Testing]: 0.04
Running grid search on S_IL2_score_21050467 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.5}
Best score: 0.10951936674694163
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.02
Coefficient of Determination (R2) [Testing]: 0.14
Running grid search on S_IL13_score_21050467 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100, 'subsample': 0.5}
Best score: -0.002331576883738795
Mean Absolute Error (MAE) [Testing]: 0.02
Root Mean Squared Error (RMSE) [Testing]: 0.03
Coefficient of Determination (R2) [Testing]: 0.03
Running grid search on S_IFNG_score_21050467 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 1.0}
Best score: 0.14472145870011874
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.01
Coefficient of Determination (R2) [Testing]: 0.13
Running grid search on S_TGFB_score_21050467 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 1.0}
Best score: 0.035040184707386325
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.01
Coefficient of Determination (R2) [Testing]: -0.03
Running grid search on S_TREM1_data column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100, 'subsample': 1.0}
Best score: 0.05379798267792597
Mean Absolute Error (MAE) [Testing]: 0.04
Root Mean Squared Error (RMSE) [Testing]: 0.05
Coefficient of Determination (R2) [Testing]: 0.06
Running grid search on S_DAP12_data column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.0826437020332194
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.04
Coefficient of Determination (R2) [Testing]: 0.02
Running grid search on S_Tcell_receptors_score column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.8}
Best score: 0.13720497974801588
Mean Absolute Error (MAE) [Testing]: 0.04
Root Mean Squared Error (RMSE) [Testing]: 0.05
Coefficient of Determination (R2) [Testing]: 0.16
Running grid search on S_IL8_21978456 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.8}
Best score: 0.23128455401739217
Mean Absolute Error (MAE) [Testing]: 0.04
Root Mean Squared Error (RMSE) [Testing]: 0.05
Coefficient of Determination (R2) [Testing]: 0.23
Running grid search on S_IFN_21978456 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100, 'subsample': 0.5}
Best score: -0.017336336792057417
Mean Absolute Error (MAE) [Testing]: 0.04
Root Mean Squared Error (RMSE) [Testing]: 0.04
Coefficient of Determination (R2) [Testing]: 0.03
Running grid search on S_MHC1_21978456 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.5}
Best score: 0.04198595068927517
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.02
Coefficient of Determination (R2) [Testing]: 0.05
Running grid search on S_MHC2_21978456 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.8}
Best score: 0.08940145635007306
Mean Absolute Error (MAE) [Testing]: 0.02
Root Mean Squared Error (RMSE) [Testing]: 0.03
Coefficient of Determination (R2) [Testing]: 0.02
Running grid search on S_Bcell_21978456 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.17741514608414627
Mean Absolute Error (MAE) [Testing]: 0.05
Root Mean Squared Error (RMSE) [Testing]: 0.07
Coefficient of Determination (R2) [Testing]: 0.03
Running grid search on S_Tcell_21978456 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.8}
Best score: 0.1119536941802293
Mean Absolute Error (MAE) [Testing]: 0.04
Root Mean Squared Error (RMSE) [Testing]: 0.05
Coefficient of Determination (R2) [Testing]: 0.15
Running grid search on S_CD103pos_mean_25446897 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.5}
Best score: 0.11511517035979142
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.04
Coefficient of Determination (R2) [Testing]: 0.10
Running grid search on S_CD103neg_mean_25446897 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 6, 'n_estimators': 200, 'subsample': 0.5}
Best score: 0.06203207587017538
Mean Absolute Error (MAE) [Testing]: 0.02
Root Mean Squared Error (RMSE) [Testing]: 0.02
Coefficient of Determination (R2) [Testing]: -0.02
Running grid search on S_IgG_19272155 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.19317543516218452
Mean Absolute Error (MAE) [Testing]: 0.05
Root Mean Squared Error (RMSE) [Testing]: 0.07
Coefficient of Determination (R2) [Testing]: 0.07
Running grid search on S_Interferon_19272155 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100, 'subsample': 0.5}
Best score: -0.020905587484932653
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.04
Coefficient of Determination (R2) [Testing]: 0.02
Running grid search on S_LCK_19272155 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.8}
Best score: 0.14622394349775247
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.04
Coefficient of Determination (R2) [Testing]: 0.15
Running grid search on S_MHC.I_19272155 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.5}
Best score: 0.05426398647908359
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.02
Coefficient of Determination (R2) [Testing]: 0.03
Running grid search on S_MHC.II_19272155 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 1.0}
Best score: 0.13785681111509934
Mean Absolute Error (MAE) [Testing]: 0.02
Root Mean Squared Error (RMSE) [Testing]: 0.03
Coefficient of Determination (R2) [Testing]: 0.05
Running grid search on S_STAT1_19272155 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.8}
Best score: 0.14605665416209196
Mean Absolute Error (MAE) [Testing]: 0.04
Root Mean Squared Error (RMSE) [Testing]: 0.04
Coefficient of Determination (R2) [Testing]: 0.09
Running grid search on S_Troester_WoundSig_19887484 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.5}
Best score: 0.0789651915412545
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.02
Coefficient of Determination (R2) [Testing]: 0.05
Running grid search on S_MDACC.FNA.1_20805453 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.20375555006761056
Mean Absolute Error (MAE) [Testing]: 0.02
Root Mean Squared Error (RMSE) [Testing]: 0.03
Coefficient of Determination (R2) [Testing]: 0.07
Running grid search on S_IGG_Cluster_21214954 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.19340494249870618
Mean Absolute Error (MAE) [Testing]: 0.04
Root Mean Squared Error (RMSE) [Testing]: 0.05
Coefficient of Determination (R2) [Testing]: 0.14
Running grid search on S_Minterferon_Cluster_21214954 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100, 'subsample': 0.5}
Best score: 0.023450828708813144
Mean Absolute Error (MAE) [Testing]: 0.02
Root Mean Squared Error (RMSE) [Testing]: 0.03
Coefficient of Determination (R2) [Testing]: 0.03
Running grid search on S_Immune_cell_Cluster_21214954 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.1660015494126487
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.03
Coefficient of Determination (R2) [Testing]: 0.18
Running grid search on S_MCD3_CD8_21214954 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.8}
Best score: 0.0883605346280425
Mean Absolute Error (MAE) [Testing]: 0.04
Root Mean Squared Error (RMSE) [Testing]: 0.04
Coefficient of Determination (R2) [Testing]: 0.07
Running grid search on S_Interferon_Cluster_21214954 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100, 'subsample': 0.5}
Best score: -0.011855230017494245
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.03
Coefficient of Determination (R2) [Testing]: 0.02
Running grid search on S_B_cell_PCA_16704732 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.1637049941109549
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.01
Coefficient of Determination (R2) [Testing]: 0.12
Running grid search on S_CD8_PCA_16704732 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.5}
Best score: 0.09923986144572745
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.03
Coefficient of Determination (R2) [Testing]: 0.13
Running grid search on S_GRANS_PCA_16704732 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 6, 'n_estimators': 200, 'subsample': 0.5}
Best score: 0.18530991159585286
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.01
Coefficient of Determination (R2) [Testing]: -0.01
Running grid search on S_LYMPHS_PCA_16704732 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100, 'subsample': 0.8}
Best score: 0.04945557061750831
Mean Absolute Error (MAE) [Testing]: 0.00
Root Mean Squared Error (RMSE) [Testing]: 0.00
Coefficient of Determination (R2) [Testing]: 0.12
Running grid search on S_T_cell_PCA_16704732 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.11259051188448313
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.01
Coefficient of Determination (R2) [Testing]: 0.09
Running grid search on S_TGFB_PCA_17349583 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100, 'subsample': 0.5}
Best score: 0.011742449461378457
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.02
Coefficient of Determination (R2) [Testing]: -0.12
Running grid search on S_Rotterdam_ERneg_PCA_15721472 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100, 'subsample': 0.5}
Best score: 0.012121196438079717
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.02
Coefficient of Determination (R2) [Testing]: 0.03
Running grid search on S_HER2_Immune_PCA_18006808 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.16711848218016787
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.02
Coefficient of Determination (R2) [Testing]: 0.14
Running grid search on S_IR7_score column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.1862035428684511
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.05
Coefficient of Determination (R2) [Testing]: 0.04
Running grid search on S_Buck14_score column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100, 'subsample': 0.8}
Best score: -0.001608356814198375
Mean Absolute Error (MAE) [Testing]: 0.02
Root Mean Squared Error (RMSE) [Testing]: 0.02
Coefficient of Determination (R2) [Testing]: 0.04
Running grid search on S_TAMsurr_score column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.18156425759012923
Mean Absolute Error (MAE) [Testing]: 0.05
Root Mean Squared Error (RMSE) [Testing]: 0.06
Coefficient of Determination (R2) [Testing]: 0.16
Running grid search on S_Immune_NSCLC_score column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.10244564712734842
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.01
Coefficient of Determination (R2) [Testing]: 0.08
Running grid search on S_Module3_IFN_score column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100, 'subsample': 0.5}
Best score: -0.012214794279973606
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.04
Coefficient of Determination (R2) [Testing]: 0.02
Running grid search on S_Module4_TcellBcell_score column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.16453949978047844
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.04
Coefficient of Determination (R2) [Testing]: 0.16
Running grid search on S_Module5_TcellBcell_score column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.8}
Best score: 0.18982036987158973
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.04
Coefficient of Determination (R2) [Testing]: 0.17
Running grid search on S_Module11_Prolif_score column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.394383773420954
Mean Absolute Error (MAE) [Testing]: 0.02
Root Mean Squared Error (RMSE) [Testing]: 0.03
Coefficient of Determination (R2) [Testing]: 0.35
Running grid search on S_CD8_CD68_ratio column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 9, 'n_estimators': 200, 'subsample': 0.5}
Best score: 0.09294423658293771
Mean Absolute Error (MAE) [Testing]: 0.05
Root Mean Squared Error (RMSE) [Testing]: 0.06
Coefficient of Determination (R2) [Testing]: -0.11
Running grid search on S_TAMsurr_TcClassII_ratio column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.14573827520348343
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.04
Coefficient of Determination (R2) [Testing]: 0.13
Running grid search on S_CHANG_CORE_SERUM_RESPONSE_UP column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.8}
Best score: 0.2855672921480671
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.01
Coefficient of Determination (R2) [Testing]: 0.34
Running grid search on S_CSR_Activated_15701700 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 6, 'n_estimators': 200, 'subsample': 0.5}
Best score: 0.2836786079837036
Mean Absolute Error (MAE) [Testing]: 0.00
Root Mean Squared Error (RMSE) [Testing]: 0.00
Coefficient of Determination (R2) [Testing]: 0.17
Running grid search on S_B_cells column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.22153689561487874
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.04
Coefficient of Determination (R2) [Testing]: 0.14
Running grid search on S_T_cells column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.8}
Best score: 0.10191864592874492
Mean Absolute Error (MAE) [Testing]: 0.04
Root Mean Squared Error (RMSE) [Testing]: 0.05
Coefficient of Determination (R2) [Testing]: 0.15
Running grid search on S_T_helper column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100, 'subsample': 0.8}
Best score: 0.015610120272369165
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.01
Coefficient of Determination (R2) [Testing]: 0.03
Running grid search on S_Tcm column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100, 'subsample': 0.5}
Best score: 0.014613945078109114
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.02
Coefficient of Determination (R2) [Testing]: 0.06
Running grid search on S_Tem column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 1.0}
Best score: 0.08533285179897798
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.02
Coefficient of Determination (R2) [Testing]: -0.03
Running grid search on S_Th1 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.5}
Best score: 0.1747410060190523
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.02
Coefficient of Determination (R2) [Testing]: 0.16
Running grid search on S_Th2 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.8}
Best score: 0.06916848576201093
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.02
Coefficient of Determination (R2) [Testing]: 0.06
Running grid search on S_TFH column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.5}
Best score: 0.0729284103869882
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.02
Coefficient of Determination (R2) [Testing]: 0.09
Running grid search on S_CD8_Tcells column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100, 'subsample': 0.8}
Best score: 0.034183813076024604
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.01
Coefficient of Determination (R2) [Testing]: 0.08
Running grid search on S_Th17 column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100, 'subsample': 0.5}
Best score: -0.0023697750844352107
Mean Absolute Error (MAE) [Testing]: 0.02
Root Mean Squared Error (RMSE) [Testing]: 0.03
Coefficient of Determination (R2) [Testing]: 0.00
Running grid search on S_Treg column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.5}
Best score: 0.1279458877219045
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.04
Coefficient of Determination (R2) [Testing]: 0.15
Running grid search on S_Tgd column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 9, 'n_estimators': 100, 'subsample': 0.5}
Best score: 0.017220188360068535
Mean Absolute Error (MAE) [Testing]: 0.04
Root Mean Squared Error (RMSE) [Testing]: 0.06
Coefficient of Determination (R2) [Testing]: -0.10
Running grid search on S_Cytotoxic_cells column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.8}
Best score: 0.12408545139085092
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.03
Coefficient of Determination (R2) [Testing]: 0.15
Running grid search on S_NK_cells column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100, 'subsample': 1.0}
Best score: 0.04754939026275
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.01
Coefficient of Determination (R2) [Testing]: 0.00
Running grid search on S_NK_cd56dim column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.8}
Best score: 0.08390537657914059
Mean Absolute Error (MAE) [Testing]: 0.05
Root Mean Squared Error (RMSE) [Testing]: 0.06
Coefficient of Determination (R2) [Testing]: 0.14
Running grid search on S_NK_cd56bright column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.8}
Best score: 0.19340591348381417
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.04
Coefficient of Determination (R2) [Testing]: 0.22
Running grid search on S_DC column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.18563229992765645
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.03
Coefficient of Determination (R2) [Testing]: 0.11
Running grid search on S_iDC column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.5}
Best score: 0.10555306357552771
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.02
Coefficient of Determination (R2) [Testing]: 0.08
Running grid search on S_aDC column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100, 'subsample': 0.5}
Best score: 0.04734623008092609
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.04
Coefficient of Determination (R2) [Testing]: 0.05
Running grid search on S_pDC column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.09225890804599057
Mean Absolute Error (MAE) [Testing]: 0.02
Root Mean Squared Error (RMSE) [Testing]: 0.03
Coefficient of Determination (R2) [Testing]: 0.09
Running grid search on S_Eosinophils column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100, 'subsample': 0.5}
Best score: 0.035605799424536386
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.02
Coefficient of Determination (R2) [Testing]: 0.10
Running grid search on S_Macrophages column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.01, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.8}
Best score: 0.1591976434506382
Mean Absolute Error (MAE) [Testing]: 0.02
Root Mean Squared Error (RMSE) [Testing]: 0.02
Coefficient of Determination (R2) [Testing]: 0.03
Running grid search on S_Mast column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 1.0}
Best score: 0.07763240721579381
Mean Absolute Error (MAE) [Testing]: 0.02
Root Mean Squared Error (RMSE) [Testing]: 0.03
Coefficient of Determination (R2) [Testing]: 0.16
Running grid search on S_Neutrophils column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.8}
Best score: 0.14843611254077863
Mean Absolute Error (MAE) [Testing]: 0.02
Root Mean Squared Error (RMSE) [Testing]: 0.03
Coefficient of Determination (R2) [Testing]: 0.01
Running grid search on S_Bindea_full column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.12574372039541654
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.01
Coefficient of Determination (R2) [Testing]: 0.10
Running grid search on S_Expanded_IFNg column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 400, 'subsample': 0.5}
Best score: 0.17364486853409497
Mean Absolute Error (MAE) [Testing]: 0.03
Root Mean Squared Error (RMSE) [Testing]: 0.04
Coefficient of Determination (R2) [Testing]: 0.18
Running grid search on S_KEGG_MMR column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.5}
Best score: 0.12472632063163687
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.01
Coefficient of Determination (R2) [Testing]: 0.12
Running grid search on S_KEGG_TGF_Beta column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100, 'subsample': 1.0}
Best score: -0.006181594551688896
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.01
Coefficient of Determination (R2) [Testing]: 0.02
Running grid search on S_KEGG_Cytosolic_DNA_Sensing column...
Fitting 5 folds for each of 216 candidates, totalling 1080 fits
Best parameters: {'gamma': 0.1, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 200, 'subsample': 0.5}
Best score: 0.056266791023310135
Mean Absolute Error (MAE) [Testing]: 0.01
Root Mean Squared Error (RMSE) [Testing]: 0.01
Coefficient of Determination (R2) [Testing]: 0.15</code></pre>
</div>
</div>
<div id="cell-69" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.cluster <span class="im">import</span> hierarchy</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract R2 scores from the YTargetMetrics instances into a DataFrame</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>r2_data <span class="op">=</span> {target: metrics.test_r2 <span class="cf">for</span> target, metrics <span class="kw">in</span> tuned_results.items()}</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>df_r2 <span class="op">=</span> pd.DataFrame(<span class="bu">list</span>(r2_data.items()), columns<span class="op">=</span>[<span class="st">'Target'</span>, <span class="st">'R2'</span>])</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>df_r2.set_index(<span class="st">'Target'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform clustering on R2 values</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>r2_linkage <span class="op">=</span> hierarchy.linkage(df_r2, method<span class="op">=</span><span class="st">'average'</span>)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate figure size based on number of targets</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>n_targets <span class="op">=</span> <span class="bu">len</span>(df_r2)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>fig_height <span class="op">=</span> <span class="bu">max</span>(<span class="dv">8</span>, n_targets <span class="op">*</span> <span class="fl">0.4</span>)  <span class="co"># Ensure a minimum height of 8</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>fig_width <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a clustered heatmap</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>cluster_map <span class="op">=</span> sns.clustermap(df_r2, </span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>                             cmap<span class="op">=</span><span class="st">'YlGnBu'</span>, </span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>                             annot<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>                             fmt<span class="op">=</span><span class="st">'.4f'</span>,</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>                             figsize<span class="op">=</span>(fig_width, fig_height),</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>                             dendrogram_ratio<span class="op">=</span>(<span class="fl">.2</span>, <span class="fl">.01</span>),</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>                             col_cluster<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>                             row_linkage<span class="op">=</span>r2_linkage,</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>                             cbar_pos<span class="op">=</span>(<span class="fl">.02</span>, <span class="fl">.4</span>, <span class="fl">.03</span>, <span class="fl">.4</span>))</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Rotate x-axis labels</span></span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>plt.setp(cluster_map.ax_heatmap.get_xticklabels(), rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust the layout</span></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>cluster_map.figure.subplots_adjust(top<span class="op">=</span><span class="fl">0.9</span>)</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>cluster_map.ax_heatmap.set_title(<span class="st">'Clustered R2 Scores Heatmap'</span>)</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="xgboost_tuned_files/figure-html/cell-45-output-1.png" width="1189" height="4145" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-70" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use the predefined lists of immune score subgroups</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract R2 scores into a DataFrame</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>r2_data <span class="op">=</span> {target: metrics.test_r2 <span class="cf">for</span> target, metrics <span class="kw">in</span> tuned_results.items()}</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>df_r2 <span class="op">=</span> pd.DataFrame(<span class="bu">list</span>(r2_data.items()), columns<span class="op">=</span>[<span class="st">'Target'</span>, <span class="st">'R2'</span>])</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a 'Group' column based on the predefined groups</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>df_r2[<span class="st">'Group'</span>] <span class="op">=</span> df_r2[<span class="st">'Target'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">next</span>((k <span class="cf">for</span> k, v <span class="kw">in</span> imscore_series_dict.items() <span class="cf">if</span> x <span class="kw">in</span> v), <span class="st">'Other'</span>))</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort the DataFrame by group and then by R2 score within each group</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>df_r2 <span class="op">=</span> df_r2.sort_values([<span class="st">'Group'</span>, <span class="st">'R2'</span>], ascending<span class="op">=</span>[<span class="va">True</span>, <span class="va">False</span>])</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>df_r2 <span class="op">=</span> df_r2.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a color palette for the groups</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>palette <span class="op">=</span> sns.color_palette(<span class="st">"husl"</span>, <span class="bu">len</span>(imscore_series_dict))</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>group_colors <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(imscore_series_dict.keys(), palette))</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="bu">len</span>(df_r2) <span class="op">*</span> <span class="fl">0.4</span> <span class="op">+</span> <span class="dv">2</span>))</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the heatmap</span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>sns.heatmap(df_r2.set_index(<span class="st">'Target'</span>)[[<span class="st">'R2'</span>]], </span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>            cmap<span class="op">=</span><span class="st">'YlGnBu'</span>, </span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>            annot<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>            fmt<span class="op">=</span><span class="st">'.4f'</span>, </span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>            cbar_kws<span class="op">=</span>{<span class="st">'label'</span>: <span class="st">'R2 Score'</span>})</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Add colored bars to indicate groups</span></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (idx, row) <span class="kw">in</span> <span class="bu">enumerate</span>(df_r2.iterrows()):</span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>    plt.annotate(<span class="st">''</span>, xy<span class="op">=</span>(<span class="op">-</span><span class="fl">0.1</span>, i), xytext<span class="op">=</span>(<span class="op">-</span><span class="fl">0.5</span>, i),</span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>                 arrowprops<span class="op">=</span><span class="bu">dict</span>(arrowstyle<span class="op">=</span><span class="st">'-'</span>, color<span class="op">=</span>group_colors.get(row[<span class="st">'Group'</span>], <span class="st">'gray'</span>),</span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a>                                 lw<span class="op">=</span><span class="dv">5</span>),</span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>                 va<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Customize the plot</span></span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'R2 Scores Grouped by Target Categories'</span>, pad<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Targets'</span>)</span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a>plt.xticks([])  <span class="co"># Remove x-axis labels as they're redundant</span></span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a>plt.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, which<span class="op">=</span><span class="st">'major'</span>, labelsize<span class="op">=</span><span class="dv">8</span>, rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb52-39"><a href="#cb52-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-40"><a href="#cb52-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a legend for groups</span></span>
<span id="cb52-41"><a href="#cb52-41" aria-hidden="true" tabindex="-1"></a>handles <span class="op">=</span> [plt.Rectangle((<span class="dv">0</span>,<span class="dv">0</span>),<span class="dv">1</span>,<span class="dv">1</span>, color<span class="op">=</span>group_colors[group]) <span class="cf">for</span> group <span class="kw">in</span> imscore_series_dict.keys()]</span>
<span id="cb52-42"><a href="#cb52-42" aria-hidden="true" tabindex="-1"></a>plt.legend(handles, imscore_series_dict.keys(), title<span class="op">=</span><span class="st">'Target Groups'</span>, </span>
<span id="cb52-43"><a href="#cb52-43" aria-hidden="true" tabindex="-1"></a>           bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb52-44"><a href="#cb52-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-45"><a href="#cb52-45" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb52-46"><a href="#cb52-46" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'HR&gt;1': ['S_TREM1_data', 'S_CHANG_CORE_SERUM_RESPONSE_UP', 'S_IL8_21978456'], 'HR&gt;1_worst_10_prog': ['S_TGFB_score_21050467', 'S_TGFB_PCA_17349583', 'S_Lymph_Vessels', 'S_Rotterdam_ERneg_PCA_15721472', 'S_IFNG_score_21050467', 'S_Module11_Prolif_score', 'S_TREM1_data'], 'HR&lt;1': ['S_Buck14_score', 'S_Bcell_receptors_score', 'S_TFH', 'S_CD103pos_mean_25446897', 'S_T_helper'], 'HR&lt;1_best_10_prog': ['S_Buck14_score', 'S_Bcell_receptors_score', 'S_TFH', 'S_CD103pos_mean_25446897', 'S_T_helper', 'S_Attractors_G_SLAMF6', 'S_ICS5_score'], 'cytokine_chemokine_activator': ['S_Expanded_IFNg', 'S_IL2_score_21050467', 'S_IL12_score_21050467', 'S_IFNG_score_21050467', 'S_IR7_score', 'S_Interferon_19272155', 'S_Minterferon_Cluster_21214954', 'S_Interferon_Cluster_21214954', 'S_IFN_21978456', 'S_Attractors_IFIT3', 'S_Module3_IFN_score'], 'activator_T': ['S_T_cells', 'S_Tcell_receptors_score', 'S_Tcell_21978456', 'S_CD8_Tcells', 'S_CD8A', 'S_T_helper', 'S_Th17', 'S_Tcm', 'S_Tem', 'S_Th1', 'S_TFH', 'S_Cytotoxic_cells', 'C_TcellsCD4memoryresting', 'S_T_cell_PCA_16704732', 'S_Attractors_G_CD3E', 'S_Tgd', 'S_CD8_PCA_16704732', 'S_Module4_TcellBcell_score', 'S_Module5_TcellBcell_score', 'S_CD8_CD68_ratio', 'S_ICR_SCORE', 'S_ICR_ACT_SCORE', 'S_GRANS_PCA_16704732'], 'suppressor_T': ['S_Treg', 'S_TGFB_score_21050467', 'S_CTLA4_data', 'S_PD1_data', 'S_PDL1_data', 'S_PD1_PDL1_score', 'S_IL4_score_21050467', 'S_IL13_score_21050467', 'S_TGFB_PCA_17349583', 'S_TcClassII_score', 'S_KEGG_TGF_Beta', 'S_ICR_INHIB_SCORE'], 'B_cell_all': ['S_CSR_Activated_15701700', 'S_Bcell_receptors_score', 'S_B_cell_PCA_16704732'], 'innate_cell_all': ['S_pDC'], 'general': ['S_Buck14_score', 'S_Rotterdam_ERneg_PCA_15721472', 'S_KEGG_Cytosolic_DNA_Sensing']}</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="xgboost_tuned_files/figure-html/cell-46-output-2.png" width="1208" height="4791" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-71" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.colors <span class="im">import</span> LinearSegmentedColormap</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract R2 scores into a DataFrame</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>r2_data <span class="op">=</span> {target: metrics.test_r2 <span class="cf">for</span> target, metrics <span class="kw">in</span> tuned_results.items()}</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>df_r2 <span class="op">=</span> pd.DataFrame(<span class="bu">list</span>(r2_data.items()), columns<span class="op">=</span>[<span class="st">'Target'</span>, <span class="st">'R2'</span>])</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a 'Group' column based on the predefined groups</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>df_r2[<span class="st">'Group'</span>] <span class="op">=</span> df_r2[<span class="st">'Target'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">next</span>((k <span class="cf">for</span> k, v <span class="kw">in</span> imscore_series_dict.items() <span class="cf">if</span> x <span class="kw">in</span> v), <span class="st">'Other'</span>))</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort the DataFrame by group and then by R2 score within each group</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>df_r2 <span class="op">=</span> df_r2.sort_values([<span class="st">'Group'</span>, <span class="st">'R2'</span>], ascending<span class="op">=</span>[<span class="va">True</span>, <span class="va">False</span>])</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>springpastel <span class="op">=</span> [<span class="st">"#fd7f6f"</span>, <span class="st">"#7eb0d5"</span>, <span class="st">"#b2e061"</span>, <span class="st">"#bd7ebe"</span>, <span class="st">"#ffb55a"</span>, <span class="st">"#ebdc78"</span>, <span class="st">"#beb9db"</span>, <span class="st">"#fdcce5"</span>, <span class="st">"#8bd3c7"</span>, <span class="st">"#7c1158"</span>]</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a color palette for the groups</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>palette <span class="op">=</span> sns.color_palette(springpastel, <span class="bu">len</span>(imscore_series_dict))</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>group_colors <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(imscore_series_dict.keys(), palette))</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="bu">len</span>(df_r2) <span class="op">*</span> <span class="fl">0.2</span> <span class="op">+</span> <span class="dv">2</span>))</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a custom colormap for the heatmap</span></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>cmap <span class="op">=</span> LinearSegmentedColormap.from_list(<span class="st">"custom"</span>, [<span class="st">"#FFFFFF"</span>, <span class="st">"#4a4a4a"</span>])</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the heatmap</span></span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>sns.heatmap(df_r2.set_index(<span class="st">'Target'</span>)[[<span class="st">'R2'</span>]], cmap<span class="op">=</span>cmap, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">'.4f'</span>, cbar<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Color the y-axis labels based on their group</span></span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.gca()</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (idx, row) <span class="kw">in</span> <span class="bu">enumerate</span>(df_r2.iterrows()):</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>    ax.get_yticklabels()[i].set_color(group_colors.get(row[<span class="st">'Group'</span>], <span class="st">'gray'</span>))</span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>    ax.get_yticklabels()[i].set_fontweight(<span class="st">'bold'</span>)  <span class="co"># Make labels bold for better readability</span></span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Customize the plot</span></span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'R2 Scores Across Immune Score Subgroups'</span>, pad<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Immune Score Subgroups'</span>)</span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>plt.xticks([])  <span class="co"># Remove x-axis labels as they're redundant</span></span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>plt.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, which<span class="op">=</span><span class="st">'major'</span>, labelsize<span class="op">=</span><span class="dv">8</span>, rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a legend for groups</span></span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>handles <span class="op">=</span> [plt.Rectangle((<span class="dv">0</span>,<span class="dv">0</span>),<span class="dv">1</span>,<span class="dv">1</span>, color<span class="op">=</span>group_colors[group]) <span class="cf">for</span> group <span class="kw">in</span> imscore_series_dict.keys()]</span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a>plt.legend(handles, imscore_series_dict.keys(), title<span class="op">=</span><span class="st">'Immune Score Subgroups'</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="xgboost_tuned_files/figure-html/cell-47-output-1.png" width="1374" height="2491" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-72" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a faceted bar plot</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.FacetGrid(df_r2, col<span class="op">=</span><span class="st">"Group"</span>, col_wrap<span class="op">=</span><span class="dv">2</span>, height<span class="op">=</span><span class="dv">4</span>, aspect<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>g.<span class="bu">map</span>(sns.barplot, <span class="st">"Target"</span>, <span class="st">"R2"</span>, order<span class="op">=</span>df_r2.sort_values(<span class="st">'R2'</span>, ascending<span class="op">=</span><span class="va">False</span>)[<span class="st">'Target'</span>])</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>g.set_xticklabels(rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>g.set_axis_labels(<span class="st">""</span>, <span class="st">"R2 Score"</span>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>g.figure.suptitle(<span class="st">"R2 Scores by Immune Subgroups"</span>, y<span class="op">=</span><span class="fl">1.02</span>)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>g.tight_layout()</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="xgboost_tuned_files/figure-html/cell-48-output-1.png" width="1189" height="2453" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="conclusion" class="level4">
<h4 class="anchored" data-anchor-id="conclusion"><strong>Conclusion</strong></h4>
<p>Maybe XGBoost could not capture the weak nonlinear interactions between chosen X features and the immune scores despite hyperparameter tuning and cross-validation.</p>
<p>Whatâ€™s next?</p>
<ol type="1">
<li>Support Vector Regressor might fare better (with CV)</li>
<li>X features might not be informative enough. Worth considering adding other variables? Survival? Response to treatment?</li>
<li>This also implies that maybe the question needs to be reframed into a classification task?</li>
</ol>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>